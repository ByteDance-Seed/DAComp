examples:
  dacomp-de-impl-001:
    database_file: lever.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_lever__application:
            weight: 1
            compare_cols: [application_id, opportunity_id, posting_id, type, candidate_id, posting_hiring_manager_user_id, posting_owner_user_id, company, referrer_user_id, requisition_id, archived_at, archived_reason_id, comments, created_at]
          stg_lever__archive_reason:
            weight: 1
            compare_cols: [archive_reason_id, archive_reason_title]
          stg_lever__contact_email:
            weight: 1
            compare_cols: [contact_id, email]
          stg_lever__contact_link:
            weight: 1
            compare_cols: [contact_id, link]
          stg_lever__contact_phone:
            weight: 1
            compare_cols: [contact_id, phone_number, phone_type]
          stg_lever__feedback_form:
            weight: 1
            compare_cols: [creator_user_id, feedback_form_id, feedback_form_name, instructions, type]
          stg_lever__feedback_form_field:
            weight: 1
            compare_cols: [feedback_form_id, field_index, field_text, field_type]
          stg_lever__interview:
            weight: 1
            compare_cols: [interview_id, opportunity_id, candidate_id, stage_id, panel_id, creator_user_id, subject, location, gcal_event_url, feedback_reminder, note, duration]
          stg_lever__interview_feedback:
            weight: 1
            compare_cols: [feedback_form_id, interview_id]
          stg_lever__interviewer_user:
            weight: 1
            compare_cols: [interview_id, user_id]
          stg_lever__offer:
            weight: 1
            compare_cols: [offer_id, opportunity_id, candidate_id, creator_user_id, status]
          stg_lever__opportunity:
            weight: 1
            compare_cols: [opportunity_id, contact_name, contact_location, contact_headline, stage_id, owner_user_id, contact_id, origin, archived_reason_id, snoozed_until, is_data_protection_contact_allowed, is_data_protection_store_allowed, is_anonymized]
          stg_lever__opportunity_source:
            weight: 1
            compare_cols: [opportunity_id, source_name]
          stg_lever__opportunity_stage_history:
            weight: 1
            compare_cols: [opportunity_id, stage_id, updater_user_id, to_stage_index]
          stg_lever__opportunity_tag:
            weight: 1
            compare_cols: [opportunity_id, tag]
          stg_lever__posting:
            weight: 1
            compare_cols: [posting_id, posting_title, state, categories_commitment, categories_department, categories_level, categories_location, categories_team, content_description, content_description_html, content_closing, content_closing_html, creator_user_id, owner_user_id, requisition_code]
          stg_lever__posting_interview:
            weight: 1
            compare_cols: [interview_id, posting_id]
          stg_lever__posting_tag:
            weight: 1
            compare_cols: [posting_id, tag]
          stg_lever__requisition:
            weight: 1
            compare_cols: [backfill, compensation_band_currency, compensation_band_interval, compensation_band_max, compensation_band_min, creator_user_id, employment_status, headcount_infinite, hiring_manager_user_id, internal_notes, location, owner_user_id, requisition_code, requisition_id, requisition_name, status, team]
          stg_lever__requisition_offer:
            weight: 1
            compare_cols: [offer_id, requisition_id]
          stg_lever__requisition_posting:
            weight: 1
            compare_cols: [posting_id, requisition_id]
          stg_lever__resume:
            weight: 1
            compare_cols: [resume_id, opportunity_id, file_ext, file_name, file_download_url]
          stg_lever__stage:
            weight: 1
            compare_cols: [stage_id, stage_name]
          stg_lever__user:
            weight: 1
            compare_cols: [user_id, access_role, email, user_name, username, external_directory_user_id, photo]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_lever__candidate_insights:
            weight: 1
            compare_cols: [avg_interview_duration, canceled_interviews, candidate_quality_score, completed_feedback, completed_interviews, contact_id, contact_name, current_stage, is_archived, negative_feedback, opportunity_id, owner_user_id, positive_feedback, stage_id, total_feedback, total_interview_time, total_interviews]
          int_lever__candidate_lifecycle:
            weight: 1
            compare_cols: [all_recommendations, archived_reason_id, avg_days_per_stage, avg_recommendation_score, canceled_interviews, communication_frequency_score, completed_feedback_count, completed_interviews, contact_id, current_stage_id, current_stage_name, days_since_last_advancement, feedback_completion_rate_pct, has_offer, is_archived, is_hired, last_interaction_type, opportunity_id, posting_id, total_feedback_count, total_interactions, total_interviews, total_lifecycle_days, total_stages_passed]
          int_lever__contact_info:
            weight: 1
            compare_cols: [contact_id, github_link, linkedin_link]
          int_lever__hiring_funnel_metrics:
            weight: 1
            compare_cols: [avg_days_screening_to_technical, avg_days_to_screening, avg_total_days_to_hire, categories_department, categories_level, categories_location, categories_team, posting_id, posting_title, primary_bottleneck, reached_final_count, reached_hired_count, reached_offer_count, reached_screening_count, reached_technical_count, total_applications]
          int_lever__interview_feedback:
            weight: 1
            compare_cols: [candidate_id, creator_user_id, feedback_form_id, feedback_reminder, gcal_event_url, interview_date, interview_id, location, note, opportunity_id, panel_id, stage_id, subject]
          int_lever__interview_users:
            weight: 1
            compare_cols: [candidate_id, creator_user_id, duration, feedback_reminder, gcal_event_url, interview_date, interview_id, interviewer_email, interviewer_name, interviewer_user_id, location, note, opportunity_id, panel_id, stage_id, subject, timezone]
          int_lever__interviewer_performance:
            weight: 1
            compare_cols: [activity_status, canceled_interviews, completed_interviews, interviewer_email, interviewer_name, interviewer_role, interviewer_user_id, negative_outcomes, overall_performance_score, performance_tier, positive_outcome_rate, positive_outcomes, total_feedback_given, total_interviews, total_outcomes]
          int_lever__opportunity_application:
            weight: 1
            compare_cols: [application_id, application_type, archived_reason_id, comments, company, contact_headline, contact_id, contact_location, contact_name, data_protection_store_expires_at, is_anonymized, is_data_protection_contact_allowed, is_data_protection_store_allowed, last_advanced_at, last_interaction_at, opportunity_id, origin, owner_user_id, posting_hiring_manager_user_id, posting_id, posting_owner_user_id, referrer_user_id, requisition_id, snoozed_until, stage_id]
          int_lever__opportunity_contact_info:
            weight: 1
            compare_cols: [application_id, application_type, archived_reason_id, comments, company, contact_headline, contact_id, contact_location, contact_name, github_link, is_anonymized, is_data_protection_contact_allowed, is_data_protection_store_allowed, linkedin_link, opportunity_id, origin, owner_user_id, posting_hiring_manager_user_id, posting_id, posting_owner_user_id, referrer_user_id, requisition_id, snoozed_until, stage_id]
          int_lever__opportunity_tags:
            weight: 1
            compare_cols: [opportunity_id, tags]
          int_lever__opportunity_users:
            weight: 1
            compare_cols: [application_id, application_type, archived_reason_id, comments, company, contact_headline, contact_id, contact_location, contact_name, data_protection_contact_expires_at, data_protection_store_expires_at, hiring_manager_name, is_anonymized, is_data_protection_contact_allowed, is_data_protection_store_allowed, last_interaction_at, opportunity_id, opportunity_owner_name, origin, owner_user_id, posting_hiring_manager_user_id, posting_id, posting_owner_user_id, referrer_name, referrer_user_id, requisition_id, snoozed_until, stage_id]
          int_lever__posting_analytics:
            weight: 1
            compare_cols: [application_to_hire_rate_pct, avg_days_to_last_contact, avg_interview_duration_minutes, canceled_interviews, candidates_hired, candidates_rejected, categories_commitment, categories_department, categories_level, categories_location, categories_team, completed_interviews, creator_user_id, days_to_first_application, internal_application_rate_pct, internal_applications, interview_completion_rate_pct, median_days_to_advancement, offer_acceptance_rate_pct, offers_extended, owner_user_id, performance_tier, posting_effectiveness_score, posting_id, posting_state, posting_title, primary_bottleneck, referral_rate_pct, referred_applications, total_applications, total_interview_time_minutes, total_interviews_scheduled, unique_candidates, unique_interviewers, unique_opportunities]
          int_lever__posting_applications:
            weight: 1
            compare_cols: [count_manual_user_applications, count_open_opportunities, count_opportunities, count_posting_applications, count_referred_applications, posting_hiring_manager_user_id, posting_id]
          int_lever__posting_interviews:
            weight: 1
            compare_cols: [count_interview_coordinators, count_interviews, latest_interview_created_at, posting_id]
          int_lever__posting_performance:
            weight: 1
            compare_cols: [active_candidates_30d, application_to_hire_rate, application_to_interview_rate, application_to_offer_rate, archived_candidates, canceled_interviews, candidates_hired, candidates_reached_interview, candidates_reached_offer, candidates_with_email, candidates_with_phone, candidates_with_resume, categories_commitment, categories_department, categories_level, categories_location, categories_team, completed_interviews, creator_user_id, days_to_first_application, external_applications, first_application_date, internal_applications, interview_completion_rate, last_application_date, offer_to_hire_rate, owner_user_id, performance_tier, posting_id, posting_performance_score, posting_state, posting_status_analysis, posting_title, referral_rate, referred_applications, requisition_code, total_applications, total_interviews_scheduled, unique_candidates, unique_opportunities]
          int_lever__posting_tags:
            weight: 1
            compare_cols: [posting_id, tags]
          int_lever__requisition_users:
            weight: 1
            compare_cols: [backfill, compensation_band_currency, compensation_band_interval, compensation_band_max, compensation_band_min, creator_name, creator_user_id, employment_status, headcount_infinite, hiring_manager_user_id, internal_notes, location, owner_name, owner_user_id, requisition_code, requisition_id, requisition_name, status, team]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          lever__candidate_experience_insights:
            weight: 1
            compare_cols: [application_date, archive_reason, avg_interview_duration_minutes, avg_recommendation_score, candidate_anxiety_level, contact_id, contact_name, current_stage, days_from_application_to_last_advancement, days_from_application_to_last_contact, days_since_last_advancement, experience_grade, experience_risk_flag, feedback_completion_rate_pct, improvement_recommendations, interview_burden_category, interview_completion_rate_pct, interview_consistency_score, interview_experience_score, is_archived, opportunity_id, outcome_fairness_score, overall_candidate_experience_score, process_completeness_assessment, response_quality, timeline_experience_score, total_interviews, total_lifecycle_days, transparency_score]
          lever__candidate_quality_insights:
            weight: 1
            compare_cols: [analysis_date, basic_quality_candidates, best_department, best_job_level, best_source_type, exceptional_candidates, good_quality_candidates, high_quality_candidates, key_finding_overall, key_finding_source, low_quality_avg_lifecycle_days, low_quality_candidates, low_quality_interview_completion_rate, median_quality_score, overall_avg_quality_score, p75_quality_score, primary_recommendation, process_recommendation, report_title, total_candidates_analyzed]
          lever__departmental_hiring_trends:
            weight: 1
            compare_cols: [active_postings, applications_per_hire, avg_applications_per_posting, avg_candidate_experience_score, avg_interview_duration_minutes, avg_interviews_per_hire, avg_screening_pass_rate, avg_time_to_hire_days, candidate_experience_rank, candidates_hired, commitment_type, conversion_efficiency_rank, cost_efficiency_tier, department, department_performance_score, department_strength, high_efficiency_postings, hire_conversion_rate, hires_per_posting, hiring_volume_rank, interview_completion_rate, interview_hours_per_hire, level, location, offer_acceptance_rate, offers_extended, performance_tier, positive_experience_rate, referral_rate, team, total_applications, total_interviews_conducted, unique_candidates, unique_interviewers]
          lever__hiring_dashboard:
            weight: 1
            compare_cols: [avg_candidate_lifecycle_days, dashboard_title, hires_last_30_days, report_date]
          lever__hiring_dashboard_simple:
            weight: 1
            compare_cols: [dashboard_title, report_date]
          lever__hiring_dashboard_working:
            weight: 1
            compare_cols: [applications_last_30_days, avg_candidate_lifecycle_days, hires_last_30_days, report_date]
          lever__hiring_manager_scorecard:
            weight: 1
            compare_cols: [access_role, avg_applications_per_posting, avg_candidate_experience_score, avg_candidate_lifecycle_days, avg_posting_conversion_rate, avg_posting_performance_score, avg_salary_range_width, avg_total_days_to_hire, candidate_hire_rate, current_open_requisitions, decision_speed_category, departments_managed, development_recommendations, feedback_completion_rate_managed, high_efficiency_postings, high_performing_posting_rate, hiring_manager_email, hiring_manager_id, hiring_manager_name, hiring_specialization, interview_success_rate, interviewer_network_size, joined_date, overall_performance_score, performance_tier, positive_experience_candidates, requisition_fill_rate, teams_supported, total_applications_received, total_candidates_hired, total_candidates_managed, total_filled_requisitions, total_interviews_coordinated, total_postings_owned, total_requisitions_owned]
          lever__interview_enhanced:
            weight: 1
            compare_cols: [candidate_id, creator_user_id, duration, feedback_reminder, gcal_event_url, has_advanced_since_interview, hiring_manager_name, interview_date, interview_id, interviewee_contact_id, interviewee_location, interviewee_name, interviewee_origin, interviewer_email, interviewer_is_hiring_manager, interviewer_name, interviewer_user_id, location, note, opportunity_id, opportunity_owner_name, panel_id, referrer_name, stage_id, subject, timezone]
          lever__opportunity_enhanced:
            weight: 1
            compare_cols: [application_id, application_type, archive_reason, archived_reason_id, comments, company, contact_headline, contact_id, contact_location, contact_name, current_offer_status, current_stage, current_state_of_job_posting, emails, github_link, has_offer, is_anonymized, is_data_protection_contact_allowed, is_data_protection_store_allowed, job_commitment, job_location, job_team, job_title, linkedin_link, opportunity_id, origin, owner_user_id, posting_hiring_manager_user_id, posting_id, posting_owner_user_id, referrer_user_id, requisition_id, snoozed_until, stage_id, tags]
          lever__opportunity_stage_history:
            weight: 1
            compare_cols: [application_sources, archive_reason, days_in_stage, job_location, job_team, job_title, opportunity_contact_name, opportunity_id, stage, updater_user_name, valid_from]
          lever__posting_enhanced:
            weight: 1
            compare_cols: [categories_commitment, categories_department, categories_level, categories_location, categories_team, content_closing, content_closing_html, content_description, content_description_html, count_interviewees, count_manual_user_applications, count_open_opportunities, count_opportunities, count_posting_applications, count_referred_applications, count_requisitions, creator_user_id, has_requisition, owner_user_id, posting_id, posting_title, requisition_code, state, tags]
          lever__recruitment_analytics_dashboard:
            weight: 1
            compare_cols: [recruitment_health_grade, recruitment_health_score, report_date, report_title, total_applications, total_candidates, total_postings]
          lever__requisition_enhanced:
            weight: 1
            compare_cols: [backfill, compensation_band_currency, compensation_band_interval, compensation_band_max, compensation_band_min, count_offers, count_postings, creator_name, creator_user_id, employment_status, has_offer, has_posting, headcount_infinite, hiring_manager_user_id, internal_notes, location, owner_name, owner_user_id, requisition_code, requisition_id, requisition_name, status, team]
          test_timestamp:
            weight: 1
            compare_cols: []
  dacomp-de-impl-002:
    database_file: pendo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_pendo__account_history:
            weight: 1
            compare_cols: [account_id, account_id_hash, first_visit_at, last_updated_at, last_visit_at]
          stg_pendo__application_history:
            weight: 1
            compare_cols: [agent_policy_prod, agent_policy_staging, agent_version_prod, agent_version_staging, application_id, application_name, created_by_user_id, description, display_name, event_count, first_event_at, is_deleted, is_integrated, last_updated_at, last_updated_by_user_id, platform, subscription_id]
          stg_pendo__event:
            weight: 1
            compare_cols: [account_id, app_id, event_key, num_events, num_minutes, occurred_at, page_id, remote_ip, server_name, user_agent, visitor_id]
          stg_pendo__feature_event:
            weight: 1
            compare_cols: [account_id, app_id, feature_id, num_events, num_minutes, remote_ip, server_name, user_agent, visitor_id]
          stg_pendo__feature_history:
            weight: 1
            compare_cols: [app_id, created_by_user_id, feature_id, feature_name, group_id, is_core_event, is_dirty, last_updated_at, last_updated_by_user_id, page_id, root_version_id, stable_version_id, valid_through]
          stg_pendo__group:
            weight: 1
            compare_cols: [app_id, group_id, group_name]
          stg_pendo__guide_event:
            weight: 1
            compare_cols: [account_id, app_id, country, guide_event_key, guide_id, guide_step_id, latitude, longitude, region, remote_ip, server_name, type, url, user_agent, visitor_id]
          stg_pendo__guide_history:
            weight: 1
            compare_cols: [app_id, created_by_user_id, device_type, guide_id, guide_name, is_multi_step, is_training, last_updated_at, last_updated_by_user_id, launch_method, published_at, recurrence, recurrence_eligibility_window, reset_at, root_version_id, stable_version_id, state]
          stg_pendo__guide_step_history:
            weight: 1
            compare_cols: [guide_id, guide_last_updated_at, step_id]
          stg_pendo__page_event:
            weight: 1
            compare_cols: [account_id, app_id, num_events, num_minutes, page_event_key, page_id, remote_ip, server_name, user_agent, visitor_id]
          stg_pendo__page_history:
            weight: 1
            compare_cols: [app_id, created_by_user_id, group_id, is_dirty, last_updated_at, last_updated_by_user_id, page_id, page_name, root_version_id, stable_version_id, valid_through]
          stg_pendo__page_rule_history:
            weight: 1
            compare_cols: [designer_hint, page_id, page_last_updated_at, parsed_rule, rule]
          stg_pendo__poll:
            weight: 1
            compare_cols: [attribute_display, attribute_max_length, attribute_type, follow_up_poll_id, poll_id, question, reset_at]
          stg_pendo__poll_event:
            weight: 1
            compare_cols: [account_id, app_id, country, guide_id, guide_step_id, latitude, longitude, poll_event_key, poll_id, poll_response, region, remote_ip, server_name, url, user_agent, visitor_id]
          stg_pendo__user:
            weight: 1
            compare_cols: [deleted_at, first_name, last_name, user_id, user_type, username]
          stg_pendo__visitor_account_history:
            weight: 1
            compare_cols: [account_id, visitor_id, visitor_last_updated_at]
          stg_pendo__visitor_history:
            weight: 1
            compare_cols: [account_id, first_visit_at, last_browser_name, last_browser_version, last_operating_system, last_server_name, last_updated_at, last_user_agent, last_visit, n_id, visitor_id, visitor_id_hash]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_pendo__account_daily_metrics:
            weight: 1
            compare_cols: [account_id, count_active_visitors, count_event_records, count_feature_clicking_visitors, count_features_clicked, count_page_viewing_visitors, count_pages_viewed, occurred_on, sum_events, sum_minutes]
          int_pendo__calendar_spine:
            weight: 1
            compare_cols: [date_day]
          int_pendo__conversion_funnel_analysis:
            weight: 1
            compare_cols: [account_id, app_id, avg_30d_feature_to_deep_rate, avg_30d_overall_conversion_rate, avg_30d_page_to_feature_rate, avg_engagement_score, avg_features_per_user, avg_pages_per_visitor, bounce_rate, conversion_rate_trend, event_date, feature_to_deep_conversion_rate, funnel_health_rating, high_quality_session_rate, optimization_recommendation, overall_conversion_rate, page_to_feature_conversion_rate, total_visitors, visitors_with_deep_engagement, visitors_with_feature_use, visitors_with_page_views]
          int_pendo__customer_rfm_analysis:
            weight: 1
            compare_cols: [account_at_risk_ratio, account_avg_rfm_score, account_high_value_ratio, account_id, account_top_segment_ratio, account_total_visitors, action_priority, average_daily_events, count_active_days, count_active_months, count_associated_accounts, customer_lifetime_days, customer_value_tier, frequency_score, magnitude_score, predicted_clv_tier, recency_days, recency_score, recommended_strategy, rfm_composite_score, rfm_segment, total_events, total_minutes, visitor_id]
          int_pendo__data_quality_checks:
            weight: 1
            compare_cols: [business_logic_score, consistency_score, overall_quality_score, report_section]
          int_pendo__feature_daily_metrics:
            weight: 1
            compare_cols: [avg_daily_clicks_per_visitor, avg_daily_minutes_per_visitor, count_accounts, count_click_events, count_first_time_accounts, count_first_time_visitors, count_return_accounts, count_return_visitors, count_visitors, feature_id, occurred_on, percent_of_daily_feature_accounts, percent_of_daily_feature_clicks, percent_of_daily_feature_visitors, sum_clicks]
          int_pendo__feature_info:
            weight: 1
            compare_cols: [app_display_name, app_id, app_platform, created_by_user_full_name, created_by_user_id, created_by_user_username, feature_id, feature_name, group_id, is_core_event, is_dirty, last_updated_at, last_updated_by_user_full_name, last_updated_by_user_id, last_updated_by_user_username, page_created_at, page_id, page_name, page_valid_through, product_area_name, root_version_id, stable_version_id, valid_through]
          int_pendo__guide_alltime_metrics:
            weight: 1
            compare_cols: [count_accounts, count_events, count_visitors, count_visitors_advanced, count_visitors_completed, count_visitors_dismissed, count_visitors_shown, count_visitors_snoozed, first_event_at, guide_id, last_event_at]
          int_pendo__guide_daily_metrics:
            weight: 1
            compare_cols: [count_accounts, count_first_time_accounts, count_first_time_visitors, count_guide_events, count_return_accounts, count_return_visitors, count_visitors, count_visitors_advanced, count_visitors_completed, count_visitors_dismissed, count_visitors_shown, guide_id, occurred_on, percent_of_daily_guide_accounts, percent_of_daily_guide_visitors]
          int_pendo__guide_info:
            weight: 1
            compare_cols: [app_display_name, app_id, app_platform, count_steps, created_by_user_full_name, created_by_user_id, created_by_user_username, device_type, guide_id, guide_name, is_multi_step, is_training, last_updated_by_user_full_name, last_updated_by_user_id, last_updated_by_user_username, launch_method, recurrence, recurrence_eligibility_window, root_version_id, stable_version_id, state]
          int_pendo__latest_account:
            weight: 1
            compare_cols: [account_id, account_id_hash, first_visit_at, last_updated_at, last_visit_at, latest_account_index]
          int_pendo__latest_application:
            weight: 1
            compare_cols: [agent_policy_prod, agent_policy_staging, agent_version_prod, agent_version_staging, application_id, application_name, created_by_user_id, description, display_name, event_count, first_event_at, is_deleted, is_integrated, last_updated_at, last_updated_by_user_id, latest_application_index, platform, subscription_id]
          int_pendo__latest_feature:
            weight: 1
            compare_cols: [app_id, created_by_user_id, feature_id, feature_name, group_id, is_core_event, is_dirty, last_updated_at, last_updated_by_user_id, latest_feature_index, page_id, root_version_id, stable_version_id, valid_through]
          int_pendo__latest_guide:
            weight: 1
            compare_cols: [app_id, created_by_user_id, device_type, guide_id, guide_name, is_multi_step, is_training, last_updated_at, last_updated_by_user_id, latest_guide_index, launch_method, published_at, recurrence, recurrence_eligibility_window, reset_at, root_version_id, stable_version_id, state]
          int_pendo__latest_guide_step:
            weight: 1
            compare_cols: [guide_id, latest_guide_step_index, step_id]
          int_pendo__latest_nps_rating:
            weight: 1
            compare_cols: [account_id, nps_rating, visitor_id]
          int_pendo__latest_page:
            weight: 1
            compare_cols: [app_id, created_by_user_id, group_id, is_dirty, last_updated_at, last_updated_by_user_id, latest_page_index, page_id, page_name, root_version_id, stable_version_id, valid_through]
          int_pendo__latest_page_rule:
            weight: 1
            compare_cols: [designer_hint, latest_page_rule_index, page_id, parsed_rule, rule]
          int_pendo__latest_visitor:
            weight: 1
            compare_cols: [account_id, first_visit_at, last_browser_name, last_browser_version, last_operating_system, last_server_name, last_updated_at, last_user_agent, last_visit, latest_visitor_index, n_id, visitor_id, visitor_id_hash]
          int_pendo__latest_visitor_account:
            weight: 1
            compare_cols: [account_id, latest_visitor_account_index, visitor_id, visitor_last_updated_at]
          int_pendo__page_daily_metrics:
            weight: 1
            compare_cols: [avg_daily_minutes_per_visitor, avg_daily_pageviews_per_visitor, count_accounts, count_first_time_accounts, count_first_time_visitors, count_pageview_events, count_return_accounts, count_return_visitors, count_visitors, occurred_on, page_id, percent_of_daily_page_accounts, percent_of_daily_page_visitors, percent_of_daily_pageviews, sum_pageviews]
          int_pendo__page_info:
            weight: 1
            compare_cols: [app_display_name, app_id, app_platform, count_active_features, created_by_user_full_name, created_by_user_id, created_by_user_username, group_id, is_dirty, last_updated_by_user_full_name, last_updated_by_user_id, last_updated_by_user_username, page_id, page_name, product_area_name, root_version_id, rules, stable_version_id, valid_through]
          int_pendo__product_health_metrics:
            weight: 1
            compare_cols: [account_id, app_id, avg_active_days_per_user, avg_events_per_session, avg_features_per_user, avg_lifetime_events, avg_nps_score, avg_session_duration, deep_engagement_session_rate, detractor_rate, feature_adoption_rate, feature_depth_adoption_rate, features_used, health_grade, highly_active_user_rate, net_promoter_score, overall_health_score, power_user_rate, primary_improvement_area, promoter_rate, retention_30d, retention_7d, retention_90d, risk_level, sessions_per_user, total_features_available, user_feature_adoption_rate]
          int_pendo__user_lifecycle_segments:
            weight: 1
            compare_cols: [average_daily_events, average_daily_minutes, count_active_days, count_active_months, days_since_last_active, first_event_on, is_new_user, is_valuable_user, last_event_on, lifecycle_stage, needs_attention, sum_events, sum_minutes, usage_intensity, user_age_days, user_value_score, visitor_id]
          int_pendo__visitor_daily_metrics:
            weight: 1
            compare_cols: [count_event_records, count_features_clicked, count_pages_viewed, occurred_on, sum_events, sum_minutes, visitor_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          account:
            weight: 1
            compare_cols: [account_id, account_id_hash, average_daily_events, average_daily_minutes, avg_nps_rating, count_active_days, count_active_months, count_active_visitors, count_associated_visitors, count_event_records, count_feature_clicking_visitors, count_page_viewing_visitors, first_event_on, last_event_on, latest_account_index, max_nps_rating, min_nps_rating, sum_events, sum_minutes]
          account_daily_metrics:
            weight: 1
            compare_cols: [account_id, count_active_visitors, count_event_records, count_feature_clicking_visitors, count_features_clicked, count_page_viewing_visitors, count_pages_viewed, date_day, sum_events, sum_minutes]
          customer_lifecycle_insights:
            weight: 1
            compare_cols: [visitor_id, account_id, first_event_on, last_event_on, count_active_months, sum_events, sum_minutes, average_daily_events, average_daily_minutes, count_associated_accounts, lifecycle_stage, user_value_score, engagement_trend, churn_risk_level, is_valuable_user, needs_attention, is_new_user, activity_density, usage_intensity, rfm_segment, customer_value_tier, recency_score, frequency_score, magnitude_score, rfm_composite_score, recommended_strategy, predicted_clv_tier, action_priority, overall_health_score, health_grade, primary_improvement_area, product_risk_level, net_promoter_score, feature_adoption_rate, account_retention_30d, customer_segment_label, comprehensive_customer_value, recommended_next_action, customer_journey_stage, predicted_ltv_tier, engagement_velocity, usage_trend, account_influence_level, customer_importance_level, investment_expectation]
          executive_dashboard_metrics:
            weight: 1
            compare_cols: [avg_customer_value, avg_feature_adoption, avg_platform_health_score, avg_retention_rate, calculation_date, conversion_opportunities, conversion_rate, customers_needing_attention, excellent_revenue_accounts, growth_trend_assessment, high_growth_accounts, high_risk_accounts, low_risk_accounts, medium_risk_accounts, new_customers_onboarding, overall_business_health_score, paying_accounts, platform_total_users, primary_alert_status, strategic_customers, strategic_recommendation, total_accounts, user_growth_rate_7d]
          feature:
            weight: 1
            compare_cols: [app_display_name, app_id, app_platform, avg_visitor_events, avg_visitor_minutes, count_accounts, count_click_events, count_visitors, created_by_user_full_name, created_by_user_id, created_by_user_username, feature_id, feature_name, first_click_at, group_id, is_core_event, is_dirty, last_click_at, last_updated_at, last_updated_by_user_full_name, last_updated_by_user_id, last_updated_by_user_username, page_created_at, page_id, page_name, page_valid_through, product_area_name, root_version_id, stable_version_id, sum_clicks, valid_through]
          feature_daily_metrics:
            weight: 1
            compare_cols: [avg_daily_clicks_per_visitor, avg_daily_minutes_per_visitor, count_accounts, count_click_events, count_first_time_accounts, count_first_time_visitors, count_return_accounts, count_return_visitors, count_visitors, date_day, feature_id, percent_of_daily_feature_accounts, percent_of_daily_feature_clicks, percent_of_daily_feature_visitors, product_area_name, sum_clicks]
          feature_event:
            weight: 1
            compare_cols: [account_id, app_display_name, app_id, app_platform, feature_event_key, feature_id, feature_name, num_events, num_minutes, occurred_at, page_id, page_name, previous_feature_id, previous_feature_name, previous_feature_num_events, previous_feature_num_minutes, previous_feature_page_id, previous_feature_page_name, previous_feature_product_area_id, previous_feature_product_area_name, product_area_id, product_area_name, remote_ip, server_name, user_agent, visitor_id]
          guide:
            weight: 1
            compare_cols: [app_display_name, app_id, app_platform, count_accounts, count_steps, count_visitors, count_visitors_advanced, count_visitors_dismissed, count_visitors_shown, created_by_user_full_name, created_by_user_id, created_by_user_username, device_type, guide_id, guide_name, is_multi_step, is_training, last_updated_by_user_full_name, last_updated_by_user_id, last_updated_by_user_username, launch_method, recurrence, recurrence_eligibility_window, root_version_id, stable_version_id, state]
          guide_daily_metrics:
            weight: 1
            compare_cols: [date_day, guide_id]
          guide_event:
            weight: 1
            compare_cols: [account_id, app_display_name, app_id, app_platform, country, guide_event_key, guide_id, guide_name, guide_step_id, latitude, longitude, region, remote_ip, server_name, type, url, user_agent, visitor_id]
          page:
            weight: 1
            compare_cols: [app_id, avg_visitor_minutes, avg_visitor_pageviews, count_accounts, count_pageview_events, count_visitors, created_by_user_id, group_id, is_dirty, last_updated_at, last_updated_by_user_id, latest_page_index, page_id, page_name, root_version_id, stable_version_id, sum_pageviews, valid_through]
          page_daily_metrics:
            weight: 1
            compare_cols: [avg_daily_minutes_per_visitor, avg_daily_pageviews_per_visitor, count_accounts, count_first_time_accounts, count_first_time_visitors, count_pageview_events, count_return_accounts, count_return_visitors, count_visitors, date_day, page_id, percent_of_daily_page_accounts, percent_of_daily_page_visitors, percent_of_daily_pageviews, sum_pageviews]
          page_event:
            weight: 1
            compare_cols: [account_id, app_id, num_events, num_minutes, page_event_key, page_id, page_name, previous_page_id, previous_page_name, previous_page_num_events, previous_page_num_minutes, previous_page_product_area_id, product_area_id, remote_ip, server_name, user_agent, visitor_id]
          product_adoption_analytics:
            weight: 1
            compare_cols: [feature_id, feature_name, is_core_event, page_name, app_id, total_users_tried, avg_events_per_user, avg_minutes_per_user, avg_active_days_per_user, regular_users, casual_users]
          product_adoption_summary:
            weight: 1
            compare_cols: [feature_id, account_id, app_id, total_users, usage_sessions, total_events, avg_events_per_session, avg_minutes_per_session, adoption_level, feature_health_score]
          visitor:
            weight: 1
            compare_cols: [account_id, average_daily_events, average_daily_minutes, count_active_days, count_active_months, count_associated_accounts, count_event_records, first_event_on, first_visit_at, last_browser_name, last_browser_version, last_event_on, last_operating_system, last_server_name, last_updated_at, last_user_agent, last_visit, latest_nps_rating, latest_visitor_index, n_id, sum_events, sum_minutes, visitor_id, visitor_id_hash]
          visitor_daily_metrics:
            weight: 1
            compare_cols: [date_day, visitor_id, count_event_records, count_features_clicked, sum_events, sum_minutes]
          visitor_feature:
            weight: 1
            compare_cols: [visitor_id, feature_id, sum_clicks, sum_minutes, avg_daily_minutes, count_active_days, count_click_events]
  dacomp-de-impl-003:
    database_file: customer360.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_customer360__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_code_numeric, country_name]
          stg_customer360__nicknames:
            weight: 1
            compare_cols: [canonical_name, nickname]
          stg_customer360__state_territory_codes:
            weight: 1
            compare_cols: [alpha2_country_code, state_code, state_territory]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_customer360__customer_behavior_analysis:
            weight: 1
            compare_cols: [account_age_days, address_data_quality, churn_risk_level, composite_engagement_score, customer_first_touchpoint, customer_journey_pattern, customer_last_activity, customer_maturity, customer_segment, email_domain, has_contact_phone, in_marketo, in_stripe, in_zendesk, marketo_engagement, marketo_lead_id, organization_data_quality, payment_reliability, primary_email, primary_organization, recommended_action, stripe_customer_id, stripe_engagement, zendesk_engagement, zendesk_user_id]
          int_customer360__customer_lifecycle_metrics:
            weight: 1
            compare_cols: [account_age_days, acquisition_cohort_month, acquisition_month, acquisition_season, acquisition_year, action_priority, active_180_days, active_30_days, active_365_days, active_60_days, active_90_days, churn_probability, customer_first_touchpoint, customer_health_score, customer_journey_pattern, customer_last_activity, customer_segment, customer_tier, days_since_last_activity, estimated_customer_ltv, estimated_customer_value, estimated_transaction_count, expected_retention_rate, frequency_score, growth_potential, intervention_urgency, is_strategic_account, lifecycle_stage, marketo_lead_id, months_since_acquisition, performance_vs_expectation, platform_consistency_score, primary_email, primary_organization, recency_score, revenue_at_risk, stripe_customer_id, zendesk_user_id]
          int_customer360__marketo:
            weight: 1
            compare_cols: [address_line_1, address_line_1_long, address_line_2, billing_address_line_1, billing_address_line_1_long, billing_address_line_2, billing_city, billing_country_code, billing_country_long, billing_country_long_alt, billing_postal_code, billing_state_code, billing_state_long, city, company_phone, company_phone_extension, country_code, country_long, country_long_alt, do_not_call, email, email_address_stripped, email_domain, first_name, first_name_clean, full_name, full_name_clean, inferred_city, inferred_country_code, inferred_country_long, inferred_country_long_alt, inferred_organization_name, inferred_organization_name_no_suffix, inferred_organization_name_suffix, inferred_postal_code, inferred_state_code, inferred_state_long, ip_address, is_email_invalid, is_unsubscribed, last_name, last_name_clean, lead_id, mobile_phone, mobile_phone_extension, name_suffix, name_title, organization_name, organization_name_no_suffix, organization_name_suffix, phone, phone_extension, possible_alt_first_names, postal_code, state_code, state_long, updated_at]
          int_customer360__marketo_for_matching:
            weight: 1
            compare_cols: [address_line_1_long, billing_address_line_1_long, billing_city, billing_country_code, billing_country_long, billing_postal_code, billing_state_code, billing_state_long, city, company_phone, country_code, country_long, email, email_address_stripped, email_domain, first_name_clean, full_name_clean, inferred_organization_name_no_suffix, last_name_clean, lead_id, mobile_phone, organization_name_no_suffix, phone, postal_code, state_code, state_long]
          int_customer360__risk_assessment:
            weight: 1
            compare_cols: [account_stability_risk, active_30_days, active_90_days, activity_decline_risk, churn_probability, churn_risk_level, composite_engagement_score, critical_alert_flag, customer_health_score, customer_priority_score, customer_segment, days_since_last_activity, email_engagement_risk, engagement_warning_flag, estimated_customer_ltv, high_value_at_risk_flag, intervention_roi, intervention_success_probability, intervention_timeline, is_delinquent, lifecycle_stage, lifecycle_transition_risk, marketo_lead_id, org_relationship_risk, organization_id, payment_behavior_risk, platform_abandonment_risk, platform_consistency_score, potential_revenue_loss, primary_risk_factor, recommended_intervention, revenue_at_risk_score, risk_adjusted_customer_value, risk_assessment_timestamp, risk_category, risk_trend, satisfaction_risk_score, stripe_account_created, stripe_customer_id, support_engagement_risk, total_risk_score, zendesk_active, zendesk_suspended, zendesk_user_id]
          int_customer360__source_matches:
            weight: 1
            compare_cols: [marketo_lead_id, stripe_customer_id, zendesk_user_id]
          int_customer360__stripe:
            weight: 1
            compare_cols: [customer_address_line_1, customer_address_line_1_long, customer_address_line_2, customer_address_line_2_long, customer_city, customer_country_code, customer_country_long, customer_country_long_alt, customer_id, customer_name, customer_name_clean, customer_name_suffix, customer_name_title, customer_organization_name, customer_organization_name_no_suffix, customer_organization_name_suffix, customer_possible_alt_first_names, customer_postal_code, customer_state_code, customer_state_long, email, email_address_stripped, email_domain, is_deleted, is_delinquent, phone, phone_extension, shipping_address_line_1, shipping_address_line_1_long, shipping_address_line_2, shipping_address_line_2_long, shipping_city, shipping_country_code, shipping_country_long, shipping_country_long_alt, shipping_name, shipping_name_clean, shipping_name_suffix, shipping_name_title, shipping_organization_name, shipping_organization_name_no_suffix, shipping_organization_name_suffix, shipping_phone, shipping_phone_extension, shipping_possible_alt_first_names, shipping_postal_code, shipping_state_code, shipping_state_long]
          int_customer360__stripe_for_matching:
            weight: 1
            compare_cols: [customer_address_line_1_long, customer_address_line_2_long, customer_city, customer_country_code, customer_country_long, customer_country_long_alt, customer_id, customer_name_clean, customer_organization_name_no_suffix, customer_state_code, customer_state_long, email, email_address_stripped, email_domain, match_placeholder, phone, shipping_address_line_1_long, shipping_address_line_2_long, shipping_city, shipping_country_code, shipping_country_long, shipping_country_long_alt, shipping_name_clean, shipping_organization_name_no_suffix, shipping_phone, shipping_state_code, shipping_state_long]
          int_customer360__zendesk:
            weight: 1
            compare_cols: [created_at, email, email_address_stripped, email_domain, full_name, full_name_clean, is_active, is_deleted, is_suspended, name_suffix, name_title, organization_created_at, organization_id, organization_name, organization_name_no_suffix, organization_name_suffix, organization_updated_at, phone, phone_extension, possible_alt_first_names, updated_at, user_id]
          int_customer360__zendesk_for_matching:
            weight: 1
            compare_cols: [email, email_address_stripped, email_domain, full_name_clean, organization_id, organization_name_no_suffix, phone, user_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          customer360__address:
            weight: 1
            compare_cols: [address_line_1, address_line_2, address_type, city, country, country_alt_name, country_code, customer360_id, postal_code, priority, rank, source_system, state, state_code]
          customer360__conversion_funnel_analysis:
            weight: 1
            compare_cols: [account_age_days, activity_grade, awareness_engagement_quality, awareness_to_conversion_speed, conversion_engagement_quality, conversion_to_support_speed, cross_stage_engagement_consistency, customer_first_touchpoint, customer_journey_pattern, customer_last_activity, customer_segment, customer_tier, drop_off_risk, expected_optimization_value, funnel_analysis_timestamp, funnel_efficiency, funnel_performance_grade, intervention_priority, journey_completeness_score, journey_efficiency_index, journey_velocity, lifecycle_stage, marketing_to_sales_days, marketo_lead_id, next_stage_conversion_probability, optimization_recommendation, predictive_full_journey_probability, primary_email, primary_engagement_channel, primary_organization, reached_awareness, reached_conversion, reached_support, revenue_velocity_monthly, sales_to_support_days, stripe_customer_id, success_target, support_engagement_quality, value_realization_pattern, weighted_engagement_score, zendesk_user_id]
          customer360__customer:
            weight: 1
            compare_cols: [address_line_1, address_line_2, city, country, country_alt_name, customer360_id, customer360_organization_id, email, first_sale_date, full_name, ip_address, is_organization_header, most_recent_sale_date, organization_name, phone, postal_code, source_ids, state]
          customer360__customer_activity_metrics:
            weight: 1
            compare_cols: [account_age_days, active_180_days, active_30_days, active_365_days, active_60_days, active_90_days, active_channel_count, activity_analysis_timestamp, activity_efficiency, activity_grade, activity_momentum, activity_priority_score, activity_risk_level, composite_engagement_score, cross_platform_consistency, customer_first_touchpoint, customer_health_score, customer_journey_pattern, customer_last_activity, customer_segment, days_since_last_activity, do_not_call, engagement_maturity, engagement_velocity, estimated_monthly_activities, in_marketo, in_stripe, in_zendesk, is_delinquent, is_email_invalid, is_unsubscribed, lifecycle_stage, marketing_depth, marketing_engagement_score, marketo_lead_id, marketo_registration_date, months_since_last_activity, predicted_next_month_activity, primary_email, primary_engagement_channel, primary_organization, recommended_activity_intervention, sales_depth, sales_engagement_score, seasonally_adjusted_activity, stripe_customer_id, stripe_deleted, stripe_registration_date, support_depth, support_engagement_score, weeks_since_last_activity, weighted_engagement_score, zendesk_active, zendesk_deleted, zendesk_registration_date, zendesk_suspended, zendesk_user_id]
          customer360__customer_value_analysis:
            weight: 1
            compare_cols: [account_age_days, acquisition_roi_assessment, adjusted_ltv, analysis_timestamp, churn_probability, concentration_risk, customer_health_score, customer_segment, customer_tier, days_since_last_activity, development_opportunity, estimated_customer_ltv, expected_annual_revenue, frequency_score, investment_priority_score, investment_recommendation, lifecycle_stage, marketo_lead_id, monetary_score, portfolio_contribution_pct, potential_revenue_loss, primary_email, primary_organization, recency_score, recommended_engagement_model, revenue_risk_percentage, revenue_tier, rfm_avg_score, rfm_score, rfm_segment, risk_category, strategic_classification, stripe_customer_id, success_target, upsell_potential, value_stability, zendesk_user_id]
          customer360__email:
            weight: 1
            compare_cols: [index]
          customer360__ip_address:
            weight: 1
            compare_cols: [customer360_id, ip_address, last_seen, source_system]
          customer360__mapping:
            weight: 1
            compare_cols: [customer360_id, customer360_organization_id, is_organization_header, marketo_lead_id, source_ids, stripe_customer_id, zendesk_user_id]
          customer360__name:
            weight: 1
            compare_cols: [customer360_id, full_name, index]
          customer360__organization:
            weight: 1
            compare_cols: [customer360_id, index, organization_name]
          customer360__organization_network:
            weight: 1
            compare_cols: [account_penetration_score, at_risk_customers, avg_customer_ltv, avg_engagement_score, champions, concentration_risk, contacts_rank_within_type, cross_sell_opportunity_score, customer_tiers_represented, email_domain, email_domains_count, engagement_breadth_percentage, estimated_org_size, expansion_priority, full_journey_contacts, growth_accounts, growth_potential, key_accounts, loyal_customers, ltv_rank_within_type, market_share_within_type, marketing_contacts, max_engagement_score, network_analysis_timestamp, organization_influence_score, organization_maturity, organization_risk_level, organization_type, organization_value_score, recommended_strategy, recovery_accounts, sales_contacts, standardized_org_name, strategic_accounts, strategic_value_tier, support_contacts, tier1_contacts, tier2_contacts, tier3_contacts, total_contacts, value_score_rank_within_type]
          customer360__phone:
            weight: 1
            compare_cols: [customer360_id, extension, index, phone]
          customer360__status:
            weight: 1
            compare_cols: [customer360_id, do_not_call, is_email_invalid, is_unsubscribed, overall_status, source_systems]
          customer360__summary:
            weight: 1
            compare_cols: [address_line_1, address_line_2, city, country, country_alt_name, customer360_id, customer360_organization_id, email, full_name, ip_address, is_organization_header, organization_name, phone, postal_code, state]
          customer360__updates:
            weight: 1
            compare_cols: [customer360_id, first_seen, last_updated, total_updates, update_types, updated_by_systems]
  dacomp-de-impl-004:
    database_file: salesforce.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_salesforce__account:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_state_code, billing_street, industry, is_deleted, last_activity_date, last_referenced_date, last_viewed_date, master_record_id, number_of_employees, owner_id, ownership, parent_id, rating, record_type_id, shipping_city, shipping_country, shipping_country_code, shipping_postal_code, shipping_state, shipping_state_code, shipping_street, type, website]
          stg_salesforce__account_history:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_street, industry, is_deleted, number_of_employees, owner_id, ownership, parent_id, rating, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, type, website]
          stg_salesforce__contact:
            weight: 1
            compare_cols: [account_id, assistant_name, assistant_phone, birthdate, contact_description, contact_id, contact_name, department, email, email_bounced_date, email_bounced_reason, fax, first_name, home_phone, is_deleted, is_email_bounced, last_activity_date, last_curequest_date, last_cuupdate_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, lead_source, mailing_city, mailing_country, mailing_country_code, mailing_postal_code, mailing_state, mailing_state_code, mailing_street, master_record_id, mobile_phone, other_city, other_country, other_phone, other_postal_code, other_state, other_street, owner_id, phone, photo_url, reports_to_id, salutation, title]
          stg_salesforce__contact_history:
            weight: 1
            compare_cols: [account_id, contact_description, contact_name, email, first_name, is_deleted, last_activity_date, last_modified_date, last_name, lead_source, mailing_city, mailing_country, mailing_postal_code, mailing_state, mailing_street, mobile_phone, owner_id, phone, title]
          stg_salesforce__event:
            weight: 1
            compare_cols: [activity_date, activity_date_time, duration_in_minutes, end_date_time, event_description, event_id, is_deleted, location, owner_id, start_date_time, subject, type, what_id, who_id]
          stg_salesforce__lead:
            weight: 1
            compare_cols: [annual_revenue, city, company, converted_account_id, converted_contact_id, converted_date, converted_opportunity_id, country, country_code, created_by_id, email, email_bounced_date, email_bounced_reason, fax, first_name, geocode_accuracy, has_opted_out_of_email, industry, is_converted, is_deleted, is_unread_by_owner, last_activity_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, latitude, lead_description, lead_id, lead_name, lead_source, longitude, master_record_id, mobile_phone, number_of_employees, owner_id, phone, photo_url, postal_code, salutation, state, state_code, status, street, system_modstamp, title, website]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_salesforce__account_enhanced:
            weight: 1
            compare_cols: [account_age_days, account_id, account_maturity_stage, account_name, account_size_segment, account_type, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_street, data_completeness_score, geographic_region, industry, industry_normalized, is_high_value_account, last_modified_date, number_of_employees, owner_id, phone, website]
          int_salesforce__lead_conversion_funnel:
            weight: 1
            compare_cols: [annual_revenue, company, conversion_speed_category, conversion_time_days, converted_account_id, converted_contact_id, converted_date, converted_opportunity_id, email, first_name, has_complete_conversion, industry, is_converted, last_name, lead_age_days, lead_id, lead_name, lead_quality_score, lead_source, lead_source_category, lead_temperature, mobile_phone, number_of_employees, owner_id, phone, status]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          salesforce__account_daily_history:
            weight: 1
            compare_cols: [account_id, account_name, account_source, annual_revenue, billing_city, billing_country, billing_state, industry, last_activity_date, number_of_employees, owner_id, ownership, parent_id, rating, snapshot_date, type, website]
          salesforce__contact_daily_history:
            weight: 1
            compare_cols: [account_id, contact_name, email, first_name, last_activity_date, last_name, lead_source, mailing_city, mailing_country, mailing_state, mobile_phone, owner_id, phone, snapshot_date, title]
  dacomp-de-impl-005:
    database_file: google_ads.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_google_ads__account_history:
            weight: 1
            compare_cols: [account_id, account_name, auto_tagging_enabled, currency_code, is_most_recent_record, time_zone, updated_at]
          stg_google_ads__account_stats:
            weight: 1
            compare_cols: [account_id, ad_network_type, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__ad_group_criterion_history:
            weight: 1
            compare_cols: [ad_group_id, criterion_id, is_most_recent_record, keyword_match_type, keyword_text, status, type]
          stg_google_ads__ad_group_history:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, ad_group_type, campaign_id, is_most_recent_record, status, updated_at]
          stg_google_ads__ad_group_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__ad_history:
            weight: 1
            compare_cols: [ad_group_id, ad_id, ad_name, ad_type, display_url, final_urls, is_most_recent_record, status, updated_at]
          stg_google_ads__ad_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__campaign_history:
            weight: 1
            compare_cols: [account_id, advertising_channel_subtype, advertising_channel_type, campaign_id, campaign_name, end_date, is_most_recent_record, serving_status, start_date, status, tracking_url_template, updated_at]
          stg_google_ads__campaign_stats:
            weight: 1
            compare_cols: [account_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__keyword_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, criterion_id, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__search_term_keyword_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, criterion_id, date_day, device, impressions, search_term, search_term_match_type, spend, view_through_conversions]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_google_ads__account_performance_metrics:
            weight: 1
            compare_cols: [account_id, account_maturity_stage, account_name, clicks, conversions, conversions_value, cost_per_conversion, cpc, cpm, ctr, currency_code, date_day, days_since_first_activity, has_spend_no_clicks_flag, high_spend_alert_flag, impressions, invalid_metrics_flag, performance_tier, roas, spend, time_zone]
          int_google_ads__campaign_cohort_analysis:
            weight: 1
            compare_cols: [advertising_channel_subtype, advertising_channel_type, campaign_id, campaign_launch_cohort, campaign_name, campaign_status, clicks, cohort_avg_ctr, cohort_avg_roas, cohort_avg_spend, conversions, conversions_value, cost_per_conversion, cpc, ctr, ctr_vs_cohort_pct, cumulative_clicks, cumulative_conversions, cumulative_conversions_value, cumulative_spend, data_quality_issue, date_day, days_since_launch, exceptional_performance_flag, impressions, investment_tier, lifecycle_stage, momentum_indicator, performance_tier_in_cohort, roas, roas_vs_cohort_pct, spend, spend_vs_cohort_pct, underperforming_flag]
          int_google_ads__keyword_performance_segmentation:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertising_channel_type, bid_recommendation, campaign_avg_conversion_rate, campaign_avg_cpc, campaign_avg_ctr, campaign_avg_roas, campaign_id, campaign_name, clicks, conversion_rate, conversions, conversions_value, cost_per_conversion, cpc, cpm, ctr, ctr_vs_campaign_pct, data_quality_flag, date_day, impressions, keyword_id, keyword_maturity_stage, optimization_needed_flag, pause_candidate_flag, performance_tier, roas, roas_vs_campaign_pct, scale_opportunity_flag, spend]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          google_ads__account_report:
            weight: 1
            compare_cols: [account_id, account_name, auto_tagging_enabled, clicks, conversions, conversions_value, currency_code, date_day, impressions, spend, time_zone]
          google_ads__ad_group_report:
            weight: 1
            compare_cols: [account_id, account_name, ad_group_id, ad_group_name, ad_group_type, campaign_id, campaign_name, clicks, conversions, conversions_value, currency_code, date_day, impressions, spend, status, view_through_conversions]
          google_ads__ad_report:
            weight: 1
            compare_cols: [account_id, account_name, ad_group_id, ad_group_name, ad_id, ad_name, ad_type, campaign_id, campaign_name, clicks, conversions, conversions_value, currency_code, date_day, display_url, impressions, spend, status, view_through_conversions]
          google_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, account_name, advertising_channel_subtype, advertising_channel_type, campaign_id, campaign_name, clicks, conversions, conversions_value, currency_code, date_day, impressions, spend, status, view_through_conversions]
          google_ads__channel_performance_analysis:
            weight: 1
            compare_cols: [active_campaigns, ad_network_type, advertising_channel_subtype, advertising_channel_type, avg_campaign_health_score, avg_roas, bottom_tier_campaigns, channel_benchmark_ctr, channel_benchmark_roas, channel_efficiency_score, channel_investment_tier, clicks_share_pct, conversions_share_pct, cost_per_conversion, cpa_vs_device_benchmark_pct, cpc, cpm, ctr, ctr_vs_channel_benchmark_pct, ctr_vs_device_benchmark_pct, date_day, device, device_benchmark_cpa, device_benchmark_ctr, growth_opportunity, growth_phase_campaigns, high_investment_spend, high_momentum_campaigns, high_momentum_pct, launch_phase_campaigns, performance_classification, portfolio_health_alert, premium_spend, premium_spend_pct, roas, roas_vs_channel_benchmark_pct, roi_alert, spend_share_pct, strategic_recommendation, strategic_review_needed, top_tier_campaigns, top_tier_pct, total_clicks, total_conversions, total_conversions_value, total_impressions, total_spend, underperforming_campaigns, underperforming_pct]
          google_ads__customer_acquisition_analysis:
            weight: 1
            compare_cols: [account_id, account_maturity_stage, account_name, acquisition_efficiency_tier, acquisition_recommendation, acquisition_sophistication_score, active_campaigns_count, advertising_channel_subtype, advertising_channel_type, average_customer_ltv, cac_efficiency_percentile, cac_performance_tier, campaign_lifecycle_stage, channel_diversity_count, clicks, cohort_avg_cac, cohort_avg_ltv, conversions, conversions_value, cost_per_conversion, cpc, ctr, cumulative_acquisition_cost, cumulative_conversions, cumulative_ltv, customer_acquisition_cost, customer_maturity_stage, date_day, estimated_payback_days, high_cac_alert, impressions, ltv_cac_performance_percentile, ltv_cac_ratio, negative_roi_alert, retention_risk, roas, scale_opportunity, spend, strategic_customer_segment]
          google_ads__executive_dashboard:
            weight: 1
            compare_cols: [account_id, account_maturity_stage, account_name, active_campaigns, active_keywords, bid_increase_opportunities, budget_efficiency_tier, campaigns_in_growth, campaigns_in_launch, campaigns_in_maturity, conversions_mom_change_pct, conversions_wow_growth_pct, currency_code, date_day, high_momentum_campaigns, immediate_attention_required, overall_account_health_score, overall_cost_per_conversion, overall_cpc, overall_ctr, overall_roas, pause_candidate_keywords, performance_score, performance_score_30d_avg, performance_tier, premium_investment_campaigns, premium_investment_pct, premium_investment_spend, roas_30d_avg, scale_opportunity, spend_30d_avg, spend_mom_change_pct, spend_wow_growth_pct, star_performer_keywords, strategic_recommendation, top_performer_account, total_clicks, total_conversions, total_conversions_value, total_impressions, total_spend, trending_alert, underperforming_campaigns]
          google_ads__keyword_report:
            weight: 1
            compare_cols: [account_id, account_name, ad_group_id, ad_group_name, campaign_id, campaign_name, clicks, conversions, conversions_value, criterion_id, currency_code, date_day, impressions, keyword_match_type, keyword_text, spend, status, type, view_through_conversions]
          google_ads__search_term_report:
            weight: 1
            compare_cols: [account_id, account_name, ad_group_id, campaign_id, campaign_name, clicks, conversions, conversions_value, criterion_id, currency_code, date_day, impressions, keyword_text, search_term, search_term_match_type, spend, view_through_conversions]
          google_ads__url_report:
            weight: 1
            compare_cols: [account_id, account_name, ad_group_id, ad_group_name, ad_id, base_url, campaign_id, campaign_name, clicks, conversions, conversions_value, currency_code, date_day, impressions, spend, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term, view_through_conversions]
  dacomp-de-impl-006:
    database_file: ad_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_amazon_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, campaign_bidding_strategy, click_through_rate, clicks, cost, cost_per_click, impressions, platform]
          stg_amazon_ads__campaign_report:
            weight: 1
            compare_cols: [campaign_applicable_budget_rule_id, campaign_applicable_budget_rule_name, campaign_bidding_strategy, campaign_budget_amount, campaign_budget_currency_code, campaign_budget_type, campaign_id, campaign_rule_based_budget_amount, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform, purchases_30_d, return_on_ad_spend, sales_30_d, sales_7_d]
          stg_amazon_ads__keyword_report:
            weight: 1
            compare_cols: [ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, budget_type, campaign_budget_amount, campaign_id, click_through_rate, clicks, cost, cost_per_click, currency_code, date_day, impressions, keyword_bid, keyword_id, keyword_status, keyword_type, match_type, platform, return_on_ad_spend, targeting]
          stg_amazon_ads__product_report:
            weight: 1
            compare_cols: [ad_group_id, advertised_asin, advertised_sku, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, attributed_units_ordered_14_d, attributed_units_ordered_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform, return_on_ad_spend]
          stg_amazon_ads__search_report:
            weight: 1
            compare_cols: [ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, keyword_id, match_type, platform, query, return_on_ad_spend, search_term]
          stg_apple_search_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, avg_cost_per_acquisition, avg_cost_per_tap, avg_cpa_currency, avg_cpt_currency, calculated_tap_through_rate, conversion_rate, conversions, cost_per_conversion, cost_per_tap, date_day, impressions, lat_off_installs, lat_on_installs, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_apple_search_ads__ad_report:
            weight: 1
            compare_cols: [ad_group_id, ad_id, campaign_id, conversions, cost_per_conversion, cost_per_download, cost_per_tap, date_day, impressions, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_apple_search_ads__campaign_report:
            weight: 1
            compare_cols: [avg_cost_per_acquisition, avg_cost_per_tap, calculated_tap_through_rate, campaign_id, conversions, cost_per_conversion, cost_per_tap, date_day, impressions, lat_off_installs, lat_on_installs, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_facebook_ads__ad_actions:
            weight: 1
            compare_cols: [action_1_d_view, action_7_d_click, action_type, action_value, ad_id, date_day, inline_value, is_index_action, platform]
          stg_facebook_ads__ad_report:
            weight: 1
            compare_cols: [account_id, ad_id, click_through_rate, cost_per_click, cost_per_thousand_impressions, date_day, impressions, inline_link_clicks, platform, spend]
          stg_google_ads__account_report:
            weight: 1
            compare_cols: [ad_network_type, clicks, conversions, conversions_value, date_day, device, impressions, view_through_conversions]
          stg_google_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, ad_network_type, clicks, conversions, conversions_value, date_day, device, impressions, view_through_conversions]
          stg_google_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_linkedin_ads__campaign_report:
            weight: 1
            compare_cols: [campaign_id, click_through_rate, clicks, comments, cost, cost_per_click, cost_per_thousand_impressions, date_day, follows, impressions, likes, opens, platform, sends, shares, video_completions, video_views]
          stg_microsoft_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, assists, average_position, bounce_rate, campaign_id, click_through_rate, clicks, conversions, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, device_os, device_type, impressions, network, platform, return_on_ad_spend, revenue, spend]
          stg_pinterest_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, campaign_id, click_through_rate, clicks, close_ups, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, impressions, outbound_clicks, pin_clicks, platform, saves, spend, spend_in_micro_dollar, total_conversions, total_conversions_value, total_conversions_value_in_micro_dollar, video_views]
          stg_reddit_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, campaign_id, click_through_rate, clicks, comments, community_joins, conversion_value, conversions, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, cost_per_video_view, date_day, downvotes, engagement_rate, impressions, platform, post_visits, profile_visits, saves, shares, spend, total_engagements, upvotes, video_view_rate, video_views]
          stg_snapchat_ads__campaign_report:
            weight: 1
            compare_cols: [ad_account_id, app_installs, campaign_id, conversion_purchases, conversion_purchases_value, cost_per_install, cost_per_swipe, cost_per_thousand_impressions, cost_per_video_view, date_day, impressions, platform, quartile_1, quartile_2, quartile_3, saves, screen_time_millis, shares, spend, story_completes, story_opens, swipe_up_rate, swipes, video_views, view_completion]
          stg_tiktok_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, calculated_cost_per_click, campaign_id, click_through_rate, clicks, comments, conversion_rate, conversions, cost_per_conversion, cost_per_thousand_impressions, cost_per_thousand_reached, date_day, follows, impressions, likes, platform, profile_visits, reach, shares, spend, video_play_actions, video_views_p_100, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_twitter_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, app_clicks, app_installs, app_opens, billed_charge_local_micro, campaign_id, card_engagements, carousel_swipes, click_through_rate, clicks, cost_per_click, cost_per_engagement, cost_per_thousand_impressions, date_day, engagement_rate, engagements, follows, impressions, likes, media_engagements, media_views, placement, platform, poll_card_vote, replies, retweets, spend, video_total_views, video_views_100, video_views_25, video_views_50, video_views_75]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_ad_reporting__account_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_network_type, click_through_rate, clicks, conversions, conversions_value, cost, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, device, impressions, interaction_event_types, interactions, platform, return_on_ad_spend, view_through_conversions]
          int_ad_reporting__ad_group_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_group_id, ad_network_type, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, conversions, conversions_value, cost, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, device, impressions, interaction_event_types, interactions, platform, return_on_ad_spend, view_through_conversions]
          int_ad_reporting__ad_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_group_id, ad_id, ad_network_type, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, conversions, conversions_value, cost, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, device, impressions, installs, interaction_event_types, interactions, platform, return_on_ad_spend, taps, view_through_conversions]
          int_ad_reporting__campaign_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_network_type, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, campaign_name, click_through_rate, clicks, conversions, conversions_value, cost, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, device, impressions, interaction_event_types, interactions, platform, return_on_ad_spend, view_through_conversions]
          int_ad_reporting__country_mapping:
            weight: 1
            compare_cols: [continent, country_code, country_name, currency_code, gdp_per_capita_usd, internet_penetration_pct, is_advertising_market, is_developed_market, iso_alpha_3_code, mobile_penetration_pct, platform_availability, population_estimate, region, sub_region, timezone_primary]
          int_ad_reporting__customer_journey_analysis:
            weight: 1
            compare_cols: [acquisition_cohort, active_days, analysis_generated_at, average_order_value, campaigns_interacted, click_to_conversion_rate, cohort_size, conversion_behavior, customer_identifier, customer_lifespan_days, customer_roas, customer_value_tier, days_since_acquisition, engagement_level, first_interaction_date, impression_to_click_rate, last_interaction_date, platforms_used, recency_status, retained_month_1, retained_month_2, retained_month_3, retention_rate_month_1, retention_rate_month_2, retention_rate_month_3, total_clicks, total_conversions, total_cost_attributed, total_first_touch_revenue, total_impressions, total_last_touch_revenue, total_linear_attributed_revenue, total_revenue, total_time_decay_attributed_revenue]
          int_ad_reporting__geo_channel_performance:
            weight: 1
            compare_cols: [active_advertisers, active_campaigns, active_days_in_month, analysis_generated_at, avg_daily_platform_diversity, campaigns_per_advertiser, country_code, cpc_std_dev, cpc_variance, market_cpa, market_cpc, market_cpm, market_ctr, market_maturity, market_opportunity_level, market_roas, marketing_channel, month_over_month_spend_growth, multi_channel_advertisers, performance_month, performance_percentile, prev_month_spend, region, single_channel_advertisers, spend_share_percentile, total_clicks, total_conversions, total_impressions, total_revenue, total_spend]
          int_ad_reporting__keyword_report:
            weight: 1
            compare_cols: [account_id, ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, conversions, conversions_value, cost, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, first_page_cpc, first_position_cpc, impressions, interactions, keyword_id, keyword_text, keyword_type, match_type, platform, quality_score, return_on_ad_spend, search_budget_lost_impression_share, search_impression_share, search_rank_lost_impression_share, top_of_page_cpc, view_through_conversions]
          int_ad_reporting__monthly_campaign_country_report:
            weight: 1
            compare_cols: [account_id, avg_daily_clicks, avg_daily_impressions, avg_daily_spend, campaign_id, campaign_name, country_code, days_active_in_month, first_active_date, last_active_date, month, month_year, monthly_amazon_roas_30d, monthly_click_through_rate, monthly_cost_per_click, monthly_cost_per_conversion, monthly_cost_per_thousand_impressions, monthly_return_on_ad_spend, platform, total_active_view_impressions, total_active_view_measurable_impressions, total_attributed_conversions_14_d, total_attributed_conversions_30_d, total_attributed_sales_14_d, total_attributed_sales_30_d, total_clicks, total_conversions, total_conversions_value, total_cost, total_impressions, total_interactions, total_view_through_conversions, year]
          int_ad_reporting__monthly_campaign_region_report:
            weight: 1
            compare_cols: [account_id, avg_daily_regional_clicks, avg_daily_regional_impressions, avg_daily_regional_spend, campaign_id, campaign_name, countries_in_region, country_list, days_active_in_month, first_active_date, last_active_date, month, month_year, monthly_regional_amazon_roas_30d, monthly_regional_click_through_rate, monthly_regional_cost_per_click, monthly_regional_cost_per_conversion, monthly_regional_cost_per_thousand_impressions, monthly_regional_return_on_ad_spend, platform, region, regional_conversion_concentration, regional_cost_concentration, regional_cost_share_pct, regional_impression_share_pct, total_active_view_impressions, total_active_view_measurable_impressions, total_attributed_conversions_14_d, total_attributed_conversions_30_d, total_attributed_sales_14_d, total_attributed_sales_30_d, total_clicks, total_conversions, total_conversions_value, total_cost, total_impressions, total_interactions, total_view_through_conversions, year]
          int_ad_reporting__search_report:
            weight: 1
            compare_cols: [account_id, ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, conversions, conversions_value, cost, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, impressions, interactions, keyword_id, match_type, platform, quality_score, query, return_on_ad_spend, search_budget_lost_impression_share, search_exact_match_impression_share, search_impression_share, search_rank_lost_impression_share, search_term, search_term_length, search_term_match_type, search_term_word_count, view_through_conversions]
          int_ad_reporting__time_series_analytics:
            weight: 1
            compare_cols: [active_campaigns, campaigns_with_clicks, cpc_30d_ma, cpc_30d_volatility, cpc_7d_ma, cpc_z_score, ctr_30d_ma, ctr_30d_trend_forecast, ctr_30d_volatility, ctr_7d_ma, ctr_dow_deviation_pct, ctr_momentum, ctr_seasonal_factor, ctr_trend_slope_90d, ctr_z_score, daily_clicks, daily_conversions, daily_cpa, daily_cpc, daily_ctr, daily_impressions, daily_revenue, daily_roas, daily_spend, date_day, day_of_week, day_type, dow_avg_ctr, dow_avg_spend, market_active_day, market_state, month_of_year, month_period, monthly_avg_ctr, monthly_avg_spend, optimization_recommendation, platform, quarter_of_year, requires_investigation, seasonal_period, spend_30d_ma, spend_30d_trend_forecast, spend_7d_ma, spend_90d_ma, spend_dow_deviation_pct, spend_ewma, spend_lower_confidence, spend_mom_change_pct, spend_momentum, spend_seasonal_factor, spend_trend_direction, spend_trend_slope_90d, spend_upper_confidence, spend_wow_change_pct, spend_yoy_change_pct, week_of_year]
          int_ad_reporting__unified_campaign_metrics:
            weight: 1
            compare_cols: [campaign_age_days, campaign_id, campaign_type, click_through_rate, clicks, conversion_type, conversions, cost, cost_efficiency_tier, cost_per_click, cost_per_conversion, cost_per_mille, ctr_performance_tier, currency, daily_budget, date_day, has_data_quality_issues, impressions, lifecycle_stage, platform, return_on_ad_spend, revenue_30d, revenue_7d, roas_performance_tier, volume_tier]
          int_ad_reporting__url_report:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, attributed_units_ordered_14_d, attributed_units_ordered_30_d, avg_order_value, avg_session_duration, bounce_rate, campaign_id, click_through_rate, clicks, conversions, conversions_value, cost, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, display_url, final_url, impressions, interactions, landing_page_experience, landing_page_url, mobile_friendly_click_rate, pages_per_session, platform, product_asin, product_sku, return_on_ad_spend, units_per_conversion, url_or_product_id, url_type, view_through_conversions]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          ad_reporting__account_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_network_type, clicks, conversions, conversions_value, cpa, cpc, cpm, ctr_percent, data_last_updated, device_type, impressions, interaction_event_types, interactions, platform, report_date, roas, spend, view_through_conversions]
          ad_reporting__ad_group_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_group_id, ad_group_name, ad_network_type, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, campaign_id, campaign_name, clicks, conversions, conversions_value, cpa, cpc, cpm, ctr_percent, data_last_updated, device_type, impressions, interaction_event_types, interactions, platform, report_date, roas, spend, view_through_conversions]
          ad_reporting__ad_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_group_id, ad_group_name, ad_id, ad_name, ad_network_type, ad_status, ad_type, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, campaign_id, campaign_name, clicks, conversions, conversions_value, cpa, cpc, cpm, ctr_percent, device_type, impressions, installs, interaction_event_types, interactions, platform, report_date, roas, spend, taps, view_through_conversions]
          ad_reporting__campaign_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_impressions, active_view_viewability, ad_network_type, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, campaign_id, campaign_name, clicks, conversions, conversions_value, cpa, cpc, cpm, ctr_percent, data_last_updated, device_type, impressions, interaction_event_types, interactions, platform, report_date, roas, spend, view_through_conversions]
          ad_reporting__customer_analytics:
            weight: 1
            compare_cols: [acquisition_cohort, active_days, analysis_generated_at, average_order_value, campaigns_interacted, churn_risk_level, click_to_conversion_rate, clv_percentile, clv_potential, cohort_clv_percentile, cohort_size, conversion_behavior, customer_health_score, customer_identifier, customer_lifespan_days, customer_roas, customer_value_tier, days_since_acquisition, engagement_level, first_interaction_date, frequency_score, health_score_percentile, impression_to_click_rate, investment_priority, last_interaction_date, marketing_recommendation, monetary_score, platforms_used, recency_score, recency_status, report_generated_at, retained_month_1, retained_month_2, retained_month_3, retention_rate_month_1, retention_rate_month_2, retention_rate_month_3, rfm_segment, total_clicks, total_conversions, total_cost_attributed, total_first_touch_revenue, total_impressions, total_last_touch_revenue, total_linear_attributed_revenue, total_revenue, total_time_decay_attributed_revenue]
          ad_reporting__executive_dashboard:
            weight: 1
            compare_cols: [allocation_strategy, analysis_period_end, analysis_period_start, avg_countries_active, avg_customer_retention_rate, avg_market_position_percentile, avg_performance_volatility, avg_platform_growth_rate, avg_platforms_per_customer, customer_strategy_insight, dashboard_generated_at, efficiency_leader, executive_recommendation, expansion_mode, high_opportunity_spend_ratio, high_value_customers_acquired, investment_efficiency_grade, mature_markets_percentage, max_platform_anomaly_days, month_over_month_growth_rate, monthly_ad_spend, monthly_avg_customer_value, monthly_new_customers, monthly_revenue, overall_cpc, overall_ctr, overall_roas, performance_consistency, performance_leader_ctr, platforms_in_use, platforms_with_data, portfolio_diversification, reporting_month, reporting_quarter, reporting_year, revenue_leader, top_platform_cpc, top_platform_ctr, top_platform_roas, total_active_campaigns, total_optimizing_days, total_scaling_days]
          ad_reporting__keyword_report:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_group_name, ad_network_type, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, campaign_id, campaign_name, clicks, conversions, conversions_value, cpa, cpc, cpm, ctr_percent, data_last_updated, device_type, first_page_cpc, first_position_cpc, impressions, interaction_event_types, interactions, keyword_id, keyword_text, match_type, platform, quality_score, report_date, roas, search_budget_lost_impression_share, search_impression_share, search_rank_lost_impression_share, spend, top_of_page_cpc, view_through_conversions]
          ad_reporting__market_opportunities:
            weight: 1
            compare_cols: [active_advertisers, active_campaigns, active_days_in_month, analysis_generated_at, avg_daily_platform_diversity, budget_recommendation, campaigns_per_advertiser, country_code, cpc_std_dev, cpc_variance, current_cpc, current_ctr, current_monthly_spend, current_roas, expected_incremental_revenue, growth_rate, implementation_timeline, investment_strategy, market_cpa, market_cpm, market_maturity, market_opportunity_level, market_risk_level, marketing_channel, multi_channel_advertisers, opportunity_tier, performance_month, performance_percentile, region, resource_requirements, single_channel_advertisers, spend_share_percentile, strategic_action_plan, success_probability, total_clicks, total_conversions, total_impressions, total_opportunity_score, total_revenue]
          ad_reporting__monthly_campaign_country_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurable_impressions, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, avg_cpa, avg_cpc, avg_cpm, avg_ctr_percent, avg_daily_clicks, avg_daily_impressions, avg_daily_spend, avg_roas, campaign_id, campaign_name, clicks, conversions, conversions_value, country_code, data_last_updated, days_active_in_month, first_active_date, impressions, interactions, last_active_date, month, monthly_amazon_roas_30d, platform, report_month, spend, view_through_conversions, year]
          ad_reporting__monthly_campaign_region_report:
            weight: 1
            compare_cols: [account_id, active_view_impressions, active_view_measurable_impressions, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, avg_cpa, avg_cpc, avg_cpm, avg_ctr_percent, avg_daily_regional_clicks, avg_daily_regional_impressions, avg_daily_regional_spend, avg_roas, campaign_id, campaign_name, clicks, conversions, conversions_value, countries_in_region, country_list, data_last_updated, days_active_in_month, first_active_date, impressions, interactions, last_active_date, mart_created_at, month, monthly_regional_amazon_roas_30d, platform, region, regional_conversion_concentration, regional_cost_concentration, regional_cost_share_pct, regional_impression_share_pct, report_month, spend, view_through_conversions, year]
          ad_reporting__predictive_analytics:
            weight: 1
            compare_cols: [active_campaigns, anomaly_probability_next_month, budget_recommendation, cpc_volatility, ctr_momentum, ctr_volatility, current_avg_cpc, current_avg_ctr, current_avg_roas, current_monthly_spend, established_campaigns, expected_revenue_current_performance, expected_revenue_optimized_performance, forecast_base_date, forecast_confidence, forecast_generated_at, forecast_risk_level, forecast_target_date, incremental_revenue_opportunity, mom_ctr_change, mom_spend_growth, new_campaigns, performance_month, platform, predicted_next_month_ctr, predicted_next_month_spend, predicted_roas, prediction_success_probability, risk_mitigation_plan, spend_momentum, strategic_recommendation]
          ad_reporting__search_report:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_group_name, ad_network_type, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, campaign_id, campaign_name, clicks, conversions, conversions_value, cpa, cpc, cpm, ctr_percent, data_last_updated, device_type, impressions, interaction_event_types, interactions, keyword_id, match_type, matched_keyword, platform, quality_score, report_date, roas, search_budget_lost_impression_share, search_exact_match_impression_share, search_impression_share, search_rank_lost_impression_share, search_term, search_term_length, search_term_word_count, spend, view_through_conversions]
          ad_reporting__url_report:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_group_name, ad_id, ad_name, ad_network_type, attributed_conversions_14_day, attributed_conversions_30_day, attributed_sales_14_day, attributed_sales_30_day, attributed_units_ordered_14_d, attributed_units_ordered_30_d, avg_order_value, avg_session_duration, bounce_rate, campaign_id, campaign_name, clicks, conversions, conversions_value, cpa, cpc, cpm, ctr_percent, data_last_updated, destination_url, device_type, impressions, interaction_event_types, interactions, landing_page_experience, mobile_friendly_click_rate, page_path, pages_per_session, platform, product_asin, product_sku, report_date, roas, spend, units_per_conversion, url_type, view_through_conversions, website_domain]
  dacomp-de-impl-007:
    database_file: app_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_apple_store__app_crash_daily:
            weight: 1
            compare_cols: [app_name, app_version, crashes, date_day, device, platform_version, unique_devices_with_crashes]
          stg_apple_store__app_session_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, date_day, device, platform_version, sessions, source_type, total_session_duration, unique_devices]
          stg_apple_store__app_store_app:
            weight: 1
            compare_cols: [app_id, app_name, content_rights_declaration, primary_locale, was_made_for_kids]
          stg_apple_store__app_store_discovery_and_engagement_standard_daily:
            weight: 1
            compare_cols: [app_name, country, date_day, device, engagement_type, event_type, page_type, page_views, platform_version, source_type, unique_page_views]
          stg_apple_store__app_store_download_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, date_day, device, download_type, platform_version, source_type, total_downloads]
          stg_apple_store__app_store_installation_and_deletion_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, counts, date_day, device, event_type, platform_version, unique_devices]
          stg_apple_store__financial_stats_subscriptions_country:
            weight: 1
            compare_cols: [app_id, app_name, country, date_day, revenue, subscription_name]
          stg_apple_store__sales_subscription_event_summary:
            weight: 1
            compare_cols: [app_id, app_name, consecutive_paid_periods, country, date_day, event_type, marketing_opt_in_duration, proceeds_reason, quantity, standard_subscription_duration, subscription_id, subscription_name]
          stg_apple_store__sales_subscription_summary:
            weight: 1
            compare_cols: [active_subscriptions, app_id, app_name, country, date_day, free_trial_subscriptions, subscription_duration, subscription_name]
          stg_google_play__earnings:
            weight: 1
            compare_cols: [buyer_currency, country, date_day, package_name, revenue_local_currency, revenue_usd]
          stg_google_play__stats_crashes_app_version:
            weight: 1
            compare_cols: [anrs, app_version_code, crashes, date_day, package_name]
          stg_google_play__stats_crashes_os_version:
            weight: 1
            compare_cols: [anrs, crashes, date_day, os_version, package_name]
          stg_google_play__stats_crashes_overview:
            weight: 1
            compare_cols: [anrs, crashes, date_day, package_name]
          stg_google_play__stats_installs_app_version:
            weight: 1
            compare_cols: [active_devices_last_30_days, app_version_code, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_country:
            weight: 1
            compare_cols: [country, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_device:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_os_version:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device_installs, device_uninstalls, device_upgrades, install_events, os_version, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_overview:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_ratings_app_version:
            weight: 1
            compare_cols: [app_version_code, average_rating, date_day, package_name, rolling_total_average_rating]
          stg_google_play__stats_ratings_country:
            weight: 1
            compare_cols: [average_rating, country, date_day, package_name, rolling_total_average_rating]
          stg_google_play__stats_ratings_device:
            weight: 1
            compare_cols: [average_rating, date_day, device, package_name, rolling_total_average_rating]
          stg_google_play__stats_ratings_os_version:
            weight: 1
            compare_cols: [average_rating, date_day, os_version, package_name, rolling_total_average_rating]
          stg_google_play__stats_ratings_overview:
            weight: 1
            compare_cols: [average_rating, date_day, package_name, rolling_total_average_rating]
          stg_google_play__stats_store_performance_country:
            weight: 1
            compare_cols: [country, date_day, package_name, store_listing_acquisitions, store_listing_conversion_rate, store_listing_visitors]
          stg_google_play__stats_store_performance_traffic_source:
            weight: 1
            compare_cols: [date_day, package_name, store_listing_acquisitions, store_listing_conversion_rate, store_listing_visitors, traffic_source]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_app_health_metrics:
            weight: 1
            compare_cols: [app_name, crash_count, crash_rate_30d_avg, crash_rate_7d_avg, crash_rate_per_thousand, crash_rate_trend_7d, crashes_30d_sum, data_quality_flag, date_day, health_score, health_status, installs, installs_30d_sum, platform, total_activity, uninstall_rate_7d_avg, uninstall_rate_percentage, uninstalls, volume_tier]
          int_apple_store__app_version:
            weight: 1
            compare_cols: [app_name, app_platform, app_version, crashes, date_day, deletions]
          int_apple_store__country:
            weight: 1
            compare_cols: [app_name, app_platform, country, date_day, deletions, downloads, install_events, uninstall_events, update_events]
          int_apple_store__device:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, device, downloads]
          int_apple_store__os_version:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, downloads, os_version]
          int_apple_store__overview:
            weight: 1
            compare_cols: [app_name, app_platform, crashes, date_day, deletions, downloads, page_views]
          int_apple_store__traffic_source:
            weight: 1
            compare_cols: [acquisitions, app_name, app_platform, date_day, traffic_source, visitors]
          int_channel_performance:
            weight: 1
            compare_cols: [app_name, channel_category, channel_efficiency_score, channel_performance_tier, conversion_rank_30d, conversion_rank_daily, conversion_rate_30d_avg, conversion_rate_7d_avg, conversion_rate_percentage, conversion_trend_7d, conversions, data_quality_flag, date_day, install_per_conversion_ratio, installer_growth_7d_percentage, installers, installers_30d_sum, installers_7d_sum, investment_recommendation, market_share_percentage, platform, store_visitors, traffic_source, visitors_30d_sum, visitors_7d_sum, volume_rank_30d, volume_rank_daily]
          int_google_play__app_version:
            weight: 1
            compare_cols: [app_name, app_platform, app_version, crashes, date_day, deletions]
          int_google_play__country:
            weight: 1
            compare_cols: [app_name, app_platform, country, date_day, deletions, downloads, install_events, uninstall_events, update_events]
          int_google_play__device:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, device, downloads]
          int_google_play__os_version:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, downloads, os_version]
          int_google_play__overview:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, downloads, page_views]
          int_google_play__traffic_source:
            weight: 1
            compare_cols: [acquisitions, app_name, app_platform, date_day, traffic_source, visitors]
          int_user_lifecycle_analysis:
            weight: 1
            compare_cols: [active_days_l30, active_days_l7, activity_metric, data_quality_flag, date_day, first_install_date, package_name, platform, user_activity_level, user_age_days, user_lifecycle_stage, user_status, user_value_segment]
          int_user_rfm_analysis:
            weight: 1
            compare_cols: [app_id, avg_transaction_value, buyer_country, buyer_currency, customer_health_status, customer_lifetime_days, customer_segment, data_quality_flag, estimated_clv, first_transaction_date, frequency_count, frequency_score, last_transaction_date, monetary_score, monetary_value, purchase_count, recency_days, recency_score, refund_count, rfm_score, rfm_segment_code, subscription_count, total_transactions]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          app_reporting__app_health_monitoring_report:
            weight: 1
            compare_cols: [app_name, crash_count, crash_rate_30d_avg, crash_rate_7d_avg, crash_rate_per_thousand, crash_rate_trend_7d, crashes_30d_sum, date_day, health_score, health_status, installs, installs_30d_sum, platform, total_activity, uninstall_rate_7d_avg, uninstall_rate_percentage, volume_tier]
          app_reporting__app_version_report:
            weight: 1
            compare_cols: [app_name, app_platform, app_version, crashes, date_day, deletions, source_relation]
          app_reporting__channel_effectiveness_report:
            weight: 1
            compare_cols: [app_name, channel_category, channel_efficiency_score, channel_performance_tier, conversion_rank_30d, conversion_rate_30d_avg, conversion_trend_7d, date_day, installer_growth_7d_percentage, installers_30d_sum, investment_recommendation, is_declining_performance, is_top_channel, is_top_volume_source, market_share_percentage, platform, should_scale_up, traffic_source, visitors_30d_sum, volume_rank_30d]
          app_reporting__country_report:
            weight: 1
            compare_cols: [app_name, app_platform, country, date_day, deletions, downloads, install_events, uninstall_events, update_events]
          app_reporting__device_report:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, device, downloads]
          app_reporting__os_version_report:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, downloads, os_version]
          app_reporting__overview_report:
            weight: 1
            compare_cols: [app_name, app_platform, date_day, deletions, downloads, page_views]
          app_reporting__traffic_source_report:
            weight: 1
            compare_cols: [acquisitions, app_name, app_platform, date_day, traffic_source, visitors]
          app_reporting__user_lifecycle_report:
            weight: 1
            compare_cols: [date_day, platform, user_lifecycle_stage]
          app_reporting__user_value_segmentation_report:
            weight: 1
            compare_cols: [customer_segment, global_customer_count, global_segment_revenue, global_avg_clv, revenue_contribution_percentage, revenue_rank, segment_avg_rfm_score, health_rate_percentage, critical_rate_percentage, high_value_rate_percentage, churn_risk_rate_percentage, countries_present, largest_country_customer_count, avg_recency_score, avg_frequency_score, avg_monetary_score, premium_rfm_customers, rfm_score_stddev, growth_potential, investment_priority, roi_expectation, recommended_actions, business_impact_level]
  dacomp-de-impl-008:
    database_file: asana.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_asana__project:
            weight: 1
            compare_cols: [created_at, current_status, due_date, is_archived, is_public, modified_at, notes, owner_user_id, project_id, project_name, team_id, workspace_id]
          stg_asana__project_task:
            weight: 1
            compare_cols: [project_id, task_id]
          stg_asana__section:
            weight: 1
            compare_cols: [section_name]
          stg_asana__story:
            weight: 1
            compare_cols: [created_at, created_by_user_id, source, story_id, story_text, story_type, target_id]
          stg_asana__tag:
            weight: 1
            compare_cols: [color, tag_id, tag_name, tag_notes, workspace_id]
          stg_asana__task:
            weight: 1
            compare_cols: [due_date, is_completed, start_date, task_description, task_name, workspace_id]
          stg_asana__task_follower:
            weight: 1
            compare_cols: [task_id, user_id]
          stg_asana__task_section:
            weight: 1
            compare_cols: [section_id, task_id]
          stg_asana__task_tag:
            weight: 1
            compare_cols: [tag_id, task_id]
          stg_asana__team:
            weight: 1
            compare_cols: [organization_id, team_id, team_name]
          stg_asana__user:
            weight: 1
            compare_cols: [email, user_id, user_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_asana__project_health_indicators:
            weight: 1
            compare_cols: [active_tasks, activity_percentage, anomaly_flag, assigned_tasks, assignment_percentage, avg_completion_time_days, avg_delay_days, avg_response_time_days, avg_task_complexity, avg_task_health_score, completed_tasks, completion_percentage, days_to_deadline, deadline_status, delayed_tasks, focus_areas, health_grade, high_urgency_tasks, is_valid_record, max_task_age_days, overall_health_score, overdue_percentage, overdue_tasks, poor_performance_tasks, progress_score, project_age_days, project_created_at, project_due_date, project_forecast, project_id, project_name, project_owner, project_status, quality_percentage, quality_score, quality_tasks, recent_task_completion, recent_task_creation, resource_score, risk_level, risk_percentage, risk_score, team_id, total_tasks, unassigned_tasks, unique_assignees]
          int_asana__project_task_metrics:
            weight: 1
            compare_cols: [avg_close_time_assigned_days, avg_close_time_days, number_of_assigned_open_tasks, number_of_open_tasks, number_of_tasks_completed, project_id]
          int_asana__project_user:
            weight: 1
            compare_cols: [role, user_id]
          int_asana__subtask_parent:
            weight: 1
            compare_cols: [parent_assignee_name, parent_due_date, parent_task_id, parent_task_name]
          int_asana__task_assignee:
            weight: 1
            compare_cols: [assignee_email, assignee_name, assignee_user_id, completed_by_user_id, due_date, has_assignee, is_completed, parent_task_id, start_date, task_description, task_name, workspace_id]
          int_asana__task_comments:
            weight: 1
            compare_cols: [conversation, number_of_comments, task_id]
          int_asana__task_first_modifier:
            weight: 1
            compare_cols: [first_modifier_name, first_modifier_user_id]
          int_asana__task_followers:
            weight: 1
            compare_cols: [followers, number_of_followers, task_id]
          int_asana__task_open_length:
            weight: 1
            compare_cols: [days_open, days_since_first_assignment, days_since_last_assignment, has_been_assigned, is_completed, is_currently_assigned]
          int_asana__task_performance_metrics:
            weight: 1
            compare_cols: [activity_score, assignee_user_id, complexity_score, days_open, days_since_first_assignment, days_since_last_assignment, delay_days, due_date, health_score, is_completed, is_valid_record, performance_grade, response_time_days, task_description, task_name, task_status_category, urgency_score]
          int_asana__task_projects:
            weight: 1
            compare_cols: [number_of_projects, project_ids, project_names, projects_sections, task_id]
          int_asana__task_story:
            weight: 1
            compare_cols: [action_taken, created_by_user_id, story_id, story_text, story_type]
          int_asana__task_tags:
            weight: 1
            compare_cols: [number_of_tags, tags, task_id]
          int_asana__user_productivity_trends:
            weight: 1
            compare_cols: [activity_month, anomaly_flag, avg_completion_time, avg_health_score, completion_rate_3m_avg, completion_rate_pct, completion_rate_rank, completion_time_3m_avg, completion_trend, cumulative_tasks_assigned, cumulative_tasks_completed, health_score_3m_avg, health_score_rank, is_valid_record, prev_month_tasks, productivity_tier, quality_rate_pct, speed_trend, tasks_completed, total_complexity_points, total_tasks_assigned, workload_rank]
          int_asana__user_task_metrics:
            weight: 1
            compare_cols: [number_of_open_tasks, number_of_tasks_completed]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          asana__daily_metrics:
            weight: 1
            compare_cols: [date_day, net_task_change, tasks_completed, tasks_created]
          asana__project:
            weight: 1
            compare_cols: [avg_close_time_assigned_days, avg_close_time_days, current_status, due_date, is_archived, is_public, notes, number_of_assigned_open_tasks, number_of_open_tasks, number_of_tasks_completed, number_of_users_involved, owner_user_id, project_id, project_link, project_name, sections, team_id, team_name, users_involved]
          asana__project_analytics:
            weight: 1
            compare_cols: [comprehensive_project_score, efficiency_rank, focus_areas, health_grade, improvement_opportunities, is_valid_record, management_priority, overall_health_score, overdue_tasks, planned_duration_days, project_deadline, project_forecast, project_id, project_name, project_owner, project_start_date, project_status, risk_level, schedule_forecast, success_factors, team_id, team_name]
          asana__tag:
            weight: 1
            compare_cols: [color, number_of_tasks, tag_id, tag_name, tag_notes, workspace_id]
          asana__task:
            weight: 1
            compare_cols: [assignee_email, assignee_name, assignee_user_id, completed_by_user_id, conversation, days_open, days_since_first_assignment, days_since_last_assignment, due_date, first_modifier_name, first_modifier_user_id, followers, has_been_assigned, is_completed, is_currently_assigned, is_subtask, number_of_comments, number_of_followers, number_of_projects, number_of_tags, parent_assignee_name, parent_assignee_user_id, parent_due_date, parent_task_id, parent_task_name, project_ids, project_names, projects_sections, start_date, tags, task_description, task_link, task_name, workspace_id]
          asana__task_lifecycle_analysis:
            weight: 1
            compare_cols: [activity_level, activity_score, anomaly_patterns, assignee_name, assignee_performance_grade, assignee_user_id, avg_daily_activity_rate, completion_timestamp, complexity_execution_match, complexity_score, creation_timestamp, current_lifecycle_stage, days_with_activity, delay_days, due_date, first_assignment_timestamp, health_score, hours_assigned_to_completion, improvement_opportunities, last_assignment_timestamp, last_modification_timestamp, lifecycle_efficiency_category, lifecycle_health_score, parent_task_id, performance_grade, project_health_score, project_name, response_time_days, success_patterns, task_name, task_status_category, team_id, total_lifecycle_hours, unique_action_types, urgency_score]
          asana__team:
            weight: 1
            compare_cols: [number_of_active_projects, number_of_projects, organization_id, team_id, team_name]
          asana__team_efficiency_metrics:
            weight: 1
            compare_cols: [active_projects, active_team_tasks, avg_completion_rate, avg_estimated_completion_days, avg_member_completion_rate, avg_member_performance, avg_member_quality_rate, avg_project_health, avg_project_performance, avg_project_velocity, avg_quality_rate, avg_risk_percentage, avg_tasks_per_assignee_across_projects, avg_tasks_per_member, collaboration_efficiency_score, completed_projects, completed_team_tasks, developing_performers, efficiency_grade, efficiency_rank, enterprise_projects, high_performers, high_risk_members, high_workload_members, improvement_recommendations, is_valid_record, large_projects, medium_projects, on_schedule_rate_pct, overall_team_efficiency_score, overdue_projects, overdue_team_tasks, performance_rank, project_management_score, quality_completion_rate_pct, quality_management_score, quality_rank, resource_optimization_score, schedule_reliability_rank, small_projects, solid_performers, team_id, team_maturity_level, team_name, team_size_category, team_strengths, top_performers, total_project_assignments, total_projects, total_team_tasks, underperformers, unique_team_members, workload_balance_status]
          asana__user:
            weight: 1
            compare_cols: [avg_close_time_assigned_days, email, user_id, user_name]
          asana__user_performance_dashboard:
            weight: 1
            compare_cols: [completion_rate_rank, completion_rate_vs_baseline, completion_time_vs_baseline_pct, comprehensive_performance_score, email, health_score_vs_baseline, historical_months, is_valid_record, performance_rank, portfolio_complex_tasks, portfolio_overdue_tasks, user_id, user_name]
  dacomp-de-impl-009:
    database_file: google_play.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_google_play__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_name, numeric_code, region, sub_region]
          stg_google_play__earnings:
            weight: 1
            compare_cols: [_fivetran_synced, amount_buyer_currency, amount_merchant_currency, base_plan_id, buyer_country, buyer_currency, buyer_hardware, buyer_postal_code, buyer_state, currency_conversion_rate, merchant_currency, offer_id, order_id, package_name, product_title, product_type, refund_type, sku_id, tax_type, transaction_date, transaction_pt_timestamp, transaction_timezone, transaction_type]
          stg_google_play__stats_crashes_app_version:
            weight: 1
            compare_cols: [android_os_version, anrs, app_version_code, crashes, date_day, package_name]
          stg_google_play__stats_crashes_os_version:
            weight: 1
            compare_cols: [android_os_version, anrs, crashes, date_day, package_name]
          stg_google_play__stats_crashes_overview:
            weight: 1
            compare_cols: [anrs, crashes, date_day, package_name]
          stg_google_play__stats_installs_app_version:
            weight: 1
            compare_cols: [active_device_installs, android_os_version, app_version_code, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, device, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_country:
            weight: 1
            compare_cols: [active_device_installs, country, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_device:
            weight: 1
            compare_cols: [active_device_installs, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, device, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_os_version:
            weight: 1
            compare_cols: [active_device_installs, android_os_version, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_overview:
            weight: 1
            compare_cols: [_fivetran_synced, active_device_installs, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_ratings_app_version:
            weight: 1
            compare_cols: [app_version_code, daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__stats_ratings_country:
            weight: 1
            compare_cols: [country, daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__stats_ratings_device:
            weight: 1
            compare_cols: [daily_average_rating, date_day, device, package_name, total_average_rating]
          stg_google_play__stats_ratings_os_version:
            weight: 1
            compare_cols: [android_os_version, daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__stats_ratings_overview:
            weight: 1
            compare_cols: [daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__store_performance_country:
            weight: 1
            compare_cols: [date_day, package_name, store_listing_conversion_rate, store_listing_installers, store_listing_visitors]
          stg_google_play__store_performance_source:
            weight: 1
            compare_cols: [date_day, package_name, store_listing_conversion_rate, store_listing_installers, store_listing_visitors, traffic_source]
          stg_google_play__subscriptions_country:
            weight: 1
            compare_cols: [cancelled_subscriptions, country, date_day, new_subscriptions, package_name, product_id, total_active_subscriptions]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_google_play__app_quality_metrics:
            weight: 1
            compare_cols: [active_versions_count, anr_rate_per_1k_devices, avg_7d_anrs, avg_7d_crashes, avg_7d_rating, crash_rate_per_1k_devices, daily_anrs, daily_crashes, date_day, os_with_most_crashes, package_name, quality_category, quality_score, stability_risk_level, stability_trend, supported_os_versions, total_stability_issues, version_with_most_crashes, worst_os_anrs, worst_os_crashes, worst_version_anrs, worst_version_crashes]
          int_google_play__earnings:
            weight: 1
            compare_cols: [charge_amount, charge_transactions, country_short, date_day, merchant_currency, net_amount, other_amount, other_transactions, package_name, refund_amount, refund_transactions, sku_id, transactions]
          int_google_play__latest_product_info:
            weight: 1
            compare_cols: [package_name, product_title, sku_id]
          int_google_play__revenue_analytics:
            weight: 1
            compare_cols: [arpu_daily, average_transaction_value, avg_30d_net_revenue, avg_7d_net_revenue, buyer_country, cancelled_subscriptions, cumulative_net_revenue, daily_gross_revenue, daily_net_revenue, daily_paying_transactions, daily_refund_transactions, daily_refunds, date_day, growth_momentum, merchant_currency, net_subscriber_growth, new_subscriptions, package_name, product_title, refund_rate, revenue_health_score, revenue_per_new_subscription, revenue_per_transaction, revenue_tier, risk_flag, sku_id, subscription_churn_rate, total_active_subscriptions, total_transactions, weekly_revenue_growth_rate]
          int_google_play__store_performance:
            weight: 1
            compare_cols: [date_day, package_name, store_listing_conversion_rate, store_listing_installers, store_listing_visitors, traffic_source]
          int_google_play__user_behavior_metrics:
            weight: 1
            compare_cols: [active_device_installs, avg_30d_device_installs, avg_7d_device_installs, avg_7d_device_uninstalls, country, daily_average_rating, daily_churn_rate, daily_device_installs, daily_device_uninstalls, date_day, growth_momentum, install_uninstall_ratio, market_maturity, package_name, rating_trend, user_engagement_level, weekly_install_growth_rate]
          int_google_play__user_retention_analysis:
            weight: 1
            compare_cols: [churn_risk_level, cohort_lifecycle_stage, cohort_size, country, current_avg_7d_churn_rate, current_daily_churn_rate, day_14_retention_rate, day_1_retention_rate, day_30_retention_rate, day_60_retention_rate, day_7_retention_rate, day_90_retention_rate, install_date, package_name, prev_month_day_30_retention, prev_week_day_7_retention, product_stickiness, retention_category, retention_quality_score, retention_trend]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          google_play__app_version_report:
            weight: 1
            compare_cols: [active_devices_last_30_days, android_os_version, anrs, app_version_code, average_rating, crashes, date_day, device, device_installs, device_uninstalls, device_upgrades, install_events, net_device_installs, package_name, rolling_total_average_rating, total_device_installs, total_device_uninstalls, uninstall_events, update_events, user_installs, user_uninstalls]
          google_play__comprehensive_performance_dashboard:
            weight: 1
            compare_cols: [accelerating_markets, active_devices, anr_rate_per_1k_devices, average_rating, average_revenue_per_user, avg_transaction_value, business_health_status, crash_rate_per_1k_devices, daily_anrs, daily_churn_rate, daily_crashes, daily_installs, daily_net_revenue, daily_transactions, daily_uninstalls, date_day, day_1_retention_rate, day_30_retention_rate, day_7_retention_rate, growth_trend, high_engagement_markets, install_uninstall_ratio, new_subscriptions, overall_performance_score, package_name, primary_risk_flag, quality_score, recommended_action, refund_rate, revenue_health_score, store_acquisitions, store_conversion_rate, store_visitors, total_issues_per_1k_devices, version_fragmentation]
          google_play__country_report:
            weight: 1
            compare_cols: [active_devices_last_30_days, average_rating, country_long, country_short, date_day, device_installs, device_uninstalls, device_upgrades, install_events, net_device_installs, package_name, region, rolling_store_conversion_rate, rolling_total_average_rating, store_listing_acquisitions, store_listing_conversion_rate, store_listing_visitors, sub_region, total_device_installs, total_device_uninstalls, total_store_acquisitions, total_store_visitors, uninstall_events, update_events, user_installs, user_uninstalls]
          google_play__device_report:
            weight: 1
            compare_cols: [active_devices_last_30_days, average_rating, date_day, device, device_installs, device_uninstalls, device_upgrades, install_events, net_device_installs, package_name, rolling_total_average_rating, total_device_installs, total_device_uninstalls, uninstall_events, update_events, user_installs, user_uninstalls]
          google_play__finance_report:
            weight: 1
            compare_cols: [cancelled_subscriptions, charge_amount, charge_transactions, country_long, country_short, date_day, merchant_currency, net_amount, new_subscriptions, other_amount, other_transactions, package_name, product_title, refund_amount, refund_transactions, region, sku_id, sub_region, total_active_subscriptions, transactions]
          google_play__geo_market_analysis:
            weight: 1
            compare_cols: [app_crash_rate_per_1k, app_quality_score, average_revenue_per_user, avg_active_devices, avg_daily_installs, avg_daily_revenue, avg_transaction_value, churn_risk_level, country, country_name, daily_churn_rate, dominant_engagement_level, dominant_growth_momentum, growth_potential_score, investment_recommendation, market_insight, market_maturity_level, market_size_score, market_tier, opportunity_type, overall_market_score, package_name, product_stickiness, region, retention_category, revenue_last_30_days, revenue_opportunity_score, store_conversion_rate, store_installs_30d, store_performance_score, store_visitors_30d, sub_region, user_quality_score, weekly_growth_rate]
          google_play__os_version_report:
            weight: 1
            compare_cols: [active_devices_last_30_days, android_os_version, anrs, average_rating, crashes, date_day, device_installs, device_uninstalls, device_upgrades, install_events, net_device_installs, package_name, rolling_total_average_rating, total_device_installs, total_device_uninstalls, uninstall_events, update_events, user_installs, user_uninstalls]
          google_play__overview_report:
            weight: 1
            compare_cols: [active_devices_last_30_days, anrs, average_rating, crashes, date_day, device_installs, device_uninstalls, device_upgrades, install_events, net_device_installs, package_name, rolling_store_conversion_rate, rolling_total_average_rating, total_device_installs, total_device_uninstalls, uninstall_events, update_events, user_installs, user_uninstalls]
          google_play__product_portfolio_analysis:
            weight: 1
            compare_cols: [average_revenue_per_user, avg_active_devices, avg_daily_revenue, avg_transaction_value, bcg_matrix_category, daily_churn_rate, day_30_retention_rate, day_7_retention_rate, growth_stage, high_engagement_markets, investment_priority, package_name, portfolio_health_score, portfolio_type, quality_score, revenue_countries, strong_retention_markets, total_installs_30d, total_markets, total_products, total_revenue_30d, user_base_trend]
          google_play__time_series_trends:
            weight: 1
            compare_cols: [active_countries, active_devices, active_subscriptions, anomaly_flag, avg_transaction_value, daily_churn_rate, daily_install_uninstall_ratio, daily_installs, daily_performance_vs_baseline, daily_transactions, daily_uninstalls, date_day, day_name, install_anomaly_score, install_stability, install_trend, install_volatility_coefficient, ma_30d_installs, ma_30d_quality, ma_30d_revenue, ma_7d_churn, ma_7d_installs, ma_7d_quality, ma_7d_revenue, month_name, new_subscriptions, package_name, performance_momentum, quality_score, revenue_anomaly_score, revenue_per_active_device, revenue_trend, revenue_volatility_coefficient, risk_growth_profile, week_of_year, wow_install_growth_rate, wow_revenue_growth_rate]
  dacomp-de-impl-010:
    database_file: hubspot.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marketing
      - pg_catalog
      - raw
      - sales
      - service
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_hubspot__company:
            weight: 1
            compare_cols: [address, address_2, annual_revenue, city, company_id, company_name, country, description, industry, is_company_deleted, state]
          stg_hubspot__contact:
            weight: 1
            compare_cols: [calculated_merged_vids, company_annual_revenue, contact_company, contact_id, email, first_name, is_contact_deleted, job_title, last_name]
          stg_hubspot__deal:
            weight: 1
            compare_cols: [amount, deal_id, deal_name, deal_pipeline_id, deal_pipeline_stage_id, description, is_deal_deleted, owner_id, portal_id]
          stg_hubspot__deal_contact:
            weight: 1
            compare_cols: [association_category, association_type_id, contact_id, deal_id]
          stg_hubspot__deal_pipeline:
            weight: 1
            compare_cols: [created_timestamp, deal_pipeline_id, is_pipeline_active, pipeline_display_order, pipeline_label, updated_timestamp]
          stg_hubspot__deal_pipeline_stage:
            weight: 1
            compare_cols: [created_timestamp, deal_pipeline_id, deal_pipeline_stage_id, is_closed_won, is_deal_pipeline_stage_deleted, is_stage_active, is_stage_closed, pipeline_stage_label, stage_display_order, stage_probability, updated_timestamp]
          stg_hubspot__email_event:
            weight: 1
            compare_cols: [app_id, caused_by_created_timestamp, caused_by_id, created_timestamp, email_campaign_id, email_event_filtered, email_event_id, email_event_type, obsoleted_by_created_timestamp, obsoleted_by_id, portal_id, recipient_email_address, sent_by_created_timestamp, sent_by_id]
          stg_hubspot__email_event_click:
            weight: 1
            compare_cols: [click_browser, click_ip_address, click_location, click_referer, click_user_agent, clicked_url, email_event_id]
          stg_hubspot__email_event_open:
            weight: 1
            compare_cols: [email_event_id, open_browser, open_duration, open_ip_address, open_location, open_user_agent]
          stg_hubspot__email_event_sent:
            weight: 1
            compare_cols: [email_bcc, email_cc, email_event_id, email_from, email_reply_to, email_subject]
          stg_hubspot__email_event_status_change:
            weight: 1
            compare_cols: [email_event_id, is_bounced, status_change_requested_by, status_change_source, subscription_changes, subscription_status]
          stg_hubspot__engagement:
            weight: 1
            compare_cols: [engagement_id, engagement_type, portal_id]
          stg_hubspot__engagement_email:
            weight: 1
            compare_cols: [all_owner_ids, all_team_ids, email_subject, email_text, engagement_type]
          stg_hubspot__form:
            weight: 1
            compare_cols: [created_timestamp, follow_up_id, form_action, form_css_class, form_id, form_method, form_name, form_redirect, form_submit_text, form_type, lead_nurturing_campaign_id, notify_recipients, portal_id]
          stg_hubspot__owner:
            weight: 1
            compare_cols: [active_user_id, created_timestamp, email_address, first_name, full_name, last_name, owner_id, owner_type, portal_id, updated_timestamp]
          stg_hubspot__ticket:
            weight: 1
            compare_cols: [closed_date, is_ticket_deleted, owner_id, ticket_category, ticket_content, ticket_id, ticket_pipeline_id, ticket_pipeline_stage_id, ticket_priority, ticket_subject]
          stg_hubspot__ticket_company:
            weight: 1
            compare_cols: [association_category, company_id, ticket_id]
          stg_hubspot__ticket_contact:
            weight: 1
            compare_cols: [association_category, contact_id, ticket_id]
          stg_hubspot__ticket_pipeline:
            weight: 1
            compare_cols: [created_timestamp, is_pipeline_active, is_ticket_pipeline_deleted, object_type_id, pipeline_display_order, pipeline_label, ticket_pipeline_id]
          stg_hubspot__ticket_pipeline_stage:
            weight: 1
            compare_cols: [created_timestamp, is_closed, is_stage_active, is_ticket_pipeline_stage_deleted, pipeline_stage_label, stage_display_order, ticket_pipeline_id, ticket_pipeline_stage_id, ticket_state]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_hubspot__contact_lifecycle_metrics:
            weight: 1
            compare_cols: [avg_deal_value, contact_age_days, contact_id, contact_maturity_segment, conversion_status, conversion_velocity_score, days_to_conversion, email, email_click_through_rate, email_open_rate, engagement_tier, first_deal_date, last_deal_closed_date, last_engagement_date, overall_engagement_score, total_associated_deals, total_closed_deals, total_deal_value, total_emails_bounced, total_emails_clicked, total_emails_opened, total_emails_sent]
          int_hubspot__contact_merge_adjust:
            weight: 1
            compare_cols: [calculated_merged_vids, company_annual_revenue, contact_company, contact_id, email, first_name, is_contact_deleted, job_title, last_name]
          int_hubspot__deal_performance_metrics:
            weight: 1
            compare_cols: [avg_stage_cycle_time, avg_stage_deal_size, closed_quarter, closed_year, created_quarter, created_year, deal_amount, deal_cycle_time_days, deal_id, deal_name, deal_pipeline, deal_pipeline_stage, deal_size_category, deal_stage, deal_status, deals_in_stage, lost_from_stage, median_stage_cycle_time, owner_id, same_quarter_conversion_rate, same_quarter_revenue, same_quarter_wins, stage_win_rate, total_stage_value, won_from_stage]
          int_hubspot__deals_enhanced:
            weight: 1
            compare_cols: [amount, deal_id, deal_name, deal_pipeline_id, deal_pipeline_stage_id, description, is_deal_deleted, is_deal_pipeline_deleted, is_deal_pipeline_stage_deleted, is_pipeline_active, owner_active_user_id, owner_email_address, owner_full_name, owner_id, pipeline_label, pipeline_stage_label, portal_id]
          int_hubspot__email_aggregate_status_change:
            weight: 1
            compare_cols: [email_campaign_id, email_send_id, unsubscribes]
          int_hubspot__email_event_aggregates:
            weight: 1
            compare_cols: [bounces, clicks, deferrals, deliveries, drops, forwards, opens, prints, sends, spam_reports]
          int_hubspot__email_marketing_attribution:
            weight: 1
            compare_cols: [attributed_deals, attributed_revenue, click_through_rate, email_campaign_id, lead_conversion_rate, open_rate, revenue_per_recipient, revenue_per_send, roi_tier, total_sends, unique_recipients]
          int_hubspot__owner_performance_metrics:
            weight: 1
            compare_cols: [avg_lost_cycle_time, avg_won_cycle_time, avg_won_deal_size, cycle_time_rank, deals_won_rank, development_focus, efficiency_percentile, enterprise_deals, enterprise_win_rate, large_deal_win_rate, large_deals, lost_deals, medium_deals, open_deals, overall_performance_score, owner_email, owner_id, owner_name, performance_tier, pipeline_health_status, pipeline_value, revenue_percentile, revenue_rank, sales_specialization, small_deals, total_deals, total_won_revenue, volume_percentile, win_rate_percentage, win_rate_percentile, win_rate_rank, won_deals]
          int_hubspot__owners_enhanced:
            weight: 1
            compare_cols: [owner_active_user_id, owner_email_address, owner_full_name, owner_id]
      marketing:
        description: 'Custom layer: marketing'
        weight: 20
        tables:
          hubspot__contact_engagement_analysis:
            weight: 3
            compare_cols: [contact_id, email, days_to_conversion, contact_maturity_segment, conversion_status, conversion_velocity_score, total_emails_sent, total_emails_opened, total_emails_clicked, total_emails_bounced, email_open_rate, email_click_through_rate, total_associated_deals, total_closed_deals, total_deal_value, avg_deal_value, overall_engagement_score, engagement_tier, final_engagement_classification, email_campaigns_engaged, total_emails_opened, email_attributed_deals, engagement_recency_status, customer_value_segment, revenue_per_email_sent, mql_classification, email_attributed_revenue, sales_readiness_status, primary_attribution_type, revenue_per_day_known, comprehensive_engagement_score]
          hubspot__contacts:
            weight: 3
            compare_cols: [contact_id, calculated_merged_vids, email, first_name, last_name, contact_company, job_title, company_annual_revenue, total_email_opens, total_email_clicks, total_email_bounces, total_unique_email_prints, total_unique_email_drops, total_email_deliveries, total_email_drops, total_email_forwards, total_unique_email_opens, total_unique_email_deliveries, total_unique_email_deferrals, total_email_spam_reports, total_unique_email_clicks, total_email_deferrals, total_unique_email_bounces, total_unique_email_spam_reports, total_email_unsubscribes, total_unique_email_unsubscribes, total_email_prints, total_unique_email_forwards]
          hubspot__email_event_sent:
            weight: 3
            compare_cols: [email_event_id, email_send_id, email_campaign_id, contact_id, recipient_email_address, email_from, email_reply_to, email_subject, email_bcc, email_cc]
          hubspot__email_sends:
            weight: 3
            compare_cols: [email_send_id, email_event_id, email_campaign_id, contact_id, recipient_email_address email_from, email_reply_to, email_subject, email_bcc, email_cc, was_delivered, was_opened, was_clicked, was_bounced, was_deferred, was_spam_reported, was_unsubscribed, was_forwarded, was_printed, opens, clicks, deliveries, bounces, deferrals, drops, forwards, prints, spam_reports, unsubscribes]
      sales:
        description: 'Custom layer: sales'
        weight: 20
        tables:
          hubspot__companies:
            weight: 3
            compare_cols: [company_id, company_name, description, industry, address, address_2, city, state, country, annual_revenue]
          hubspot__deals:
            weight: 3
            compare_cols: [deal_id, deal_pipeline_id, deal_pipeline_stage_id, owner_id, portal_id, deal_name, description, amount, pipeline_label, is_pipeline_active, pipeline_stage_label, owner_active_user_id, owner_email_address, owner_full_name]
          hubspot__sales_performance_dashboard:
            weight: 3
            compare_cols: [created_year, created_quarter, deals_created_in_quarter, deals_won_in_quarter, deals_lost_in_quarter, deals_still_open, revenue_won_in_quarter, pipeline_value_in_quarter, total_open_pipeline, quarterly_win_rate, prev_quarter_win_rate, prev_quarter_revenue, revenue_growth_rate, avg_won_deal_size, p25_deal_size, p75_deal_size, active_sales_reps_in_quarter, revenue_per_sales_rep, weighted_pipeline_forecast, time_weighted_forecast, quarterly_performance_rating, quarterly_goal_status]
          hubspot__sales_rep_performance:
            weight: 3
            compare_cols: [owner_id, owner_name, owner_email, total_deals, won_deals, total_won_revenue, win_rate_percentage, avg_won_cycle_time, current_pipeline_value, enterprise_win_rate, large_deal_win_rate, enterprise_revenue, large_revenue, medium_revenue, small_revenue, revenue_rank, win_rate_rank, volume_rank, efficiency_rank, revenue_percentile, win_rate_percentile, volume_percentile, efficiency_percentile, overall_performance_score, performance_tier, sales_specialization, development_focus, pipeline_health_status, primary_deal_segment, segments_covered, activity_level, activity_consistency, recent_active_months, performance_trend, revenue_trend_percentage, win_rate_trend_points, revenue_volatility]
      service:
        description: 'Custom layer: service'
        weight: 20
        tables:
          hubspot__customer_support_analytics:
            weight: 3
            compare_cols: [ticket_id, ticket_subject, ticket_pipeline, ticket_stage, ticket_status, priority_level, days_open, sla_status, resolution_efficiency, urgency_score, risk_level, service_quality_rating, escalation_recommendation, agent_first_name, agent_last_name, agent_email, contact_first_name, contact_last_name, contact_email, contact_job_title, company_name, company_industry, company_annual_revenue, customer_segment]
          hubspot__tickets:
            weight: 3
            compare_cols: [ticket_id, owner_id, ticket_subject, ticket_content, ticket_category, ticket_priority, ticket_pipeline_id, ticket_pipeline_stage_id, ticket_state, company_ids, contact_ids, contact_emails, owner_active_user_id, company_names, owner_email_address, pipeline_stage_label, pipeline_stage_order, pipeline_label, owner_full_name]
  dacomp-de-impl-011:
    database_file: jira.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_jira__comment:
            weight: 1
            compare_cols: [author_user_id, body, comment_id, is_public, issue_id, last_update_user_id]
          stg_jira__component:
            weight: 1
            compare_cols: [component_description, component_id, component_name, project_id]
          stg_jira__field:
            weight: 1
            compare_cols: [field_id, field_name, is_array, is_custom]
          stg_jira__field_option:
            weight: 1
            compare_cols: [field_id, field_option_id, field_option_name]
          stg_jira__issue:
            weight: 1
            compare_cols: [assignee_user_id, creator_user_id, due_date, environment, issue_description, issue_id, issue_key, issue_name, issue_type_id, original_estimate_seconds, parent_issue_id, priority_id, project_id, remaining_estimate_seconds, reporter_user_id, resolution_id, status_id, time_spent_seconds, work_ratio]
          stg_jira__issue_field_history:
            weight: 1
            compare_cols: [field_id, field_value, is_active, issue_id]
          stg_jira__issue_link:
            weight: 1
            compare_cols: [issue_id, link_type_id, related_issue_id]
          stg_jira__issue_multiselect_history:
            weight: 1
            compare_cols: [field_id, field_value, is_active, issue_id]
          stg_jira__issue_type:
            weight: 1
            compare_cols: [description, is_subtask, issue_type_id, issue_type_name]
          stg_jira__priority:
            weight: 1
            compare_cols: [priority_description, priority_id, priority_name]
          stg_jira__project:
            weight: 1
            compare_cols: [permission_scheme_id, project_category_id, project_description, project_id, project_key, project_lead_user_id, project_name]
          stg_jira__resolution:
            weight: 1
            compare_cols: [resolution_description, resolution_id, resolution_name]
          stg_jira__sprint:
            weight: 1
            compare_cols: [board_id, sprint_id, sprint_name]
          stg_jira__status:
            weight: 1
            compare_cols: [status_category_id, status_description, status_id, status_name]
          stg_jira__status_category:
            weight: 1
            compare_cols: [status_category_id, status_category_name]
          stg_jira__user:
            weight: 1
            compare_cols: [email, is_active, locale, time_zone, user_display_name, user_id, username]
          stg_jira__version:
            weight: 1
            compare_cols: [description, is_archived, is_released, project_id, start_date, version_id, version_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_jira__field_history_scd:
            weight: 1
            compare_cols: [issue_id, sprint, status_id, story_point_estimate, story_points, valid_starting_on]
          int_jira__issue_assign_resolution:
            weight: 1
            compare_cols: [issue_id]
          int_jira__issue_calendar_spine:
            weight: 1
            compare_cols: [earliest_open_until_week, issue_day_id, issue_id]
          int_jira__issue_comments:
            weight: 1
            compare_cols: [count_comments, issue_id]
          int_jira__issue_epic:
            weight: 1
            compare_cols: [issue_id]
          int_jira__issue_field_history:
            weight: 1
            compare_cols: [field_id, field_name, field_value, is_active, issue_id]
          int_jira__issue_join:
            weight: 1
            compare_cols: [assignee_email, assignee_name, assignee_timezone, assignee_user_id, creator_user_id, current_priority, current_status, current_status_category, due_date, environment, issue_description, issue_id, issue_key, issue_name, issue_type_id, original_estimate_seconds, parent_issue_id, priority_id, project_id, project_name, remaining_estimate_seconds, reporter_user_id, resolution_id, resolution_type, status_id, time_spent_seconds, work_ratio]
          int_jira__issue_lifecycle_analysis:
            weight: 1
            compare_cols: [activity_pattern, assignee_user_id, issue_id, issue_key, issue_type_id, lifecycle_speed, priority_id, project_id, reporter_user_id, total_field_changes]
          int_jira__issue_multiselect_history:
            weight: 1
            compare_cols: [field_id, field_name, field_value, is_active, issue_id]
          int_jira__issue_sprint:
            weight: 1
            compare_cols: [board_id, count_sprint_changes, current_sprint_id, current_sprint_name, issue_id, issue_key, project_id]
          int_jira__issue_type_parents:
            weight: 1
            compare_cols: [assignee_user_id, creator_user_id, due_date, environment, issue_description, issue_id, issue_key, issue_name, issue_type, issue_type_id, original_estimate_seconds, parent_issue_id, parent_issue_type, priority_id, project_id, remaining_estimate_seconds, reporter_user_id, resolution_id, status_id, time_spent_seconds, work_ratio]
          int_jira__issue_users:
            weight: 1
            compare_cols: [assignee_email, assignee_name, assignee_timezone, assignee_user_id, creator_user_id, due_date, environment, issue_description, issue_id, issue_key, issue_name, issue_type_id, original_estimate_seconds, parent_issue_id, priority_id, project_id, remaining_estimate_seconds, reporter_email, reporter_name, reporter_timezone, reporter_user_id, resolution_id, status_id, time_spent_seconds, work_ratio]
          int_jira__issue_versions:
            weight: 1
            compare_cols: [affects_versions, fixes_versions, issue_id]
          int_jira__pivot_daily_field_history:
            weight: 1
            compare_cols: [issue_id, sprint, status, story_point_estimate, story_points, valid_starting_on]
          int_jira__project_health_scoring:
            weight: 1
            compare_cols: [open_issues, overall_health_score, project_id, project_key, resolved_issues, total_issues, trajectory_status]
          int_jira__project_metrics:
            weight: 1
            compare_cols: [count_closed_issues, count_open_assigned_issues, count_open_issues, project_id]
          int_jira__sprint_performance_analytics:
            weight: 1
            compare_cols: [burndown_variance, daily_velocity, day_number, issues_completed, issues_remaining, scope_change_issues, scope_change_points, snapshot_date, sprint_health_score, sprint_id, sprint_name, sprint_phase, sprint_risk_status, story_points_completed, story_points_remaining, timeline_progress_ratio, total_issues_committed, total_story_points_committed, velocity_category, velocity_trend_3d]
          int_jira__user_activity_metrics:
            weight: 1
            compare_cols: [activity_date, daily_activity_score, project_id, user_id]
          int_jira__user_metrics:
            weight: 1
            compare_cols: [count_closed_issues, count_open_issues, user_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          jira__daily_issue_field_history:
            weight: 1
            compare_cols: [assignee, components, date_day, issue_day_id, issue_id, issue_type, priority, reporter, status, story_point_estimate, story_points]
          jira__daily_sprint_issue_history:
            weight: 1
            compare_cols: [assignee_name, assignee_user_id, date_day, date_week, days_left_in_sprint, is_issue_open, is_issue_resolved_in_sprint, is_sprint_completed, issue_id, issue_key, original_estimate_seconds, remaining_estimate_seconds, sprint_id, sprint_issue_day_id, sprint_name, status, story_point_estimate, story_points, time_spent_seconds]
          jira__issue_enhanced:
            weight: 1
            compare_cols: [assignee_email, assignee_name, assignee_timezone, assignee_user_id, creator_user_id, current_priority, current_status, current_status_category, due_date, environment, issue_description, issue_id, issue_key, issue_name, issue_type_id, original_estimate_seconds, parent_issue_id, priority_id, project_id, project_name, remaining_estimate_seconds, reporter_user_id, resolution_id, resolution_type, status_id, time_spent_seconds, work_ratio]
          jira__issue_intelligence_analytics:
            weight: 1
            compare_cols: [age_risk_score, assignee_name, assignment_risk_score, collaboration_opportunity_score, completion_probability, complexity_risk_score, current_priority, current_status, deviation_risk_score, efficiency_opportunity_score, health_status, high_complexity_risk, intelligence_score, intervention_urgency, is_active_sprint, issue_id, issue_key, issue_type, lifecycle_deviation_ratio, lifecycle_outlier_status, lifecycle_pattern, lifecycle_quality_score, predicted_completion_timeframe, process_opportunity_score, project_name, recommended_action, regression_ratio, strategic_importance, total_lifecycle_days, total_opportunity_score, total_risk_score]
          jira__issue_intelligence_simple:
            weight: 1
            compare_cols: [assignee_name, completion_probability, current_status, issue_id, issue_key, issue_name, project_name, risk_level]
          jira__project_enhanced:
            weight: 1
            compare_cols: [count_closed_issues, count_open_assigned_issues, count_open_issues, permission_scheme_id, project_category_id, project_description, project_id, project_key, project_lead_user_id, project_name]
          jira__project_risk_assessment:
            weight: 1
            compare_cols: [budget_impact_prediction, complexity_risk_score, delivered_value_points, estimated_project_value_points, health_risk_score, high_delay_cost_issues, net_issue_growth_30d, overall_health_score, primary_risk_driver, primary_risk_factor, project_id, project_key, project_name, recommended_intervention, resolution_velocity_change_percent, resource_risk_score, risk_category, scope_risk_score, sprint_adoption_rate, strategic_priority_recommendation, team_stability_percentage, timeline_prediction, total_external_links, total_hours_invested, trajectory_status, unique_components, unique_issue_types, value_delivery_percentage]
          jira__project_risk_simple:
            weight: 1
            compare_cols: [count_closed_issues, count_open_issues, project_id, project_name, project_value, risk_category]
          jira__sprint_enhanced:
            weight: 1
            compare_cols: [board_id, issues_committed, open_sprint_issues, resolved_sprint_issues, sprint_assignees, sprint_id, sprint_issues, sprint_name, story_point_estimate_committed, story_point_estimate_completed, story_point_estimate_end, story_points_committed, story_points_completed, story_points_end]
          jira__stakeholder_engagement_insights:
            weight: 1
            compare_cols: [cross_functional_projects, development_opportunity, direct_network_connections, engagement_breadth_score, engagement_depth_score, engagement_impact_score, engagement_quality_score, engagement_risk_status, influence_level, issues_assigned, issues_reported, recommended_engagement_strategy, response_pattern_type, stakeholder_archetype, stakeholder_id, strategic_value_score, total_comments_authored, total_engagement_score, total_projects_involved, user_display_name]
          jira__team_performance_dashboard:
            weight: 1
            compare_cols: [at_churn_risk, avg_daily_activity_score, avg_resolution_days, avg_sprint_completion_rate, avg_weekly_activity_score, bug_issues, consistency_percentage, current_engagement_tier, current_lifecycle_stage, current_pattern_type, days_since_first_issue, email, epic_issues, estimate_accuracy_percentage, high_priority_issues, inactive_recently, issue_types_worked_on, leadership_indicator, linked_issues, overall_performance_score, poor_estimation, project_id, project_name, projects_contributed_to, resolution_rate_percentage, resolved_issues, sprint_count, total_assigned_issues, total_story_points_delivered, unique_collaborators_on_issues, user_display_name, user_id]
          jira__team_performance_dashboard_simple:
            weight: 1
            compare_cols: [avg_close_time_days, count_closed_issues, count_open_issues, email, performance_tier, user_display_name, user_id]
          jira__user_enhanced:
            weight: 1
            compare_cols: [avg_age_currently_open_seconds, avg_close_time_seconds, count_closed_issues, count_open_issues, email, is_active, locale, median_age_currently_open_seconds, median_close_time_seconds, time_zone, user_display_name, user_id, username]
  dacomp-de-impl-012:
    database_file: marketo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
      - utils
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_marketo__activity_change_data_value:
            weight: 1
            compare_cols: [activity_id, activity_type_id, api_method_name, campaign_id, field_name, lead_id, modifying_user, new_value, old_value, primary_attribute_value_id, reason, request_id, source]
          stg_marketo__activity_click_email:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, campaign_run_id, click_device, click_link_url, click_platform, click_user_agent, email_template_id, is_mobile_device, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_delete_lead:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_email_bounced:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, campaign_run_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_email_delivered:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, campaign_run_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_merge_leads:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, lead_id, merged_lead_ids, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_open_email:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, campaign_run_id, email_template_id, is_mobile_device, lead_id, open_device, open_platform, open_user_agent, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_send_email:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_unsubscribe_email:
            weight: 1
            compare_cols: [activity_id, activity_type_id, campaign_id, campaign_run_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__campaigns:
            weight: 1
            compare_cols: [campaign_id, campaign_name, campaign_type, computed_url, created_timestamp, description, flow_id, folder_id, folder_type, is_active, is_communication_limit_enabled, is_requestable, is_system, max_members, program_id, qualification_rule_type, qualification_rule_unit, recurrence_day_of_month, recurrence_day_of_week, recurrence_end_at, recurrence_interval_type, recurrence_start_at, recurrence_week_of_month, recurrence_weekday_only, smart_list_id, status, updated_timestamp, workspace_name]
          stg_marketo__email_template_history:
            weight: 1
            compare_cols: [created_timestamp, description, email_template_id, email_template_name, email_template_status, folder_id, folder_type, from_email, from_name, operational, program_id, publish_to_msi, reply_email, subject, template, text_only, updated_timestamp, url, version, web_view, workspace]
          stg_marketo__lead:
            weight: 1
            compare_cols: [created_timestamp, email, first_name, last_name, lead_id, updated_timestamp]
          stg_marketo__lead_describe:
            weight: 1
            compare_cols: [data_type, display_name, field_max_length, is_rest_readonly, is_soap_readonly, lead_describe_id, rest_name, rest_name_xf, soap_name]
          stg_marketo__program:
            weight: 1
            compare_cols: [channel, created_timestamp, description, end_date, program_id, program_name, program_status, program_type, sfdc_id, sfdc_name, start_date, updated_timestamp, url, workspace_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_marketo__lead:
            weight: 1
            compare_cols: [created_timestamp, email, first_name, is_deleted, is_merged, last_name, lead_id, merged_into_lead_id, updated_timestamp]
          marketo__bounces__by_sent_email:
            weight: 1
            compare_cols: [count_bounces, email_send_id]
          marketo__change_data_details:
            weight: 1
            compare_cols: [city_c, company_c, country_c, date_day, do_not_call_c, email_c, email_invalid_c, first_name_c, industry_c, last_name_c, lead_id, lead_score_c, lead_source_c, lead_status_c, phone_c, rating_c, state_c, title_c, unsubscribed_c]
          marketo__change_data_pivot:
            weight: 1
            compare_cols: [city_c, company_c, country_c, date_day, do_not_call_c, email_c, email_invalid_c, first_name_c, industry_c, last_name_c, lead_day_id, lead_id, lead_score_c, lead_source_c, lead_status_c, phone_c, rating_c, state_c, title_c, unsubscribed_c]
          marketo__change_data_scd:
            weight: 1
            compare_cols: [company_c, email_c, first_name_c, last_name_c, lead_day_id, lead_id, lead_status_c, valid_to]
          marketo__clicks__by_sent_email:
            weight: 1
            compare_cols: [count_clicks, email_send_id]
          marketo__deliveries__by_sent_email:
            weight: 1
            compare_cols: [count_deliveries, email_send_id]
          marketo__email_sends_deduped:
            weight: 1
            compare_cols: [activity_id, activity_rank, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          marketo__lead_calendar_spine:
            weight: 1
            compare_cols: [lead_id]
          marketo__opens__by_sent_email:
            weight: 1
            compare_cols: [count_opens, count_unique_opens, email_send_id]
          marketo__unsubscribes__by_sent_email:
            weight: 1
            compare_cols: [count_unsubscribes, email_send_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          marketo__campaigns:
            weight: 1
            compare_cols: [campaign_id, campaign_name, campaign_type, computed_url, count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes, created_timestamp, description, flow_id, folder_id, folder_type, is_active, is_communication_limit_enabled, is_requestable, is_system, max_members, program_id, qualification_rule_type, qualification_rule_unit, recurrence_interval_type, recurrence_weekday_only, smart_list_id, status, updated_timestamp, workspace_name]
          marketo__email_funnel_dashboard:
            weight: 1
            compare_cols: [actual_date, analysis_type, campaign_id, email_template_id, period_delivery_rate, period_emails_bounced, period_emails_clicked, period_emails_delivered, period_emails_opened, period_emails_sent, period_emails_unsubscribed, period_identifier, period_unique_clicked, period_unique_opened, period_unique_recipients, total_click_actions, total_open_actions]
          marketo__email_sends:
            weight: 1
            compare_cols: [activity_id, activity_rank, activity_type_id, campaign_id, campaign_run_id, campaign_type, count_bounces, count_clicks, count_deliveries, count_opens, count_unsubscribes, email_send_id, email_template_id, is_operational, lead_id, primary_attribute_value, primary_attribute_value_id, program_id, was_bounced, was_clicked, was_delivered, was_opened, was_unsubscribed]
          marketo__email_stats__by_campaign:
            weight: 1
            compare_cols: [campaign_id, count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes]
          marketo__email_stats__by_email_template:
            weight: 1
            compare_cols: [count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes, email_template_id]
          marketo__email_stats__by_lead:
            weight: 1
            compare_cols: [count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes, lead_id]
          marketo__email_stats__by_program:
            weight: 1
            compare_cols: [count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes]
          marketo__email_templates:
            weight: 1
            compare_cols: [count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes, created_timestamp, description, email_template_id, email_template_name, email_template_status, folder_id, folder_type, from_email, from_name, operational, program_id, publish_to_msi, reply_email, subject, template, text_only, updated_timestamp, url, version, web_view, workspace]
          marketo__lead_history:
            weight: 1
            compare_cols: [company_c, date_day, email_c, first_name_c, last_name_c, lead_history_id, lead_id, lead_status_c]
          marketo__lead_intelligence_simple:
            weight: 1
            compare_cols: [days_since_last_email, email, email_open_rate_pct, first_name, last_name, lead_health_status, lead_id, lead_quality_tier, lead_tenure_days, next_best_action, rfm_segment, total_emails_bounced, total_emails_clicked, total_emails_opened, total_emails_sent, total_lead_score, total_unsubscribes, unique_campaigns_participated, value_tier]
          marketo__leads:
            weight: 1
            compare_cols: [count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes, created_timestamp, email, first_name, is_merged, last_name, lead_id, merged_into_lead_id, updated_timestamp]
          marketo__operational_health_simple:
            weight: 1
            compare_cols: [at_risk_leads_pct, avg_lead_score, avg_open_rate_last_7_days, bounce_rate_volatility, campaigns_with_bounce_issues, critical_campaigns, days_of_data, deliverability_health_status, delivery_rate_volatility, delivery_stability, earliest_activity_date, engaged_leads, engaged_leads_pct, health_check_date, health_check_timestamp, healthy_campaigns, healthy_campaigns_pct, inactive_leads, latest_activity_date, lead_database_health_status, low_engaged_leads, moderately_engaged_leads, overall_bounce_rate_pct, overall_delivery_rate_pct, overall_health_score, primary_recommendation, recent_delivery_rate_pct, successful_deliveries, system_volume_classification, total_bounces, total_campaigns, total_email_attempts, total_leads]
          marketo__programs:
            weight: 1
            compare_cols: [channel, count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes, created_timestamp, description, end_date, program_id, program_name, program_status, program_type, sfdc_id, sfdc_name, start_date, updated_timestamp, url, workspace_name]
      utils:
        description: 'Custom layer: utils'
        weight: 0
        tables:
          marketo__calendar_spine:
            weight: 1
            compare_cols: []
  dacomp-de-impl-013:
    database_file: netsuite.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_netsuite2__account_types:
            weight: 1
            compare_cols: [account_type_id, is_balancesheet, is_leftside, type_name]
          stg_netsuite2__accounting_book_subsidiaries:
            weight: 1
            compare_cols: [accounting_book_id, status, subsidiary_id]
          stg_netsuite2__accounting_books:
            weight: 1
            compare_cols: [accounting_book_id, accounting_book_name, base_book_id, effective_period_id, is_adjustment_only, is_consolidated, is_primary]
          stg_netsuite2__accounting_period_fiscal_cal:
            weight: 1
            compare_cols: [accounting_period_id, fiscal_calendar_id]
          stg_netsuite2__accounting_periods:
            weight: 1
            compare_cols: [accounting_period_id, closed_at, ending_at, is_adjustment, is_all_locked, is_ap_locked, is_ar_locked, is_closed, is_posting, is_quarter, is_year, name, parent_id, starting_at]
          stg_netsuite2__accounts:
            weight: 1
            compare_cols: [account_id, account_number, general_rate_type, is_balancesheet, is_leftside, name, parent_id, type_name]
          stg_netsuite2__classes:
            weight: 1
            compare_cols: [class_external_id, class_id, full_name, is_inactive, name]
          stg_netsuite2__consolidated_exchange_rates:
            weight: 1
            compare_cols: [accounting_book_id, accounting_period_id, average_rate, consolidated_exchange_rate_id, current_rate, from_currency_id, from_subsidiary_id, historical_rate, to_currency_id, to_subsidiary_id]
          stg_netsuite2__currencies:
            weight: 1
            compare_cols: [currency_id, name, symbol]
          stg_netsuite2__customers:
            weight: 1
            compare_cols: [alt_name, company_name, currency_id, customer_external_id, customer_id, default_billing_address_id, default_shipping_address_id, email_address, entity_id, first_name, is_person, last_name, parent_id, phone_number, receivables_account_id]
          stg_netsuite2__departments:
            weight: 1
            compare_cols: [department_id, full_name, is_inactive, parent_id, subsidiary_id]
          stg_netsuite2__employees:
            weight: 1
            compare_cols: [approval_limit, department_id, email, employee_id, entity_id, expense_limit, first_name, is_inactive, last_name, purchase_order_approval_limit, purchase_order_limit, subsidiary_id, supervisor_id]
          stg_netsuite2__entities:
            weight: 1
            compare_cols: [customer_id, employee_id, entity_id, entity_name, entity_type, job_id, vendor_id]
          stg_netsuite2__entity_address:
            weight: 1
            compare_cols: [addr1, addr2, addr3, addressee, city, country, full_address, nkey, state, zipcode]
          stg_netsuite2__fiscal_calendar:
            weight: 1
            compare_cols: [fiscal_calendar_external_id, fiscal_calendar_id, fiscal_calendar_name, fiscal_month, is_default]
          stg_netsuite2__items:
            weight: 1
            compare_cols: [asset_account_id, class_id, deferral_account_id, department_id, description, expense_account_id, gain_loss_account_id, income_account_id, item_id, item_type, location_id, name, parent_id, subsidiary_id]
          stg_netsuite2__jobs:
            weight: 1
            compare_cols: [customer_id, default_billing_address_id, default_shipping_address_id, entity_id, job_external_id, job_id, parent_id]
          stg_netsuite2__location_main_address:
            weight: 1
            compare_cols: [addr1, addr2, addr3, addressee, city, country, full_address, nkey, state, zipcode]
          stg_netsuite2__locations:
            weight: 1
            compare_cols: [full_name, location_id, main_address_id, name, parent_id, subsidiary_id]
          stg_netsuite2__subsidiaries:
            weight: 1
            compare_cols: [country, currency_id, email, fiscal_calendar_id, full_name, is_elimination, main_address_id, name, parent_id, state, subsidiary_id]
          stg_netsuite2__transaction_accounting_lines:
            weight: 1
            compare_cols: [account_id, accounting_book_id, amount, credit_amount, debit_amount, exchange_rate, net_amount, paid_amount, transaction_id, transaction_line_id, unpaid_amount]
          stg_netsuite2__transaction_lines:
            weight: 1
            compare_cols: [class_id, department_id, entity_id, item_id, location_id, memo, netamount, subsidiary_id, transaction_id, transaction_line_id, transaction_line_number]
          stg_netsuite2__transactions:
            weight: 1
            compare_cols: [accounting_period_id, entity_id, is_posting, is_reversal_defer, memo, reversal_date, reversal_transaction_id, status, transaction_date, transaction_id, transaction_number, transaction_type]
          stg_netsuite2__vendor_categories:
            weight: 1
            compare_cols: [name, vendor_category_id]
          stg_netsuite2__vendors:
            weight: 1
            compare_cols: [alt_name, company_name, vendor_category_id, vendor_id]
          stg_netsuite__accounting_books:
            weight: 1
            compare_cols: [accounting_book_id, is_primary]
          stg_netsuite__accounting_periods:
            weight: 1
            compare_cols: [accounting_period_id, fiscal_calendar_id, full_name, is_adjustment, is_closed, name, quarter, year_0, year_id]
          stg_netsuite__accounts:
            weight: 1
            compare_cols: [account_id, account_number, general_rate_type, is_balancesheet, is_leftside, name, parent_id, type_name]
          stg_netsuite__classes:
            weight: 1
            compare_cols: [class_id, full_name]
          stg_netsuite__consolidated_exchange_rates:
            weight: 1
            compare_cols: [accounting_book_id, accounting_period_id, average_rate, consolidated_exchange_rate_id, current_rate, from_subsidiary_id, historical_rate, to_subsidiary_id]
          stg_netsuite__currencies:
            weight: 1
            compare_cols: [currency_id, name, symbol]
          stg_netsuite__customers:
            weight: 1
            compare_cols: [city, company_name, country, customer_id, state, zipcode]
          stg_netsuite__departments:
            weight: 1
            compare_cols: [department_id, full_name, name]
          stg_netsuite__expense_accounts:
            weight: 1
            compare_cols: [account_number, expense_account_id, name, parent_id]
          stg_netsuite__income_accounts:
            weight: 1
            compare_cols: [account_number, income_account_id, name, parent_id]
          stg_netsuite__items:
            weight: 1
            compare_cols: [item_id, name, sales_description, type_name]
          stg_netsuite__locations:
            weight: 1
            compare_cols: [city, country, full_name, location_id, name]
          stg_netsuite__subsidiaries:
            weight: 1
            compare_cols: [fiscal_calendar_id, name, parent_id, subsidiary_id]
          stg_netsuite__transaction_lines:
            weight: 1
            compare_cols: [account_id, class_id, company_id, department_id, item_id, location_id, memo, non_posting_line, subsidiary_id, transaction_id, transaction_line_id]
          stg_netsuite__transactions:
            weight: 1
            compare_cols: [accounting_period_id, currency_id, is_advanced_intercompany, is_intercompany, status, transaction_date, transaction_id, transaction_type]
          stg_netsuite__vendor_types:
            weight: 1
            compare_cols: [name, vendor_type_id]
          stg_netsuite__vendors:
            weight: 1
            compare_cols: [company_name, create_date_at, vendor_id, vendor_type_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_netsuite2__accounting_periods:
            weight: 1
            compare_cols: [accounting_period_id, closed_at, ending_at, is_adjustment, is_all_locked, is_ap_locked, is_ar_locked, is_closed, is_posting, is_quarter, is_year, name, parent_id, starting_at]
          int_netsuite2__accounts:
            weight: 1
            compare_cols: [account_id, account_number, general_rate_type, name, parent_id, type_name]
          int_netsuite2__acctxperiod_exchange_rate_map:
            weight: 1
            compare_cols: [account_id, accounting_period_id, exchange_rate, from_subsidiary_id, to_subsidiary_currency_symbol, to_subsidiary_id, to_subsidiary_name]
          int_netsuite2__ar_aging_analysis:
            weight: 1
            compare_cols: [customer_id, customer_name, customer_email, customer_phone, customer_credit_limit, subsidiary_id, total_ar_amount, overdue_amount, expected_recoverable_amount, expected_loss_amount, current_amount, days_1_30_amount, days_31_60_amount, days_61_90_amount, days_91_120_amount, days_121_180_amount, over_180_days_amount, overdue_percentage, credit_utilization_ratio, weighted_average_days_outstanding, customer_risk_score, collection_priority, recommended_action, credit_status, cash_flow_impact, total_invoices, max_days_past_due, estimated_collection_days, ar_aging_id]
          int_netsuite2__balance_sheet:
            weight: 1
            compare_cols: [account_category, account_display_name, account_id, account_name, account_number, account_type_name, accounting_period_ending, accounting_period_name, balance_sheet_id, balance_sheet_sort_helper, converted_amount, is_account_intercompany, is_account_leftside, is_accounting_period_adjustment, is_accounting_period_closed, subsidiary_currency_symbol, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_id, transaction_line_id]
          int_netsuite2__cash_flow_analysis:
            weight: 1
            compare_cols: [subsidiary_id, analysis_month, operating_cash_flow, investing_cash_flow, financing_cash_flow, net_cash_flow, total_cash_inflows, total_cash_outflows, expected_operating_cash_flow, cumulative_cash_flow, cumulative_operating_cash_flow, three_month_avg_cash_flow, net_cash_flow_change_rate, operating_cash_flow_change_rate, cash_flow_health, cash_flow_stability, cash_efficiency_ratio, predicted_next_month_cash_flow, predicted_next_quarter_cash_flow, cash_flow_risk_level, recommended_action, transaction_count, inflow_transactions, outflow_transactions, cash_flow_analysis_id]
          int_netsuite2__cash_flow_forecasting:
            weight: 1
            compare_cols: [subsidiary_id, forecast_month, forecast_month_offset, forecast_horizon, forecast_net_cash_flow, forecast_operating_cash_flow, forecast_investing_cash_flow, forecast_financing_cash_flow, forecast_net_cash_flow_lower_bound, forecast_net_cash_flow_upper_bound, forecast_confidence, cumulative_forecast_cash_flow, cumulative_forecast_operating_cash_flow, three_month_forecast_avg, forecast_trend, forecast_risk_level, recommended_action, net_cash_flow_volatility, historical_periods, cash_flow_forecast_id]
          int_netsuite2__customer_credit_risk:
            weight: 1
            compare_cols: [customer_id, customer_name, customer_email, customer_creation_date, customer_relationship_days, relationship_duration_months, subsidiary_id, total_receivables, total_collections, total_revenue, outstanding_receivables, collection_ratio, receivables_to_revenue_ratio, total_transactions, payment_transactions, outstanding_transactions, days_since_last_outstanding, payment_performance_score, payment_timeliness_score, relationship_stability_score, revenue_volume_score, receivables_control_score, total_credit_score, credit_rating, risk_level, customer_activity_status, recommended_credit_limit, collection_difficulty, risk_assessment_date, customer_risk_id]
          int_netsuite2__customer_profitability:
            weight: 1
            compare_cols: [customer_id, customer_name, customer_email, customer_maturity, subsidiary_id, total_revenue, total_cogs, allocated_expenses, gross_profit, net_profit, gross_margin_pct, net_margin_pct, transaction_count, first_transaction_date, last_transaction_date, average_order_value, revenue_score, frequency_score, margin_score, total_customer_score, customer_segment, activity_status, predicted_clv, investment_recommendation, analysis_date, customer_profitability_id]
          int_netsuite2__customers:
            weight: 1
            compare_cols: [alt_name, company_name, currency_id, customer_external_id, customer_id, date_first_order_at, default_billing_address_id, default_shipping_address_id, email_address, entity_id, first_name, is_person, last_name, parent_id, phone_number, receivables_account_id]
          int_netsuite2__data_quality_metrics:
            weight: 1
            compare_cols: [report_type, completeness_score, consistency_score, accuracy_score, overall_quality_score, quality_grade, primary_concern, recommended_action, tables_assessed, integrity_checks_performed, business_rules_validated, assessment_timestamp, quality_assessment_id]
          int_netsuite2__financial_ratios:
            weight: 1
            compare_cols: [subsidiary_id, accounting_period_id, current_ratio, quick_ratio, cash_ratio, return_on_equity, gross_margin_ratio, net_profit_margin, receivables_turnover, total_current_assets, total_current_liabilities, cash_and_equivalents, accounts_receivable, total_equity, total_revenue, total_cogs, net_income, calculation_date, liquidity_score, profitability_score, efficiency_score, overall_financial_health_score, financial_health_grade, financial_ratios_id]
          int_netsuite2__income_statement:
            weight: 1
            compare_cols: [account_category, account_id, account_name, account_number, account_number_and_name, account_type_name, accounting_period_ending, accounting_period_name, class_full_name, converted_amount, department_full_name, income_statement_id, income_statement_sort_helper, is_accounting_period_adjustment, is_accounting_period_closed, location_full_name, subsidiary_currency_symbol, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_id, transaction_line_id]
          int_netsuite2__locations:
            weight: 1
            compare_cols: [full_name, location_id, main_address_id, name, parent_id, subsidiary_id]
          int_netsuite2__supplier_credit_monitoring:
            weight: 1
            compare_cols: [vendor_id, vendor_name, vendor_email, vendor_creation_date, vendor_relationship_days, relationship_duration_months, subsidiary_id, total_payables, total_payments, total_expenses, outstanding_balance, payment_ratio, avg_payment_delay_days, total_transactions, payment_transactions, outstanding_transactions, days_since_last_outstanding, payment_performance_score, payment_timeliness_score, relationship_stability_score, transaction_frequency_score, total_credit_score, credit_rating, risk_level, vendor_activity_status, recommended_credit_limit, supplier_monitoring_id]
          int_netsuite2__tran_and_reporting_periods:
            weight: 1
            compare_cols: [accounting_period_id, reporting_accounting_period_id]
          int_netsuite2__tran_lines_w_accounting_period:
            weight: 1
            compare_cols: [account_id, subsidiary_id, transaction_accounting_period_id, transaction_id, transaction_line_id, unconverted_amount]
          int_netsuite2__tran_with_converted_amounts:
            weight: 1
            compare_cols: [account_category, account_id, converted_amount_using_reporting_month, converted_amount_using_transaction_accounting_period, is_income_statement, reporting_accounting_period_id, subsidiary_id, tran_with_converted_amounts_id, transaction_accounting_period_id, transaction_id, transaction_line_id, unconverted_amount]
          int_netsuite2__transaction_details:
            weight: 1
            compare_cols: [account_id, account_name, account_number, account_type_name, accounting_period_ending, accounting_period_name, converted_amount, is_account_leftside, is_accounting_period_adjustment, is_accounting_period_closed, sub_id, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_details_id, transaction_id, transaction_line_amount, transaction_line_id]
          int_netsuite2__transaction_lines:
            weight: 1
            compare_cols: [account_id, amount, class_id, credit_amount, debit_amount, department_id, entity_id, exchange_rate, is_billable, is_cleared, is_closed, is_cogs, is_commitment_firm, is_eliminate, is_main_line, is_posting, is_tax_line, item_id, location_id, memo, netamount, paid_amount, subsidiary_id, tl_row, transaction_id, transaction_line_id, transaction_line_number, unpaid_amount]
          int_netsuite__accountxperiod_exchange_rate_map:
            weight: 1
            compare_cols: [account_id, accounting_period_id, exchange_rate, from_subsidiary_id, to_subsidiary_id]
          int_netsuite__transaction_and_reporting_periods:
            weight: 1
            compare_cols: [accounting_period_id, reporting_accounting_period_id]
          int_netsuite__transaction_lines_w_accounting_period:
            weight: 1
            compare_cols: [account_id, subsidiary_id, transaction_accounting_period_id, transaction_id, transaction_line_id, unconverted_amount]
          int_netsuite__transactions_with_converted_amounts:
            weight: 1
            compare_cols: [account_category, account_id, converted_amount_using_reporting_month, converted_amount_using_transaction_accounting_period, is_income_statement, reporting_accounting_period_id, subsidiary_id, transaction_accounting_period_id, transaction_id, transaction_line_id, unconverted_amount]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          netsuite2_balance_sheet:
            weight: 1
            compare_cols: [account_category, account_display_name, account_id, account_name, account_number, account_type_name, accounting_period_ending, accounting_period_name, balance_sheet_id, balance_sheet_sort_helper, converted_amount, is_account_intercompany, is_account_leftside, is_accounting_period_adjustment, is_accounting_period_closed, subsidiary_currency_symbol, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_id, transaction_line_id]
          netsuite2_customer_analytics:
            weight: 1
            compare_cols: [customer_id, customer_name, customer_email, subsidiary_id, profitability_segment, value_tier, lifecycle_stage, activity_status, retention_category, total_revenue, net_profit, transaction_count, avg_transactions_per_month, comprehensive_customer_score, retention_probability, seasonal_preference, transaction_consistency, growth_potential, recommended_action, engagement_frequency, customer_age_days, transaction_value_volatility, q1_transactions, q2_transactions, q3_transactions, q4_transactions, customer_analytics_id]
          netsuite2_financial_dashboard:
            weight: 1
            compare_cols: [subsidiary_id, accounting_period_id, dashboard_date, current_ratio, quick_ratio, return_on_equity, gross_margin_ratio, net_profit_margin, overall_financial_health_score, financial_health_grade, net_cash_flow, operating_cash_flow, cash_flow_health, predicted_next_month_cash_flow, cash_flow_risk_level, total_ar_amount, overdue_amount, overdue_percentage, weighted_average_days_outstanding, total_customers, high_value_customers, at_risk_customers, total_customer_revenue, average_customer_value, avg_financial_health, financial_health_volatility, avg_net_margin, avg_current_ratio, cash_flow_consistency_percentage, total_risk_score, risk_level, primary_risk_factor, liquidity_performance, profitability_performance, roe_performance, collection_performance, improvement_recommendation, overall_rating, key_alert, dashboard_id]
          netsuite2_income_statement:
            weight: 1
            compare_cols: [account_category, account_id, account_name, account_number, account_number_and_name, account_type_name, accounting_period_ending, accounting_period_name, class_full_name, converted_amount, department_full_name, income_statement_id, income_statement_sort_helper, is_accounting_period_adjustment, is_accounting_period_closed, location_full_name, subsidiary_currency_symbol, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_id, transaction_line_id]
          netsuite2_operational_metrics:
            weight: 1
            compare_cols: [subsidiary_id, department_id, department_name, location_id, location_name, performance_month, department_revenue, gross_profit, net_profit, gross_margin_percentage, net_margin_percentage, revenue_to_expense_ratio, month_over_month_growth, year_over_year_growth, three_month_avg_revenue, revenue_trend, margin_trend, performance_grade, revenue_rank_within_company, margin_rank_within_company, revenue_vs_company_avg, margin_vs_company_avg, internal_market_share, alert_status, improvement_recommendation, investment_recommendation, operational_metrics_id]
          netsuite2_transaction_details:
            weight: 1
            compare_cols: [account_id, account_name, account_number, account_type_name, accounting_period_ending, accounting_period_name, converted_amount, is_account_leftside, is_accounting_period_adjustment, is_accounting_period_closed, sub_id, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_details_id, transaction_id, transaction_line_amount, transaction_line_id]
          netsuite2_transaction_details_original:
            weight: 1
            compare_cols: [account_id, account_name, account_number, account_type_name, accounting_period_ending, accounting_period_id, accounting_period_name, class_full_name, class_id, company_name, converted_amount, currency_id, currency_name, currency_symbol, customer_alt_name, customer_city, customer_country, customer_date_first_order, customer_external_id, customer_id, customer_state, customer_zipcode, department_full_name, department_id, department_name, entity_id, exchange_rate, is_account_intercompany, is_account_leftside, is_accounting_period_adjustment, is_accounting_period_closed, is_accounts_payable, is_accounts_receivable, is_closed, is_eliminate, is_expense_account, is_income_account, is_main_line, is_reversal, is_reversal_defer, is_tax_line, is_transaction_intercompany_adjustment, is_transaction_non_posting, item_id, item_name, item_type_name, location_city, location_country, location_id, location_name, parent_account_id, parent_account_name, reversal_date, reversal_transaction_id, sales_description, subsidiary_currency_symbol, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_date, transaction_details_id, transaction_due_date, transaction_id, transaction_line_amount, transaction_line_id, transaction_memo, transaction_number, transaction_status, transaction_type, vendor_alt_name, vendor_category_id, vendor_category_name, vendor_id, vendor_name]
          netsuite2_transaction_details_simple:
            weight: 1
            compare_cols: [account_id, account_name, account_number, account_type_name, accounting_period_ending, accounting_period_name, converted_amount, is_account_leftside, is_accounting_period_adjustment, is_accounting_period_closed, sub_id, subsidiary_full_name, subsidiary_id, subsidiary_name, transaction_amount, transaction_details_id, transaction_id, transaction_line_amount, transaction_line_id]
          netsuite2_vendor_risk_analysis:
            weight: 1
            compare_cols: [vendor_id, vendor_name, vendor_email, vendor_category_name, subsidiary_id, total_vendor_spend, total_payables, total_expenses, avg_payable_amount, max_transaction_amount, total_transactions, active_months, avg_payment_delay, overdue_payment_percentage, overdue_invoices, total_payable_invoices, dependency_level, spend_concentration_ratio, relationship_stability, activity_status, vendor_risk_score, risk_level, business_impact_level, supplier_tier, management_priority, recommended_action, contract_recommendation, payment_recommendation, days_since_last_transaction, vendor_risk_analysis_id]
          netsuite__balance_sheet:
            weight: 1
            compare_cols: [transaction_id, transaction_line_id, accounting_period_id, accounting_period_ending, accounting_period_full_name, accounting_period_name, is_accounting_period_adjustment, is_accounting_period_closed, account_category, account_name, account_type_name, account_id, account_number, converted_amount, balance_sheet_sort_helper]
          netsuite__income_statement:
            weight: 1
            compare_cols: [transaction_id, transaction_line_id, accounting_period_id, accounting_period_ending, accounting_period_full_name, accounting_period_name, is_accounting_period_adjustment, is_accounting_period_closed, account_name, account_type_name, account_id, account_number, subsidiary_id, subsidiary_full_name, subsidiary_name, account_number_and_name, class_full_name, location_full_name, department_full_name, converted_amount, account_category, income_statement_sort_helper]
          netsuite__transaction_details:
            weight: 1
            compare_cols: [transaction_line_id, transaction_memo, is_transaction_non_posting, transaction_id, transaction_status, transaction_type, transaction_amount]
          netsuite__transaction_details_simplified:
            weight: 1
            compare_cols: [transaction_line_id, transaction_memo, is_transaction_non_posting, transaction_id, transaction_status, transaction_type, transaction_amount]
  dacomp-de-impl-014:
    database_file: qualtrics.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_qualtrics__block:
            weight: 1
            compare_cols: [block_id, block_visibility, description, is_locked, randomize_questions, survey_id, type]
          stg_qualtrics__block_question:
            weight: 1
            compare_cols: [block_id, question_id, survey_id]
          stg_qualtrics__contact_mailing_list_membership:
            weight: 1
            compare_cols: [contact_id, contact_lookup_id, directory_id, is_unsubscribed, mailing_list_id, name, owner_user_id, unsubscribed_at]
          stg_qualtrics__core_contact:
            weight: 1
            compare_cols: [contact_id, email, external_data_reference, first_name, is_unsubscribed, language, last_name, mailing_list_id]
          stg_qualtrics__core_mailing_list:
            weight: 1
            compare_cols: [category, folder, library_id, mailing_list_id, name]
          stg_qualtrics__directory:
            weight: 1
            compare_cols: [directory_id, is_deduped_on_email, is_deduped_on_ext_ref, is_deduped_on_first_name, is_deduped_on_last_name, is_deduped_on_phone, is_default, name]
          stg_qualtrics__directory_contact:
            weight: 1
            compare_cols: [contact_id, directory_id, email, email_domain, ext_ref, first_name, is_unsubscribed_from_directory, language, last_name]
          stg_qualtrics__directory_mailing_list:
            weight: 1
            compare_cols: [created_at, directory_id, last_modified_at, mailing_list_id, name, owner_user_id]
          stg_qualtrics__distribution:
            weight: 1
            compare_cols: [created_at, distribution_id, header_from_email, header_from_name, header_reply_to_email, header_subject, last_modified_at, message_id, message_library_id, message_text, organization_id, owner_user_id, parent_distribution_id, recipient_contact_id, recipient_library_id, recipient_mailing_list_id, recipient_sample_id, request_status, request_type, send_at, survey_id, survey_link_expires_at, survey_link_type]
          stg_qualtrics__distribution_contact:
            weight: 1
            compare_cols: [contact_frequency_rule_id, contact_id, contact_lookup_id, distribution_id, response_id, status, survey_link, survey_session_id]
          stg_qualtrics__question:
            weight: 1
            compare_cols: [data_export_tag, is_data_hidden, is_data_private, next_answer_id, next_choice_id, question_description, question_description_option, question_id, question_text, question_text_unsafe, question_type, selector, sub_selector, survey_id, validation_setting_force_response, validation_setting_force_response_type, validation_setting_type]
          stg_qualtrics__question_option:
            weight: 1
            compare_cols: [key, question_id, recode_value, survey_id, text]
          stg_qualtrics__question_response:
            weight: 1
            compare_cols: [loop_id, question, question_id, question_option_key, response_id, response_text, sub_question_key, sub_question_text, value]
          stg_qualtrics__sub_question:
            weight: 1
            compare_cols: [choice_data_export_tag, key, question_id, survey_id, text]
          stg_qualtrics__survey:
            weight: 1
            compare_cols: [auto_scoring_category, brand_base_url, brand_id, bundle_short_name, composition_type, creator_user_id, default_scoring_category, division_id, last_accessed_at, last_activated_at, last_modified_at, owner_user_id, project_category, project_type, registry_sha, registry_version, schema_version, scoring_summary_after_questions, scoring_summary_after_survey, scoring_summary_category, survey_id, survey_name, survey_status]
          stg_qualtrics__survey_embedded_data:
            weight: 1
            compare_cols: [import_id, key, response_id, value]
          stg_qualtrics__survey_response:
            weight: 1
            compare_cols: [distribution_channel, duration_in_seconds, ip_address, is_finished, location_latitude, location_longitude, progress, recipient_first_name, recipient_last_name, recorded_date, response_id, status, survey_id, user_language]
          stg_qualtrics__survey_version:
            weight: 1
            compare_cols: [created_at, is_published, publisher_user_id, survey_id, version_description, version_id, version_number, was_published]
          stg_qualtrics__user:
            weight: 1
            compare_cols: [account_status, division_id, email, first_name, language, last_name, organization_id, response_count_auditable, response_count_deleted, response_count_generated, time_zone, user_id, user_type, username]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_qualtrics__contacts:
            weight: 1
            compare_cols: [contact_id, count_mailing_lists_subscribed_to, count_mailing_lists_unsubscribed_from, directory_id, email, email_domain, external_data_reference, first_name, is_research_core_contact, is_unsubscribed_from_directory, is_xm_directory_contact, language, last_name]
          int_qualtrics__question:
            weight: 1
            compare_cols: [block_description, block_id, block_question_randomization, block_type, block_visibility, choice_data_export_tag, data_export_tag, is_block_locked, is_data_hidden, is_data_private, next_answer_id, next_choice_id, parent_question_id, question_description, question_description_option, question_id, question_text, question_type, selector, sub_question_key, sub_question_text, sub_selector, survey_id, validation_setting_force_response, validation_setting_force_response_type, validation_setting_type]
          int_qualtrics__response_quality:
            weight: 1
            compare_cols: [analysis_date, duration_in_seconds, include_in_analysis, is_finished, overall_quality_rating, progress, quality_score, response_id, survey_id, timing_quality]
          int_qualtrics__responses:
            weight: 1
            compare_cols: [distribution_channel, duration_in_seconds, ip_address, is_finished_with_survey, location_latitude, location_longitude, loop_id, question_id, question_option_key, question_response_id, question_text, recipient_email, recipient_first_name, recipient_last_name, response_text, sub_question_key, sub_question_text, survey_id, survey_progress, survey_response_id, survey_response_status, user_language, value]
          int_qualtrics__survey:
            weight: 1
            compare_cols: [auto_scoring_category, brand_base_url, brand_id, bundle_short_name, composition_type, count_published_versions, creator_user_id, default_scoring_category, division_id, owner_user_id, project_category, project_type, publisher_user_id, registry_sha, registry_version, schema_version, scoring_summary_after_questions, scoring_summary_after_survey, scoring_summary_category, survey_id, survey_name, survey_status, version_description, version_id, version_number]
          int_qualtrics__survey_embedded_data:
            weight: 1
            compare_cols: [response_id]
          int_qualtrics__survey_performance:
            weight: 1
            compare_cols: [avg_completion_rate, avg_completion_time_seconds, completed_responses, completion_rate, survey_id, survey_name, survey_status, total_responses]
          int_qualtrics__user_engagement:
            weight: 1
            compare_cols: [avg_completion_progress, avg_response_duration, completed_responses, completion_rate_score, engagement_level, overall_engagement_score, surveys_participated, total_responses, user_identifier]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          qualtrics__channel_performance:
            weight: 1
            compare_cols: [avg_duration, avg_progress, channel_tier, completed_responses, completion_rank, completion_rate, distribution_channel, efficiency_rank, lengthy_responses, rushed_responses, strategic_recommendation, surveys_using_channel, total_responses, unique_participants]
          qualtrics__contact:
            weight: 1
            compare_cols: [contact_id, count_mailing_lists_subscribed_to, count_mailing_lists_unsubscribed_from, directory_id, email, email_domain, external_data_reference, first_name, is_research_core_contact, is_unsubscribed_from_directory, is_xm_directory_contact, language, last_name, mailing_list_ids]
          qualtrics__daily_breakdown:
            weight: 1
            compare_cols: [count_anonymous_completed_survey_responses, count_anonymous_survey_responses, count_contacts_created, count_contacts_unsubscribed_from_directory, count_contacts_unsubscribed_from_mailing_list, count_distinct_surveys_responded_to, count_email_completed_survey_responses, count_email_survey_responses, count_personal_link_completed_survey_responses, count_personal_link_survey_responses, count_qr_code_completed_survey_responses, count_qr_code_survey_responses, count_sms_completed_survey_responses, count_sms_survey_responses, count_social_media_completed_survey_responses, count_social_media_survey_responses, count_uncategorized_completed_survey_responses, count_uncategorized_survey_responses, date_day, total_count_completed_survey_responses, total_count_survey_responses]
          qualtrics__directory:
            weight: 1
            compare_cols: [count_contacts_completed_survey_30d, count_contacts_created_30d, count_contacts_opened_survey_30d, count_contacts_sent_survey_30d, count_contacts_started_survey_30d, count_contacts_unsubscribed_30d, count_distinct_emails, count_distinct_phones, count_mailing_lists, count_surveys_sent_30d, directory_id, is_deduped_on_email, is_deduped_on_ext_ref, is_deduped_on_first_name, is_deduped_on_last_name, is_deduped_on_phone, is_default, name, total_count_contacts, total_count_unsubscribed_contacts]
          qualtrics__distribution:
            weight: 1
            compare_cols: [created_at, distribution_id, header_from_email, header_from_name, header_reply_to_email, header_subject, last_modified_at, message_id, message_library_id, message_text, organization_id, owner_user_id, parent_distribution_id, recipient_contact_id, recipient_library_id, recipient_mailing_list_id, recipient_sample_id, request_status, request_type, send_at, survey_id, survey_link_expires_at, survey_link_type]
          qualtrics__response:
            weight: 1
            compare_cols: [block_description, block_id, block_question_randomization, block_type, block_visibility, brand_base_url, contact_external_data_reference, contact_language, distribution_channel, duration_in_seconds, email_domain, embedded_data, first_name, ip_address, is_finished_with_survey, is_research_core_contact, is_xm_directory_contact, last_name, location_latitude, location_longitude, loop_id, project_category, project_type, question_description, question_id, question_option_key, question_option_text, question_response_id, question_text, question_type, recipient_email, recipient_first_name, recipient_last_name, recode_value, response_text, sub_question_key, sub_question_text, survey_id, survey_name, survey_progress, survey_response_id, survey_response_status, survey_status, user_language, validation_setting_force_response, validation_setting_force_response_type, validation_setting_type, value]
          qualtrics__survey:
            weight: 1
            compare_cols: [auto_scoring_category, avg_response_duration_in_seconds, avg_survey_progress_pct, brand_base_url, brand_id, bundle_short_name, composition_type, count_anonymous_completed_survey_responses, count_anonymous_survey_responses, count_completed_survey_responses, count_completed_survey_responses_30d, count_email_completed_survey_responses, count_email_survey_responses, count_personal_link_completed_survey_responses, count_personal_link_survey_responses, count_published_versions, count_qr_code_completed_survey_responses, count_qr_code_survey_responses, count_questions, count_sms_completed_survey_responses, count_sms_survey_responses, count_social_media_completed_survey_responses, count_social_media_survey_responses, count_survey_responses, count_survey_responses_30d, count_uncategorized_completed_survey_responses, count_uncategorized_survey_responses, creator_email, creator_user_id, default_scoring_category, division_id, median_response_duration_in_seconds, median_survey_progress_pct, owner_email, owner_user_id, project_category, project_type, publisher_email, publisher_user_id, registry_sha, registry_version, schema_version, scoring_summary_after_questions, scoring_summary_after_survey, scoring_summary_category, survey_id, survey_name, survey_status, version_description, version_id, version_number]
          qualtrics__survey_analytics:
            weight: 1
            compare_cols: [avg_completion_time_seconds, avg_quality_score, completed_responses, completion_rate, excellent_responses, high_quality_responses, performance_tier, quality_adjusted_completion_rate, roi_score, survey_id, survey_name, survey_status, total_responses]
          qualtrics__user_cohort_analysis:
            weight: 1
            compare_cols: [avg_responses_per_user, cohort_size, high_value_users, low_value_users, medium_value_users, one_time_users, power_users]
  dacomp-de-impl-015:
    database_file: quickbooks.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_quickbooks__account:
            weight: 1
            compare_cols: [account_id, account_number, account_sub_type, account_type, balance, balance_with_sub_accounts, classification, currency_id, description, fully_qualified_name, is_active, is_sub_account, name, parent_account_id, sync_token, tax_code_id]
          stg_quickbooks__bill:
            weight: 1
            compare_cols: [balance, bill_id, currency_id, department_id, doc_number, due_date, exchange_rate, global_tax_calculation, home_balance, payable_account_id, private_note, sales_term_id, sync_token, total_amount, transaction_date, vendor_id]
          stg_quickbooks__bill_line:
            weight: 1
            compare_cols: [account_expense_account_id, account_expense_billable_status, account_expense_class_id, account_expense_customer_id, account_expense_tax_amount, account_expense_tax_code_id, amount, bill_id, description, index, item_expense_billable_status, item_expense_class_id, item_expense_customer_id, item_expense_item_id, item_expense_quantity, item_expense_tax_code_id, item_expense_unit_price]
          stg_quickbooks__customer:
            weight: 1
            compare_cols: [balance, balance_with_jobs, bill_with_parent, company_name, currency_id, customer_id, display_name, fully_qualified_name, is_active, is_job, is_taxable, notes, parent_customer_id, payment_method_id, print_on_check_name, sales_term_id, sync_token, tax_code_id]
          stg_quickbooks__department:
            weight: 1
            compare_cols: [department_id, fully_qualified_name, is_active, is_sub_department, name, parent_department_id, sync_token]
          stg_quickbooks__invoice:
            weight: 1
            compare_cols: [allow_ipnpayment, allow_online_achpayment, allow_online_credit_card_payment, allow_online_payment, apply_tax_after_discount, balance, billing_address_id, billing_bcc_email, billing_cc_email, billing_email, class_id, currency_id, custom_p_o_number, custom_sales_rep, customer_id, customer_memo, delivery_time, delivery_type, department_id, deposit, deposit_to_account_id, doc_number, due_date, email_status, exchange_rate, global_tax_calculation, home_balance, home_total_amount, invoice_id, print_status, private_note, sales_term_id, ship_date, shipping_address_id, sync_token, tax_code_id, total_amount, total_tax, tracking_number, transaction_date, transaction_source]
          stg_quickbooks__invoice_line:
            weight: 1
            compare_cols: [account_id, amount, bundle_id, description, detail_type, discount_account_id, discount_class_id, discount_tax_code_id, index, invoice_id, sales_item_account_id, sales_item_class_id, sales_item_discount_amount, sales_item_discount_rate, sales_item_item_id, sales_item_quantity, sales_item_tax_code_id, sales_item_unit_price]
          stg_quickbooks__item:
            weight: 1
            compare_cols: [asset_account_id, description, expense_account_id, fully_qualified_name, income_account_id, is_active, is_taxable, item_id, name, parent_item_id, purchase_cost, purchase_tax_code_id, quantity_on_hand, sales_tax_code_id, sku, sync_token, tax_code_id, track_quantity_on_hand, type, unit_price]
          stg_quickbooks__journal_entry:
            weight: 1
            compare_cols: [currency_id, doc_number, journal_entry_id, private_note, sync_token, transaction_date]
          stg_quickbooks__journal_entry_line:
            weight: 1
            compare_cols: [account_id, amount, billable_status, class_id, customer_id, department_id, description, index, journal_entry_id, posting_type, tax_amount, tax_applicable_on, tax_code_id, vendor_id]
          stg_quickbooks__payment:
            weight: 1
            compare_cols: [created_at, currency_id, customer_id, deposit_to_account_id, exchange_rate, payment_id, payment_method_id, payment_ref_number, private_note, receivable_account_id, sync_token, total_amount, transaction_date, unapplied_amount]
          stg_quickbooks__payment_line:
            weight: 1
            compare_cols: [amount, index, linked_txn_payment_id, payment_id]
          stg_quickbooks__vendor:
            weight: 1
            compare_cols: [acct_num, balance, company_name, currency_id, display_name, is_active, name, print_on_check_name, sales_term_id, sync_token, tax_code_id, vendor_1099, vendor_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_quickbooks__account_classifications:
            weight: 1
            compare_cols: [account_id, account_number, account_sub_type, account_type, adjusted_balance, balance, balance_with_sub_accounts, classification, currency_id, description, financial_statement_helper, fully_qualified_name, is_active, is_sub_account, multiplier, name, parent_account_id, parent_account_name, parent_account_number]
          int_quickbooks__bill_double_entry:
            weight: 1
            compare_cols: [account_id, amount, class_id, converted_amount, customer_id, department_id, transaction_date, transaction_id, transaction_source, transaction_type, vendor_id]
          int_quickbooks__cashflow_analysis:
            weight: 1
            compare_cols: [cash_flow_direction, counterparty_id, outstanding_amount, realized_amount, total_amount, transaction_date, transaction_id, transaction_type]
          int_quickbooks__customer_lifecycle:
            weight: 1
            compare_cols: [company_name, customer_id, customer_name, display_name, total_invoice_amount, total_invoices, total_payment_amount, total_payments]
          int_quickbooks__invoice_double_entry:
            weight: 1
            compare_cols: [account_id, amount, class_id, converted_amount, customer_id, department_id, index, transaction_id, transaction_source, transaction_type, vendor_id]
          int_quickbooks__journal_entry_double_entry:
            weight: 1
            compare_cols: [account_id, amount, class_id, converted_amount, customer_id, department_id, index, transaction_date, transaction_id, transaction_type, vendor_id]
          int_quickbooks__payment_double_entry:
            weight: 1
            compare_cols: [account_id, amount, class_id, converted_amount, customer_id, department_id, index, transaction_id, transaction_source, transaction_type, vendor_id]
          int_quickbooks__revenue_analysis:
            weight: 1
            compare_cols: [company_name, customer_id, customer_name, due_date, invoice_id, outstanding_balance, total_amount, transaction_date]
          int_quickbooks__vendor_spend_analysis:
            weight: 1
            compare_cols: [bill_date, bill_id, due_date, vendor_company_name, vendor_display_name, vendor_id, vendor_name]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          quickbooks__balance_sheet:
            weight: 1
            compare_cols: [account_class, account_id, account_name, account_number, account_sub_type, account_type, amount, class_id, converted_amount, parent_account_name, parent_account_number]
          quickbooks__cashflow_forecast:
            weight: 1
            compare_cols: [forecast_counterparties, forecast_month, forecast_month_num, forecast_quarter, forecast_year, forecasted_inflows, forecasted_net_cash_flow, forecasted_outflows]
          quickbooks__customer_analytics:
            weight: 1
            compare_cols: [company_name, customer_id, customer_name, display_name, outstanding_balance, total_invoice_amount, total_invoices]
          quickbooks__financial_dashboard:
            weight: 1
            compare_cols: [active_vendors_count, bill_count, cash_inflow, cash_outflow, dashboard_month, dashboard_month_num, dashboard_quarter, dashboard_year, invoice_count, net_cash_flow, outstanding_payables, outstanding_receivables, total_revenue, total_spend]
          quickbooks__general_ledger:
            weight: 1
            compare_cols: [account_class, account_id, account_name, account_number, account_sub_type, account_type, adjusted_amount, adjusted_converted_amount, amount, class_id, customer_id, department_id, financial_statement_helper, parent_account_name, parent_account_number, running_balance, running_converted_balance, transaction_id, transaction_index, transaction_source, transaction_type, unique_id, vendor_id]
          quickbooks__profitability_analysis:
            weight: 1
            compare_cols: [customer_id, invoice_id, invoice_total, outstanding_balance, revenue_month_start, revenue_quarter, revenue_year, transaction_date]
          quickbooks__vendor_performance:
            weight: 1
            compare_cols: [active_months, avg_bill_amount, days_since_last_transaction, first_transaction_date, last_transaction_date, total_lifetime_spend, total_transactions, vendor_company_name, vendor_display_name, vendor_id, vendor_name]
  dacomp-de-impl-016:
    database_file: workday.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_workday__job_family:
            weight: 1
            compare_cols: [effective_start, is_inactive, job_family_code, job_family_id, job_family_name, source_relation]
          stg_workday__job_family_group:
            weight: 1
            compare_cols: [effective_start, is_inactive, job_family_group_code, job_family_group_id, job_family_group_name, source_relation]
          stg_workday__job_family_job_family_group:
            weight: 1
            compare_cols: [job_family_group_id, job_family_id, source_relation]
          stg_workday__job_family_job_profile:
            weight: 1
            compare_cols: [job_family_id, job_profile_id, source_relation]
          stg_workday__job_profile:
            weight: 1
            compare_cols: [compensation_grade_id, is_union_eligible, is_work_shift_required, job_profile_code, job_profile_id, job_profile_summary, job_profile_title, management_level, source_relation]
          stg_workday__military_service:
            weight: 1
            compare_cols: [military_status, rank, service, source_relation]
          stg_workday__organization:
            weight: 1
            compare_cols: [effective_start, is_inactive, organization_code, organization_id, organization_name, organization_sub_type, organization_type, staffing_model, visibility]
          stg_workday__organization_job_family:
            weight: 1
            compare_cols: [job_family_group_id, job_family_id, organization_id, source_relation]
          stg_workday__organization_role:
            weight: 1
            compare_cols: [organization_id, organization_role_code, organization_role_id, source_relation]
          stg_workday__organization_role_worker:
            weight: 1
            compare_cols: [organization_id, organization_worker_code, role_id, source_relation]
          stg_workday__person_contact_email_address:
            weight: 1
            compare_cols: [email_address, email_code, email_comment, email_id, source_relation]
          stg_workday__person_name:
            weight: 1
            compare_cols: [country, first_name, full_name, last_name, name_id, person_name_type, source_relation]
          stg_workday__personal_information:
            weight: 1
            compare_cols: [city_of_birth, country_of_birth, date_of_birth, last_medical_exam_date, marital_status, personal_info_history_id, political_affiliation, source_relation]
          stg_workday__personal_information_ethnicity:
            weight: 1
            compare_cols: [ethnicity, ethnicity_group, is_hispanic_or_latino, record_type, verification_source]
          stg_workday__position:
            weight: 1
            compare_cols: [business_title, default_weekly_hours, effective_start, employee_type, position_id, source_relation]
          stg_workday__position_job_profile:
            weight: 1
            compare_cols: [job_profile_id, position_id, source_relation]
          stg_workday__position_organization:
            weight: 1
            compare_cols: [effective_end, effective_start, organization_id, position_id, source_relation]
          stg_workday__worker:
            weight: 1
            compare_cols: [effective_end, effective_start, event_type, worker_history_id, worker_id]
          stg_workday__worker_leave_status:
            weight: 1
            compare_cols: [end_date, leave_status, leave_type, start_date, worker_id]
          stg_workday__worker_position:
            weight: 1
            compare_cols: [effective_end, effective_start, position_id, worker_id]
          stg_workday__worker_position_organization:
            weight: 1
            compare_cols: [effective_end, effective_start, organization_id, position_id, worker_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_workday__career_progression:
            weight: 1
            compare_cols: [avg_position_tenure_days, business_title, career_development_score, career_growth_pace, career_move_type, career_phase, career_stability_category, career_stage, career_start_date, compensation_grade_id, data_quality_flag, days_in_position, default_weekly_hours, effective_end, effective_start, employee_type, fast_promotions, highest_management_level_reached, is_fast_promotion, is_union_eligible, is_work_shift_required, job_profile_title, lateral_moves, latest_position_date, management_level, management_positions_held, position_id, position_sequence, position_tenure_category, shift_work_positions, total_career_days, total_demotions, total_positions_held, total_promotions, union_eligible_positions, unique_compensation_grades, worker_id, workload_change]
          int_workday__employee_lifecycle:
            weight: 1
            compare_cols: [calendar_years_worked, churn_risk_category, data_quality_flag, days_as_worker, departure_category, departure_date, employee_maturity_segment, hire_date, hire_day_of_week, hire_month, hire_season, hire_year_cohort, is_employed, retained_1_year, retained_30_days, retained_3_years, retained_90_days, retention_stability_score, tenure_years, worker_id]
          int_workday__organization_metrics:
            weight: 1
            compare_cols: [annual_turnover_rate, avg_tenure_days, contingent_employees, current_employee_count, data_quality_flag, departures_last_year, directors_count, individual_contributors, intern_employees, internal_transfers_in, internal_transfers_out, management_ratio, managers_count, most_common_grade, new_hires_last_year, organization_code, organization_health_score, organization_id, organization_name, organization_size_category, organization_sub_type, organization_type, performance_category, position_fill_rate, regular_employees, senior_managers_count, shift_required_positions, staffing_model, total_positions, union_eligible_positions, unique_compensation_grades, unique_job_families, unique_job_family_groups]
          int_workday__personal_details:
            weight: 1
            compare_cols: [city_of_birth, country_of_birth, date_of_birth, email_address, ethnicity_codes, last_medical_exam_date, marital_status, military_status, personal_info_history_id, political_affiliation, source_relation]
          int_workday__worker_details:
            weight: 1
            compare_cols: [days_as_worker, departure_date, event_type, hire_date, is_employed, worker_history_id, worker_id]
          int_workday__worker_employee_enhanced:
            weight: 1
            compare_cols: [business_title, city_of_birth, country_of_birth, date_of_birth, days_as_worker, days_in_position, default_weekly_hours, departure_date, email_address, employee_type, ethnicity_codes, event_type, first_name, full_name, hire_date, is_current_employee_five_years, is_current_employee_one_year, is_current_employee_ten_years, is_employed, is_employed_five_years, is_employed_one_year, is_employed_ten_years, is_military_service, last_name, marital_status, military_status, position_end_date, position_id, position_start_date, worker_history_id, worker_id]
          int_workday__worker_position_enriched:
            weight: 1
            compare_cols: [business_title, days_in_position, default_weekly_hours, employee_type, position_end_date, position_id, position_start_date, worker_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          workday__employee_overview:
            weight: 1
            compare_cols: [business_title, career_development_score, career_growth_pace, career_phase, career_stability_category, churn_risk_category, city_of_birth, compensation_grade_id, compensation_tier, comprehensive_data_quality_flag, country_of_birth, date_of_birth, days_as_worker, days_in_position, default_weekly_hours, departure_category, departure_date, dept_health_score, dept_management_ratio, dept_performance_category, dept_size, dept_size_category, dept_turnover_rate, email_address, employee_id, employee_maturity_segment, employee_risk_level, employee_type, employee_value_segment, ethnicity_codes, event_type, fast_promotions, first_name, full_name, highest_management_level_reached, hire_date, hire_month, hire_quarter_cohort, hire_season, hire_year_cohort, is_current_employee_five_years, is_current_employee_one_year, is_current_employee_ten_years, is_employed, is_employed_five_years, is_employed_one_year, is_employed_ten_years, is_military_service, is_union_eligible, is_work_shift_required, last_name, lateral_moves, management_positions_held, marital_status, military_status, organization_id, organization_name, organization_sub_type, organization_type, overall_employee_score, position_end_date, position_id, position_start_date, retained_1_year, retained_30_days, retained_3_years, retained_90_days, retention_stability_score, tenure_years, total_demotions, total_positions_held, total_promotions, work_conditions_score, worker_history_id, worker_id]
          workday__job_overview:
            weight: 1
            compare_cols: [active_positions_count, analysis_timestamp, associated_job_families_count, associated_job_family_groups_count, avg_weekly_hours, compensation_grade_id, contingent_employees_count, current_employees_count, inactive_positions_count, is_union_eligible, is_work_shift_required, job_family_codes, job_family_group_codes, job_family_group_names, job_family_names, job_profile_code, job_profile_id, job_summary, job_title, job_value_tier, management_level, max_weekly_hours, min_weekly_hours, senior_employees_count, total_positions_count, veteran_employees_count]
          workday__organization_overview:
            weight: 1
            compare_cols: [access_level, active_positions_count, analysis_timestamp, annual_turnover_rate, avg_career_development_score, avg_employee_age, avg_employee_performance_score, avg_former_tenure_years, avg_retention_stability_score, current_active_employees, data_quality_flag, departures_last_year, development_required_employees, director_role_employees, entry_level_employees, ethnic_diversity_count, executive_level_employees, experienced_employees, fast_track_employees_count, former_employees, high_achievers_count, high_risk_employees, high_value_flight_risk_employees, high_value_stable_employees, junior_employees, last_activity_date, last_departure_date, lead_role_employees, low_risk_employees, management_ratio, management_recommendation, management_role_employees, medium_risk_employees, mid_level_employees, military_veterans_count, new_assignments_last_year, new_hire_employees, organization_age_days, organization_age_years, organization_code, organization_created_date, organization_health_score, organization_id, organization_maturity_level, organization_name, organization_size_category, organization_sub_type, organization_type, organizational_level, performance_category, position_fill_rate, senior_employees, senior_level_employees, stable_development_employees, staffing_model, total_employees_ever, total_positions, total_promotions_in_organization, unique_organization_roles, veteran_employees, visibility]
          workday__organization_performance:
            weight: 1
            compare_cols: [analysis_timestamp, annual_turnover_rate, avg_career_development_score, avg_employee_age, avg_employee_satisfaction_proxy, avg_tenure_days, avg_tenure_years, avg_weekly_hours, avg_weekly_hours_per_employee, contingent_employees, current_employee_count, data_quality_flag, departures_last_year, development_required_count, directors_count, enhanced_organization_effectiveness_score, ethnic_diversity_count, fast_track_count, high_achiever_percentage, high_achievers_count, high_risk_employees, high_risk_percentage, high_value_flight_risk_count, high_value_retained_count, high_value_retention_rate, individual_contributors, intern_employees, internal_transfers_in, internal_transfers_out, low_risk_employees, management_ratio, managers_count, medium_risk_employees, mid_career_professionals_count, military_veterans_count, most_common_grade, new_hires_last_year, organization_code, organization_health_score, organization_id, organization_maturity, organization_name, organization_risk_level, organization_size_category, organization_sub_type, organization_type, performance_category, position_fill_rate, recommended_action, regular_employee_percentage, regular_employees, senior_managers_count, senior_professionals_count, span_of_control, stable_development_count, staffing_model, talent_density_ratio, talent_flight_risk_rate, total_positions, total_weekly_hours, unique_compensation_grades, unique_job_families, unique_job_family_groups, young_professionals_count]
          workday__position_overview:
            weight: 1
            compare_cols: [avg_career_development_score, avg_employee_age, avg_employee_performance_score, avg_retention_score, avg_tenure_years_in_position, business_title, challenging_work_conditions_score, compensation_grade_id, compensation_tier, cost_performance_analysis, current_workers_assigned, data_quality_flag, default_weekly_hours, department_health_score, department_performance_level, department_size_category, department_total_employees, department_turnover_rate, departures_last_year, employee_type, ethnic_diversity_count, flight_risk_employees_count, former_workers_assigned, high_risk_employees_count, high_value_employees_count, is_union_eligible, is_work_shift_required, job_profile_id, job_profile_title, last_assignment_date, last_departure_date, low_risk_employees_count, management_level, management_level_numeric, management_priority, medium_risk_employees_count, military_veterans_count, new_assignments_last_year, new_employees_count, organization_id, organization_name, organization_sub_type, organization_type, position_age_category, position_age_days, position_created_date, position_efficiency_score, position_id, position_occupancy_status, position_performance_category, position_turnover_rate, similar_positions_in_department, staffing_model, strategic_recommendation, total_workers_ever_assigned, veteran_employees_count]
          workday__workforce_analytics:
            weight: 1
            compare_cols: [active_employees, avg_career_development_score, avg_tenure_departed_years, avg_tenure_years, avg_weekly_hours, contingent_employees, directors_and_above, early_terminations, fast_track_employees, former_employees, full_time_employees, full_time_percentage, high_achiever_percentage, high_achievers, high_risk_employees, high_risk_percentage, individual_contributors, intern_employees, long_term_departures, low_risk_employees, management_percentage, managers, medium_risk_employees, mid_term_departures, part_time_employees, regular_employee_percentage, regular_employees, retention_rate_1_year, retention_rate_30_days, retention_rate_3_years, retention_rate_90_days, senior_managers, short_term_departures, total_employees_all_time, total_positions, total_weekly_hours]
  dacomp-de-impl-017:
    database_file: greenhouse.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_greenhouse__activity:
            weight: 1
            compare_cols: [activity_id, body, candidate_id, subject, user_id]
          stg_greenhouse__application:
            weight: 1
            compare_cols: [application_id, applied_at, candidate_id, current_stage_id, last_activity_at, prospect, source_id, status]
          stg_greenhouse__application_history:
            weight: 1
            compare_cols: [application_id, new_stage_id, new_status, updated_at]
          stg_greenhouse__attachment:
            weight: 1
            compare_cols: [attachment_id, candidate_id, filename, id, index, type, url]
          stg_greenhouse__candidate:
            weight: 1
            compare_cols: [candidate_id, coordinator_user_id, current_company, current_title, first_name, full_name, is_private, last_activity_at, last_name, last_updated_at, new_candidate_id, recruiter_user_id]
          stg_greenhouse__candidate_tag:
            weight: 1
            compare_cols: [candidate_id, tag_id]
          stg_greenhouse__department:
            weight: 1
            compare_cols: [department_id, id]
          stg_greenhouse__eeoc:
            weight: 1
            compare_cols: [application_id, disability_status_description, disability_status_id, gender_description, gender_id, race_description, race_id, veteran_status_description, veteran_status_id]
          stg_greenhouse__email_address:
            weight: 1
            compare_cols: [candidate_id]
          stg_greenhouse__hiring_team:
            weight: 1
            compare_cols: [job_id, user_id]
          stg_greenhouse__interview:
            weight: 1
            compare_cols: [id, interview_id, interview_kit_content, job_stage_id, name]
          stg_greenhouse__job:
            weight: 1
            compare_cols: [created_at, job_id, last_updated_at, name, notes, requisition_id, status]
          stg_greenhouse__job_application:
            weight: 1
            compare_cols: [application_id, job_id]
          stg_greenhouse__job_department:
            weight: 1
            compare_cols: [department_id, job_id]
          stg_greenhouse__job_office:
            weight: 1
            compare_cols: [job_id, office_id]
          stg_greenhouse__job_opening:
            weight: 1
            compare_cols: [application_id, close_reason_id, closed_at, id, job_id, job_opening_id, opened_at, opening_id]
          stg_greenhouse__job_post:
            weight: 1
            compare_cols: [created_at, id, job_id, job_post_id]
          stg_greenhouse__job_stage:
            weight: 1
            compare_cols: [created_at, id, job_id, job_stage_id, name]
          stg_greenhouse__office:
            weight: 1
            compare_cols: [external_office_id, location_name, office_id, office_name, parent_office_id, primary_contact_user_id]
          stg_greenhouse__phone_number:
            weight: 1
            compare_cols: [candidate_id, phone_number]
          stg_greenhouse__prospect_pool:
            weight: 1
            compare_cols: [id, prospect_pool_id]
          stg_greenhouse__prospect_stage:
            weight: 1
            compare_cols: [id, prospect_pool_id, prospect_stage_id]
          stg_greenhouse__scheduled_interview:
            weight: 1
            compare_cols: [application_id, end_at, interview_id, last_updated_at, location, organizer_user_id, scheduled_interview_id, start_at, status]
          stg_greenhouse__scheduled_interviewer:
            weight: 1
            compare_cols: [interviewer_user_id, scheduled_interview_id, scorecard_id]
          stg_greenhouse__scorecard:
            weight: 1
            compare_cols: [application_id, candidate_id, interview_name, interviewed_at, last_updated_at, overall_recommendation, scorecard_id, submitted_at, submitted_by_user_id]
          stg_greenhouse__scorecard_attribute:
            weight: 1
            compare_cols: [id, name, note, rating, scorecard_attribute_id, scorecard_id, type]
          stg_greenhouse__social_media_address:
            weight: 1
            compare_cols: [candidate_id]
          stg_greenhouse__source:
            weight: 1
            compare_cols: [id, name, source_id, source_type_id]
          stg_greenhouse__tag:
            weight: 1
            compare_cols: [id, tag_id]
          stg_greenhouse__user:
            weight: 1
            compare_cols: [created_at, disabled, employee_id, first_name, full_name, last_name, last_updated_at, site_admin, user_id]
          stg_greenhouse__user_email:
            weight: 1
            compare_cols: [user_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_greenhouse__application_info:
            weight: 1
            compare_cols: [application_id, application_job_key, candidate_company, candidate_disability_status, candidate_full_name, candidate_gender, candidate_id, candidate_race, candidate_tags, candidate_veteran_status, count_activities, current_company, current_job_stage, current_stage_id, current_title, first_contact_date, hiring_managers, job_departments, job_id, job_offices, job_parent_departments, job_requisition_id, job_sourcers, job_status, job_title, last_contact_date, linkedin_url, primary_email, prospect, prospect_owner_name, prospect_pool, prospect_stage, recruiter_name, referrer_name, source_id, sourced_from, sourced_from_type, status, website]
          int_greenhouse__application_users:
            weight: 1
            compare_cols: [application_id, candidate_company, candidate_full_name, candidate_id, current_stage_id, prospect, prospect_owner_name, referrer_name, source_id, status]
          int_greenhouse__candidate_contacts:
            weight: 1
            compare_cols: [candidate_id, coordinator_user_id, current_company, current_title, email, first_name, full_name, github_url, is_private, last_activity_at, last_name, last_updated_at, linkedin_url, new_candidate_id, phone, recruiter_user_id, resume_url]
          int_greenhouse__candidate_tags:
            weight: 1
            compare_cols: [candidate_id, full_name]
          int_greenhouse__candidate_users:
            weight: 1
            compare_cols: [candidate_id, current_company, current_title, full_name]
          int_greenhouse__hiring_team:
            weight: 1
            compare_cols: [coordinators, hiring_managers, job_id, recruiters, sourcers]
          int_greenhouse__interview_scorecard:
            weight: 1
            compare_cols: [application_id, candidate_id, interview_id, interview_name, interviewer_user_id, job_stage_id, location, organizer_user_id, overall_recommendation, scheduled_interview_id, scorecard_id, scorecard_submitted_by_user_id, status]
          int_greenhouse__interview_users:
            weight: 1
            compare_cols: [application_id, candidate_id, interview_id, interview_name, interview_scorecard_key, interviewer_email, interviewer_name, interviewer_user_id, job_stage_id, location, organizer_name, organizer_user_id, overall_recommendation, scheduled_interview_id, scorecard_id, scorecard_submitted_by_user_id, scorecard_submitter_name, status]
          int_greenhouse__job_departments:
            weight: 1
            compare_cols: [departments, job_id, parent_departments]
          int_greenhouse__job_info:
            weight: 1
            compare_cols: [coordinators, departments, hiring_managers, job_id, name, notes, office_locations, offices, parent_departments, recruiters, requisition_id, sourcers, status]
          int_greenhouse__job_offices:
            weight: 1
            compare_cols: [job_id, locations, offices]
          int_greenhouse__user_emails:
            weight: 1
            compare_cols: [disabled, email_count, employee_id, full_name, user_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          greenhouse__application_enhanced:
            weight: 1
            compare_cols: [application_id, application_job_key, candidate_company, candidate_disability_status, candidate_full_name, candidate_gender, candidate_id, candidate_race, candidate_tags, candidate_veteran_status, count_activities, current_company, current_job_stage, current_stage_id, current_title, first_contact_date, hiring_managers, job_departments, job_id, job_offices, job_parent_departments, job_requisition_id, job_sourcers, job_status, job_title, last_contact_date, linkedin_url, primary_email, prospect, prospect_owner_name, prospect_pool, prospect_stage, recruiter_name, referrer_name, source_id, sourced_from, sourced_from_type, status, website]
          greenhouse__application_history:
            weight: 1
            compare_cols: [application_id, candidate_disability_status, candidate_gender, candidate_id, candidate_race, candidate_veteran_status, count_activities_in_stage, current_status, days_in_stage, full_name, hiring_managers, job_departments, job_id, job_offices, job_parent_departments, job_title, new_stage, new_stage_id, new_status, recruiter_name, sourced_from, sourced_from_type, valid_from, valid_until]
          greenhouse__candidate_summary:
            weight: 1
            compare_cols: [active_count, avg_interview_score, candidate_id, candidate_quality_score, candidate_status, current_company, current_title, first_name, full_name, hired_count, interview_success_rate, last_name, personal_hire_rate, positive_interviews, rejected_count, total_applications, total_interviews]
          greenhouse__diversity_metrics:
            weight: 1
            compare_cols: [application_quarter, application_year, disability_applications, disability_hire_rate, disability_hire_representation, disability_hires, female_applications, female_hires, male_applications, male_hires, non_white_applications, non_white_hires, total_applications, total_hires, veteran_applications, veteran_hire_rate, veteran_hire_representation, veteran_hires, white_applications, white_hires]
          greenhouse__interview_enhanced:
            weight: 1
            compare_cols: [application_current_job_stage, application_id, candidate_disability_status, candidate_gender, candidate_id, candidate_name, candidate_race, candidate_veteran_status, current_application_status, duration_interview_minutes, hiring_managers, interview_id, interview_name, interview_scorecard_key, interviewer_email, interviewer_is_hiring_manager, interviewer_name, interviewer_user_id, job_departments, job_id, job_offices, job_parent_departments, job_stage, job_stage_id, job_title, location, organizer_name, organizer_user_id, overall_recommendation, recruiter_name, scheduled_interview_id, scorecard_id, scorecard_submitted_by_user_id, scorecard_submitter_name, status]
          greenhouse__interview_scorecard_detail:
            weight: 1
            compare_cols: [application_id, attribute_category, attribute_name, index, interview_name, interview_scorecard_key, interviewer_name, note, overall_recommendation, rating, scorecard_attribute_key, scorecard_id]
          greenhouse__job_enhanced:
            weight: 1
            compare_cols: [application_to_interview_rate, count_active_applications, count_completed_interviews, count_hired_applications, count_prospect_applications, count_rated_applications, count_rejected_applications, count_total_applications, count_total_interviews, created_month, created_year, days_since_created, departments, hiring_managers, interview_to_hire_rate, job_id, name, offices, overall_conversion_rate, recruiters, requisition_id, sourcers, status]
          greenhouse__recruitment_performance:
            weight: 1
            compare_cols: [active_count, application_quarter, application_year, avg_interview_score, avg_process_days, completed_interviews, has_good_interview_quality, hire_rate, hired_count, interview_completion_rate, interview_rate, interview_to_hire_rate, is_fast_process, job_id, job_status, job_title, performance_tier, rejected_count, total_applications, total_interviews, total_scorecards, unique_candidates]
          greenhouse__talent_pipeline_simplified:
            weight: 1
            compare_cols: [active_applications, application_quarter, application_year, applications_with_interviews, avg_process_days, efficiency_score, hire_rate, hire_rate_rank, interview_rate, interview_to_hire_rate, performance_tier, rejected_applications, rejection_rate, source_id, source_name, source_type, total_applications, total_hires, unique_candidates, volume_rank]
  dacomp-de-impl-018:
    database_file: salesforce.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_salesforce__account:
            weight: 1
            compare_cols: [account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_state_code, billing_street, industry, is_deleted, last_activity_date, last_referenced_date, last_viewed_date, master_record_id, number_of_employees, owner_id, ownership, parent_id, rating, record_type_id, shipping_city, shipping_country, shipping_country_code, shipping_postal_code, shipping_state, shipping_state_code, shipping_street, type, website]
          stg_salesforce__account_history:
            weight: 1
            compare_cols: [account_number, account_source, billing_city, billing_country, billing_postal_code, billing_state, billing_street, industry, is_deleted, number_of_employees, owner_id, ownership, parent_id, rating, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, type, website]
          stg_salesforce__contact:
            weight: 1
            compare_cols: [account_id, assistant_name, assistant_phone, birthdate, department, email, email_bounced_date, email_bounced_reason, fax, first_name, home_phone, is_deleted, is_email_bounced, last_activity_date, last_curequest_date, last_cuupdate_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, lead_source, mailing_city, mailing_country, mailing_country_code, mailing_postal_code, mailing_state, mailing_state_code, mailing_street, master_record_id, mobile_phone, other_city, other_country, other_phone, other_postal_code, other_state, other_street, owner_id, phone, photo_url, reports_to_id, salutation, title]
          stg_salesforce__contact_history:
            weight: 1
            compare_cols: [account_id, email, first_name, is_deleted, last_modified_date, last_name, lead_source, mailing_city, mailing_country, mailing_postal_code, mailing_state, mailing_street, mobile_phone, owner_id, phone, title]
          stg_salesforce__event:
            weight: 1
            compare_cols: [activity_date, activity_date_time, duration_in_minutes, end_date_time, is_deleted, location, owner_id, start_date_time, subject, type, what_id, who_id]
          stg_salesforce__lead:
            weight: 1
            compare_cols: [annual_revenue, city, company, converted_account_id, converted_contact_id, converted_date, converted_opportunity_id, country, country_code, created_by_id, email, email_bounced_date, email_bounced_reason, fax, first_name, geocode_accuracy, has_opted_out_of_email, industry, is_converted, is_deleted, is_unread_by_owner, last_activity_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, lead_source, master_record_id, mobile_phone, number_of_employees, owner_id, phone, photo_url, postal_code, salutation, state, state_code, status, street, system_modstamp, title, website]
          stg_salesforce__opportunity:
            weight: 1
            compare_cols: [account_id, amount, campaign_id, expected_revenue, fiscal, fiscal_quarter, fiscal_year, forecast_category, forecast_category_name, has_open_activity, has_opportunity_line_item, has_overdue_task, is_closed, is_deleted, is_won, last_activity_date, last_referenced_date, last_viewed_date, lead_source, owner_id, probability, record_type_id, stage_name, synced_quote_id, type]
          stg_salesforce__opportunity_history:
            weight: 1
            compare_cols: [account_id, amount, expected_revenue, forecast_category, is_closed, is_deleted, is_won, lead_source, next_step, owner_id, probability, stage_name, type]
          stg_salesforce__opportunity_line_item:
            weight: 1
            compare_cols: [created_date, has_quantity_schedule, has_revenue_schedule, is_deleted, last_modified_date, list_price, opportunity_id, pricebook_entry_id, product_2_id, quantity, service_date, sort_order, total_price, unit_price]
          stg_salesforce__order:
            weight: 1
            compare_cols: [account_id, activated_by_id, activated_date, billing_city, billing_country, billing_postal_code, billing_state, billing_street, company_authorized_by_id, contract_id, customer_authorized_by_id, is_deleted, last_modified_date, order_number, original_order_id, owner_id, pricebook_2_id, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, status, total_amount, type]
          stg_salesforce__product_2:
            weight: 1
            compare_cols: [created_date, external_data_source_id, external_id, family, is_active, is_archived, is_deleted, last_modified_date, product_code, quantity_unit_of_measure]
          stg_salesforce__task:
            weight: 1
            compare_cols: [activity_date, call_disposition, call_duration_in_seconds, call_object, call_type, is_closed, is_deleted, is_high_priority, owner_id, priority, status, subject, type, what_id, who_id]
          stg_salesforce__user:
            weight: 1
            compare_cols: [account_id, alias, city, company_name, contact_id, country, country_code, department, email, first_name, individual_id, is_active, last_login_date, last_name, last_referenced_date, last_viewed_date, manager_id, postal_code, profile_id, state, state_code, street, title, user_role_id, user_type, username]
          stg_salesforce__user_role:
            weight: 1
            compare_cols: [developer_name, parent_role_id, rollup_description]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_salesforce__account_enhanced:
            weight: 1
            compare_cols: [account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_street, is_deleted, last_activity_date, last_referenced_date, last_viewed_date, number_of_employees, owner_id, website]
          int_salesforce__activity_summary:
            weight: 1
            compare_cols: [account_id]
          int_salesforce__date_spine:
            weight: 1
            compare_cols: [day_of_week, day_of_year, month, quarter, week, year]
          int_salesforce__lead_conversion_funnel:
            weight: 1
            compare_cols: [annual_revenue, company, converted_account_id, converted_contact_id, converted_opportunity_id, email, first_name, industry, is_converted, is_deleted, last_modified_date, last_name, lead_source, mobile_phone, number_of_employees, owner_id, phone, status, title]
          int_salesforce__opportunity_aggregation_by_owner:
            weight: 1
            compare_cols: [owner_id]
          int_salesforce__opportunity_pipeline:
            weight: 1
            compare_cols: [account_id, amount, campaign_id, expected_revenue, fiscal_quarter, fiscal_year, forecast_category, is_closed, is_deleted, is_won, lead_source, owner_id, probability, stage_name]
          int_salesforce__user_performance:
            weight: 1
            compare_cols: [email, first_name, is_active, last_name]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          dim_salesforce__user:
            weight: 1
            compare_cols: [email, first_name, is_active, last_name, manager_id, profile_id, user_role_id, user_type, username]
          fct_salesforce__account_engagement:
            weight: 1
            compare_cols: [annual_revenue, billing_city, billing_country, billing_state, owner_id, website]
          fct_salesforce__lead_performance:
            weight: 1
            compare_cols: [annual_revenue, company, converted_account_id, converted_contact_id, converted_opportunity_id, email, first_name, industry, is_converted, last_name, lead_source, number_of_employees, owner_id, status]
          fct_salesforce__sales_pipeline:
            weight: 1
            compare_cols: [account_id, amount, campaign_id, expected_revenue, fiscal_quarter, fiscal_year, forecast_category, is_closed, is_won, lead_source, owner_id, probability, stage_name]
          salesforce__account_daily_history:
            weight: 1
            compare_cols: [account_source, annual_revenue, billing_city, billing_country, billing_state, industry, number_of_employees, owner_id, ownership, parent_id, rating, type, website]
          salesforce__contact_daily_history:
            weight: 1
            compare_cols: [account_id, email, first_name, last_activity_date, last_name, lead_source, mailing_city, mailing_country, mailing_postal_code, mailing_state, mobile_phone, owner_id, phone, title]
          salesforce__contact_enhanced:
            weight: 1
            compare_cols: [account_id, assistant_name, assistant_phone, birthdate, department, email, email_bounced_date, email_bounced_reason, fax, first_name, home_phone, is_deleted, is_email_bounced, last_activity_date, last_curequest_date, last_cuupdate_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, lead_source, mailing_city, mailing_country, mailing_country_code, mailing_postal_code, mailing_state, mailing_state_code, mailing_street, master_record_id, mobile_phone, other_city, other_country, other_phone, other_postal_code, other_state, other_street, owner_id, phone, photo_url, reports_to_id, salutation, title]
          salesforce__daily_activity:
            weight: 1
            compare_cols: [leads_created, leads_converted, tasks_completed, events_completed, opportunities_created, opportunities_created_amount, opportunities_won, opportunities_won_amount, opportunities_lost, opportunities_lost_amount, pipeline_amount]
          salesforce__manager_performance:
            weight: 1
            compare_cols: [manager_id, total_team_members, team_bookings_amount_this_quarter, team_total_bookings, team_total_bookings_amount, team_lost_amount_this_quarter, team_total_lost, team_total_lost_amount, team_pipeline_created_this_quarter, team_total_pipeline, team_total_pipeline_amount, team_avg_days_to_close, team_largest_booking, team_largest_pipeline_deal, manager_name, manager_email, manager_title, manager_department, manager_city, manager_state, win_loss_ratio, avg_bookings_per_rep]
          salesforce__opportunity_daily_history:
            weight: 1
            compare_cols: [account_id, amount, expected_revenue, forecast_category, is_closed, is_won, last_activity_date, lead_source, next_step, owner_id, probability, stage_name, type]
          salesforce__opportunity_enhanced:
            weight: 1
            compare_cols: [account_id, amount, campaign_id, expected_revenue, fiscal, fiscal_quarter, fiscal_year, forecast_category, forecast_category_name, has_open_activity, has_opportunity_line_item, has_overdue_task, is_closed, is_deleted, is_won, last_activity_date, last_referenced_date, last_viewed_date, lead_source, next_step, owner_id, probability, record_type_id, stage_name, synced_quote_id, type]
          salesforce__opportunity_line_item_enhanced:
            weight: 1
            compare_cols: [has_quantity_schedule, has_revenue_schedule, is_deleted, last_modified_date, list_price, opportunity_id, pricebook_entry_id, product_2_id, product_code, quantity, service_date, sort_order, total_price, unit_price]
          salesforce__owner_performance:
            weight: 1
            compare_cols: [owner_id, manager_id, b_owner_id, bookings_amount_closed_this_month, bookings_amount_closed_this_quarter, total_number_bookings, total_bookings_amount, bookings_count_closed_this_month, bookings_count_closed_this_quarter, avg_bookings_amount, largest_booking, avg_days_to_close, l_owner_id, lost_amount_this_month, lost_amount_this_quarter, total_number_lost, total_lost_amount, lost_count_this_month, lost_count_this_quarter, p_owner_id, pipeline_created_amount_this_month, pipeline_created_amount_this_quarter, pipeline_created_forecast_amount_this_month, pipeline_created_forecast_amount_this_quarter, pipeline_count_created_this_month, pipeline_count_created_this_quarter, total_number_pipeline, total_pipeline_amount, total_pipeline_forecast_amount, avg_pipeline_opp_amount, largest_deal_in_pipeline, avg_days_open]
          salesforce__revenue_analytics:
            weight: 1
            compare_cols: [account_id, amount, fiscal_quarter, fiscal_year, is_won, lead_source, owner_id, stage_name]
          salesforce__sales_snapshot:
            weight: 1
            compare_cols: [snapshot_date, current_month_start, current_quarter_start, current_year_start, total_opportunities, won_opportunities, lost_opportunities, open_opportunities, total_opportunity_value, won_amount, lost_amount, pipeline_amount, avg_days_to_close, avg_won_deal_size, opportunities_created_this_month, opportunities_created_this_quarter, opportunities_won_this_month, opportunities_won_this_quarter, pipeline_created_this_month, pipeline_created_this_quarter, revenue_this_month, revenue_this_quarter, total_leads, converted_leads, open_leads, conversion_rate_pct, total_accounts, unique_account_owners, unique_industries, avg_company_size, total_users, active_users, win_rate_pct, close_rate_pct]
          salesforce__team_performance:
            weight: 1
            compare_cols: [team_manager_id, team_manager_name, team_type, team_size, active_team_members, high_performers, good_performers, developing_performers, new_users, team_performance_tier, team_health_score, team_diversity_level, team_total_opportunities, team_won_opportunities, team_win_rate_percentage, team_total_revenue, team_total_pipeline, avg_opportunities_per_member, avg_wins_per_member, avg_revenue_per_member, avg_win_rate_per_member, team_total_leads, team_converted_leads, team_lead_conversion_rate, team_total_activities, avg_activity_completion_rate, team_revenue_current_quarter, team_deals_current_quarter, revenue_growth_qoq_percentage, team_activities_per_win_ratio, top_revenue_performer, top_win_rate_performer, new_team_members, veteran_team_members]
  dacomp-de-impl-019:
    database_file: apple_store.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_apple_store__app_crash_daily:
            weight: 1
            compare_cols: [app_id, app_version, crashes, date_day, device, platform_version, unique_devices]
          stg_apple_store__app_session_daily:
            weight: 1
            compare_cols: [app_id, app_version, date_day, device, page_type, platform_version, sessions, source_type, territory, total_session_duration, unique_devices]
          stg_apple_store__app_store_app:
            weight: 1
            compare_cols: [app_id, app_name, subscription_status_url]
          stg_apple_store__app_store_discovery_and_engagement_daily:
            weight: 1
            compare_cols: [app_id, counts, date_day, device, engagement_type, event, page_type, platform_version, source_type, territory, unique_counts]
          stg_apple_store__app_store_download_daily:
            weight: 1
            compare_cols: [app_id, app_version, counts, device, download_type, page_type, platform_version, pre_order, source_type, territory]
          stg_apple_store__app_store_installation_and_deletion_daily:
            weight: 1
            compare_cols: [app_download_date, app_id, app_version, counts, date_day, device, download_type, event, page_type, platform_version, source_type, territory, unique_devices]
          stg_apple_store__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_code_numeric, country_name, region, region_code, sub_region, sub_region_code]
          stg_apple_store__sales_subscription_events:
            weight: 1
            compare_cols: [app_apple_id, app_name, cancellation_reason, client, consecutive_paid_periods, country, days_before_canceling, days_canceled, device, event, marketing_opt_in, marketing_opt_in_duration, paid_service_days_recovered, preserved_pricing, previous_subscription_apple_id, previous_subscription_name, proceeds_reason, promotional_offer_id, promotional_offer_name, quantity, standard_subscription_duration, state, subscription_apple_id, subscription_group_id, subscription_name, subscription_offer_duration, subscription_offer_type, vendor_number]
          stg_apple_store__sales_subscription_summary:
            weight: 1
            compare_cols: [active_free_trial_introductory_offer_subscriptions, active_pay_as_you_go_introductory_offer_subscriptions, active_pay_up_front_introductory_offer_subscriptions, active_standard_price_subscriptions, app_apple_id, app_name, billing_retry, client, country, customer_currency, customer_price, developer_proceeds, device, free_trial_offer_code_subscriptions, free_trial_promotional_offer_subscriptions, grace_period, marketing_opt_ins, pay_as_you_go_offer_code_subscriptions, pay_as_you_go_promotional_offer_subscriptions, pay_up_front_offer_code_subscriptions, pay_up_front_promotional_offer_subscriptions, preserved_pricing, proceeds_currency, proceeds_reason, promotional_offer_id, standard_subscription_duration, state, subscribers, subscription_apple_id, subscription_group_id, subscription_name, subscription_offer_name, vendor_number]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_apple_store__app:
            weight: 1
            compare_cols: [app_id, date_day]
          int_apple_store__app_dim:
            weight: 1
            compare_cols: [app_id, app_name, source_relation]
          int_apple_store__app_version_app_crashes:
            weight: 1
            compare_cols: [app_id, app_version, crashes, date_day, source_relation]
          int_apple_store__app_version_install_deletions:
            weight: 1
            compare_cols: [app_id, app_version, date_day, deletions, installations, source_type]
          int_apple_store__app_version_report:
            weight: 1
            compare_cols: [app_id, app_version, date_day, source_type]
          int_apple_store__app_version_sessions_activity:
            weight: 1
            compare_cols: [active_devices, app_id, date_day, sessions, source_type]
          int_apple_store__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_code_numeric, country_name, region, region_code, sub_region, sub_region_code]
          int_apple_store__crash_daily:
            weight: 1
            compare_cols: [app_id, crashes, date_day, source_relation]
          int_apple_store__date_spine:
            weight: 1
            compare_cols: [date_day]
          int_apple_store__device_app_crashes:
            weight: 1
            compare_cols: [app_id, crashes, date_day, device, source_relation]
          int_apple_store__device_downloads_daily:
            weight: 1
            compare_cols: [app_id, date_day, device, first_time_downloads, redownloads, source_type, total_downloads]
          int_apple_store__device_impressions_page_views:
            weight: 1
            compare_cols: [app_id, date_day, device, impressions, impressions_unique_device, page_views, page_views_unique_device, source_type]
          int_apple_store__device_install_deletions:
            weight: 1
            compare_cols: [app_id, date_day, deletions, device, installations, source_type]
          int_apple_store__device_report:
            weight: 1
            compare_cols: [app_id, date_day, device, source_type]
          int_apple_store__device_sessions_activity:
            weight: 1
            compare_cols: [active_devices, app_id, device, sessions, source_type]
          int_apple_store__discovery_and_engagement_daily:
            weight: 1
            compare_cols: [app_id, date_day, device, engagement_type, impressions, impressions_unique_device, page_type, page_views, page_views_unique_device, platform_version, source_type, territory]
          int_apple_store__download_daily:
            weight: 1
            compare_cols: [app_id, app_version, counts, device, download_type, first_time_downloads, page_type, platform_version, pre_order, redownloads, source_type, territory, total_downloads]
          int_apple_store__installation_and_deletion_daily:
            weight: 1
            compare_cols: [app_download_date, app_id, app_version, date_day, deletions, device, download_type, first_time_downloads, installations, page_type, platform_version, redownloads, source_type, territory, total_downloads]
          int_apple_store__platform_version_app_crashes:
            weight: 1
            compare_cols: [app_id, crashes, date_day, platform_version, source_relation]
          int_apple_store__platform_version_downloads_daily:
            weight: 1
            compare_cols: [app_id, first_time_downloads, platform_version, redownloads, source_type, total_downloads]
          int_apple_store__platform_version_impressions_pv:
            weight: 1
            compare_cols: [app_id, date_day, impressions, impressions_unique_device, page_views, page_views_unique_device, platform_version, source_type]
          int_apple_store__platform_version_install_deletions:
            weight: 1
            compare_cols: [app_id, date_day, deletions, installations, platform_version, source_type]
          int_apple_store__platform_version_report:
            weight: 1
            compare_cols: [app_id, date_day, platform_version, source_type]
          int_apple_store__platform_version_sessions_activity:
            weight: 1
            compare_cols: [active_devices, app_id, date_day, platform_version, sessions, source_type]
          int_apple_store__session_daily:
            weight: 1
            compare_cols: [active_devices, app_id, app_version, date_day, device, page_type, platform_version, sessions, source_type, territory, total_session_duration]
          int_apple_store__source_type_impressions_page_views:
            weight: 1
            compare_cols: [app_id, date_day, impressions, page_views, source_type]
          int_apple_store__source_type_install_deletions:
            weight: 1
            compare_cols: [app_id, date_day, deletions, installations, source_type]
          int_apple_store__source_type_report:
            weight: 1
            compare_cols: [app_id, source_type]
          int_apple_store__source_type_sessions_activity:
            weight: 1
            compare_cols: [active_devices, app_id, sessions, source_type]
          int_apple_store__subscription_events:
            weight: 1
            compare_cols: [app_apple_id, app_name, country, date_day, event_cancel, event_renew, event_subscribe, state, subscription_name, vendor_number]
          int_apple_store__subscription_report:
            weight: 1
            compare_cols: [app_apple_id, app_name, country, state, subscription_name, vendor_number]
          int_apple_store__subscription_summary:
            weight: 1
            compare_cols: [active_free_trial_introductory_offer_subscriptions, active_pay_as_you_go_introductory_offer_subscriptions, active_pay_up_front_introductory_offer_subscriptions, active_standard_price_subscriptions, app_apple_id, app_name, country, date_day, state, subscription_name, vendor_number]
          int_apple_store__territory_downloads_daily:
            weight: 1
            compare_cols: [app_id, first_time_downloads, redownloads, source_type, territory, total_downloads]
          int_apple_store__territory_impressions_page_views:
            weight: 1
            compare_cols: [app_id, date_day, impressions, impressions_unique_device, page_views, page_views_unique_device, source_type, territory]
          int_apple_store__territory_install_deletions:
            weight: 1
            compare_cols: [app_id, date_day, deletions, installations, source_type, territory]
          int_apple_store__territory_report:
            weight: 1
            compare_cols: [app_id, source_type, territory]
          int_apple_store__territory_sessions_activity:
            weight: 1
            compare_cols: [active_devices, app_id, sessions, source_type, territory]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          apple_store__app_version_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, app_version, crashes, deletions, installations, sessions, source_type]
          apple_store__device_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, crashes, date_day, deletions, device, first_time_downloads, impressions, impressions_unique_device, installations, page_views, page_views_unique_device, redownloads, sessions, source_type, total_downloads]
          apple_store__overview_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, crashes, date_day, deletions, first_time_downloads, impressions, installations, page_views, redownloads, sessions, total_downloads]
          apple_store__platform_version_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, crashes, date_day, deletions, first_time_downloads, impressions, impressions_unique_device, installations, page_views, page_views_unique_device, platform_version, redownloads, sessions, source_type, total_downloads]
          apple_store__source_type_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, date_day, deletions, impressions, installations, page_views, sessions, source_type]
          apple_store__subscription_report:
            weight: 1
            compare_cols: [active_free_trial_introductory_offer_subscriptions, active_pay_as_you_go_introductory_offer_subscriptions, active_pay_up_front_introductory_offer_subscriptions, active_standard_price_subscriptions, app_apple_id, app_name, date_day, event_cancel, event_renew, event_subscribe, region, state, sub_region, subscription_name, territory_long, territory_short, vendor_number]
          apple_store__territory_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, date_day, deletions, first_time_downloads, impressions, impressions_unique_device, installations, page_views, page_views_unique_device, redownloads, region, sessions, sub_region, territory_long, territory_short, total_downloads]
  dacomp-de-impl-020:
    database_file: intercom.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_intercom__admin:
            weight: 1
            compare_cols: [admin_id, name, job_title]
          stg_intercom__company_history:
            weight: 1
            compare_cols: [company_name, industry, monthly_spend, plan_id, plan_name, session_count, user_count, website]
          stg_intercom__company_tag_history:
            weight: 1
            compare_cols: [company_id, company_updated_at, tag_id]
          stg_intercom__contact_company_history:
            weight: 1
            compare_cols: [company_id, contact_id]
          stg_intercom__contact_history:
            weight: 1
            compare_cols: [admin_id, contact_email, contact_id, contact_name, contact_role, phone]
          stg_intercom__contact_tag_history:
            weight: 1
            compare_cols: [contact_id, contact_updated_at, tag_id]
          stg_intercom__conversation_contact_history:
            weight: 1
            compare_cols: [contact_id, conversation_id]
          stg_intercom__conversation_history:
            weight: 1
            compare_cols: [assignee_id, assignee_type, conversation_id, conversation_rating_remark, first_contact_reply_type, sla_name, sla_status, snoozed_until, source_author_id, source_author_type, source_delivered_as, source_subject, source_type, state, waiting_since]
          stg_intercom__conversation_part_history:
            weight: 1
            compare_cols: [conversation_part_id, part_type, body, conversation_id, author_id, author_type]
          stg_intercom__conversation_tag_history:
            weight: 1
            compare_cols: [conversation_id, conversation_updated_at, tag_id]
          stg_intercom__tag:
            weight: 1
            compare_cols: [name, tag_id]
          stg_intercom__team:
            weight: 1
            compare_cols: [team_id, name]
          stg_intercom__team_admin:
            weight: 1
            compare_cols: [admin_id, team_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_intercom__company_history:
            weight: 1
            compare_cols: [company_age_days, monthly_spend, session_count, user_count]
          int_intercom__company_tags_aggregate:
            weight: 1
            compare_cols: [all_company_tags, company_id]
          int_intercom__contact_company_history:
            weight: 1
            compare_cols: [company_id, contact_id]
          int_intercom__contact_company_names:
            weight: 1
            compare_cols: [all_contact_company_names, contact_id]
          int_intercom__contact_latest:
            weight: 1
            compare_cols: [admin_id, contact_email, contact_id, contact_name, contact_role, email_domain, is_active_1d, is_active_30d, is_active_7d, last_contacted_at, last_email_clicked_at, last_email_opened_at, last_replied_at, retained_30d, retained_7d, signed_up_at, updated_at]
          int_intercom__contact_tags_aggregate:
            weight: 1
            compare_cols: [all_contact_tags, contact_id]
          int_intercom__conversation_part_aggregates:
            weight: 1
            compare_cols: [conversation_id, count_assignments, count_reopens, count_total_parts]
          int_intercom__conversation_part_events:
            weight: 1
            compare_cols: [conversation_id, first_close_by_admin_id, first_close_by_author_id, first_contact_author_id, last_close_by_admin_id, last_close_by_author_id, last_contact_author_id]
          int_intercom__conversation_string_aggregates:
            weight: 1
            compare_cols: [conversation_admins, conversation_contacts, conversation_id]
          int_intercom__conversation_tags_aggregate:
            weight: 1
            compare_cols: [all_conversation_tags, conversation_id]
          int_intercom__latest_conversation:
            weight: 1
            compare_cols: [conversation_assignee_type, conversation_author_type, conversation_created_at, conversation_initiated_type, conversation_last_updated_at, conversation_rating, conversation_rating_remark, conversation_state, conversation_subject, conversation_type]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          intercom__company_enhanced:
            weight: 1
            compare_cols: [all_company_tags, company_age_days, company_name, industry, monthly_spend, plan_id, plan_name, session_count, user_count, website]
          intercom__company_metrics:
            weight: 1
            compare_cols: [avg_conversation_parts, avg_conversation_rating, contacts_active_30d, contacts_active_7d, contacts_total, conv_rate_email, conv_rate_messenger, conv_rate_other, conv_rate_overall, p50_reopens, p50_time_to_first_close_min, p50_time_to_first_response_min, p50_time_to_last_close_min, registration_retention_30d, registration_retention_7d]
          intercom__contact_enhanced:
            weight: 1
            compare_cols: [admin_id, all_contact_company_names, all_contact_tags, contact_email, contact_id, contact_name, contact_role, email_domain, retained_30d, retained_7d]
          intercom__conversation_enhanced:
            weight: 1
            compare_cols: [all_contact_company_names, all_conversation_admins, all_conversation_contacts, all_conversation_tags, conversation_assignee_type, conversation_author_type, conversation_id, conversation_initiated_type, conversation_rating, conversation_remark, conversation_state, conversation_subject, conversation_type, first_close_by_admin_id, first_close_by_author_id, first_contact_author_id, is_read, last_close_by_admin_id, last_close_by_author_id, last_contact_author_id, sla_name, sla_status, snoozed_until, waiting_since]
          intercom__conversation_metrics:
            weight: 1
            compare_cols: [conversation_assignee_type, conversation_author_type, conversation_id, conversation_initiated_type, conversation_rating, conversation_rating_remark, conversation_state, conversation_subject, conversation_type, count_assignments, count_reopens, count_total_parts, first_close_by_admin_id, first_close_by_author_id, first_contact_author_id, is_read, last_close_by_admin_id, last_close_by_author_id, last_contact_author_id, sla_name, sla_status, snoozed_until, time_to_admin_first_close_minutes, time_to_admin_last_close_minutes, time_to_first_assignment_minutes, time_to_first_close_minutes, time_to_first_response_minutes, time_to_last_assignment_minutes, time_to_last_close_minutes, waiting_since]
  dacomp-de-impl-021:
    database_file: klaviyo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_klaviyo__campaign:
            weight: 1
            compare_cols: [campaign_id, campaign_name, CAMPAIGN_TYPE, EMAIL_TEMPLATE_ID, from_email, FROM_NAME, STATUS, STATUS_ID, SUBJECT]
          stg_klaviyo__event:
            weight: 1
            compare_cols: [campaign_id, event_attribution, event_id, flow_id, FLOW_MESSAGE_ID, metric_id, numeric_value, occurred_on, person_id, property_compare_at_price, property_price, type, UUID, variation_id]
          stg_klaviyo__flow:
            weight: 1
            compare_cols: [flow_id, flow_name, is_archived, status, trigger_type]
          stg_klaviyo__metric:
            weight: 1
            compare_cols: [integration_category, integration_id, integration_name, metric_id, metric_name, source_relation]
          stg_klaviyo__person:
            weight: 1
            compare_cols: [ADDRESS_1, ADDRESS_2, CITY, COUNTRY, email, full_name, LAST_EVENT_DATE, LATITUDE, LONGITUDE, ORGANIZATION, person_id, phone_number, REGION, timezone, TITLE, ZIP]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_klaviyo__campaign_flow_metrics:
            weight: 1
            compare_cols: [count_active_on_site, count_clicked_email, count_clicked_sms, count_marked_email_as_spam, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_received_sms, count_refunded_order, count_sent_sms, count_unsubscribed, count_unsubscribed_from_sms, count_viewed_product, email_open_rate, gmv_gross, gmv_net, last_touch_campaign_id, last_touch_flow_id, total_count_unique_people, unique_count_active_on_site, unique_count_clicked_email, unique_count_clicked_sms, unique_count_marked_email_as_spam, unique_count_opened_email, unique_count_ordered_product, unique_count_placed_order, unique_count_received_email, unique_count_received_sms, unique_count_refunded_order, unique_count_sent_sms, unique_count_unsubscribed, unique_count_unsubscribed_from_sms, unique_count_viewed_product, variation_id]
          int_klaviyo__campaigns_enriched:
            weight: 1
            compare_cols: [campaign_id, campaign_name, CAMPAIGN_TYPE, campaign_variation_key, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, email_click_to_open_rate, email_open_rate, EMAIL_TEMPLATE_ID, from_email, FROM_NAME, gmv_gross, gmv_net, STATUS, STATUS_ID, SUBJECT, total_count_unique_people, variation_id]
          int_klaviyo__event_attribution:
            weight: 1
            compare_cols: [campaign_id, event_attribution, event_id, flow_id, FLOW_MESSAGE_ID, last_touch_id, metric_id, numeric_value, occurred_on, person_id, property_compare_at_price, property_price, session_event_type, session_touch_type, touch_id, touch_type, type, UUID, variation_id]
          int_klaviyo__events:
            weight: 1
            compare_cols: [amount_negative, amount_positive, campaign_name, campaign_subject_line, CAMPAIGN_TYPE, event_attribution, event_id, flow_name, integration_category, integration_id, integration_name, inter_event_minutes, is_engagement_event, last_touch_campaign_id, last_touch_flow_id, last_touch_id, metric_id, numeric_value, occurred_on, person_city, person_country, person_email, person_id, person_region, person_timezone, session_seq, session_touch_type, touch_id, touch_type, type, UUID, variation_id]
          int_klaviyo__flows_enriched:
            weight: 1
            compare_cols: [count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, email_click_to_open_rate, email_open_rate, flow_id, flow_name, flow_variation_key, gmv_gross, gmv_net, is_archived, status, total_count_unique_people, trigger_type, variation_id]
          int_klaviyo__person_campaign_flow:
            weight: 1
            compare_cols: [count_active_on_site, count_clicked_email, count_clicked_sms, count_marked_email_as_spam, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_received_sms, count_refunded_order, count_sent_sms, count_unsubscribed, count_unsubscribed_from_sms, count_viewed_product, last_touch_campaign_id, last_touch_flow_id, person_id, sum_revenue_placed_order, variation_id]
          int_klaviyo__person_metrics:
            weight: 1
            compare_cols: [active_days, active_months, active_weeks, count_active_on_site, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, count_viewed_product, email_click_to_open_rate, email_open_rate, first_event_on, last_event_on, missing_day_count, person_id, product_view_to_order_rate, site_to_order_rate, sum_revenue_cancelled_order, sum_revenue_ordered_product, sum_revenue_placed_order, sum_revenue_refunded_order]
          int_klaviyo__persons_enriched:
            weight: 1
            compare_cols: [ADDRESS_1, ADDRESS_2, CITY, count_active_on_site, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_viewed_product, COUNTRY, email, email_open_rate, first_event_on, full_name, LAST_EVENT_DATE, last_event_on, LATITUDE, LONGITUDE, ORGANIZATION, person_id, REGION, sum_revenue_cancelled_order, sum_revenue_ordered_product, sum_revenue_placed_order, sum_revenue_refunded_order, timezone, TITLE, ZIP]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          klaviyo__campaigns:
            weight: 1
            compare_cols: [active_days, campaign_id, campaign_name, CAMPAIGN_TYPE, campaign_variation_key, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, email_click_to_open_rate, email_open_rate, EMAIL_TEMPLATE_ID, from_email, FROM_NAME, gmv_gross, gmv_net, gmv_net_campaign, product_view_to_order_rate_campaign, STATUS, STATUS_ID, SUBJECT, total_amount_negative, total_amount_positive, total_count_unique_people, total_placed_orders, variation_id]
          klaviyo__events:
            weight: 1
            compare_cols: [amount_negative, amount_positive, campaign_name, campaign_subject_line, CAMPAIGN_TYPE, date_gap_days, day_amount_negative, day_amount_positive, day_click_to_open_rate, day_clicked_email, day_net_revenue, day_opened_email, day_ordered_product, day_placed_order, event_attribution, event_id, event_net_revenue, flow_name, integration_category, integration_id, integration_name, inter_event_minutes, is_attributed, is_engagement_event, last_touch_campaign_id, last_touch_flow_id, last_touch_id, metric_id, numeric_value, occurred_on, person_city, person_country, person_email, person_event_seq, person_id, person_region, person_timezone, prev_occurred_on, session_seq, session_touch_type, touch_id, touch_type, type, UUID, variation_id]
          klaviyo__flows:
            weight: 1
            compare_cols: [active_days, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, email_click_to_open_rate, email_open_rate, flow_id, flow_name, gmv_gross, gmv_net, gmv_net_flow, is_archived, product_view_to_order_rate_flow, status, total_amount_negative, total_amount_positive, total_count_unique_people, total_placed_orders, trigger_type, variation_id]
          klaviyo__person_campaign_flow:
            weight: 1
            compare_cols: [count_active_on_site, count_clicked_email, count_clicked_sms, count_marked_email_as_spam, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_received_sms, count_refunded_order, count_sent_sms, count_unsubscribed, count_unsubscribed_from_sms, count_viewed_product, email_open_rate_touch, has_converted, last_touch_campaign_id, last_touch_flow_id, net_revenue_touch, person_id, product_view_to_order_rate_touch, sum_revenue_placed_order, touch_span_days, variation_id]
          klaviyo__persons:
            weight: 1
            compare_cols: [active_days, active_months, active_retention_rate_day, active_retention_rate_month, active_retention_rate_week, active_weeks, ADDRESS_1, ADDRESS_2, CITY, count_active_on_site, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_viewed_product, COUNTRY, days_span, email, email_open_rate, first_event_on, first_event_on_1, full_name, has_30day_retention, has_7day_retention, LAST_EVENT_DATE, last_event_on, last_event_on_2, LATITUDE, LONGITUDE, missing_day_count, months_span, ORGANIZATION, paid_retention_rate_month, person_id, REGION, sum_revenue_cancelled_order, sum_revenue_ordered_product, sum_revenue_placed_order, sum_revenue_refunded_order, timezone, TITLE, updated_at, weeks_span, ZIP]
  dacomp-de-impl-022:
    database_file: recharge.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_recharge__address:
            weight: 1
            compare_cols: [address1, address2, address_id, city, company, country, country_code, country_name, customer_id, default_address, first_name, last_name, name, phone, province, province_code, subscription_id, updated_at, zip]
          stg_recharge__address_discounts:
            weight: 1
            compare_cols: [address_discount_id, address_id, discount_id, updated_at]
          stg_recharge__address_shipping_line:
            weight: 1
            compare_cols: [address_id, shipping_rate_id, shipping_zone_id]
          stg_recharge__charge:
            weight: 1
            compare_cols: [address_id, charge_id, charge_status, customer_id, last_attempt_error, name, note, processed_at, retry_at, retry_count, scheduled_at, shopify_order_id, updated_at]
          stg_recharge__charge_discount:
            weight: 1
            compare_cols: [charge_id, discount_id, updated_at]
          stg_recharge__charge_line_item:
            weight: 1
            compare_cols: [charge_id, charge_line_item_id, price, product_title, quantity, shopify_order_line_item_id, shopify_product_id, shopify_variant_id, subscription_id, updated_at, variant_title]
          stg_recharge__charge_order_attribute:
            weight: 1
            compare_cols: [charge_id, name, value]
          stg_recharge__charge_shipping_line:
            weight: 1
            compare_cols: [charge_id, charge_shipping_line_id, code, price, shipping_rate_id, title]
          stg_recharge__charge_tax_line:
            weight: 1
            compare_cols: [charge_id, charge_tax_line_id, price, rate, title]
          stg_recharge__checkout:
            weight: 1
            compare_cols: [checkout_completed_at, checkout_created_at, checkout_id, checkout_updated_at, customer_id, delivery_date, note, shipping_date, shopify_cart_token, shopify_checkout_id]
          stg_recharge__customer:
            weight: 1
            compare_cols: [customer_hash, customer_id, email, shopify_customer_id]
          stg_recharge__discount:
            weight: 1
            compare_cols: [applies_to_product_type, discount_created_at, discount_id, discount_type, discount_updated_at, duration, duration_usage_limit, max_subsequent_contracts, shipping_product_title, shipping_variant_title, value, value_type]
          stg_recharge__one_time_product:
            weight: 1
            compare_cols: [charge_id, one_time_created_at, one_time_product_id, one_time_updated_at, price, product_title, quantity, shopify_product_id, shopify_variant_id, variant_title]
          stg_recharge__order:
            weight: 1
            compare_cols: [charge_id, customer_id, order_created_at, order_id, order_processed_at, order_updated_at]
          stg_recharge__order_line_item:
            weight: 1
            compare_cols: [charge_id, order_line_item_id, price, product_title, quantity, shopify_product_id, shopify_variant_id, subscription_id, updated_at, variant_title]
          stg_recharge__subscription:
            weight: 1
            compare_cols: [address_id, customer_id, shopify_product_id, shopify_variant_id, subscription_cancelled_at, subscription_created_at, subscription_id, subscription_updated_at]
          stg_recharge__subscription_history:
            weight: 1
            compare_cols: [is_most_recent_record, subscription_id, subscription_status]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_recharge__calendar_spine:
            weight: 1
            compare_cols: [date_day]
          int_recharge__customer_daily_rollup:
            weight: 1
            compare_cols: [customer_id, date_day, date_month, date_week, date_year]
          int_recharge__customer_details:
            weight: 1
            compare_cols: [avg_amount_charged, avg_item_quantity_per_order, avg_order_amount, avg_order_line_item_total, charges_count, customer_id, subscriptions_active_count, total_amount_charged, total_amount_discounted, total_amount_ordered, total_amount_taxed, total_order_line_item_total, total_orders, total_quantity_ordered, total_refunds]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          recharge__billing_history:
            weight: 1
            compare_cols: [calculated_order_total_price, calculated_order_total_refunds, charge_id, charge_status, customer_id, order_id]
          recharge__charge_line_item_history:
            weight: 1
            compare_cols: [address_id, amount, charge_id, charge_row_num, customer_id, item_title, line_item_type]
          recharge__customer_daily_rollup:
            weight: 1
            compare_cols: [calculated_order_total_price_realized, customer_id, date_day, date_month, date_week, date_year, no_of_orders, order_item_quantity_realized, order_line_item_total_realized]
          recharge__customer_details:
            weight: 1
            compare_cols: [active_months, avg_amount_charged, avg_item_quantity_per_order, avg_order_amount, avg_order_line_item_total, charges_count, customer_hash, customer_id, email, is_currently_subscribed, is_new_customer, shopify_customer_id, subscriptions_active_count, total_amount_charged, total_amount_discounted, total_amount_ordered, total_amount_taxed, total_order_line_item_total, total_orders, total_quantity_ordered, total_refunds]
          recharge__monthly_recurring_revenue:
            weight: 1
            compare_cols: [calculated_net_order_mrr, customer_id, date_month]
          recharge__subscription_overview:
            weight: 1
            compare_cols: [address_id, cancellation_reason, cancellation_reason_comments, charge_interval_frequency, charge_interval_frequency_days, charges_until_expiration, count_queued_charges, count_successful_charges, customer_id, expire_after_specific_number_of_charges, external_product_id_ecommerce, external_variant_id_ecommerce, order_day_of_month, order_day_of_week, order_interval_frequency, order_interval_unit, shopify_product_id, shopify_variant_id, subscription_id, subscription_status]
  dacomp-de-impl-023:
    database_file: social_media_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_social_media__account_history:
            weight: 1
            compare_cols: [approval_status, business_id, business_name, deleted, id, industry_type, name, salt, timezone]
          stg_social_media__facebook_posts:
            weight: 1
            compare_cols: [created_timestamp, id, impressions, is_eligible_for_promotion, is_instagram_eligible, page_category, page_followers, page_id, page_name, page_username, post_id, post_message, post_url, privacy_value, shares, status_type]
          stg_social_media__instagram_posts:
            weight: 1
            compare_cols: [account_followers, account_media_count, account_username, comments, created_timestamp, engagement, engagement_rate, impressions, impressions_override, media_type, media_type_category, media_url, page_name, post_caption, post_url, reach, shares]
          stg_social_media__linkedin_posts:
            weight: 1
            compare_cols: [created_timestamp, organization_id, platform, post_id, post_url]
          stg_social_media__twitter_organic_tweets:
            weight: 1
            compare_cols: [account_id, app_clicks, card_engagements, carousel_swipes, clicks, date, engagement_rate, engagements, follows, impressions, likes, placement, poll_card_vote, qualified_impressions, replies, retweets, tweets_send, unfollows, url_clicks, video_15_s_views, video_3_s_100_pct_views, video_6_s_views, video_content_starts, video_cta_clicks, video_total_views, video_views_100, video_views_25, video_views_50, video_views_75]
          stg_social_media__twitter_user_history:
            weight: 1
            compare_cols: [default_profile, default_profile_image, description, favourites_count, followers_count, following_count, lang, listed_count, location, protected, screen_name, statuses_count, time_zone, url, verified]
          stg_social_media__youtube_videos:
            weight: 1
            compare_cols: [channel_id, channel_title, clicks, comments, engagement_rate, estimated_shares, impressions, likes, page_name, post_url, privacy_status, subscribers, video_description, video_id, video_title]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          social_media_reporting__facebook_posts_reporting:
            weight: 1
            compare_cols: [clicks, comments, content_type, created_timestamp, day, engagement_rate, has_link, impressions, likes, month, page_id, page_name, page_recency_rank, platform, post_id, post_message, post_url, rolling_7_post_shares, shares, text_length_chars, text_word_count, week]
          social_media_reporting__instagram_posts_reporting:
            weight: 1
            compare_cols: [account_followers, calculated_engagement_rate, clicks, comments, content_format, created_timestamp, followers_engagement_rate, impressions, likes, page_name, platform, post_message, post_url, reach, saves, shares]
          social_media_reporting__linkedin_posts_reporting:
            weight: 1
            compare_cols: [calculated_engagement_rate, clicks, comments, created_timestamp, impressions, likes, page_id, page_name, platform, post_category, post_id, post_url, shares]
          social_media_reporting__twitter_posts_reporting:
            weight: 1
            compare_cols: [app_clicks, calculated_engagement_rate, clicks, comments, created_timestamp, engagement_rate, impressions, likes, page_id, platform, qualified_impressions, shares, url_clicks]
          social_media_reporting__youtube_videos_reporting:
            weight: 1
            compare_cols: [calculated_engagement_rate, channel_subscribers, channel_total_videos, clicks, comments, created_timestamp, impressions, likes, likes_per_view_ratio, page_id, page_name, platform, post_id, post_message, post_url, privacy_status, shares, views_per_subscriber]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          social_media_reporting__ctr_by_platform:
            weight: 1
            compare_cols: [active_accounts_count, clicks, comments, content_type, ctr, engagement_rate, impressions, likes, month, platform, posts_count, shares]
          social_media_reporting__daily_kpis:
            weight: 1
            compare_cols: [active_accounts_count, clicks, comments, content_type, ctr, day, engagement_rate, impressions, likes, platform, posts_count, shares]
          social_media_reporting__retention_kpis:
            weight: 1
            compare_cols: [cohort_pages, cohort_week, platform, retained_pages, retention_rate, target_week, week_offset]
          social_media_reporting__rollup_report:
            weight: 1
            compare_cols: [clicks, comments, content_quality_score, created_timestamp, daily_platform_rank, engagement_rate, impressions, likes, page_id, platform, platform_lifetime_rank, post_id, shares]
  dacomp-de-impl-024:
    database_file: tiktok_ads.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_tiktok_ads__ad_group_history:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertiser_id, age_groups, audience_type, budget, budget_mode, campaign_id, creative_material_mode, frequency, frequency_schedule, gender, interest_category, is_most_recent_record, landing_page_url, secondary_optimization_event, source_relation]
          stg_tiktok_ads__ad_group_report_hourly:
            weight: 1
            compare_cols: [ad_group_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_tiktok_ads__ad_history:
            weight: 1
            compare_cols: [ad_group_id, ad_id, ad_name, advertiser_id, base_url, call_to_action, campaign_id, click_tracking_url, impression_tracking_url, is_most_recent_record, landing_page_url, url_host, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
          stg_tiktok_ads__ad_report_hourly:
            weight: 1
            compare_cols: [ad_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_tiktok_ads__advertiser:
            weight: 1
            compare_cols: [address, advertiser_id, advertiser_name, balance, company, contacter, country, currency, description, email, industry, language, telephone_number, timezone]
          stg_tiktok_ads__campaign_country_report:
            weight: 1
            compare_cols: [campaign_id, clicks, conversion, conversion_rate, cost_per_conversion, country_code, cpc, cpm, ctr, impressions, real_time_conversion, spend, stat_time_day]
          stg_tiktok_ads__campaign_history:
            weight: 1
            compare_cols: [advertiser_id, budget, budget_mode, campaign_id, campaign_name, campaign_type, is_most_recent_record, is_new_structure, objective_type, split_test_variable, status, updated_at]
          stg_tiktok_ads__campaign_report_hourly:
            weight: 1
            compare_cols: [average_video_play, average_video_play_per_user, campaign_id, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_tiktok_ads__ad_group_history_latest:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertiser_id, age_groups, audience_type, budget, budget_mode, campaign_id, creative_material_mode, frequency, frequency_schedule, gender, interest_category, is_most_recent_record, landing_page_url, secondary_optimization_event, source_relation]
          int_tiktok_ads__ad_group_report_hourly:
            weight: 1
            compare_cols: [ad_group_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          int_tiktok_ads__ad_history_latest:
            weight: 1
            compare_cols: [ad_group_id, ad_id, ad_name, advertiser_id, base_url, call_to_action, campaign_id, click_tracking_url, impression_tracking_url, is_most_recent_record, landing_page_url, url_host, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
          int_tiktok_ads__ad_report_hourly:
            weight: 1
            compare_cols: [ad_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          int_tiktok_ads__advertiser:
            weight: 1
            compare_cols: [address, advertiser_id, advertiser_name, balance, company, contacter, country, currency, description, email, industry, language, telephone_number, timezone]
          int_tiktok_ads__campaign_country_report:
            weight: 1
            compare_cols: [campaign_id, clicks, conversion, conversion_rate, cost_per_conversion, country_code, cpc, cpm, ctr, impressions, real_time_conversion, spend, stat_time_day]
          int_tiktok_ads__campaign_history_latest:
            weight: 1
            compare_cols: [advertiser_id, budget, budget_mode, campaign_id, campaign_name, campaign_type, is_most_recent_record, is_new_structure, objective_type, split_test_variable, status, updated_at]
          int_tiktok_ads__campaign_report_hourly:
            weight: 1
            compare_cols: [average_video_play, average_video_play_per_user, campaign_id, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          tiktok_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertiser_id, advertiser_name, audience_type, budget, campaign_id, campaign_name, clicks, comments, conversion, currency, daily_cpc, daily_cpm, daily_ctr, date_day, follows, gender, impressions, interest_category, likes, profile_visits, reach, real_time_conversion, shares, spend, total_conversion_value, total_purchase_value, total_sales_lead_value, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          tiktok_ads__ad_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, ad_id, ad_name, advertiser_id, advertiser_name, audience_type, budget, campaign_id, campaign_name, clicks, comments, conversion, currency, daily_cpc, daily_cpm, daily_ctr, date_day, follows, gender, impressions, interest_category, likes, profile_visits, reach, real_time_conversion, shares, spend, total_conversion_value, total_purchase_value, total_sales_lead_value, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          tiktok_ads__advertiser_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, clicks, comments, conversion, currency, daily_cpc, daily_cpm, daily_ctr, date_day, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, total_conversion_value, total_purchase_value, total_sales_lead_value, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          tiktok_ads__campaign_country_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, budget, budget_mode, campaign_id, campaign_name, campaign_type, clicks, conversion, country_code, currency, daily_cpc, daily_cpm, date_day, impressions, objective_type, real_time_conversion, spend, split_test_variable, status]
          tiktok_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, campaign_id, campaign_name, clicks, comments, conversion, currency, daily_cpc, daily_cpm, date_day, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, total_conversion_value, total_purchase_value, total_sales_lead_value, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          tiktok_ads__url_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, ad_id, ad_name, advertiser_name, audience_type, base_url, budget, campaign_id, campaign_name, clicks, comments, conversion, currency, daily_cpc, daily_cpm, daily_ctr, date_day, follows, gender, impressions, interest_category, likes, profile_visits, reach, real_time_conversion, shares, spend, total_conversion_value, total_purchase_value, total_sales_lead_value, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
  dacomp-de-impl-025:
    database_file: twilio.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_twilio__account_history:
            weight: 1
            compare_cols: [account_id, friendly_name, owner_account_id, status, type, updated_at]
          stg_twilio__address:
            weight: 1
            compare_cols: [account_id, address_sid, city, country_code, customer_name, emergency_enabled, postal_code, region, street, street_secondary, updated_at, validated, verified]
          stg_twilio__call:
            weight: 1
            compare_cols: [account_id, annotation, answered_by, call_duration_s, call_id, caller_name, contact_phone_number, direction, forwarded_from, group_id, has_talked, parent_call_id, price_unit, raw_price, start_date, status, user_phone_number]
          stg_twilio__incoming_phone_number:
            weight: 1
            compare_cols: [account_id, address_requirements, beta, capability_mms, capability_sms, capability_voice, emergency_status, friendly_name, incoming_phone_number_id, phone_number, updated_at, voice_caller_id_lookup, voice_url]
          stg_twilio__message:
            weight: 1
            compare_cols: [account_id, body, direction, error_code, error_message, message_from, message_id, message_to, messaging_service_id, num_media, num_segments, price, price_unit, status, timestamp_sent, updated_at]
          stg_twilio__messaging_service:
            weight: 1
            compare_cols: [account_id, friendly_name, inbound_method, inbound_request_url, messaging_service_id, status_callback, status_callback_method, updated_at, us_app_to_person_registered, use_case, use_inbound_webhook_on_number]
          stg_twilio__outgoing_caller_id:
            weight: 1
            compare_cols: [created_at, friendly_name, outgoing_caller_id_id, phone_number, updated_at]
          stg_twilio__usage_record:
            weight: 1
            compare_cols: [account_id, category, count, count_unit, end_date, price, price_unit, start_date, usage, usage_unit]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_twilio__account_latest:
            weight: 1
            compare_cols: [account_id, friendly_name, status, type, updated_at]
          int_twilio__account_metrics:
            weight: 1
            compare_cols: [account_id, account_name, avg_call_duration_s, avg_segments_per_message, completed_calls, delivered_messages, failed_calls, failed_messages, status, total_call_cost_usd, total_calls, total_message_cost_usd, total_messages, type]
          int_twilio__messages:
            weight: 1
            compare_cols: [account_id, body, body_no_spaces, date_day, date_month, date_week, direction, error_code, error_message, message_id, message_to, messaging_service_id, num_characters, num_media, num_segments, phone_number, price, price_unit, status, timestamp_sent, updated_at]
          int_twilio__messaging_service:
            weight: 1
            compare_cols: [account_id, friendly_name, inbound_method, messaging_service_id, us_app_to_person_registered, use_case, use_inbound_webhook_on_number]
          int_twilio__usage_record_daily:
            weight: 1
            compare_cols: [account_id, daily_price, price_unit, start_date]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          twilio__account_overview:
            weight: 1
            compare_cols: [account_id, account_name, account_status, account_type, date_day, date_month, date_week, price_unit, total_accepted_messages, total_canceled_messages, total_delivered_messages, total_failed_messages, total_inbound_messages, total_messages, total_messages_spend, total_outbound_messages, total_queued_messages, total_read_messages, total_received_messages, total_receiving_messages, total_scheduled_messages, total_sending_messages, total_sent_messages, total_undelivered_messages]
          twilio__message_enhanced:
            weight: 1
            compare_cols: [account_id, body, date_day, date_month, date_week, direction, error_code, error_message, friendly_name, inbound_method, message_id, messaging_service_id, num_characters, num_media, num_segments, num_words, phone_number, price, price_unit, status, timestamp_sent, us_app_to_person_registered, use_case, use_inbound_webhook_on_number]
          twilio__number_overview:
            weight: 1
            compare_cols: [phone_number, total_inbound_messages, total_messages, total_outbound_messages, total_spend]
  dacomp-de-impl-026:
    database_file: twitter.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_twitter_ads__account_history:
            weight: 1
            compare_cols: [account_id, approval_status, business_id, business_name, created_timestamp, industry_type, is_deleted, is_latest_version, name, timezone, timezone_switched_timestamp, updated_timestamp]
          stg_twitter_ads__campaign_history:
            weight: 1
            compare_cols: [account_id, campaign_id, campaign_name, created_timestamp, currency, daily_budget_amount, daily_budget_amount_local_micro, duration_in_days, end_timestamp, entity_status, frequency_cap, funding_instrument_id, is_deleted, is_latest_version, is_servable, is_standard_delivery, start_timestamp, total_budget_amount_local_micro, updated_timestamp]
          stg_twitter_ads__campaign_locations_report:
            weight: 1
            compare_cols: [account_id, campaign_id, clicks, country, date_day, impressions, placement, spend, spend_micro, url_clicks]
          stg_twitter_ads__campaign_regions_report:
            weight: 1
            compare_cols: [account_id, campaign_id, clicks, country, date_day, impressions, placement, region, spend, spend_micro, url_clicks]
          stg_twitter_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, campaign_id, clicks, conversion_custom_metric, conversion_purchases_metric, date_day, impressions, placement, spend, spend_micro, url_clicks]
          stg_twitter_ads__line_item_history:
            weight: 1
            compare_cols: [advertiser_domain, advertiser_user_id, automatically_select_bid, bid_amount, bid_amount_local_micro, bid_type, bid_unit, campaign_id, charge_by, created_timestamp, creative_source, currency, end_timestamp, entity_status, is_deleted, is_latest_version, line_item_id, name, objective, optimization, primary_web_event_tag, product_type, start_timestamp, target_cpa, target_cpa_local_micro, total_budget_amount, total_budget_amount_local_micro, updated_timestamp]
          stg_twitter_ads__line_item_keywords_report:
            weight: 1
            compare_cols: [account_id, clicks, date_day, impressions, keyword, keyword_id, line_item_id, placement, spend, spend_micro, url_clicks]
          stg_twitter_ads__line_item_report:
            weight: 1
            compare_cols: [account_id, clicks, date_day, impressions, line_item_id, placement, spend, spend_micro, url_clicks]
          stg_twitter_ads__promoted_tweet_history:
            weight: 1
            compare_cols: [approval_status, created_timestamp, entity_status, is_deleted, is_latest_version, line_item_id, promoted_tweet_id, tweet_id, updated_timestamp]
          stg_twitter_ads__promoted_tweet_report:
            weight: 1
            compare_cols: [account_id, clicks, conversion_custom_metric, conversion_purchases_metric, date_day, date_ts, impressions, placement, promoted_tweet_id, spend, spend_micro, url_clicks]
          stg_twitter_ads__tweet:
            weight: 1
            compare_cols: [account_id, language, name, tweet_id]
          stg_twitter_ads__tweet_url:
            weight: 1
            compare_cols: [base_url, display_url, expanded_url, index, indices, tweet_id, url, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_twitter_ads__accounts:
            weight: 1
            compare_cols: [account_id, account_name, approval_status, business_id, business_name, created_timestamp, industry_type, is_deleted, timezone, timezone_switched_timestamp, updated_timestamp]
          int_twitter_ads__campaign_locations_report_base:
            weight: 1
            compare_cols: [account_id, campaign_id, clicks, country, date_day, impressions, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__campaign_regions_report_base:
            weight: 1
            compare_cols: [account_id, campaign_id, clicks, country, date_day, impressions, placement, region, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__campaign_report_base:
            weight: 1
            compare_cols: [account_id, campaign_id, clicks, date_day, impressions, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__campaigns:
            weight: 1
            compare_cols: [account_id, campaign_id, campaign_name, created_timestamp, currency, end_timestamp, entity_status, frequency_cap, funding_instrument_id, is_deleted, is_servable, is_standard_delivery, start_timestamp, total_budget_amount, updated_timestamp]
          int_twitter_ads__keyword_report_base:
            weight: 1
            compare_cols: [account_id, clicks, date_day, impressions, keyword, keyword_id, line_item_id, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__line_item_report_base:
            weight: 1
            compare_cols: [account_id, clicks, date_day, impressions, line_item_id, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__line_items:
            weight: 1
            compare_cols: [advertiser_domain, advertiser_user_id, bid_amount, bid_type, bid_unit, campaign_id, charge_by, created_timestamp, currency, end_timestamp, entity_status, is_deleted, line_item_id, line_item_name, objective, optimization, primary_web_event_tag, product_type, start_timestamp, target_cpa, total_budget_amount, updated_timestamp]
          int_twitter_ads__promoted_tweet_report_base:
            weight: 1
            compare_cols: [account_id, clicks, date_day, impressions, placement, promoted_tweet_id, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__promoted_tweets:
            weight: 1
            compare_cols: [approval_status, created_timestamp, is_deleted, line_item_id, promoted_tweet_id, promoted_tweet_status, tweet_id, updated_timestamp]
          int_twitter_ads__tweet_url_first:
            weight: 1
            compare_cols: [base_url, display_url, expanded_url, tweet_id, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
          int_twitter_ads__tweets:
            weight: 1
            compare_cols: [account_id, language, tweet_full_text, tweet_id, tweet_name]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          twitter_ads__account_report:
            weight: 1
            compare_cols: [account_id, account_name, approval_status, business_id, business_name, clicks, created_timestamp, date_day, impressions, industry_type, is_deleted, placement, spend, spend_micro, timezone, timezone_switched_timestamp, total_conversions, total_conversions_sale_amount, updated_timestamp, url_clicks]
          twitter_ads__campaign_country_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_created_timestamp, campaign_currency, campaign_daily_budget_amount, campaign_end_timestamp, campaign_frequency_cap, campaign_funding_instrument_id, campaign_id, campaign_name, campaign_start_timestamp, campaign_status, campaign_total_budget_amount, campaign_updated_timestamp, clicks, country, date_day, impressions, is_campaign_deleted, is_campaign_servable, is_campaign_standard_delivery, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          twitter_ads__campaign_region_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_created_timestamp, campaign_currency, campaign_daily_budget_amount, campaign_end_timestamp, campaign_frequency_cap, campaign_funding_instrument_id, campaign_id, campaign_name, campaign_start_timestamp, campaign_status, campaign_total_budget_amount, campaign_updated_timestamp, clicks, country, date_day, impressions, is_campaign_deleted, is_campaign_servable, is_campaign_standard_delivery, placement, region, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          twitter_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_id, campaign_name, campaign_status, clicks, created_timestamp, currency, daily_budget_amount, date_day, end_timestamp, frequency_cap, funding_instrument_id, impressions, is_deleted, is_servable, is_standard_delivery, placement, spend, spend_micro, start_timestamp, total_conversions, total_conversions_sale_amount, updated_timestamp, url_clicks]
          twitter_ads__keyword_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_id, campaign_name, clicks, currency, date_day, impressions, keyword, keyword_id, line_item_id, line_item_name, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          twitter_ads__line_item_report:
            weight: 1
            compare_cols: [account_id, account_name, advertiser_domain, advertiser_user_id, bid_amount, bid_type, bid_unit, campaign_id, campaign_name, campaign_status, charge_by, clicks, created_timestamp, currency, date_day, end_timestamp, impressions, is_deleted, line_item_id, line_item_name, line_item_status, objective, optimization, placement, primary_web_event_tag, product_type, spend, spend_micro, start_timestamp, target_cpa, total_conversions, total_conversions_sale_amount, updated_timestamp, url_clicks]
          twitter_ads__promoted_tweet_report:
            weight: 1
            compare_cols: [account_id, account_name, approval_status, campaign_id, campaign_name, campaign_status, clicks, created_timestamp, currency, date_day, impressions, is_deleted, line_item_id, line_item_name, line_item_status, placement, promoted_tweet_id, promoted_tweet_status, spend, spend_micro, total_conversions, total_conversions_sale_amount, tweet_id, tweet_name, updated_timestamp, url_clicks]
          twitter_ads__url_report:
            weight: 1
            compare_cols: [account_id, account_name, base_url, campaign_id, campaign_name, clicks, currency, date_day, display_url, expanded_url, impressions, line_item_id, line_item_name, placement, promoted_tweet_id, spend, spend_micro, total_conversions, total_conversions_sale_amount, tweet_id, tweet_name, url_clicks, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
  dacomp-de-impl-027:
    database_file: xero.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_xero__account:
            weight: 1
            compare_cols: [account_class, account_code, account_id, account_name, account_type]
          stg_xero__bank_transaction:
            weight: 1
            compare_cols: [bank_transaction_id, contact_id]
          stg_xero__contact:
            weight: 1
            compare_cols: [contact_id, contact_name]
          stg_xero__credit_note:
            weight: 1
            compare_cols: [contact_id, credit_note_id]
          stg_xero__invoice:
            weight: 1
            compare_cols: [contact_id, invoice_date, invoice_id]
          stg_xero__invoice_line_item:
            weight: 1
            compare_cols: [account_code, description, discount_entered_as_percent, discount_rate, invoice_id, item_code, line_amount, line_item_id, quantity, tax_amount, tax_type, unit_amount]
          stg_xero__invoice_line_item_has_tracking_category:
            weight: 1
            compare_cols: [_fivetran_synced, invoice_id, line_item_id, tracking_category_id, tracking_option]
          stg_xero__journal:
            weight: 1
            compare_cols: [created_date_utc, journal_date, journal_id, journal_number, reference, source_id, source_type]
          stg_xero__journal_line:
            weight: 1
            compare_cols: [account_code, account_id, account_name, account_type, description, gross_amount, journal_id, journal_line_id, net_amount, tax_amount, tax_name, tax_type]
          stg_xero__journal_line_has_tracking_category:
            weight: 1
            compare_cols: [_fivetran_synced, journal_id, journal_line_id, tracking_category_id, tracking_option]
          stg_xero__organization:
            weight: 1
            compare_cols: [financial_year_end_day, financial_year_end_month, organisation_id]
          stg_xero__tracking_category:
            weight: 1
            compare_cols: [status, tracking_category_id, tracking_category_name]
          stg_xero__tracking_category_has_option:
            weight: 1
            compare_cols: [_fivetran_synced, tracking_category_id, tracking_option_id]
          stg_xero__tracking_category_option:
            weight: 1
            compare_cols: [is_active, is_archived, status, tracking_option_id, tracking_option_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_xero__general_ledger_fact:
            weight: 1
            compare_cols: [account_class, account_code, account_id, account_name, account_type, class, contact_id, contact_name, cost_center, created_date_utc, customer, department, description, gross_amount, journal_date, journal_id, journal_line_id, journal_number, location, net_amount, project, reference, region, source_id, source_type, tax_amount, tax_name, tax_type]
          int_xero__invoice_line_item_pivoted_tracking_categories:
            weight: 1
            compare_cols: [class, cost_center, customer, department, invoice_id, line_item_id, location, project, region]
          int_xero__invoice_line_items_enriched:
            weight: 1
            compare_cols: [account_class, account_code, account_name, account_type, class, contact_id, contact_name, cost_center, customer, department, description, discount_rate, effective_tax_rate, invoice_id, line_amount, line_item_id, location, project, quantity, region, tax_amount, tax_type, unit_amount]
          int_xero__journal_line_pivoted_tracking_categories:
            weight: 1
            compare_cols: [class, cost_center, customer, department, journal_id, journal_line_id, location, project, region]
          int_xero__tracking_categories_with_options:
            weight: 1
            compare_cols: [is_active, is_archived, option_status, status, tracking_category_id, tracking_category_name, tracking_option_id, tracking_option_name]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          xero__balance_sheet_report:
            weight: 1
            compare_cols: [account_name, amount, balance_sheet_category, balance_sheet_subcategory, category_total, department, project, region, report_date, subcategory_total]
          xero__general_ledger:
            weight: 1
            compare_cols: [account_class, account_code, account_id, account_name, account_type, class, contact_id, contact_name, cost_center, created_date_utc, customer, department, description, gross_amount, journal_date, journal_id, journal_line_id, journal_number, location, net_amount, project, reference, region, source_id, source_type, tax_amount, tax_name, tax_type]
          xero__invoice_line_items:
            weight: 1
            compare_cols: [account_class, account_code, account_name, account_type, class, contact_id, contact_name, cost_center, customer, department, description, discount_rate, invoice_cum_gross_nonneg, invoice_gross_nonneg, invoice_id, invoice_line_count, invoice_net_nonneg, line_amount, line_amount_nonneg, line_item_id, line_item_type, line_net_of_tax, line_seq_in_invoice, line_share_gross, line_share_net, quantity, tax_amount, tax_amount_nonneg, tax_type, unit_amount]
          xero__profit_and_loss_report:
            weight: 1
            compare_cols: [account_name, cumulative_net, department, expenses, fiscal_month, fiscal_year, net_amount, period_type, pl_category, pl_subcategory, region, revenue]
  dacomp-de-impl-028:
    database_file: youtube_analytics.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_youtube__channel_basic:
            weight: 1
            compare_cols: [annotation_click_through_rate, annotation_clickable_impressions, annotation_clicks, annotation_closable_impressions, annotation_close_rate, annotation_closes, annotation_impressions, average_view_duration_percentage, average_view_duration_seconds, card_click_rate, card_clicks, card_impressions, channel_id, channel_title, date_day, deleted, dislikes, estimated_minutes_watched, estimated_red_minutes_watched, likes, shares, subscribers_gained, subscribers_lost, video_id, video_title, views]
          stg_youtube__channel_demographics:
            weight: 1
            compare_cols: [age_group, channel_id, country_code, date_day, gender, video_id, views_percentage]
          stg_youtube__video:
            weight: 1
            compare_cols: [channel_id, channel_title, id, video_category_id, video_definition, video_description, video_dimension, video_duration, video_license, video_live_broadcast_content, video_privacy_status, video_projection, video_statistics_comment_count, video_statistics_dislike_count, video_statistics_favorite_count, video_statistics_like_count, video_statistics_view_count, video_title, video_upload_status]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_youtube__age_pivot:
            weight: 1
            compare_cols: [13-17, 18-24, 25-34, 35-44, 45-54, 55-64, 65-, country_code, date_day, pct_total_before_normalization, video_id]
          int_youtube__channel_basic:
            weight: 1
            compare_cols: [average_view_duration_percentage, average_view_duration_seconds, avg_view_duration_seconds_weighted, channel_id, date_day, dislike_rate, dislikes, like_rate, likes, net_subscribers, prev_day_views, red_watch_time_minutes, share_rate, shares, subscribers_gained, subscribers_lost, video_id, views, views_rolling_7d, watch_time_minutes, watch_time_minutes_rolling_7d]
          int_youtube__channel_demographics:
            weight: 1
            compare_cols: [age_group, channel_id, country_code, gender, video_id, views_percentage]
          int_youtube__gender_pivot:
            weight: 1
            compare_cols: [country_code, female, male, pct_total_before_normalization, video_id]
          int_youtube__video:
            weight: 1
            compare_cols: [channel_id, default_thumbnail_url, high_thumbnail_url, medium_thumbnail_url, video_category_id, video_default_audio_language, video_default_language, video_definition, video_description, video_dimension, video_duration, video_id, video_privacy_status, video_projection, video_statistics_comment_count, video_statistics_dislike_count, video_statistics_favorite_count, video_statistics_like_count, video_statistics_view_count, video_tags, video_title, video_upload_status]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          youtube__age_demographics_pivot:
            weight: 1
            compare_cols: [13-17_view_percentage, 18-24_view_percentage, 25-34_view_percentage, 35-44_view_percentage, 45-54_view_percentage, 55-64_view_percentage, 65-_view_percentage, country_code, video_id, video_published_date, video_title]
          youtube__demographics_report:
            weight: 1
            compare_cols: [age_groups_count, country_code, genders_count, records_count, total_views_percentage, video_id, video_published_date, video_title]
          youtube__gender_demographics_pivot:
            weight: 1
            compare_cols: [country_code, female_view_percentage, male_view_percentage, video_id, video_published_date, video_title]
          youtube__video_metadata:
            weight: 1
            compare_cols: [channel_id, default_thumbnail_url, high_thumbnail_url, medium_thumbnail_url, video_category_id, video_description, video_id, video_title]
          youtube__video_report:
            weight: 1
            compare_cols: [avg_view_duration_seconds, dislike_rate, like_rate, net_subscribers, records_count, share_rate, total_dislikes, total_likes, total_red_watch_time_minutes, total_shares, total_subscribers_gained, total_subscribers_lost, total_views, total_watch_time_minutes]
  dacomp-de-impl-029:
    database_file: zendesk.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_zendesk__brand:
            weight: 1
            compare_cols: [brand_id]
          stg_zendesk__daylight_time:
            weight: 1
            compare_cols: [daylight_end_utc, daylight_offset, daylight_start_utc, time_zone, year]
          stg_zendesk__domain_name:
            weight: 1
            compare_cols: [domain_name, organization_id]
          stg_zendesk__group:
            weight: 1
            compare_cols: [group_id]
          stg_zendesk__organization:
            weight: 1
            compare_cols: [created_at, details, external_id, name, organization_id, updated_at]
          stg_zendesk__organization_tag:
            weight: 1
            compare_cols: [organization_id, tag]
          stg_zendesk__schedule:
            weight: 1
            compare_cols: [schedule_id]
          stg_zendesk__schedule_holiday:
            weight: 1
            compare_cols: [end_date, schedule_holiday_id, start_date]
          stg_zendesk__ticket:
            weight: 1
            compare_cols: [assignee_id, brand_id, created_channel, description, due_at, external_id, group_id, is_public, organization_id, priority, problem_id, recipient, requester_id, source_from_id, source_from_title, source_rel, source_to_address, source_to_name, status, subject, submitter_id, ticket_form_id, ticket_id, type, updated_at, url]
          stg_zendesk__ticket_chat:
            weight: 1
            compare_cols: [authenticated, backend, channel, chat_id, conversation_id, initiator, integration_id, tags, ticket_id, user_id, visitor_id, webpath]
          stg_zendesk__ticket_chat_event:
            weight: 1
            compare_cols: [actor_id, chat_id, chat_index, external_message_id, filename, is_history_context, message, message_id, message_source, mime_type, original_message, original_message_type, parent_message_id, reason, size, status, status_updated_at, type, url]
          stg_zendesk__ticket_comment:
            weight: 1
            compare_cols: [body, is_facebook_comment, is_public, is_tweet, ticket_comment_id, ticket_id, user_id]
          stg_zendesk__ticket_field_history:
            weight: 1
            compare_cols: [field_name, ticket_id, updated, user_id, value]
          stg_zendesk__ticket_form_history:
            weight: 1
            compare_cols: [active, display_name, end_user_visible, name, ticket_form_id, updated_at]
          stg_zendesk__ticket_schedule:
            weight: 1
            compare_cols: [created_at, schedule_id, ticket_id]
          stg_zendesk__ticket_tag:
            weight: 1
            compare_cols: [tags, ticket_id]
          stg_zendesk__time_zone:
            weight: 1
            compare_cols: [standard_offset, time_zone]
          stg_zendesk__user:
            weight: 1
            compare_cols: [created_at, email, external_id, is_active, is_suspended, last_login_at, locale, name, organization_id, phone, role, ticket_restriction, time_zone, updated_at, user_id]
          stg_zendesk__user_tag:
            weight: 1
            compare_cols: [tag, user_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_zendesk__assignee_updates:
            weight: 1
            compare_cols: [assignee_id, ticket_id, user_id, valid_ending_at, valid_starting_at]
          int_zendesk__latest_ticket_form:
            weight: 1
            compare_cols: [active, display_name, latest_form_index, name, ticket_form_id, updated_at]
          int_zendesk__organization_aggregates:
            weight: 1
            compare_cols: [name, organization_id]
          int_zendesk__requester_updates:
            weight: 1
            compare_cols: [requester_id, ticket_id, user_id, valid_ending_at, valid_starting_at]
          int_zendesk__ticket_aggregates:
            weight: 1
            compare_cols: [assignee_id, brand_id, created_channel, description, external_id, group_id, is_public, organization_id, priority, problem_id, recipient, requester_id, source_from_id, source_from_title, source_rel, source_to_address, source_to_name, status, subject, submitter_id, ticket_form_active, ticket_form_id, ticket_form_name, ticket_id, type, url]
          int_zendesk__ticket_comment_stats:
            weight: 1
            compare_cols: [comment_count, first_agent_public_reply_at, private_comment_count, public_comment_count, ticket_id]
          int_zendesk__ticket_historical_satisfaction:
            weight: 1
            compare_cols: [field_name, ticket_id, valid_ending_at, valid_starting_at, value]
          int_zendesk__ticket_metrics:
            weight: 1
            compare_cols: [age_days, comment_count, first_response_minutes, private_comment_count, public_comment_count, resolution_minutes, status, ticket_id]
          int_zendesk__ticket_status_transitions:
            weight: 1
            compare_cols: [resolved_at, ticket_id]
          int_zendesk__updates:
            weight: 1
            compare_cols: [field_name, is_public, ticket_id, user_id, value]
          int_zendesk__user_aggregates:
            weight: 1
            compare_cols: [email, external_id, is_active, is_internal_role, is_suspended, locale, name, organization_id, phone, role, ticket_restriction, time_zone, user_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          zendesk__ticket_enriched:
            weight: 1
            compare_cols: [assignee_email, assignee_id, assignee_is_internal, assignee_name, brand_id, created_channel, description, group_id, organization_id, organization_name, organization_tags, priority, requester_email, requester_id, requester_is_internal, requester_name, status, subject, ticket_form_active, ticket_form_id, ticket_form_name, ticket_id, ticket_tags, type, updated_at, url]
          zendesk__ticket_metrics:
            weight: 1
            compare_cols: [age_days, comment_count, first_response_minutes, private_comment_count, public_comment_count, resolution_minutes, status, ticket_id]
          zendesk__ticket_summary:
            weight: 1
            compare_cols: [created_channel, distinct_assignees, distinct_organizations, distinct_requesters, priority, status, ticket_count]
  dacomp-de-impl-030:
    database_file: zuora.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_zuora__account:
            weight: 1
            compare_cols: [account_id, account_number, auto_pay, balance, batch, bill_cycle_day, bill_to_contact_id, created_by_id, credit_balance, crm_id, currency, default_payment_method_id, is_most_recent_record, last_invoice_date, mrr, name, notes, parent_account_id, payment_term, sold_to_contact_id, status, tax_exempt_effective_date, tax_exempt_expiration_date, tax_exempt_status, total_debit_memo_balance, total_invoice_balance, updated_by_id, updated_date, vatid]
          stg_zuora__amendment:
            weight: 1
            compare_cols: [amendment_id, auto_renew, code, created_by_id, current_term, current_term_period_type, description, is_most_recent_record, name, new_rate_plan_id, removed_rate_plan_id, renewal_setting, renewal_term, renewal_term_period_type, status, subscription_id, term_type, type, updated_by_id]
          stg_zuora__contact:
            weight: 1
            compare_cols: [account_id, address_1, address_2, city, contact_id, country, created_by_id, description, first_name, is_most_recent_account_contact, is_most_recent_record, last_name, mobile_phone, postal_code, state, updated_by_id, updated_date, work_email, work_phone]
          stg_zuora__credit_balance_adjustment:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, adjustment_date, amount, amount_home_currency, bill_to_contact_id, cancelled_on, comment, created_by_id, credit_balance_adjustment_id, default_payment_method_id, exchange_rate, exchange_rate_date, home_currency, invoice_id, is_most_recent_record, journal_entry_id, number, parent_account_id, reason_code, reference_id, sold_to_contact_id, source_transaction_id, source_transaction_number, source_transaction_type, status, transaction_currency, transferred_to_accounting, type, updated_by_id, updated_date]
          stg_zuora__invoice:
            weight: 1
            compare_cols: [account_id, adjustment_amount, amount, amount_home_currency, amount_without_tax, amount_without_tax_home_currency, auto_pay, balance, bill_to_contact_id, comments, created_by_id, credit_balance_adjustment_amount, credit_memo_amount, default_payment_method_id, due_date, exchange_rate, exchange_rate_date, home_currency, includes_one_time, includes_recurring, includes_usage, invoice_date, invoice_id, invoice_number, is_most_recent_record, last_email_sent_date, parent_account_id, payment_amount, payment_term, posted_by, posted_date, refund_amount, sold_to_contact_id, source, source_id, source_type, status, target_date, tax_amount, tax_status, transaction_currency, transferred_to_accounting, updated_by_id, updated_date]
          stg_zuora__invoice_item:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amendment_id, applied_to_invoice_item_id, balance, bill_to_contact_id, charge_amount, charge_amount_home_currency, charge_date, charge_name, created_by_id, deferred_revenue_accounting_code_id, exchange_rate, exchange_rate_date, home_currency, invoice_id, invoice_item_id, is_most_recent_record, journal_entry_id, parent_account_id, processing_type, product_id, product_rate_plan_charge_id, product_rate_plan_id, quantity, rate_plan_charge_id, rate_plan_id, recognized_revenue_accounting_code_id, rev_rec_start_date, service_end_date, service_start_date, sku, sold_to_contact_id, source_item_type, subscription_id, tax_amount, tax_mode, transaction_currency, unit_price, uom, updated_by_id, updated_date]
          stg_zuora__invoice_payment:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_period_id, amount, amount_currency_rounding, amount_home_currency, bill_to_contact_id, cash_accounting_code_id, created_by_id, default_payment_method_id, exchange_rate, exchange_rate_date, home_currency, invoice_id, invoice_payment_id, is_most_recent_record, journal_entry_id, journal_run_id, parent_account_id, payment_id, payment_method_id, provider_exchange_rate_date, refund_amount, sold_to_contact_id, transaction_currency, updated_by_id, updated_date]
          stg_zuora__order:
            weight: 1
            compare_cols: [account_id, bill_to_contact_id, category, created_by_id, default_payment_method_id, description, error_code, error_message, is_most_recent_record, order_date, order_id, order_number, response, scheduled_date, sold_to_contact_id, state, status, updated_by_id, updated_date]
          stg_zuora__payment:
            weight: 1
            compare_cols: [account_id, accounting_code, amount, amount_home_currency, applied_amount, applied_credit_balance_amount, bill_to_contact_id, cancelled_on, comment, created_by_id, currency, effective_date, exchange_rate, exchange_rate_date, home_currency, is_most_recent_record, parent_account_id, payment_id, payment_method_id, payment_number, refund_amount, settled_on, sold_to_contact_id, status, submitted_on, transaction_currency, transferred_to_accounting, type, unapplied_amount, updated_by_id, updated_date]
          stg_zuora__payment_method:
            weight: 1
            compare_cols: [account_id, ach_account_type, active, bank_transfer_account_type, created_by_id, credit_card_type, is_most_recent_record, last_failed_sale_transaction_date, last_transaction_date_time, last_transaction_status, max_consecutive_payment_failures, num_consecutive_failures, payment_method_id, payment_method_name, payment_method_status, payment_method_type, paypal_type, sub_type, total_number_of_error_payments, total_number_of_processed_payments, updated_by_id, updated_date]
          stg_zuora__product:
            weight: 1
            compare_cols: [category, created_by_id, description, effective_end_date, effective_start_date, is_most_recent_record, name, product_id, sku, updated_by_id, updated_date]
          stg_zuora__product_rate_plan:
            weight: 1
            compare_cols: [created_by_id, description, effective_end_date, effective_start_date, is_most_recent_record, name, product_id, product_rate_plan_id]
          stg_zuora__rate_plan:
            weight: 1
            compare_cols: [account_id, amendment_id, bill_to_contact_id, created_by_id, default_payment_method_id, is_most_recent_record, name, original_rate_plan_id, product_id, product_rate_plan_id, rate_plan_id, sold_to_contact_id, subscription_id, updated_by_id, updated_date]
          stg_zuora__rate_plan_charge:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amendment_id, apply_discount_to, bill_cycle_type, bill_to_contact_id, bill_to_contact_snapshot_id, billing_period, billing_timing, booking_exchange_rate, booking_exchange_rate_date, charge_model, charge_number, charge_type, charged_through_date, credit_option, default_payment_method_id, deferred_revenue_accounting_code_id, description, discount_level, dmrc, dmrchome_currency, dtcv, dtcvhome_currency, effective_end_date, effective_start_date, end_date_condition, exchange_rate, exchange_rate_date, home_currency, is_prepaid, is_processed, mrr, mrrhome_currency, name, number_of_periods, original_id, original_order_date, price_change_option, processed_through_date, product_id, product_rate_plan_charge_id, product_rate_plan_id, quantity, rate_plan_id, recognized_revenue_accounting_code_id, specific_billing_period, specific_end_date, specific_list_price_base, subscription_id, tcv, tcvhome_currency, transaction_currency, trigger_date, trigger_event, uom, up_to_periods, up_to_periods_type, version, weekly_bill_cycle_day, is_most_recent_record]
          stg_zuora__refund:
            weight: 1
            compare_cols: [accounting_code, amount, cancelled_on, comment, created_by_id, is_most_recent_record, method_type, payment_method_id, refund_date, refund_id, refund_number, refund_transaction_time, source_type, status, submitted_on, transferred_to_accounting, type, updated_by_id, updated_date]
          stg_zuora__refund_invoice_payment:
            weight: 1
            compare_cols: [created_by_id, is_most_recent_record, refund_amount, refund_invoice_payment_id, updated_by_id, updated_date]
          stg_zuora__subscription:
            weight: 1
            compare_cols: [account_id, auto_renew, bill_to_contact_id, cancel_reason, current_term, current_term_period_type, default_payment_method_id, externally_managed_by, initial_term, initial_term_period_type, invoice_owner_id, is_invoice_separate, is_latest_version, is_most_recent_record, notes, original_id, parent_account_id, payment_term, previous_subscription_id, renewal_term, renewal_term_period_type, revision, sold_to_contact_id, status, subscription_id, subscription_name, term_type, updated_by_id, version]
          stg_zuora__taxation_item:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amendment_id, balance, bill_to_contact_id, created_by_id, credit_amount, exchange_rate, exempt_amount, exempt_amount_home_currency, home_currency, invoice_id, invoice_item_id, is_most_recent_record, journal_entry_id, name, payment_amount, product_id, product_rate_plan_charge_id, product_rate_plan_id, rate_plan_charge_id, rate_plan_id, sales_tax_payable_accounting_code_id, sold_to_contact_id, subscription_id, tax_amount, tax_amount_home_currency, tax_description, tax_mode, tax_rate, tax_rate_type, taxation_item_id, transaction_currency, updated_by_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_zuora__account_current:
            weight: 1
            compare_cols: [account_id, account_number, auto_pay, balance, batch, bill_cycle_day, bill_to_contact_id, created_by_id, credit_balance, crm_id, currency, default_payment_method_id, last_invoice_date, mrr, name, notes, parent_account_id, payment_term, sold_to_contact_id, status, tax_exempt_effective_date, tax_exempt_expiration_date, tax_exempt_status, total_debit_memo_balance, total_invoice_balance, updated_by_id, updated_date, vatid]
          int_zuora__amendment_current:
            weight: 1
            compare_cols: [amendment_id, auto_renew, code, created_by_id, current_term, current_term_period_type, description, new_rate_plan_id, removed_rate_plan_id, renewal_setting, renewal_term, renewal_term_period_type, subscription_id, term_type, updated_by_id]
          int_zuora__billing_enriched:
            weight: 1
            compare_cols: [credit_balance_adjustment_amount_home_currency, credit_balance_adjustments, discount_charges, discount_charges_home_currency, invoice_amount_paid_home_currency, invoice_id, invoice_items, payment_methods, payments, products, subscriptions, tax_amount_home_currency, units]
          int_zuora__contact_current:
            weight: 1
            compare_cols: [account_id, address_1, address_2, city, contact_id, country, created_by_id, description, first_name, is_most_recent_account_contact, last_name, mobile_phone, postal_code, state, updated_by_id, work_email, work_phone]
          int_zuora__invoice_base:
            weight: 1
            compare_cols: [account_id, home_currency, invoice_amount, invoice_amount_home_currency, invoice_amount_paid, invoice_amount_unpaid, invoice_id, invoice_number, purchase_type, refund_amount, status, tax_amount, total_amount_past_due, transaction_currency]
          int_zuora__invoice_item_base:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amendment_id, applied_to_invoice_item_id, balance, bill_to_contact_id, charge_amount, charge_amount_home_currency, charge_date, charge_day, charge_month, charge_name, charge_week, created_by_id, deferred_revenue_accounting_code_id, discount_amount, discount_amount_home_currency, exchange_rate, exchange_rate_date, home_currency, invoice_id, invoice_item_id, is_most_recent_record, journal_entry_id, parent_account_id, processing_type, product_id, product_rate_plan_charge_id, product_rate_plan_id, quantity, rate_plan_charge_id, rate_plan_id, recognized_revenue_accounting_code_id, service_end_date, service_start_date, service_start_day, service_start_month, service_start_week, sku, sold_to_contact_id, source_item_type, subscription_id, tax_amount, tax_mode, transaction_currency, unit_price, uom, updated_by_id]
          int_zuora__invoice_payment_current:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_period_id, amount, amount_currency_rounding, amount_home_currency, bill_to_contact_id, cash_accounting_code_id, created_by_id, default_payment_method_id, exchange_rate, exchange_rate_date, home_currency, invoice_id, invoice_payment_id, journal_entry_id, journal_run_id, parent_account_id, payment_id, payment_method_id, provider_exchange_rate_date, refund_amount, sold_to_contact_id, transaction_currency, updated_by_id, updated_date]
          int_zuora__mrr_date_spine:
            weight: 1
            compare_cols: [date_day, date_index, date_month, date_week, date_year]
          int_zuora__payment_current:
            weight: 1
            compare_cols: [account_id, accounting_code, amount, amount_home_currency, bill_to_contact_id, comment, created_by_id, currency, effective_date, exchange_rate, exchange_rate_date, home_currency, parent_account_id, payment_id, payment_method_id, payment_number, sold_to_contact_id, status, transaction_currency, transferred_to_accounting, type, updated_by_id]
          int_zuora__payment_method_current:
            weight: 1
            compare_cols: [account_id, ach_account_type, active, bank_transfer_account_type, created_by_id, credit_card_type, last_transaction_date_time, last_transaction_status, max_consecutive_payment_failures, num_consecutive_failures, payment_method_id, payment_method_name, payment_method_status, payment_method_type, paypal_type, sub_type, total_number_of_error_payments, total_number_of_processed_payments, updated_by_id]
          int_zuora__product_current:
            weight: 1
            compare_cols: [category, created_by_id, description, name, product_id, sku, updated_by_id]
          int_zuora__product_rate_plan_current:
            weight: 1
            compare_cols: [created_by_id, description, name, product_id, product_rate_plan_id]
          int_zuora__rate_plan_charge_current:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amended_by_order_on, amendment_id, apply_discount_to, bill_cycle_day, bill_cycle_type, bill_to_contact_id, bill_to_contact_snapshot_id, billing_period, billing_timing, booking_exchange_rate, booking_exchange_rate_date, charge_model, charge_number, charge_type, charged_through_date, created_by_id, credit_option, default_payment_method_id, deferred_revenue_accounting_code_id, description, discount_level, dmrc, dmrchome_currency, dtcv, dtcvhome_currency, end_date_condition, exchange_rate, home_currency, is_prepaid, is_processed, mrr, mrrhome_currency, number_of_periods, original_id, original_order_date, price_change_option, price_increase_percentage, product_id, product_rate_plan_charge_id, product_rate_plan_id, quantity, rate_plan_charge_id, rate_plan_id, recognized_revenue_accounting_code_id, segment, sold_to_contact_id, specific_billing_period, specific_end_date, specific_list_price_base, subscription_id, tcv, tcvhome_currency, transaction_currency, trigger_date, trigger_event, uom, up_to_periods, up_to_periods_type, updated_by_id, updated_date, version]
          int_zuora__rate_plan_current:
            weight: 1
            compare_cols: [account_id, amendment_id, bill_to_contact_id, created_by_id, default_payment_method_id, name, original_rate_plan_id, product_id, product_rate_plan_id, rate_plan_id, sold_to_contact_id, subscription_id, updated_by_id, updated_date]
          int_zuora__subscription_current:
            weight: 1
            compare_cols: [account_id, auto_renew, bill_to_contact_id, cancel_reason, cancelled_date, contract_acceptance_date, contract_effective_date, created_by_id, current_term, current_term_period_type, default_payment_method_id, externally_managed_by, initial_term, initial_term_period_type, invoice_owner_id, is_invoice_separate, is_latest_version, notes, original_created_date, original_id, parent_account_id, payment_term, previous_subscription_id, renewal_term, renewal_term_period_type, revision, service_activation_date, sold_to_contact_id, status, subscription_end_date, subscription_id, subscription_name, term_type, updated_by_id, version]
          int_zuora__transaction_date_spine:
            weight: 1
            compare_cols: [date_day, date_index, date_month, date_week, date_year]
          int_zuora__transactions_grouped:
            weight: 1
            compare_cols: [account_id, daily_invoice_amount, daily_invoice_amount_paid, daily_invoice_amount_unpaid, daily_invoices, daily_refunds, date_day, date_month, date_week, date_year]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          zuora__account_daily_overview:
            weight: 1
            compare_cols: [account_country, account_email, account_first_name, account_id, account_last_name, account_name, account_number, account_postal_code, account_state, account_status, daily_invoice_amount, daily_invoice_amount_paid, daily_invoice_amount_unpaid, daily_invoice_items, daily_invoices, daily_refunds, date_day, date_index, date_month, date_week, date_year]
          zuora__account_overview:
            weight: 1
            compare_cols: [account_city, account_country, account_credit_balance, account_email, account_first_name, account_id, account_last_name, account_name, account_number, account_postal_code, account_state, account_status, account_zuora_calculated_mrr, invoice_count, invoice_item_count, is_auto_pay, total_amount_not_paid, total_amount_paid, total_invoice_amount, total_taxes]
          zuora__billing_history:
            weight: 1
            compare_cols: [account_id, credit_balance_adjustment_amount_home_currency, credit_balance_adjustments, discount_charges, discount_charges_home_currency, home_currency, invoice_amount, invoice_amount_home_currency, invoice_amount_paid, invoice_amount_paid_home_currency, invoice_amount_unpaid, invoice_amount_unpaid_home_currency, invoice_id, invoice_items, invoice_number, invoice_service_end_date, invoice_service_start_date, most_recent_charge_date, most_recent_credit_balance_adjustment_date, most_recent_payment_date, payment_methods, payments, products, purchase_type, refund_amount, status, subscriptions, tax_amount, tax_amount_home_currency, transaction_currency, units]
          zuora__line_item_enhanced:
            weight: 1
            compare_cols: [billing_type, currency, customer_city, customer_company, customer_country, customer_email, customer_id, customer_level, customer_name, discount_amount, header_id, header_status, line_item_id, line_item_index, payment_id, payment_method, payment_method_id, product_id, product_name, product_type, quantity, refund_amount, subscription_id, subscription_plan, subscription_status, tax_amount, total_amount, transaction_type]
          zuora__line_item_history:
            weight: 1
            compare_cols: [account_id, account_status, amendment_id, amendment_name, amendment_status, amendment_type, balance, charge_amount, charge_amount_home_currency, charge_billing_period, charge_billing_timing, charge_model, charge_name, charge_segment, charge_type, discount_amount, discount_amount_home_currency, invoice_item_id, invoice_number, product_category, product_description, product_id, product_name, product_rate_plan_charge_id, product_rate_plan_description, product_rate_plan_id, product_rate_plan_name, rate_plan_charge_id, rate_plan_charge_name, sku, subscription_id, tax_amount, transaction_currency, unit_price, uom]
          zuora__monthly_recurring_revenue:
            weight: 1
            compare_cols: [account_id, account_month, discount_current_month_mrr, discount_current_month_non_mrr, gross_current_month_mrr, gross_current_month_non_mrr, net_current_month_mrr, net_current_month_non_mrr]
          zuora__subscription_overview:
            weight: 1
            compare_cols: [account_id, account_name, amendment_id, amendment_name, amendment_status, amendment_type, auto_renew, cancel_reason, charge_billing_period, charge_billing_timing, charge_model, charge_mrr, charge_mrr_home_currency, charge_type, current_term, current_term_period_type, initial_term, initial_term_period_type, is_latest_version, previous_subscription_id, rate_plan_charge_id, rate_plan_charge_name, renewal_term, renewal_term_period_type, status, subscription_id, term_end_date, term_start_date, term_type, version]
  dacomp-de-evol-001:
    database_file: lever.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_lever__application:
            weight: 1
            compare_cols: [application_id, archived_reason_id, candidate_id, comments, company, opportunity_id, posting_hiring_manager_user_id, posting_id, posting_owner_user_id, referrer_user_id, requisition_id, type]
          stg_lever__archive_reason:
            weight: 1
            compare_cols: [archive_reason_id, archive_reason_title]
          stg_lever__contact_email:
            weight: 1
            compare_cols: [contact_id, email]
          stg_lever__contact_link:
            weight: 1
            compare_cols: [contact_id, link]
          stg_lever__contact_phone:
            weight: 1
            compare_cols: [contact_id, phone_number, phone_type]
          stg_lever__feedback_form:
            weight: 1
            compare_cols: [creator_user_id, feedback_form_id, feedback_form_name, instructions, type]
          stg_lever__feedback_form_field:
            weight: 1
            compare_cols: [feedback_form_id, field_index, field_text, field_type]
          stg_lever__interview:
            weight: 1
            compare_cols: [candidate_id, creator_user_id, duration, feedback_reminder, gcal_event_url, interview_date, interview_id, location, note, opportunity_id, panel_id, stage_id, subject, timezone]
          stg_lever__interview_feedback:
            weight: 1
            compare_cols: [feedback_form_id, interview_id]
          stg_lever__interviewer_user:
            weight: 1
            compare_cols: [interview_id, user_id]
          stg_lever__offer:
            weight: 1
            compare_cols: [candidate_id, creator_user_id, offer_id, opportunity_id, status]
          stg_lever__opportunity:
            weight: 1
            compare_cols: [archived_reason_id, contact_headline, contact_id, contact_location, contact_name, is_anonymized, is_data_protection_contact_allowed, is_data_protection_store_allowed, opportunity_id, origin, owner_user_id, snoozed_until, stage_id]
          stg_lever__opportunity_source:
            weight: 1
            compare_cols: [opportunity_id, source_name]
          stg_lever__opportunity_stage_history:
            weight: 1
            compare_cols: [opportunity_id, stage_id, to_stage_index, updater_user_id]
          stg_lever__opportunity_tag:
            weight: 1
            compare_cols: [opportunity_id, tag]
          stg_lever__posting:
            weight: 1
            compare_cols: [categories_commitment, categories_department, categories_level, categories_location, categories_team, content_closing, content_closing_html, content_description, content_description_html, creator_user_id, owner_user_id, posting_id, posting_title, requisition_code, state]
          stg_lever__posting_interview:
            weight: 1
            compare_cols: [interview_id, posting_id]
          stg_lever__posting_tag:
            weight: 1
            compare_cols: [posting_id, tag]
          stg_lever__requisition:
            weight: 1
            compare_cols: [backfill, compensation_band_currency, compensation_band_interval, compensation_band_max, compensation_band_min, creator_user_id, employment_status, headcount_hired, headcount_infinite, headcount_total, hiring_manager_user_id, internal_notes, location, owner_user_id, requisition_code, requisition_id, requisition_name, status, team]
          stg_lever__requisition_offer:
            weight: 1
            compare_cols: [offer_id, requisition_id]
          stg_lever__requisition_posting:
            weight: 1
            compare_cols: [posting_id, requisition_id]
          stg_lever__resume:
            weight: 1
            compare_cols: [file_download_url, file_ext, file_name, opportunity_id, resume_id]
          stg_lever__stage:
            weight: 1
            compare_cols: [stage_id, stage_name]
          stg_lever__user:
            weight: 1
            compare_cols: [access_role, email, external_directory_user_id, photo, user_id, user_name, username]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 49
        tables:
          int_lever__candidate_insights:
            weight: 7
            compare_cols: [avg_interview_duration, canceled_interviews, candidate_age_group, candidate_education_level, candidate_experience_quality, candidate_experience_years, candidate_gender, candidate_quality_score, candidate_status_category, completed_feedback, completed_interviews, contact_id, contact_name, current_stage, current_stage_order, days_to_last_advancement, experience_tier, feedback_completion_rate, interview_completion_rate, is_archived, negative_feedback, opportunity_id, owner_user_id, positive_feedback, positive_feedback_rate, process_speed_category, stage_id, total_feedback, total_interview_time, total_interviews]
          int_lever__candidate_lifecycle:
            weight: 0
            compare_cols: []
          int_lever__contact_info:
            weight: 0
            compare_cols: []
          int_lever__diversity_analytics:
            weight: 1
            compare_cols: [bias_risk_flag, diversity_score]
          int_lever__hiring_funnel_metrics:
            weight: 1
            compare_cols: [application_to_hired_rate, application_to_screening_rate, avg_days_screening_to_technical, avg_days_to_screening, avg_total_days_to_hire, categories_department, categories_level, categories_location, categories_team, final_to_offer_rate, hiring_efficiency_grade, offer_to_hired_rate, posting_id, posting_title, primary_bottleneck, reached_final_count, reached_hired_count, reached_offer_count, reached_screening_count, reached_technical_count, screening_to_technical_rate, technical_to_final_rate, total_applications]
          int_lever__interview_feedback:
            weight: 0
            compare_cols: []
          int_lever__interview_users:
            weight: 0
            compare_cols: []
          int_lever__interviewer_performance:
            weight: 1
            compare_cols: [advancement_rate, avg_interview_duration_minutes, canceled_interviews, completed_interviews, interviewer_diversity_score, interviewer_email, interviewer_joined_date, interviewer_name, interviewer_role, interviewer_user_id, interviews_per_month, performance_tier]
          int_lever__opportunity_application:
            weight: 0
            compare_cols: []
          int_lever__opportunity_contact_info:
            weight: 0
            compare_cols: []
          int_lever__opportunity_tags:
            weight: 0
            compare_cols: []
          int_lever__opportunity_users:
            weight: 0
            compare_cols: []
          int_lever__posting_analytics:
            weight: 0
            compare_cols: []
          int_lever__posting_applications:
            weight: 0
            compare_cols: []
          int_lever__posting_interviews:
            weight: 0
            compare_cols: []
          int_lever__posting_performance:
            weight: 0
            compare_cols: []
          int_lever__posting_tags:
            weight: 0
            compare_cols: []
          int_lever__requisition_users:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 50
        tables:
          lever__candidate_experience_insights:
            weight: 0
            compare_cols: []
          lever__candidate_quality_insights:
            weight: 0
            compare_cols: []
          lever__departmental_hiring_trends:
            weight: 0
            compare_cols: []
          lever__diversity_inclusion_report:
            weight: 9
            compare_cols: []
          lever__hiring_dashboard:
            weight: 0
            compare_cols: []
          lever__hiring_dashboard_simple:
            weight: 0
            compare_cols: []
          lever__hiring_dashboard_working:
            weight: 0
            compare_cols: []
          lever__hiring_manager_scorecard:
            weight: 0
            compare_cols: []
          lever__interview_enhanced:
            weight: 0
            compare_cols: []
          lever__opportunity_enhanced:
            weight: 0
            compare_cols: []
          lever__opportunity_stage_history:
            weight: 0
            compare_cols: []
          lever__posting_enhanced:
            weight: 0
            compare_cols: []
          lever__recruitment_analytics_dashboard:
            weight: 1
            compare_cols: [total_applications]
          lever__recruitment_analytics_dashboard_simple:
            weight: 0
            compare_cols: []
          lever__requisition_enhanced:
            weight: 0
            compare_cols: []
          test_timestamp:
            weight: 0
            compare_cols: []
  dacomp-de-evol-002:
    database_file: lever.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_lever__application:
            weight: 1
            compare_cols: [application_id, archived_reason_id, candidate_id, comments, company, opportunity_id, posting_hiring_manager_user_id, posting_id, posting_owner_user_id, referrer_user_id, requisition_id, type]
          stg_lever__archive_reason:
            weight: 1
            compare_cols: [archive_reason_id, archive_reason_title]
          stg_lever__contact_email:
            weight: 1
            compare_cols: [contact_id, email]
          stg_lever__contact_link:
            weight: 1
            compare_cols: [contact_id, link]
          stg_lever__contact_phone:
            weight: 1
            compare_cols: [contact_id, phone_number, phone_type]
          stg_lever__feedback_form:
            weight: 1
            compare_cols: [created_at, creator_user_id, feedback_form_id, feedback_form_name, instructions, type]
          stg_lever__feedback_form_field:
            weight: 1
            compare_cols: [feedback_form_id, field_index, field_text, field_type]
          stg_lever__interview:
            weight: 1
            compare_cols: [candidate_id, creator_user_id, duration, feedback_reminder, gcal_event_url, interview_date, interview_id, location, note, opportunity_id, panel_id, stage_id, subject, timezone]
          stg_lever__interview_feedback:
            weight: 1
            compare_cols: [feedback_form_id, interview_id]
          stg_lever__interviewer_user:
            weight: 1
            compare_cols: [interview_id, user_id]
          stg_lever__offer:
            weight: 1
            compare_cols: [candidate_id, creator_user_id, offer_id, opportunity_id, status]
          stg_lever__opportunity:
            weight: 1
            compare_cols: [archived_reason_id, contact_headline, contact_id, contact_location, contact_name, is_anonymized, is_data_protection_contact_allowed, is_data_protection_store_allowed, opportunity_id, origin, owner_user_id, snoozed_until, stage_id]
          stg_lever__opportunity_source:
            weight: 1
            compare_cols: [opportunity_id, source_name]
          stg_lever__opportunity_stage_history:
            weight: 1
            compare_cols: [opportunity_id, stage_id, to_stage_index, updated_at, updater_user_id]
          stg_lever__opportunity_tag:
            weight: 1
            compare_cols: [opportunity_id, tag]
          stg_lever__posting:
            weight: 1
            compare_cols: [categories_commitment, categories_department, categories_level, categories_location, categories_team, content_closing, content_closing_html, content_description, content_description_html, creator_user_id, owner_user_id, posting_id, posting_title, requisition_code, state]
          stg_lever__posting_interview:
            weight: 1
            compare_cols: [interview_id, posting_id]
          stg_lever__posting_tag:
            weight: 1
            compare_cols: [posting_id, tag]
          stg_lever__requisition:
            weight: 1
            compare_cols: [backfill, compensation_band_currency, compensation_band_interval, compensation_band_max, compensation_band_min, creator_user_id, employment_status, headcount_hired, headcount_infinite, headcount_total, hiring_manager_user_id, internal_notes, location, owner_user_id, requisition_code, requisition_id, requisition_name, status, team]
          stg_lever__requisition_offer:
            weight: 1
            compare_cols: [offer_id, requisition_id]
          stg_lever__requisition_posting:
            weight: 1
            compare_cols: [posting_id, requisition_id]
          stg_lever__resume:
            weight: 1
            compare_cols: [created_at, file_download_url, file_ext, file_name, file_uploaded_at, opportunity_id, resume_id]
          stg_lever__stage:
            weight: 1
            compare_cols: [stage_id, stage_name]
          stg_lever__user:
            weight: 1
            compare_cols: [access_role, deactivated_at, email, external_directory_user_id, photo, user_id, user_name, username]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_lever__candidate_insights:
            weight: 0
            compare_cols: []
          int_lever__candidate_lifecycle:
            weight: 0
            compare_cols: []
          int_lever__candidate_performance_volatility_analysis:
            weight: 2
            compare_cols: [candidate_performance_volatility, multi_round_consistency_coefficient]
          int_lever__contact_info:
            weight: 0
            compare_cols: []
          int_lever__cross_cultural_bias_calibration:
            weight: 2
            compare_cols: []
          int_lever__hiring_funnel_metrics:
            weight: 1
            compare_cols: [application_to_hired_rate, application_to_screening_rate, avg_days_screening_to_technical, avg_days_to_screening, avg_total_days_to_hire, categories_department, categories_level, categories_location, categories_team, final_to_offer_rate, hiring_efficiency_grade, offer_to_hired_rate, posting_id, posting_title, primary_bottleneck, reached_final_count, reached_hired_count, reached_offer_count, reached_screening_count, reached_technical_count, screening_to_technical_rate, technical_to_final_rate, total_applications]
          int_lever__interview_feedback:
            weight: 0
            compare_cols: []
          int_lever__interview_users:
            weight: 0
            compare_cols: []
          int_lever__interviewer_cognitive_state_monitoring:
            weight: 2
            compare_cols: [fatigue_prediction_score, interviewer_cognitive_load_index]
          int_lever__interviewer_performance:
            weight: 1
            compare_cols: [activity_status, advancement_rate, avg_feedback_completion_hours, avg_interview_duration_minutes, avg_recommendation_score, canceled_interviews, completed_interviews, feedback_completion_rate, first_interview_date, interviewer_email, interviewer_joined_date, interviewer_name, interviewer_role, interviewer_user_id, interviews_per_month, last_interview_date, overall_performance_score, performance_tier, positive_outcome_rate]
          int_lever__multi_constraint_optimization_engine:
            weight: 2
            compare_cols: [constraint_satisfaction_score, global_optimization_priority]
          int_lever__opportunity_application:
            weight: 0
            compare_cols: []
          int_lever__opportunity_contact_info:
            weight: 0
            compare_cols: []
          int_lever__opportunity_tags:
            weight: 0
            compare_cols: []
          int_lever__opportunity_users:
            weight: 0
            compare_cols: []
          int_lever__posting_analytics:
            weight: 0
            compare_cols: []
          int_lever__posting_applications:
            weight: 0
            compare_cols: []
          int_lever__posting_interviews:
            weight: 0
            compare_cols: []
          int_lever__posting_performance:
            weight: 0
            compare_cols: []
          int_lever__posting_tags:
            weight: 0
            compare_cols: []
          int_lever__requisition_users:
            weight: 0
            compare_cols: []
          int_lever__timezone_coordination_matrix:
            weight: 2
            compare_cols: [cross_timezone_coordination_cost]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          lever__candidate_experience_insights:
            weight: 0
            compare_cols: []
          lever__candidate_quality_insights:
            weight: 0
            compare_cols: []
          lever__departmental_hiring_trends:
            weight: 0
            compare_cols: []
          lever__global_interview_quality_dashboard:
            weight: 4
            compare_cols: []
          lever__hiring_dashboard:
            weight: 1
            compare_cols: []
          lever__hiring_dashboard_simple:
            weight: 0
            compare_cols: []
          lever__hiring_dashboard_working:
            weight: 0
            compare_cols: []
          lever__hiring_manager_scorecard:
            weight: 0
            compare_cols: []
          lever__intelligent_scheduling_orchestrator:
            weight: 5
            compare_cols: [constraint_satisfaction_score, opportunity_id]
          lever__interview_enhanced:
            weight: 0
            compare_cols: []
          lever__opportunity_enhanced:
            weight: 0
            compare_cols: []
          lever__opportunity_stage_history:
            weight: 0
            compare_cols: []
          lever__posting_enhanced:
            weight: 0
            compare_cols: []
          lever__recruitment_analytics_dashboard:
            weight: 0
            compare_cols: []
          lever__recruitment_analytics_dashboard_simple:
            weight: 0
            compare_cols: []
          lever__requisition_enhanced:
            weight: 0
            compare_cols: []
          test_timestamp:
            weight: 0
            compare_cols: []
  dacomp-de-evol-003:
    database_file: pendo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_pendo__account_history:
            weight: 1
            compare_cols: [account_id, account_id_hash]
          stg_pendo__application_history:
            weight: 1
            compare_cols: [agent_policy_prod, agent_policy_staging, agent_version_prod, agent_version_staging, application_id, application_name, created_by_user_id, description, display_name, event_count, is_deleted, is_integrated, last_updated_by_user_id, platform, subscription_id]
          stg_pendo__event:
            weight: 1
            compare_cols: [account_id, app_id, event_key, num_events, num_minutes, page_id, remote_ip, server_name, user_agent, visitor_id]
          stg_pendo__feature_event:
            weight: 1
            compare_cols: [account_id, app_id, feature_event_key, feature_id, num_events, num_minutes, remote_ip, server_name, user_agent, visitor_id]
          stg_pendo__feature_history:
            weight: 1
            compare_cols: [app_id, created_by_user_id, feature_id, feature_name, group_id, is_core_event, is_dirty, last_updated_by_user_id, page_id, root_version_id, stable_version_id, valid_through]
          stg_pendo__group:
            weight: 1
            compare_cols: [app_id, group_id, group_name]
          stg_pendo__guide_event:
            weight: 1
            compare_cols: [account_id, app_id, country, guide_event_key, guide_id, guide_step_id, latitude, longitude, region, remote_ip, server_name, type, url, user_agent, visitor_id]
          stg_pendo__guide_history:
            weight: 1
            compare_cols: [app_id, created_by_user_id, device_type, guide_id, guide_name, is_multi_step, is_training, last_updated_at, last_updated_by_user_id, launch_method, recurrence, recurrence_eligibility_window, root_version_id, stable_version_id, state]
          stg_pendo__guide_step_history:
            weight: 1
            compare_cols: [guide_id, step_id]
          stg_pendo__page_event:
            weight: 1
            compare_cols: [account_id, app_id, num_events, num_minutes, page_event_key, page_id, remote_ip, server_name, user_agent, visitor_id]
          stg_pendo__page_history:
            weight: 1
            compare_cols: [app_id, created_by_user_id, group_id, is_dirty, last_updated_at, last_updated_by_user_id, page_id, page_name, root_version_id, stable_version_id, valid_through]
          stg_pendo__page_rule_history:
            weight: 1
            compare_cols: [designer_hint, page_id, page_last_updated_at, parsed_rule, rule]
          stg_pendo__poll:
            weight: 1
            compare_cols: [attribute_display, attribute_max_length, attribute_type, follow_up_poll_id, poll_id, question, reset_at]
          stg_pendo__poll_event:
            weight: 1
            compare_cols: [account_id, app_id, country, guide_id, guide_step_id, latitude, longitude, occurred_at, poll_event_key, poll_id, poll_response, region, remote_ip, server_name, type, url, user_agent, visitor_id]
          stg_pendo__user:
            weight: 1
            compare_cols: [first_name, last_name, user_id, user_type, username]
          stg_pendo__visitor_account_history:
            weight: 1
            compare_cols: [account_id, visitor_id, visitor_last_updated_at]
          stg_pendo__visitor_history:
            weight: 1
            compare_cols: [account_id, first_visit_at, last_browser_name, last_browser_version, last_operating_system, last_server_name, last_updated_at, last_user_agent, last_visit, n_id, visitor_id, visitor_id_hash]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_pendo__account_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__calendar_spine:
            weight: 0
            compare_cols: []
          int_pendo__conversion_funnel_analysis:
            weight: 1
            compare_cols: [account_id, app_id, avg_30d_overall_conversion_rate, avg_30d_page_to_feature_rate, avg_engagement_score, avg_features_per_user, avg_pages_per_visitor, bounce_rate, event_date, feature_to_deep_conversion_rate, funnel_health_rating, high_quality_session_rate, overall_conversion_rate, page_to_feature_conversion_rate, total_visitors, visitors_with_deep_engagement, visitors_with_feature_use, visitors_with_page_views]
          int_pendo__customer_rfm_analysis:
            weight: 0
            compare_cols: []
          int_pendo__data_quality_checks:
            weight: 0
            compare_cols: []
          int_pendo__feature_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__feature_info:
            weight: 0
            compare_cols: []
          int_pendo__guide_alltime_metrics:
            weight: 0
            compare_cols: []
          int_pendo__guide_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__guide_info:
            weight: 0
            compare_cols: []
          int_pendo__latest_account:
            weight: 0
            compare_cols: []
          int_pendo__latest_application:
            weight: 0
            compare_cols: []
          int_pendo__latest_feature:
            weight: 0
            compare_cols: []
          int_pendo__latest_guide:
            weight: 0
            compare_cols: []
          int_pendo__latest_guide_step:
            weight: 0
            compare_cols: []
          int_pendo__latest_nps_rating:
            weight: 0
            compare_cols: []
          int_pendo__latest_page:
            weight: 0
            compare_cols: []
          int_pendo__latest_page_rule:
            weight: 0
            compare_cols: []
          int_pendo__latest_visitor:
            weight: 0
            compare_cols: []
          int_pendo__latest_visitor_account:
            weight: 0
            compare_cols: []
          int_pendo__page_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__page_info:
            weight: 0
            compare_cols: []
          int_pendo__product_health_metrics:
            weight: 0
            compare_cols: []
          int_pendo__user_behavior_quality:
            weight: 8
            compare_cols: [user_behavior_quality_score, visitor_id]
          int_pendo__user_lifecycle_segments:
            weight: 1
            compare_cols: [activity_density, average_daily_events, average_daily_minutes, churn_risk_level, count_active_days, count_active_months, days_since_last_active, engagement_trend, first_event_on, is_new_user, is_valuable_user, last_event_on, lifecycle_stage, needs_attention, sum_events, sum_minutes, usage_intensity, user_age_days, user_value_score, visitor_id]
          int_pendo__visitor_daily_metrics:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          account:
            weight: 0
            compare_cols: []
          account_daily_metrics:
            weight: 0
            compare_cols: []
          customer_lifecycle_insights:
            weight: 1
            compare_cols: [visitor_id, account_id, sum_events, enhanced_lifecycle_stage, user_value_score, engagement_trend, churn_risk_level, is_valuable_user, needs_attention, is_new_user, activity_density, usage_intensity, rfm_segment, customer_value_tier, recency_score, frequency_score, magnitude_score, rfm_composite_score, customer_segment_label, comprehensive_customer_value, recommended_next_action, customer_journey_stage, predicted_ltv_tier, engagement_velocity, usage_trend]
          executive_dashboard_metrics:
            weight: 1
            compare_cols: [total_accounts, paying_accounts, strategic_customers, customers_needing_attention, new_customers_onboarding, avg_feature_adoption, high_risk_accounts, medium_risk_accounts, low_risk_accounts, fake_activity_risk_accounts, high_growth_accounts, excellent_revenue_accounts, conversion_opportunities, calculation_date, user_growth_rate_7d, growth_trend_assessment, avg_daily_active_users, user_activity_volatility, overall_business_health_score]
          feature:
            weight: 0
            compare_cols: []
          feature_daily_metrics:
            weight: 0
            compare_cols: []
          feature_event:
            weight: 0
            compare_cols: []
          guide:
            weight: 0
            compare_cols: []
          guide_daily_metrics:
            weight: 0
            compare_cols: []
          guide_event:
            weight: 0
            compare_cols: []
          page:
            weight: 0
            compare_cols: []
          page_daily_metrics:
            weight: 0
            compare_cols: []
          page_event:
            weight: 0
            compare_cols: []
          product_adoption_analytics:
            weight: 0
            compare_cols: []
          product_adoption_summary:
            weight: 0
            compare_cols: []
          visitor:
            weight: 0
            compare_cols: []
          visitor_daily_metrics:
            weight: 0
            compare_cols: []
          visitor_feature:
            weight: 0
            compare_cols: []
  dacomp-de-evol-004:
    database_file: pendo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_pendo__account_history:
            weight: 0
            compare_cols: []
          stg_pendo__application_history:
            weight: 1
            compare_cols: [agent_policy_prod, agent_policy_staging, agent_version_prod, agent_version_staging, application_id, application_name, created_by_user_id, display_name, last_updated_by_user_id, platform, subscription_id]
          stg_pendo__event:
            weight: 0
            compare_cols: []
          stg_pendo__feature_event:
            weight: 0
            compare_cols: []
          stg_pendo__feature_history:
            weight: 0
            compare_cols: []
          stg_pendo__group:
            weight: 0
            compare_cols: []
          stg_pendo__guide_event:
            weight: 0
            compare_cols: []
          stg_pendo__guide_history:
            weight: 0
            compare_cols: []
          stg_pendo__guide_step_history:
            weight: 0
            compare_cols: []
          stg_pendo__page_event:
            weight: 0
            compare_cols: []
          stg_pendo__page_history:
            weight: 0
            compare_cols: []
          stg_pendo__page_rule_history:
            weight: 0
            compare_cols: []
          stg_pendo__poll:
            weight: 0
            compare_cols: []
          stg_pendo__poll_event:
            weight: 0
            compare_cols: []
          stg_pendo__user:
            weight: 0
            compare_cols: []
          stg_pendo__visitor_account_history:
            weight: 0
            compare_cols: []
          stg_pendo__visitor_history:
            weight: 0
            compare_cols: []
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_pendo__account_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__application_history_analysis:
            weight: 0
            compare_cols: []
          int_pendo__application_lifecycle_management:
            weight: 3
            compare_cols: [application_id, config_complexity_index, platform, subscription_id, version_drift_score]
          int_pendo__calendar_spine:
            weight: 0
            compare_cols: []
          int_pendo__conversion_funnel_analysis:
            weight: 0
            compare_cols: []
          int_pendo__customer_rfm_analysis:
            weight: 0
            compare_cols: []
          int_pendo__data_quality_checks:
            weight: 1
            compare_cols: [report_section, metric_type, completeness_score, consistency_score, business_logic_score, quality_description]
          int_pendo__feature_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__feature_info:
            weight: 0
            compare_cols: []
          int_pendo__guide_alltime_metrics:
            weight: 0
            compare_cols: []
          int_pendo__guide_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__guide_info:
            weight: 0
            compare_cols: []
          int_pendo__latest_account:
            weight: 0
            compare_cols: []
          int_pendo__latest_application:
            weight: 1
            compare_cols: [agent_policy_prod, agent_policy_staging, agent_version_prod, agent_version_staging, application_id, application_name, created_by_user_id, display_name, last_updated_by_user_id, platform, subscription_id]
          int_pendo__latest_feature:
            weight: 0
            compare_cols: []
          int_pendo__latest_guide:
            weight: 0
            compare_cols: []
          int_pendo__latest_guide_step:
            weight: 0
            compare_cols: []
          int_pendo__latest_nps_rating:
            weight: 0
            compare_cols: []
          int_pendo__latest_page:
            weight: 0
            compare_cols: []
          int_pendo__latest_page_rule:
            weight: 0
            compare_cols: []
          int_pendo__latest_visitor:
            weight: 0
            compare_cols: []
          int_pendo__latest_visitor_account:
            weight: 0
            compare_cols: []
          int_pendo__page_daily_metrics:
            weight: 0
            compare_cols: []
          int_pendo__page_info:
            weight: 0
            compare_cols: []
          int_pendo__product_health_metrics:
            weight: 0
            compare_cols: []
          int_pendo__real_time_integration_health:
            weight: 3
            compare_cols: [integration_health_score]
          int_pendo__technical_debt_assessment:
            weight: 2
            compare_cols: [application_id, config_complexity_index, data_impact_score, pipeline_dependency_count, platform, subscription_id, technical_debt_priority, version_drift_score]
          int_pendo__user_lifecycle_segments:
            weight: 0
            compare_cols: []
          int_pendo__visitor_daily_metrics:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          account:
            weight: 0
            compare_cols: []
          account_daily_metrics:
            weight: 0
            compare_cols: []
          customer_lifecycle_insights:
            weight: 0
            compare_cols: []
          executive_dashboard_metrics:
            weight: 0
            compare_cols: []
          feature:
            weight: 0
            compare_cols: []
          feature_daily_metrics:
            weight: 0
            compare_cols: []
          feature_event:
            weight: 0
            compare_cols: []
          guide:
            weight: 0
            compare_cols: []
          guide_daily_metrics:
            weight: 0
            compare_cols: []
          guide_event:
            weight: 0
            compare_cols: []
          operational_efficiency_dashboard:
            weight: 2
            compare_cols: []
          page:
            weight: 0
            compare_cols: []
          page_daily_metrics:
            weight: 0
            compare_cols: []
          page_event:
            weight: 0
            compare_cols: []
          product_adoption_analytics:
            weight: 0
            compare_cols: []
          product_adoption_summary:
            weight: 0
            compare_cols: []
          visitor:
            weight: 0
            compare_cols: []
          visitor_daily_metrics:
            weight: 0
            compare_cols: []
          visitor_feature:
            weight: 0
            compare_cols: []
  dacomp-de-evol-005:
    database_file: customer360.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_customer360__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_code_numeric, country_name]
          stg_customer360__nicknames:
            weight: 1
            compare_cols: [canonical_name, nickname]
          stg_customer360__state_territory_codes:
            weight: 1
            compare_cols: [alpha2_country_code, state_code, state_territory]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_customer360__customer_behavior_analysis:
            weight: 0
            compare_cols: []
          int_customer360__customer_lifecycle_metrics:
            weight: 1
            compare_cols: [account_age_days, acquisition_cohort_month, acquisition_month, acquisition_season, acquisition_year, action_priority, churn_probability, customer_first_touchpoint, customer_health_score, customer_journey_pattern, customer_last_activity, customer_segment, customer_tier, days_since_last_activity, estimated_customer_ltv, estimated_customer_value, estimated_transaction_count, expected_retention_rate, frequency_score, growth_potential, intervention_urgency, is_strategic_account, lifecycle_stage, marketo_lead_id, months_since_acquisition, performance_vs_expectation, platform_consistency_score, primary_email, primary_organization, recency_score, retention_probability, revenue_at_risk, stripe_customer_id, zendesk_user_id]
          int_customer360__marketo:
            weight: 0
            compare_cols: []
          int_customer360__marketo_for_matching:
            weight: 0
            compare_cols: []
          int_customer360__predictive_analytics:
            weight: 4
            compare_cols: [ltv_confidence_score, revenue_forecast_accuracy, trend_analysis_month]
          int_customer360__risk_assessment:
            weight: 0
            compare_cols: []
          int_customer360__source_matches:
            weight: 0
            compare_cols: []
          int_customer360__stripe:
            weight: 0
            compare_cols: []
          int_customer360__stripe_for_matching:
            weight: 0
            compare_cols: []
          int_customer360__temporal_trends:
            weight: 5
            compare_cols: [momentum_score_eng, momentum_score_rev, monthly_engagement_score, monthly_revenue, months_of_data, trend_analysis_month, trend_direction_eng, trend_direction_rev]
          int_customer360__zendesk:
            weight: 0
            compare_cols: []
          int_customer360__zendesk_for_matching:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          customer360__address:
            weight: 0
            compare_cols: []
          customer360__conversion_funnel_analysis:
            weight: 1
            compare_cols: [activity_grade, awareness_engagement_quality, awareness_to_conversion_speed, conversion_engagement_quality, conversion_to_support_speed, cross_stage_engagement_consistency, customer_first_touchpoint, customer_health_score, customer_journey_pattern, customer_last_activity, customer_segment, customer_tier, drop_off_risk, estimated_customer_ltv, expected_optimization_value, funnel_efficiency, funnel_performance_grade, intervention_priority, journey_completeness_score, journey_efficiency_index, journey_velocity, lifecycle_stage, marketing_to_sales_days, marketo_lead_id, next_stage_conversion_probability, optimization_recommendation, predictive_full_journey_probability, primary_email, primary_engagement_channel, primary_organization, reached_awareness, reached_conversion, reached_support, revenue_velocity_monthly, sales_to_support_days, stripe_customer_id, success_target, support_engagement_quality, value_realization_pattern, weighted_engagement_score, zendesk_user_id]
          customer360__customer:
            weight: 0
            compare_cols: []
          customer360__customer_activity_metrics:
            weight: 0
            compare_cols: []
          customer360__customer_value_analysis:
            weight: 1
            compare_cols: [churn_probability, customer_health_score, customer_segment, customer_tier, estimated_customer_ltv, lifecycle_stage, primary_email, primary_organization, revenue_tier, rfm_segment, strategic_classification]
          customer360__email:
            weight: 0
            compare_cols: []
          customer360__ip_address:
            weight: 0
            compare_cols: []
          customer360__mapping:
            weight: 0
            compare_cols: []
          customer360__name:
            weight: 0
            compare_cols: []
          customer360__organization:
            weight: 0
            compare_cols: []
          customer360__organization_network:
            weight: 0
            compare_cols: []
          customer360__phone:
            weight: 0
            compare_cols: []
          customer360__status:
            weight: 0
            compare_cols: []
          customer360__summary:
            weight: 0
            compare_cols: []
          customer360__trend_analysis:
            weight: 8
            compare_cols: [dynamic_segment, early_warning_score, momentum_score_eng, momentum_score_rev, monthly_engagement_score, monthly_revenue, optimal_segment_target, recommended_intervention_type, segment_migration_probability, segment_stability_score, trend_analysis_month, trend_direction_eng, trend_direction_rev]
          customer360__updates:
            weight: 0
            compare_cols: []
  dacomp-de-evol-006:
    database_file: customer360.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_customer360__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_numeric, country_name]
          stg_customer360__nicknames:
            weight: 1
            compare_cols: [canonical_name, nickname]
          stg_customer360__state_territory_codes:
            weight: 1
            compare_cols: [alpha2_country_code, state_code, state_territory]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 69
        tables:
          int_customer360__business_rule_engine:
            weight: 4
            compare_cols: [source_system, record_id, base_trust_score, system_category, l1_total_violations, primary_violation_category]
          int_customer360__conflict_resolution_engine:
            weight: 4
            compare_cols: [marketo_lead_id, stripe_customer_id, zendesk_user_id]
          int_customer360__customer_behavior_analysis:
            weight: 0
            compare_cols: []
          int_customer360__customer_lifecycle_metrics:
            weight: 0
            compare_cols: []
          int_customer360__data_quality_assessment:
            weight: 4
            compare_cols: [data_freshness_hours, data_quality_score]
          int_customer360__dynamic_weight_adjustment:
            weight: 4
            compare_cols: []
          int_customer360__marketo:
            weight: 0
            compare_cols: []
          int_customer360__marketo_for_matching:
            weight: 0
            compare_cols: []
          int_customer360__risk_assessment:
            weight: 0
            compare_cols: []
          int_customer360__source_matches:
            weight: 1
            compare_cols: [marketo_lead_id, stripe_customer_id, zendesk_user_id]
          int_customer360__stripe:
            weight: 0
            compare_cols: []
          int_customer360__stripe_for_matching:
            weight: 0
            compare_cols: []
          int_customer360__zendesk:
            weight: 0
            compare_cols: []
          int_customer360__zendesk_for_matching:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          customer360__address:
            weight: 0
            compare_cols: []
          customer360__conversion_funnel_analysis:
            weight: 0
            compare_cols: []
          customer360__customer:
            weight: 0
            compare_cols: []
          customer360__customer_activity_metrics:
            weight: 0
            compare_cols: []
          customer360__customer_value_analysis:
            weight: 0
            compare_cols: []
          customer360__data_governance_dashboard:
            weight: 4
            compare_cols: [metric_category, source_system, total_records, avg_quality_score, avg_completeness, avg_accuracy, avg_validity, avg_consistency, total_field_conflicts, critical_violations, high_violations, medium_violations, low_violations, report_timestamp, overall_data_health_score, summary_critical_violations, summary_critical_conflicts, immediate_action_items, systems_meeting_quality_threshold_pct, governance_maturity_score, total_steward_workload, active_stewards]
          customer360__email:
            weight: 0
            compare_cols: []
          customer360__ip_address:
            weight: 0
            compare_cols: []
          customer360__mapping:
            weight: 0
            compare_cols: []
          customer360__name:
            weight: 0
            compare_cols: []
          customer360__organization:
            weight: 0
            compare_cols: []
          customer360__organization_network:
            weight: 0
            compare_cols: []
          customer360__phone:
            weight: 0
            compare_cols: []
          customer360__quality_exception_management:
            weight: 5
            compare_cols: []
          customer360__status:
            weight: 0
            compare_cols: []
          customer360__summary:
            weight: 1
            compare_cols: [city, conflict_resolution_weight, country, country_alt_name, cross_system_consistency_matrix, customer360_id, customer360_organization_id, data_steward_assignment, email, full_name, ip_address, is_organization_header, organization_name, phone, postal_code, source_ids, state]
          customer360__updates:
            weight: 0
            compare_cols: []
  dacomp-de-evol-007:
    database_file: salesforce.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_salesforce__account:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_state_code, billing_street, industry, is_deleted, last_activity_date, last_referenced_date, last_viewed_date, master_record_id, number_of_employees, owner_id, ownership, parent_id, rating, record_type_id, shipping_city, shipping_country, shipping_country_code, shipping_postal_code, shipping_state, shipping_state_code, shipping_street, type, website]
          stg_salesforce__account_history:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_street, history_unique_key, industry, is_deleted, last_activity_date, number_of_employees, owner_id, ownership, parent_id, rating, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, type, website]
          stg_salesforce__contact:
            weight: 1
            compare_cols: [account_id, assistant_name, assistant_phone, birthdate, contact_description, contact_id, contact_name, department, email, email_bounced_date, email_bounced_reason, fax, first_name, home_phone, is_deleted, is_email_bounced, last_name, last_referenced_date, last_viewed_date, lead_source, mailing_city, mailing_country, mailing_country_code, mailing_postal_code, mailing_state, mailing_state_code, mailing_street, master_record_id, mobile_phone, other_city, other_country, other_phone, other_postal_code, other_state, other_street, owner_id, phone, photo_url, reports_to_id, salutation, title]
          stg_salesforce__contact_history:
            weight: 1
            compare_cols: [account_id, contact_description, contact_id, contact_name, email, first_name, history_unique_key, is_deleted, last_activity_date, last_modified_date, last_name, lead_source, mailing_city, mailing_country, mailing_postal_code, mailing_state, mailing_street, mobile_phone, owner_id, phone, title]
          stg_salesforce__event:
            weight: 1
            compare_cols: [activity_date, activity_date_time, duration_in_minutes, end_date_time, event_description, event_id, is_deleted, location, owner_id, start_date_time, subject, type, what_id, who_id]
          stg_salesforce__lead:
            weight: 1
            compare_cols: [annual_revenue, city, company, converted_account_id, converted_contact_id, converted_date, converted_opportunity_id, country, country_code, created_by_id, email, email_bounced_date, email_bounced_reason, fax, first_name, geocode_accuracy, has_opted_out_of_email, industry, is_converted, is_deleted, is_unread_by_owner, last_activity_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, latitude, lead_description, lead_id, lead_name, lead_source, longitude, master_record_id, mobile_phone, number_of_employees, owner_id, phone, photo_url, postal_code, salutation, state, state_code, status, street, system_modstamp, title, website]
          stg_salesforce__opportunity:
            weight: 1
            compare_cols: [account_id, amount, campaign_id, days_since_created, days_to_close, expected_revenue, fiscal, fiscal_quarter, fiscal_year, forecast_category, forecast_category_name, has_open_activity, has_opportunity_line_item, has_overdue_task, is_closed, is_closed_this_month, is_closed_this_quarter, is_created_this_month, is_created_this_quarter, is_deleted, is_won, last_activity_date, last_referenced_date, last_viewed_date, lead_source, next_step, opportunity_description, opportunity_id, opportunity_name, owner_id, probability, record_type_id, stage_name, synced_quote_id, type]
          stg_salesforce__opportunity_history:
            weight: 1
            compare_cols: [account_id, amount, expected_revenue, forecast_category, history_unique_key, is_closed, is_deleted, is_won, lead_source, next_step, opportunity_description, opportunity_id, opportunity_name, owner_id, probability, stage_name, type]
          stg_salesforce__opportunity_line_item:
            weight: 1
            compare_cols: [created_date, has_quantity_schedule, has_revenue_schedule, is_deleted, last_modified_date, list_price, opportunity_id, opportunity_line_item_description, opportunity_line_item_id, pricebook_entry_id, product_2_id, quantity, service_date, sort_order, total_price, unit_price]
          stg_salesforce__order:
            weight: 1
            compare_cols: [account_id, activated_by_id, activated_date, billing_city, billing_country, billing_postal_code, billing_state, billing_street, company_authorized_by_id, contract_id, customer_authorized_by_id, is_deleted, last_modified_date, order_description, order_id, order_number, original_order_id, owner_id, pricebook_2_id, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, status, total_amount, type]
          stg_salesforce__product_2:
            weight: 1
            compare_cols: [created_date, external_data_source_id, external_id, family, is_active, is_archived, is_deleted, last_modified_date, product_2_id, product_code, product_description, product_name, quantity_unit_of_measure]
          stg_salesforce__task:
            weight: 1
            compare_cols: [activity_date, call_disposition, call_duration_in_seconds, call_object, call_type, is_closed, is_deleted, is_high_priority, owner_id, priority, status, subject, task_description, task_id, type, what_id, who_id]
          stg_salesforce__user:
            weight: 1
            compare_cols: [account_id, alias, city, company_name, contact_id, country, country_code, department, email, first_name, individual_id, is_active, last_login_date, last_name, last_referenced_date, last_viewed_date, manager_id, postal_code, profile_id, state, state_code, street, title, user_id, user_name, user_role_id, user_type, username]
          stg_salesforce__user_role:
            weight: 1
            compare_cols: [developer_name, parent_role_id, rollup_description, user_role_id, user_role_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 45
        tables:
          int_salesforce__account_enhanced:
            weight: 0
            compare_cols: []
          int_salesforce__activity_summary:
            weight: 0
            compare_cols: []
          int_salesforce__customer_segmentation:
            weight: 1
            compare_cols: [account_id, customer_tier, tier_weight]
          int_salesforce__date_spine:
            weight: 0
            compare_cols: []
          int_salesforce__lead_conversion_funnel:
            weight: 0
            compare_cols: []
          int_salesforce__opportunity_aggregation_by_owner:
            weight: 0
            compare_cols: []
          int_salesforce__opportunity_pipeline:
            weight: 0
            compare_cols: []
          int_salesforce__regional_forecast_factors:
            weight: 1
            compare_cols: [economic_growth_factor, fx_risk_factor, region, seasonality_factor]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 54
        tables:
          fct_salesforce__revenue_forecast:
            weight: 1
            compare_cols: [customer_tier, region]
          salesforce__account_daily_history:
            weight: 0
            compare_cols: []
          salesforce__advanced_opportunity_analytics:
            weight: 0
            compare_cols: []
          salesforce__contact_daily_history:
            weight: 0
            compare_cols: []
          salesforce__contact_enhanced:
            weight: 0
            compare_cols: []
          salesforce__customer_360_view:
            weight: 0
            compare_cols: []
          salesforce__daily_activity:
            weight: 0
            compare_cols: []
          salesforce__lead_performance_analytics:
            weight: 0
            compare_cols: []
          salesforce__manager_performance:
            weight: 0
            compare_cols: []
          salesforce__opportunity_daily_history:
            weight: 0
            compare_cols: []
          salesforce__opportunity_enhanced:
            weight: 0
            compare_cols: []
          salesforce__opportunity_line_item_enhanced:
            weight: 0
            compare_cols: []
          salesforce__owner_performance:
            weight: 0
            compare_cols: []
          salesforce__regional_competitiveness:
            weight: 1
            compare_cols: [region]
          salesforce__revenue_forecasting:
            weight: 0
            compare_cols: []
          salesforce__sales_performance_dashboard:
            weight: 0
            compare_cols: []
          salesforce__sales_snapshot:
            weight: 0
            compare_cols: []
          salesforce__team_performance:
            weight: 1
            compare_cols: [owner_id, region, total_opportunities, won_opportunities]
          salesforce__team_performance_simple:
            weight: 0
            compare_cols: []
  dacomp-de-evol-008:
    database_file: salesforce.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 30
        tables:
          stg_salesforce__account:
            weight: 0
            compare_cols: []
          stg_salesforce__account_history:
            weight: 0
            compare_cols: []
          stg_salesforce__composite_transaction_events:
            weight: 2
            compare_cols: [child_sequence_number, event_driven_sync_checksum, parent_transaction_id, risk_adjustment_factor]
          stg_salesforce__contact:
            weight: 0
            compare_cols: []
          stg_salesforce__contact_history:
            weight: 0
            compare_cols: []
          stg_salesforce__currency_exchange_snapshots:
            weight: 2
            compare_cols: [exchange_rate_snapshot_id, snapshot_time]
          stg_salesforce__event:
            weight: 0
            compare_cols: []
          stg_salesforce__lead:
            weight: 0
            compare_cols: []
          stg_salesforce__opportunity:
            weight: 0
            compare_cols: []
          stg_salesforce__opportunity_history:
            weight: 0
            compare_cols: []
          stg_salesforce__opportunity_line_item:
            weight: 0
            compare_cols: []
          stg_salesforce__order:
            weight: 0
            compare_cols: []
          stg_salesforce__product_2:
            weight: 0
            compare_cols: []
          stg_salesforce__task:
            weight: 0
            compare_cols: []
          stg_salesforce__user:
            weight: 0
            compare_cols: []
          stg_salesforce__user_role:
            weight: 0
            compare_cols: []
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 50
        tables:
          int_salesforce__account_enhanced:
            weight: 1
            compare_cols: [account_id, account_name, account_size_segment, account_type, industry_normalized, owner_id]
          int_salesforce__activity_summary:
            weight: 0
            compare_cols: []
          int_salesforce__date_spine:
            weight: 0
            compare_cols: []
          int_salesforce__hierarchical_transaction_modeling:
            weight: 2
            compare_cols: [composite_transaction_hierarchy_path, parent_transaction_id]
          int_salesforce__lead_conversion_funnel:
            weight: 0
            compare_cols: []
          int_salesforce__multi_currency_normalization:
            weight: 3
            compare_cols: [account_id, exchange_rate_snapshot_id]
          int_salesforce__opportunity_aggregation_by_owner:
            weight: 0
            compare_cols: []
          int_salesforce__opportunity_pipeline:
            weight: 1
            compare_cols: [amount, composite_transaction_hierarchy_path, deal_velocity_risk, exchange_rate_snapshot_id, opportunity_id, opportunity_name, owner_id, stage_name]
          int_salesforce__revenue_recognition_engine:
            weight: 3
            compare_cols: [revenue_allocation_matrix]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 20
        tables:
          salesforce__account_daily_history:
            weight: 0
            compare_cols: []
          salesforce__advanced_opportunity_analytics:
            weight: 0
            compare_cols: []
          salesforce__contact_daily_history:
            weight: 0
            compare_cols: []
          salesforce__contact_enhanced:
            weight: 0
            compare_cols: []
          salesforce__customer_360_view:
            weight: 0
            compare_cols: []
          salesforce__daily_activity:
            weight: 0
            compare_cols: []
          salesforce__global_revenue_analytics:
            weight: 8
            compare_cols: []
          salesforce__lead_performance_analytics:
            weight: 0
            compare_cols: []
          salesforce__manager_performance:
            weight: 0
            compare_cols: []
          salesforce__opportunity_daily_history:
            weight: 0
            compare_cols: []
          salesforce__opportunity_enhanced:
            weight: 0
            compare_cols: []
          salesforce__opportunity_line_item_enhanced:
            weight: 0
            compare_cols: []
          salesforce__owner_performance:
            weight: 0
            compare_cols: []
          salesforce__revenue_forecasting:
            weight: 1
            compare_cols: []
          salesforce__sales_performance_dashboard:
            weight: 1
            compare_cols: [avg_sales_cycle_days, avg_team_win_rate, avg_won_cycle_days, close_rate_pct, deal_type_focus, enterprise_accounts, high_confidence_deals, high_risk_deals, high_value_accounts, improvement_recommendation, manager_email, manager_id, manager_name, opportunities_created_this_month, opportunities_created_this_quarter, owner_id, quarterly_momentum, rep_email, rep_is_active, rep_name, rep_role, revenue_performance_tier, revenue_this_month, revenue_this_quarter, strategic_deals, team_total_revenue, territory_coverage, total_opportunities, unique_accounts, velocity_performance_tier, weighted_pipeline_value, win_rate_pct, win_rate_performance_tier, won_opportunities, won_this_month, won_this_quarter]
          salesforce__sales_snapshot:
            weight: 0
            compare_cols: []
  dacomp-de-evol-009:
    database_file: salesforce.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_salesforce__account:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_state_code, billing_street, industry, is_deleted, last_activity_date, last_referenced_date, last_viewed_date, master_record_id, number_of_employees, owner_id, ownership, parent_id, rating, record_type_id, shipping_city, shipping_country, shipping_country_code, shipping_postal_code, shipping_state, shipping_state_code, shipping_street, type, website]
          stg_salesforce__account_history:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_street, industry, is_deleted, last_activity_date, number_of_employees, owner_id, ownership, parent_id, rating, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, type, website]
          stg_salesforce__contact:
            weight: 1
            compare_cols: [account_id, assistant_name, assistant_phone, birthdate, contact_description, contact_id, contact_name, department, email, email_bounced_date, email_bounced_reason, fax, first_name, home_phone, is_deleted, is_email_bounced, last_activity_date, last_curequest_date, last_cuupdate_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, lead_source, mailing_city, mailing_country, mailing_country_code, mailing_postal_code, mailing_state, mailing_state_code, mailing_street, master_record_id, mobile_phone, other_city, other_country, other_phone, other_postal_code, other_state, other_street, owner_id, phone, photo_url, reports_to_id, salutation, title]
          stg_salesforce__contact_history:
            weight: 1
            compare_cols: [account_id, contact_description, contact_id, contact_name, email, first_name, history_unique_key, is_deleted, last_activity_date, last_modified_date, last_name, lead_source, mailing_city, mailing_country, mailing_postal_code, mailing_state, mailing_street, mobile_phone, owner_id, phone, title]
          stg_salesforce__event:
            weight: 1
            compare_cols: [activity_date, activity_date_time, duration_in_minutes, end_date_time, event_description, event_id, is_deleted, location, owner_id, start_date_time, subject, type, what_id, who_id]
          stg_salesforce__lead:
            weight: 1
            compare_cols: [annual_revenue, city, company, converted_account_id, converted_contact_id, converted_date, converted_opportunity_id, country, country_code, created_by_id, email, email_bounced_date, email_bounced_reason, fax, first_name, geocode_accuracy, has_opted_out_of_email, industry, is_converted, is_deleted, is_unread_by_owner, last_activity_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, latitude, lead_description, lead_id, lead_name, lead_source, longitude, master_record_id, mobile_phone, number_of_employees, owner_id, phone, photo_url, postal_code, salutation, state, state_code, status, street, system_modstamp, title, website]
          stg_salesforce__opportunity:
            weight: 1
            compare_cols: [account_id, amount, campaign_id, days_since_created, days_to_close, expected_revenue, fiscal, fiscal_quarter, fiscal_year, forecast_category, forecast_category_name, has_open_activity, has_opportunity_line_item, has_overdue_task, is_closed, is_closed_this_month, is_closed_this_quarter, is_created_this_month, is_created_this_quarter, is_deleted, is_won, last_activity_date, last_referenced_date, last_viewed_date, lead_source, next_step, opportunity_description, opportunity_id, opportunity_name, owner_id, probability, record_type_id, stage_name, synced_quote_id, type]
          stg_salesforce__opportunity_history:
            weight: 1
            compare_cols: [account_id, amount, expected_revenue, forecast_category, history_unique_key, is_closed, is_deleted, is_won, last_activity_date, last_modified_date, lead_source, next_step, opportunity_description, opportunity_id, opportunity_name, owner_id, probability, stage_name, type]
          stg_salesforce__opportunity_line_item:
            weight: 1
            compare_cols: [created_date, has_quantity_schedule, has_revenue_schedule, is_deleted, last_modified_date, list_price, opportunity_id, opportunity_line_item_description, opportunity_line_item_id, pricebook_entry_id, product_2_id, quantity, service_date, sort_order, total_price, unit_price]
          stg_salesforce__order:
            weight: 1
            compare_cols: [account_id, activated_by_id, activated_date, billing_city, billing_country, billing_postal_code, billing_state, billing_street, company_authorized_by_id, contract_id, customer_authorized_by_id, effective_date, end_date, is_deleted, last_modified_date, order_description, order_id, order_number, original_order_id, owner_id, pricebook_2_id, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, status, total_amount, type]
          stg_salesforce__product_2:
            weight: 1
            compare_cols: [created_date, external_data_source_id, external_id, family, is_active, is_archived, is_deleted, last_modified_date, product_2_id, product_code, product_description, product_name, quantity_unit_of_measure]
          stg_salesforce__task:
            weight: 1
            compare_cols: [activity_date, call_disposition, call_duration_in_seconds, call_object, call_type, is_closed, is_deleted, is_high_priority, owner_id, priority, status, subject, task_description, task_id, type, what_id, who_id]
          stg_salesforce__user:
            weight: 1
            compare_cols: [account_id, alias, city, company_name, contact_id, country, country_code, department, email, first_name, individual_id, is_active, last_login_date, last_name, last_referenced_date, last_viewed_date, manager_id, postal_code, profile_id, state, state_code, street, title, user_id, user_name, user_role_id, user_type, username]
          stg_salesforce__user_role:
            weight: 1
            compare_cols: [developer_name, parent_role_id, rollup_description, user_role_id, user_role_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 40
        tables:
          int_salesforce__account_enhanced:
            weight: 1
            compare_cols: [account_age_days, account_id, account_maturity_stage, account_name, account_number, account_size_segment, account_source, account_type, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_street, data_completeness_score, geographic_region, industry_normalized, is_deleted, is_high_value_account, last_activity_date, last_referenced_date, last_viewed_date, number_of_employees, owner_id, website]
          int_salesforce__activity_summary:
            weight: 0
            compare_cols: []
          int_salesforce__date_spine:
            weight: 0
            compare_cols: []
          int_salesforce__lead_conversion_funnel:
            weight: 0
            compare_cols: []
          int_salesforce__opportunity_aggregation_by_owner:
            weight: 0
            compare_cols: []
          int_salesforce__opportunity_pipeline:
            weight: 1
            compare_cols: [account_id, account_name, account_size_segment, amount, campaign_id, close_date_status, days_to_close, deal_size_category, deal_velocity_risk, expected_revenue, fiscal_quarter, fiscal_year, forecast_category, geographic_region, industry_normalized, is_closed, is_deleted, is_high_value_account, is_strategic_deal, is_won, lead_source, opportunity_age_days, opportunity_id, opportunity_name, owner_id, probability, stage_name, stage_progression_score, weighted_pipeline_value, win_probability_confidence]
          int_salesforce__user_performance:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 59
        tables:
          dim_salesforce__user:
            weight: 0
            compare_cols: []
          fct_salesforce__account_engagement:
            weight: 0
            compare_cols: []
          fct_salesforce__lead_performance:
            weight: 0
            compare_cols: []
          fct_salesforce__sales_pipeline:
            weight: 1
            compare_cols: [account_id, account_name, account_size_segment, amount, billing_city, billing_country, billing_state, campaign_id, close_date_status, close_month, close_quarter, close_year, created_month, created_quarter, created_year, days_to_close, deal_cycle_category, deal_size_category, deal_velocity_risk, expected_revenue, fiscal_quarter, fiscal_year, forecast_accuracy_days, forecast_category, geographic_region, industry_normalized, is_closed, is_current_quarter_close, is_high_value_account, is_strategic_deal, is_won, lead_source, opportunity_age_days, opportunity_id, opportunity_name, opportunity_status, owner_id, owner_name, pipeline_health_score, probability, stage_name, stage_progression_score, weighted_pipeline_value, win_probability_confidence]
          salesforce__account_daily_history:
            weight: 0
            compare_cols: []
          salesforce__contact_daily_history:
            weight: 0
            compare_cols: []
          salesforce__contact_enhanced:
            weight: 0
            compare_cols: []
          salesforce__customer_lifecycle:
            weight: 8
            compare_cols: [account_id, account_name, new_customer_revenue, owner_id, renewal_revenue, total_opportunities]
          salesforce__daily_activity:
            weight: 0
            compare_cols: []
          salesforce__manager_performance:
            weight: 0
            compare_cols: []
          salesforce__opportunity_daily_history:
            weight: 0
            compare_cols: []
          salesforce__opportunity_enhanced:
            weight: 0
            compare_cols: []
          salesforce__opportunity_line_item_enhanced:
            weight: 0
            compare_cols: []
          salesforce__owner_performance:
            weight: 0
            compare_cols: []
          salesforce__revenue_analytics:
            weight: 1
            compare_cols: [account_id, account_name, account_size_segment, account_value_outcome, amount, close_month, close_quarter, geographic_region, industry_normalized, is_current_quarter, is_previous_quarter, is_won, lead_source, lost_revenue, opportunity_id, opportunity_name, owner_id, owner_manager, owner_name, owner_performance_tier, owner_type, revenue_per_day, revenue_velocity_category, sales_cycle_days, seasonal_period, seasonal_quarter, stage_name, won_revenue]
          salesforce__sales_snapshot:
            weight: 0
            compare_cols: []
          salesforce__team_performance:
            weight: 0
            compare_cols: []
  dacomp-de-evol-010:
    database_file: salesforce.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_salesforce__account:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_state_code, billing_street, industry, is_deleted, last_activity_date, last_referenced_date, last_viewed_date, master_record_id, number_of_employees, owner_id, ownership, parent_id, rating, record_type_id, shipping_city, shipping_country, shipping_country_code, shipping_postal_code, shipping_state, shipping_state_code, shipping_street, type, website]
          stg_salesforce__account_history:
            weight: 1
            compare_cols: [account_description, account_id, account_name, account_number, account_source, annual_revenue, billing_city, billing_country, billing_postal_code, billing_state, billing_street, history_unique_key, industry, is_deleted, last_activity_date, number_of_employees, owner_id, ownership, parent_id, rating, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, type, website]
          stg_salesforce__contact:
            weight: 1
            compare_cols: [account_id, assistant_name, assistant_phone, birthdate, contact_description, contact_id, contact_name, department, email, email_bounced_date, email_bounced_reason, fax, first_name, home_phone, is_deleted, is_email_bounced, last_activity_date, last_curequest_date, last_cuupdate_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, lead_source, mailing_city, mailing_country, mailing_country_code, mailing_postal_code, mailing_state, mailing_state_code, mailing_street, master_record_id, mobile_phone, other_city, other_country, other_phone, other_postal_code, other_state, other_street, owner_id, phone, photo_url, reports_to_id, salutation, title]
          stg_salesforce__contact_history:
            weight: 1
            compare_cols: [account_id, contact_description, contact_id, contact_name, email, first_name, history_unique_key, is_deleted, last_activity_date, last_modified_date, last_name, lead_source, mailing_city, mailing_country, mailing_postal_code, mailing_state, mailing_street, mobile_phone, owner_id, phone, title]
          stg_salesforce__event:
            weight: 1
            compare_cols: [activity_date_time, duration_in_minutes, end_date_time, event_description, event_id, is_deleted, location, owner_id, start_date_time, subject, type, what_id, who_id]
          stg_salesforce__lead:
            weight: 1
            compare_cols: [annual_revenue, city, company, converted_account_id, converted_contact_id, converted_date, converted_opportunity_id, country, country_code, created_by_id, email, email_bounced_date, email_bounced_reason, fax, first_name, geocode_accuracy, has_opted_out_of_email, industry, is_converted, is_deleted, is_unread_by_owner, last_activity_date, last_modified_date, last_name, last_referenced_date, last_viewed_date, latitude, lead_description, lead_id, lead_name, lead_source, longitude, master_record_id, mobile_phone, number_of_employees, owner_id, phone, photo_url, postal_code, salutation, state, state_code, status, street, system_modstamp, title, website]
          stg_salesforce__opportunity:
            weight: 1
            compare_cols: [account_id, amount, campaign_id, days_since_created, days_to_close, expected_revenue, fiscal, fiscal_quarter, fiscal_year, forecast_category, forecast_category_name, has_open_activity, has_opportunity_line_item, has_overdue_task, is_closed, is_closed_this_month, is_closed_this_quarter, is_created_this_month, is_created_this_quarter, is_deleted, is_won, last_activity_date, last_referenced_date, last_viewed_date, lead_source, next_step, opportunity_description, opportunity_id, opportunity_name, owner_id, probability, record_type_id, stage_name, synced_quote_id, type]
          stg_salesforce__opportunity_history:
            weight: 1
            compare_cols: [account_id, amount, expected_revenue, forecast_category, history_unique_key, is_closed, is_deleted, is_won, last_activity_date, last_modified_date, lead_source, next_step, opportunity_description, opportunity_id, opportunity_name, owner_id, probability, stage_name, type]
          stg_salesforce__opportunity_line_item:
            weight: 1
            compare_cols: [created_date, has_quantity_schedule, has_revenue_schedule, is_deleted, last_modified_date, list_price, opportunity_id, opportunity_line_item_description, opportunity_line_item_id, pricebook_entry_id, product_2_id, quantity, service_date, sort_order, total_price, unit_price]
          stg_salesforce__order:
            weight: 1
            compare_cols: [account_id, activated_by_id, activated_date, billing_city, billing_country, billing_postal_code, billing_state, billing_street, company_authorized_by_id, contract_id, customer_authorized_by_id, effective_date, end_date, is_deleted, last_modified_date, order_description, order_id, order_number, original_order_id, owner_id, pricebook_2_id, shipping_city, shipping_country, shipping_postal_code, shipping_state, shipping_street, status, total_amount, type]
          stg_salesforce__product_2:
            weight: 1
            compare_cols: [created_date, external_data_source_id, external_id, family, is_active, is_archived, is_deleted, last_modified_date, product_2_id, product_code, product_description, product_name, quantity_unit_of_measure]
          stg_salesforce__task:
            weight: 1
            compare_cols: [activity_date, call_disposition, call_duration_in_seconds, call_object, call_type, is_closed, is_deleted, is_high_priority, owner_id, priority, status, subject, task_description, task_id, type, what_id, who_id]
          stg_salesforce__user:
            weight: 1
            compare_cols: [account_id, alias, city, company_name, contact_id, country, country_code, department, email, first_name, individual_id, is_active, last_login_date, last_name, last_referenced_date, last_viewed_date, manager_id, postal_code, profile_id, state, state_code, street, title, user_id, user_name, user_role_id, user_type, username]
          stg_salesforce__user_role:
            weight: 1
            compare_cols: [developer_name, parent_role_id, rollup_description, user_role_id, user_role_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 69
        tables:
          int_salesforce__account_enhanced:
            weight: 0
            compare_cols: []
          int_salesforce__activity_summary:
            weight: 0
            compare_cols: []
          int_salesforce__cost_variance_analysis:
            weight: 2
            compare_cols: [opportunity_id]
          int_salesforce__date_spine:
            weight: 0
            compare_cols: []
          int_salesforce__lead_conversion_funnel:
            weight: 0
            compare_cols: []
          int_salesforce__lifecycle_roi_calculation:
            weight: 2
            compare_cols: [is_closed, is_won, opportunity_id]
          int_salesforce__multi_dimensional_cost_allocation:
            weight: 2
            compare_cols: [opportunity_id]
          int_salesforce__opportunity_aggregation_by_owner:
            weight: 0
            compare_cols: []
          int_salesforce__opportunity_pipeline:
            weight: 1
            compare_cols: [account_id, account_name, account_size_segment, amount, campaign_id, close_date_status, days_to_close, deal_size_category, deal_velocity_risk, expected_revenue, fiscal_quarter, fiscal_year, forecast_category, geographic_region, industry_normalized, is_closed, is_deleted, is_high_value_account, is_strategic_deal, is_won, lead_source, opportunity_age_days, opportunity_id, opportunity_name, owner_id, probability, stage_name, stage_progression_score, weighted_pipeline_value, win_probability_confidence]
          int_salesforce__revenue_recognition_mapping:
            weight: 2
            compare_cols: [opportunity_id]
          int_salesforce__user_performance:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          dim_salesforce__user:
            weight: 0
            compare_cols: []
          fct_salesforce__account_engagement:
            weight: 1
            compare_cols: [account_id, account_name, account_size_segment, account_type, activity_frequency_score, churn_risk_indicator, engagement_health_score, engagement_temperature, owner_id, total_activities_30d]
          fct_salesforce__lead_performance:
            weight: 0
            compare_cols: []
          fct_salesforce__sales_pipeline:
            weight: 1
            compare_cols: [account_id, amount, is_won, opportunity_id, opportunity_name, stage_name]
          salesforce__account_daily_history:
            weight: 0
            compare_cols: []
          salesforce__contact_daily_history:
            weight: 0
            compare_cols: []
          salesforce__contact_enhanced:
            weight: 0
            compare_cols: []
          salesforce__daily_activity:
            weight: 0
            compare_cols: []
          salesforce__manager_performance:
            weight: 0
            compare_cols: []
          salesforce__opportunity_daily_history:
            weight: 0
            compare_cols: []
          salesforce__opportunity_enhanced:
            weight: 0
            compare_cols: []
          salesforce__opportunity_line_item_enhanced:
            weight: 0
            compare_cols: []
          salesforce__owner_performance:
            weight: 0
            compare_cols: []
          salesforce__revenue_analytics:
            weight: 1
            compare_cols: [account_id, account_name, amount, is_current_quarter, is_previous_quarter, is_won, lead_source, opportunity_id, opportunity_name, owner_id, sales_cycle_days, won_revenue]
          salesforce__sales_snapshot:
            weight: 0
            compare_cols: []
          salesforce__team_performance:
            weight: 0
            compare_cols: []
  dacomp-de-evol-011:
    database_file: google_ads.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_google_ads__account_history:
            weight: 1
            compare_cols: [account_id, account_name, auto_tagging_enabled, currency_code, is_most_recent_record, time_zone]
          stg_google_ads__account_stats:
            weight: 1
            compare_cols: [account_id, ad_network_type, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__ad_group_criterion_history:
            weight: 1
            compare_cols: [ad_group_id, criterion_id, is_most_recent_record, keyword_match_type, keyword_text, status, type]
          stg_google_ads__ad_group_history:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, ad_group_type, campaign_id, is_most_recent_record, status]
          stg_google_ads__ad_group_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__ad_history:
            weight: 1
            compare_cols: [ad_group_id, ad_id, ad_name, ad_type, display_url, final_urls, is_most_recent_record, status]
          stg_google_ads__ad_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__campaign_history:
            weight: 1
            compare_cols: [account_id, advertising_channel_subtype, advertising_channel_type, campaign_id, campaign_name, end_date, is_most_recent_record, serving_status, start_date, status, tracking_url_template, updated_at]
          stg_google_ads__campaign_stats:
            weight: 1
            compare_cols: [account_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__keyword_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, criterion_id, date_day, device, impressions, spend, view_through_conversions]
          stg_google_ads__search_term_keyword_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, criterion_id, date_day, device, impressions, search_term, search_term_match_type, spend, view_through_conversions]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_google_ads__account_performance_metrics:
            weight: 1
            compare_cols: [account_id, account_maturity_stage, account_name, clicks, clicks_7d_avg, conversions, conversions_value, days_since_first_activity, has_spend_no_clicks_flag, high_spend_alert_flag, impressions, impressions_7d_avg, invalid_metrics_flag, performance_score, time_zone]
          int_google_ads__campaign_cohort_analysis:
            weight: 1
            compare_cols: [advertising_channel_subtype, advertising_channel_type, campaign_health_score, campaign_id, campaign_name, campaign_status, clicks, conversions, conversions_value, date_day, days_since_launch, impressions, investment_tier, lifecycle_stage, momentum_indicator, performance_tier_in_cohort, roas, spend, underperforming_flag]
          int_google_ads__keyword_performance_segmentation:
            weight: 0
            compare_cols: []
          int_google_ads__market_intelligence:
            weight: 8
            compare_cols: [cpc_vs_channel_median_ratio, market_competition_index]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          google_ads__account_report:
            weight: 0
            compare_cols: []
          google_ads__ad_group_report:
            weight: 0
            compare_cols: []
          google_ads__ad_report:
            weight: 0
            compare_cols: []
          google_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, account_name, advertising_channel_type, campaign_id, campaign_name, clicks, conversions, conversions_value, currency_code, date_day, impressions, market_competition_index, recommended_budget_adjustment_pct, scale_opportunity_score, seasonal_performance_vs_baseline_pct, spend]
          google_ads__channel_performance_analysis:
            weight: 0
            compare_cols: []
          google_ads__customer_acquisition_analysis:
            weight: 0
            compare_cols: []
          google_ads__executive_dashboard:
            weight: 1
            compare_cols: [account_id, account_name, currency_code, date_day, overall_roas, total_conversions, total_spend]
          google_ads__keyword_report:
            weight: 0
            compare_cols: []
          google_ads__search_term_report:
            weight: 0
            compare_cols: []
          google_ads__url_report:
            weight: 0
            compare_cols: []
  dacomp-de-evol-012:
    database_file: google_ads.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 10
        tables:
          stg_google_ads__account_history:
            weight: 0
            compare_cols: []
          stg_google_ads__account_stats:
            weight: 0
            compare_cols: []
          stg_google_ads__ad_group_criterion_history:
            weight: 0
            compare_cols: []
          stg_google_ads__ad_group_history:
            weight: 0
            compare_cols: []
          stg_google_ads__ad_group_stats:
            weight: 0
            compare_cols: []
          stg_google_ads__ad_history:
            weight: 0
            compare_cols: []
          stg_google_ads__ad_stats:
            weight: 0
            compare_cols: []
          stg_google_ads__campaign_history:
            weight: 0
            compare_cols: []
          stg_google_ads__campaign_stats:
            weight: 0
            compare_cols: []
          stg_google_ads__keyword_stats:
            weight: 0
            compare_cols: []
          stg_google_ads__search_term_keyword_stats:
            weight: 1
            compare_cols: [account_id, ad_group_id, ad_network_type, campaign_id, clicks, conversions, conversions_value, criterion_id, device, impressions, search_term, search_term_match_type, spend, view_through_conversions]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 50
        tables:
          int_google_ads__account_performance_metrics:
            weight: 0
            compare_cols: []
          int_google_ads__campaign_cohort_analysis:
            weight: 0
            compare_cols: []
          int_google_ads__commercial_intent_scoring:
            weight: 2
            compare_cols: [account_id, commercial_intent_score, commercial_intent_tier]
          int_google_ads__keyword_performance_segmentation:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertising_channel_type, bid_recommendation, campaign_avg_roas, campaign_id, campaign_name, clicks, conv_rate_percentile_in_campaign, conversion_rate, conversions, conversions_value, cost_per_conversion, cpc, cpm, ctr, ctr_percentile_in_campaign, ctr_vs_campaign_pct, data_quality_flag, date_day, days_since_first_activity, efficiency_score, impressions, keyword_id, keyword_maturity_stage, lifetime_clicks, lifetime_conversions, lifetime_conversions_value, lifetime_spend, optimization_needed_flag, pause_candidate_flag, performance_tier, roas, roas_percentile_in_campaign, roas_vs_campaign_pct, scale_opportunity_flag, spend, value_tier, volume_tier]
          int_google_ads__negative_keyword_impact_analysis:
            weight: 3
            compare_cols: [negative_keyword_impact_radius]
          int_google_ads__search_term_semantic_analysis:
            weight: 3
            compare_cols: [account_id, ad_group_id, campaign_id, criterion_id, date_day, search_term, search_term_semantic_distance]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          google_ads__account_report:
            weight: 0
            compare_cols: []
          google_ads__ad_group_report:
            weight: 0
            compare_cols: []
          google_ads__ad_report:
            weight: 0
            compare_cols: []
          google_ads__campaign_report:
            weight: 0
            compare_cols: []
          google_ads__channel_performance_analysis:
            weight: 0
            compare_cols: []
          google_ads__customer_acquisition_analysis:
            weight: 0
            compare_cols: []
          google_ads__executive_dashboard:
            weight: 0
            compare_cols: []
          google_ads__keyword_report:
            weight: 1
            compare_cols: [account_id, account_name, ad_group_id, ad_group_name, campaign_id, campaign_name, clicks, conversions, conversions_value, impressions, keyword_text, spend]
          google_ads__search_term_report:
            weight: 1
            compare_cols: [account_id, clicks, commercial_intent_score, commercial_intent_tier, conversions, conversions_value, impressions, search_term, search_term_quality_score, search_term_semantic_distance, search_volume_potential_score, spend, user_journey_stage_indicator]
          google_ads__url_report:
            weight: 0
            compare_cols: []
  dacomp-de-evol-013:
    database_file: ad_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_amazon_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, campaign_bidding_strategy, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform]
          stg_amazon_ads__campaign_report:
            weight: 1
            compare_cols: [campaign_applicable_budget_rule_id, campaign_applicable_budget_rule_name, campaign_bidding_strategy, campaign_budget_amount, campaign_budget_currency_code, campaign_budget_type, campaign_id, campaign_rule_based_budget_amount, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform, purchases_30_d, return_on_ad_spend, sales_30_d, sales_7_d]
          stg_amazon_ads__keyword_report:
            weight: 1
            compare_cols: [ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, keyword_id, keyword_type, match_type, platform, return_on_ad_spend]
          stg_amazon_ads__product_report:
            weight: 1
            compare_cols: [ad_group_id, advertised_asin, advertised_sku, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, attributed_units_ordered_14_d, attributed_units_ordered_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform, return_on_ad_spend]
          stg_amazon_ads__search_report:
            weight: 1
            compare_cols: [ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, keyword_id, match_type, platform, query, return_on_ad_spend, search_term]
          stg_apple_search_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, avg_cost_per_acquisition, avg_cost_per_tap, avg_cpa_currency, avg_cpt_currency, calculated_tap_through_rate, conversion_rate, conversions, cost_per_conversion, cost_per_tap, date_day, impressions, lat_off_installs, lat_on_installs, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_apple_search_ads__ad_report:
            weight: 1
            compare_cols: [ad_group_id, ad_id, campaign_id, conversions, cost_per_conversion, cost_per_download, cost_per_tap, date_day, impressions, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_apple_search_ads__campaign_report:
            weight: 1
            compare_cols: [avg_cost_per_acquisition, avg_cost_per_tap, avg_cpa_currency, avg_cpt_currency, calculated_tap_through_rate, campaign_id, conversion_rate, conversions, cost_per_conversion, cost_per_tap, date_day, impressions, lat_off_installs, lat_on_installs, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_facebook_ads__ad_actions:
            weight: 1
            compare_cols: [action_1_d_view, action_7_d_click, action_type, action_value, ad_id, date_day, inline_value, is_index_action, platform]
          stg_facebook_ads__ad_report:
            weight: 1
            compare_cols: [account_id, ad_id, click_through_rate, cost_per_click, cost_per_thousand_impressions, date_day, impressions, inline_link_clicks, platform, spend]
          stg_google_ads__account_report:
            weight: 1
            compare_cols: [active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_cost_micros, active_view_measurable_impressions, active_view_viewability, ad_network_type, click_through_rate, clicks, conversions, conversions_value, cost, cost_micros, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, customer_id, date_day, device, impressions, interaction_event_types, interactions, platform, view_through_conversions]
          stg_google_ads__ad_group_report:
            weight: 1
            compare_cols: [active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_cost_micros, active_view_measurable_impressions, active_view_viewability, ad_group_id, ad_network_type, click_through_rate, clicks, conversions, conversions_value, cost, cost_micros, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, customer_id, date_day, device, impressions, interaction_event_types, interactions, platform, view_through_conversions]
          stg_google_ads__campaign_report:
            weight: 1
            compare_cols: [active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_cost_micros, active_view_measurable_impressions, active_view_viewability, ad_network_type, base_campaign, campaign_id, click_through_rate, clicks, conversions, conversions_value, cost, cost_micros, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, customer_id, date_day, device, impressions, interaction_event_types, interactions, platform, view_through_conversions]
          stg_linkedin_ads__campaign_report:
            weight: 1
            compare_cols: [campaign_id, click_through_rate, clicks, comments, cost, cost_per_click, cost_per_thousand_impressions, date_day, follows, impressions, likes, opens, platform, sends, shares, video_completions, video_views]
          stg_microsoft_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, assists, average_position, bounce_rate, campaign_id, click_through_rate, clicks, conversions, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, device_os, device_type, impressions, network, platform, return_on_ad_spend, revenue, spend]
          stg_pinterest_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, campaign_id, click_through_rate, clicks, close_ups, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, impressions, outbound_clicks, pin_clicks, platform, saves, spend, spend_in_micro_dollar, total_conversions, total_conversions_value, total_conversions_value_in_micro_dollar, video_views]
          stg_reddit_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, campaign_id, click_through_rate, clicks, comments, community_joins, conversion_value, conversions, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, cost_per_video_view, date_day, downvotes, engagement_rate, impressions, platform, post_visits, profile_visits, saves, shares, spend, total_engagements, upvotes, video_view_rate, video_views]
          stg_snapchat_ads__campaign_report:
            weight: 1
            compare_cols: [ad_account_id, app_installs, campaign_id, conversion_purchases, conversion_purchases_value, cost_per_install, cost_per_swipe, cost_per_thousand_impressions, cost_per_video_view, date_day, impressions, platform, quartile_1, quartile_2, quartile_3, saves, screen_time_millis, shares, spend, story_completes, story_opens, swipe_up_rate, swipes, video_views, view_completion]
          stg_tiktok_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, calculated_cost_per_click, campaign_id, click_through_rate, clicks, comments, conversion_rate, conversions, cost_per_conversion, cost_per_thousand_impressions, cost_per_thousand_reached, date_day, follows, impressions, likes, platform, profile_visits, reach, shares, spend, video_play_actions, video_views_p_100, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_twitter_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, app_clicks, app_installs, app_opens, billed_charge_local_micro, campaign_id, card_engagements, carousel_swipes, click_through_rate, clicks, cost_per_click, cost_per_engagement, cost_per_thousand_impressions, date_day, engagement_rate, engagements, follows, impressions, likes, media_engagements, media_views, placement, platform, poll_card_vote, replies, retweets, spend, video_total_views, video_views_100, video_views_25, video_views_50, video_views_75]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_ad_reporting__account_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__ad_group_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__ad_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__anomaly_detection:
            weight: 3
            compare_cols: [anomaly_detection_timestamp, anomaly_severity_level, campaign_id, platform, spend_anomaly_score]
          int_ad_reporting__budget_monitoring:
            weight: 2
            compare_cols: [campaign_id, daily_budget_utilization, monthly_budget_remaining, platform, projected_month_end_spend]
          int_ad_reporting__campaign_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__country_mapping:
            weight: 0
            compare_cols: []
          int_ad_reporting__cross_platform_deduplication:
            weight: 3
            compare_cols: [audience_overlap_score, cross_platform_frequency_cap, duplicate_exposure_risk]
          int_ad_reporting__customer_journey_analysis:
            weight: 0
            compare_cols: []
          int_ad_reporting__geo_channel_performance:
            weight: 0
            compare_cols: []
          int_ad_reporting__keyword_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__monthly_campaign_country_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__monthly_campaign_region_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__search_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__time_series_analytics:
            weight: 0
            compare_cols: []
          int_ad_reporting__unified_campaign_metrics:
            weight: 1
            compare_cols: [campaign_age_days, campaign_id, campaign_type, click_through_rate, clicks, conversions, cost, cost_per_click, cost_per_conversion, currency, daily_budget, impressions, platform, return_on_ad_spend]
          int_ad_reporting__url_report:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          ad_reporting__account_report:
            weight: 0
            compare_cols: []
          ad_reporting__ad_group_report:
            weight: 0
            compare_cols: []
          ad_reporting__ad_report:
            weight: 0
            compare_cols: []
          ad_reporting__campaign_optimization:
            weight: 4
            compare_cols: [auto_pause_recommendation, campaign_id, efficiency_ranking, performance_score, platform, score_breakdown]
          ad_reporting__campaign_report:
            weight: 0
            compare_cols: []
          ad_reporting__customer_analytics:
            weight: 0
            compare_cols: []
          ad_reporting__executive_dashboard:
            weight: 1
            compare_cols: [executive_recommendation, investment_efficiency_grade, month_over_month_growth_rate, overall_roas, reporting_month]
          ad_reporting__keyword_report:
            weight: 0
            compare_cols: []
          ad_reporting__market_opportunities:
            weight: 0
            compare_cols: []
          ad_reporting__monthly_campaign_country_report:
            weight: 0
            compare_cols: []
          ad_reporting__monthly_campaign_region_report:
            weight: 0
            compare_cols: []
          ad_reporting__predictive_analytics:
            weight: 1
            compare_cols: [platform]
          ad_reporting__search_report:
            weight: 0
            compare_cols: []
          ad_reporting__system_config:
            weight: 4
            compare_cols: []
          ad_reporting__url_report:
            weight: 0
            compare_cols: []
  dacomp-de-evol-014:
    database_file: ad_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_amazon_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, campaign_bidding_strategy, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform]
          stg_amazon_ads__campaign_report:
            weight: 1
            compare_cols: [campaign_applicable_budget_rule_id, campaign_applicable_budget_rule_name, campaign_bidding_strategy, campaign_budget_amount, campaign_budget_currency_code, campaign_budget_type, campaign_id, campaign_rule_based_budget_amount, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform, purchases_30_d, return_on_ad_spend, sales_30_d, sales_7_d]
          stg_amazon_ads__keyword_report:
            weight: 1
            compare_cols: [ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, keyword_id, keyword_type, match_type, platform, return_on_ad_spend]
          stg_amazon_ads__product_report:
            weight: 1
            compare_cols: [ad_group_id, advertised_asin, advertised_sku, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, attributed_units_ordered_14_d, attributed_units_ordered_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, platform, return_on_ad_spend]
          stg_amazon_ads__search_report:
            weight: 1
            compare_cols: [ad_group_id, attributed_conversions_14_d, attributed_conversions_30_d, attributed_sales_14_d, attributed_sales_30_d, campaign_id, click_through_rate, clicks, cost, cost_per_click, date_day, impressions, keyword_id, match_type, platform, query, return_on_ad_spend, search_term]
          stg_apple_search_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, avg_cost_per_acquisition, avg_cost_per_tap, avg_cpa_currency, avg_cpt_currency, calculated_tap_through_rate, conversion_rate, conversions, cost_per_conversion, cost_per_tap, date_day, impressions, lat_off_installs, lat_on_installs, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_apple_search_ads__ad_report:
            weight: 1
            compare_cols: [ad_group_id, ad_id, campaign_id, conversions, cost_per_conversion, cost_per_download, cost_per_tap, date_day, impressions, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_apple_search_ads__campaign_report:
            weight: 1
            compare_cols: [avg_cost_per_acquisition, avg_cost_per_tap, avg_cpa_currency, avg_cpt_currency, calculated_tap_through_rate, campaign_id, conversion_rate, conversions, cost_per_conversion, cost_per_tap, date_day, impressions, lat_off_installs, lat_on_installs, new_downloads, platform, redownloads, spend, spend_currency, tap_installs, tap_new_downloads, tap_redownloads, tap_through_rate, taps]
          stg_facebook_ads__ad_actions:
            weight: 1
            compare_cols: [action_1_d_view, action_7_d_click, action_type, action_value, ad_id, date_day, inline_value, is_index_action, platform]
          stg_facebook_ads__ad_report:
            weight: 1
            compare_cols: [account_id, ad_id, click_through_rate, cost_per_click, cost_per_thousand_impressions, date_day, impressions, inline_link_clicks, platform, spend]
          stg_google_ads__account_report:
            weight: 1
            compare_cols: [active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_cost_micros, active_view_measurable_impressions, active_view_viewability, ad_network_type, click_through_rate, clicks, conversions, conversions_value, cost, cost_micros, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, customer_id, date_day, device, impressions, interaction_event_types, interactions, platform, view_through_conversions]
          stg_google_ads__ad_group_report:
            weight: 1
            compare_cols: [active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_cost_micros, active_view_measurable_impressions, active_view_viewability, ad_group_id, ad_network_type, click_through_rate, clicks, conversions, conversions_value, cost, cost_micros, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, customer_id, date_day, device, impressions, interaction_event_types, interactions, platform, view_through_conversions]
          stg_google_ads__campaign_report:
            weight: 1
            compare_cols: [active_view_impressions, active_view_measurability, active_view_measurable_cost, active_view_measurable_cost_micros, active_view_measurable_impressions, active_view_viewability, ad_network_type, base_campaign, campaign_id, click_through_rate, clicks, conversions, conversions_value, cost, cost_micros, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, customer_id, date_day, device, impressions, interaction_event_types, interactions, platform, view_through_conversions]
          stg_linkedin_ads__campaign_report:
            weight: 1
            compare_cols: [campaign_id, click_through_rate, clicks, comments, cost, cost_per_click, cost_per_thousand_impressions, date_day, follows, impressions, likes, opens, platform, sends, shares, video_completions, video_views]
          stg_microsoft_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, assists, average_position, bounce_rate, campaign_id, click_through_rate, clicks, conversions, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, device_os, device_type, impressions, network, platform, return_on_ad_spend, revenue, spend]
          stg_pinterest_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, campaign_id, click_through_rate, clicks, close_ups, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, date_day, impressions, outbound_clicks, pin_clicks, platform, saves, spend, spend_in_micro_dollar, total_conversions, total_conversions_value, total_conversions_value_in_micro_dollar, video_views]
          stg_reddit_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, campaign_id, click_through_rate, clicks, comments, community_joins, conversion_value, conversions, cost_per_click, cost_per_conversion, cost_per_thousand_impressions, cost_per_video_view, date_day, downvotes, engagement_rate, impressions, platform, post_visits, profile_visits, saves, shares, spend, total_engagements, upvotes, video_view_rate, video_views]
          stg_snapchat_ads__campaign_report:
            weight: 1
            compare_cols: [ad_account_id, app_installs, campaign_id, conversion_purchases, conversion_purchases_value, cost_per_install, cost_per_swipe, cost_per_thousand_impressions, cost_per_video_view, date_day, impressions, platform, quartile_1, quartile_2, quartile_3, saves, screen_time_millis, shares, spend, story_completes, story_opens, swipe_up_rate, swipes, video_views, view_completion]
          stg_tiktok_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, calculated_cost_per_click, campaign_id, click_through_rate, clicks, comments, conversion_rate, conversions, cost_per_conversion, cost_per_thousand_impressions, cost_per_thousand_reached, date_day, follows, impressions, likes, platform, profile_visits, reach, shares, spend, video_play_actions, video_views_p_100, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_twitter_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, app_clicks, app_installs, app_opens, billed_charge_local_micro, campaign_id, card_engagements, carousel_swipes, click_through_rate, clicks, cost_per_click, cost_per_engagement, cost_per_thousand_impressions, date_day, engagement_rate, engagements, follows, impressions, likes, media_engagements, media_views, placement, platform, poll_card_vote, replies, retweets, spend, video_total_views, video_views_100, video_views_25, video_views_50, video_views_75]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 69
        tables:
          int_ad_reporting__account_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__ad_group_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__ad_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__campaign_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__conversion_confirmation_tracking:
            weight: 3
            compare_cols: [conversion_id, platform, campaign_id, customer_identifier, final_confirmation_status, change_reason_code, confirmation_window_days, confirmation_deadline, days_until_confirmation, adjusted_conversions, adjusted_conversion_value_usd, confirmation_risk_score, revenue_recognition_status, requires_manual_review, has_return_event, contract_signed, fulfillment_status, changed_by_system]
          int_ad_reporting__country_mapping:
            weight: 0
            compare_cols: []
          int_ad_reporting__cross_platform_contribution_scoring:
            weight: 0
            compare_cols: []
          int_ad_reporting__customer_journey_analysis:
            weight: 1
            compare_cols: [acquisition_cohort, average_order_value, campaigns_interacted, click_to_conversion_rate, cohort_size, conversion_behavior, customer_identifier, customer_lifespan_days, customer_roas, customer_value_tier, days_since_acquisition, engagement_level, platforms_used, recency_status, retained_month_1, retained_month_2, total_linear_attributed_revenue, total_revenue, total_time_decay_attributed_revenue]
          int_ad_reporting__dynamic_attribution_adjustment:
            weight: 3
            compare_cols: [conversion_id, platform, campaign_id, customer_identifier, conversion_date, adjustment_batch_id, original_conversions, original_conversion_value_usd, return_event_type, return_amount_usd, complaint_severity, has_fulfillment_delay, fulfillment_completion_percentage, adjustment_applied_at, adjustment_applied_by, platform_adjustment_policy, adjustment_timing_category]
          int_ad_reporting__enterprise_attribution_journey:
            weight: 3
            compare_cols: [customer_identifier, total_journey_duration_days, total_touchpoints, platforms_involved, departments_involved, organizational_levels_involved, journey_complexity_score, highest_stage_reached, google_attributed_cost, microsoft_attributed_cost, amazon_attributed_cost, linkedin_attribution_percentage, google_attribution_percentage, enterprise_customer_roas, revenue_per_touchpoint, daily_opportunity_value, channel_collaboration_effectiveness]
          int_ad_reporting__fulfillment_quality_scoring:
            weight: 3
            compare_cols: []
          int_ad_reporting__geo_channel_performance:
            weight: 0
            compare_cols: []
          int_ad_reporting__keyword_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__monthly_campaign_country_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__monthly_campaign_region_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__search_report:
            weight: 0
            compare_cols: []
          int_ad_reporting__time_series_analytics:
            weight: 0
            compare_cols: []
          int_ad_reporting__unified_campaign_metrics:
            weight: 1
            compare_cols: [campaign_id, campaign_type, click_through_rate, clicks, conversion_type, conversions, cost, cost_efficiency_tier, cost_per_click, cost_per_conversion, cost_per_mille, ctr_performance_tier, currency, daily_budget, date_day, has_data_quality_issues, impressions, lifecycle_stage, platform, volume_tier]
          int_ad_reporting__url_report:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          ad_reporting__account_report:
            weight: 0
            compare_cols: []
          ad_reporting__ad_group_report:
            weight: 0
            compare_cols: []
          ad_reporting__ad_report:
            weight: 0
            compare_cols: []
          ad_reporting__campaign_report:
            weight: 0
            compare_cols: []
          ad_reporting__customer_analytics:
            weight: 1
            compare_cols: [acquisition_cohort, average_order_value, campaigns_interacted, churn_risk_level, click_to_conversion_rate, clv_percentile, clv_potential, cohort_clv_percentile, cohort_size, conversion_behavior, customer_health_score, customer_identifier, customer_lifespan_days, customer_roas, customer_value_tier, days_since_acquisition, engagement_level, first_interaction_date, frequency_score impression_to_click_rate, investment_priority, marketing_recommendation, monetary_score, platforms_used, recency_score, recency_status, rfm_segment, total_clicks, total_conversions, total_cost_attributed, total_first_touch_revenue, total_impressions, total_last_touch_revenue, total_linear_attributed_revenue, total_revenue, total_time_decay_attributed_revenue]
          ad_reporting__executive_dashboard:
            weight: 1
            compare_cols: [allocation_strategy, analysis_period_end, analysis_period_start, avg_countries_active, avg_customer_retention_rate, avg_market_position_percentile, avg_performance_volatility, avg_platform_growth_rate, avg_platforms_per_customer, customer_strategy_insight, efficiency_leader, executive_recommendation, expansion_mode, high_opportunity_spend_ratio, high_value_customers_acquired, investment_efficiency_grade, mature_markets_percentage, max_platform_anomaly_days, month_over_month_growth_rate, monthly_ad_spend, monthly_avg_customer_value, monthly_new_customers, monthly_revenue]
          ad_reporting__keyword_report:
            weight: 0
            compare_cols: []
          ad_reporting__market_opportunities:
            weight: 0
            compare_cols: []
          ad_reporting__monthly_campaign_country_report:
            weight: 0
            compare_cols: []
          ad_reporting__monthly_campaign_region_report:
            weight: 0
            compare_cols: []
          ad_reporting__predictive_analytics:
            weight: 0
            compare_cols: []
          ad_reporting__search_report:
            weight: 0
            compare_cols: []
          ad_reporting__url_report:
            weight: 0
            compare_cols: []
  dacomp-de-evol-015:
    database_file: app_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_apple_store__app_crash_daily:
            weight: 1
            compare_cols: [app_name, app_version, crashes, date_day, device, platform_version, unique_devices_with_crashes]
          stg_apple_store__app_session_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, date_day, device, platform_version, sessions, source_type, total_session_duration, unique_devices]
          stg_apple_store__app_store_app:
            weight: 1
            compare_cols: [app_id, app_name, content_rights_declaration, primary_locale, was_made_for_kids]
          stg_apple_store__app_store_discovery_and_engagement_standard_daily:
            weight: 1
            compare_cols: [app_name, country, date_day, device, engagement_type, event_type, page_type, page_views, platform_version, source_type, unique_page_views]
          stg_apple_store__app_store_download_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, date_day, device, download_type, platform_version, source_type, total_downloads]
          stg_apple_store__app_store_installation_and_deletion_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, counts, date_day, device, event_type, platform_version, unique_devices]
          stg_apple_store__financial_stats_subscriptions_country:
            weight: 1
            compare_cols: [active_free_trials, active_subscriptions, app_id, app_name, country, date_day, revenue, subscription_name]
          stg_apple_store__sales_subscription_event_summary:
            weight: 1
            compare_cols: [app_id, app_name, consecutive_paid_periods, country, date_day, event_type, marketing_opt_in_duration, proceeds_reason, quantity, standard_subscription_duration, subscriber_id, subscription_id, subscription_name]
          stg_apple_store__sales_subscription_summary:
            weight: 1
            compare_cols: [active_subscriptions, app_id, app_name, billing_retry, country, date_day, free_trial_subscriptions, grace_period, marketing_opt_ins, subscription_duration, subscription_name]
          stg_google_play__earnings:
            weight: 1
            compare_cols: [buyer_currency, country, date_day, package_name, revenue_local_currency, revenue_usd, source_relation]
          stg_google_play__stats_crashes_app_version:
            weight: 1
            compare_cols: [anrs, app_version_code, crashes, date_day, package_name, source_relation]
          stg_google_play__stats_crashes_os_version:
            weight: 1
            compare_cols: [anrs, crashes, date_day, os_version, package_name, source_relation]
          stg_google_play__stats_crashes_overview:
            weight: 1
            compare_cols: [anrs, crashes, date_day, package_name, source_relation]
          stg_google_play__stats_installs_app_version:
            weight: 1
            compare_cols: [active_devices_last_30_days, app_version_code, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_country:
            weight: 1
            compare_cols: [country, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_device:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_os_version:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device_installs, device_uninstalls, device_upgrades, install_events, os_version, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_overview:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_ratings_app_version:
            weight: 1
            compare_cols: [app_version_code, average_rating, date_day, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_country:
            weight: 1
            compare_cols: [average_rating, country, date_day, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_device:
            weight: 1
            compare_cols: [average_rating, date_day, device, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_os_version:
            weight: 1
            compare_cols: [average_rating, date_day, os_version, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_overview:
            weight: 1
            compare_cols: [average_rating, date_day, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_store_performance_country:
            weight: 1
            compare_cols: [country, date_day, package_name, store_listing_acquisitions, store_listing_conversion_rate, store_listing_visitors]
          stg_google_play__stats_store_performance_traffic_source:
            weight: 1
            compare_cols: [date_day, package_name, store_listing_acquisitions, store_listing_conversion_rate, store_listing_visitors, traffic_source]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_app_health_metrics:
            weight: 1
            compare_cols: [app_name, health_score, health_status, platform, volume_tier]
          int_apple_store__app_version:
            weight: 0
            compare_cols: []
          int_apple_store__country:
            weight: 0
            compare_cols: []
          int_apple_store__device:
            weight: 0
            compare_cols: []
          int_apple_store__os_version:
            weight: 0
            compare_cols: []
          int_apple_store__overview:
            weight: 0
            compare_cols: []
          int_apple_store__traffic_source:
            weight: 0
            compare_cols: []
          int_channel_performance:
            weight: 0
            compare_cols: []
          int_google_play__app_version:
            weight: 0
            compare_cols: []
          int_google_play__country:
            weight: 0
            compare_cols: []
          int_google_play__device:
            weight: 0
            compare_cols: []
          int_google_play__os_version:
            weight: 0
            compare_cols: []
          int_google_play__overview:
            weight: 0
            compare_cols: []
          int_google_play__traffic_source:
            weight: 0
            compare_cols: []
          int_quality_user_impact_analysis:
            weight: 4
            compare_cols: [health_score, platform]
          int_realtime_monitoring_periods:
            weight: 4
            compare_cols: [monitoring_period_id, period_number]
          int_user_lifecycle_analysis:
            weight: 1
            compare_cols: [is_at_risk, is_new_user, is_reactivated_user, is_returning_user, package_name, platform, user_activity_level, user_lifecycle_stage, user_status, user_value_segment]
          int_user_rfm_analysis:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          app_reporting__app_health_monitoring_report:
            weight: 1
            compare_cols: [alert_message, app_name, health_score, health_status, overall_assessment, platform, volume_tier]
          app_reporting__app_version_report:
            weight: 0
            compare_cols: []
          app_reporting__channel_effectiveness_report:
            weight: 0
            compare_cols: []
          app_reporting__country_report:
            weight: 0
            compare_cols: []
          app_reporting__device_report:
            weight: 0
            compare_cols: []
          app_reporting__os_version_report:
            weight: 0
            compare_cols: []
          app_reporting__overview_report:
            weight: 0
            compare_cols: []
          app_reporting__quality_retention_insight_report:
            weight: 8
            compare_cols: [app_name, platform, health_score, high_risk_users, health_activity_correlation_estimate, health_impact_on_retention_rate, correlation_confidence_level, correlation_significance, quality_driven_churn_risk_score, high_value_targeted_retention_priority_score]
          app_reporting__traffic_source_report:
            weight: 0
            compare_cols: []
          app_reporting__user_lifecycle_report:
            weight: 1
            compare_cols: [platform, user_lifecycle_stage]
          app_reporting__user_value_segmentation_report:
            weight: 0
            compare_cols: []
  dacomp-de-evol-016:
    database_file: app_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_apple_store__app_crash_daily:
            weight: 1
            compare_cols: [app_name, app_version, crashes, date_day, device, platform_version, unique_devices_with_crashes]
          stg_apple_store__app_session_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, date_day, device, platform_version, sessions, source_type, total_session_duration, unique_devices]
          stg_apple_store__app_store_app:
            weight: 1
            compare_cols: [app_id, app_name, content_rights_declaration, primary_locale, was_made_for_kids]
          stg_apple_store__app_store_discovery_and_engagement_standard_daily:
            weight: 1
            compare_cols: [app_name, country, date_day, device, engagement_type, event_type, page_type, page_views, platform_version, source_type, unique_page_views]
          stg_apple_store__app_store_download_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, date_day, device, download_type, platform_version, source_type, total_downloads]
          stg_apple_store__app_store_installation_and_deletion_standard_daily:
            weight: 1
            compare_cols: [app_name, app_version, country, counts, date_day, device, event_type, platform_version, unique_devices]
          stg_apple_store__financial_stats_subscriptions_country:
            weight: 1
            compare_cols: [active_free_trials, active_subscriptions, app_id, app_name, country, date_day, revenue, subscription_name]
          stg_apple_store__sales_subscription_event_summary:
            weight: 1
            compare_cols: [app_id, app_name, consecutive_paid_periods, country, date_day, event_type, marketing_opt_in_duration, proceeds_reason, quantity, standard_subscription_duration, subscriber_id, subscription_id, subscription_name]
          stg_apple_store__sales_subscription_summary:
            weight: 1
            compare_cols: [active_subscriptions, app_id, app_name, billing_retry, country, date_day, free_trial_subscriptions, grace_period, marketing_opt_ins, subscription_duration, subscription_name]
          stg_google_play__earnings:
            weight: 1
            compare_cols: [buyer_currency, country, date_day, package_name, revenue_local_currency, revenue_usd, source_relation]
          stg_google_play__stats_crashes_app_version:
            weight: 1
            compare_cols: [anrs, app_version_code, crashes, date_day, package_name, source_relation]
          stg_google_play__stats_crashes_os_version:
            weight: 1
            compare_cols: [anrs, crashes, date_day, os_version, package_name, source_relation]
          stg_google_play__stats_crashes_overview:
            weight: 1
            compare_cols: [anrs, crashes, date_day, package_name, source_relation]
          stg_google_play__stats_installs_app_version:
            weight: 1
            compare_cols: [active_devices_last_30_days, app_version_code, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_country:
            weight: 1
            compare_cols: [country, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_device:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_os_version:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device_installs, device_uninstalls, device_upgrades, install_events, os_version, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_installs_overview:
            weight: 1
            compare_cols: [active_devices_last_30_days, date_day, device_installs, device_uninstalls, device_upgrades, install_events, package_name, uninstall_events, update_events, user_installs, user_uninstalls]
          stg_google_play__stats_ratings_app_version:
            weight: 1
            compare_cols: [app_version_code, average_rating, date_day, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_country:
            weight: 1
            compare_cols: [average_rating, country, date_day, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_device:
            weight: 1
            compare_cols: [average_rating, date_day, device, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_os_version:
            weight: 1
            compare_cols: [average_rating, date_day, os_version, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_ratings_overview:
            weight: 1
            compare_cols: [average_rating, date_day, package_name, rolling_total_average_rating, source_relation]
          stg_google_play__stats_store_performance_country:
            weight: 1
            compare_cols: [country, date_day, package_name, store_listing_acquisitions, store_listing_conversion_rate, store_listing_visitors]
          stg_google_play__stats_store_performance_traffic_source:
            weight: 1
            compare_cols: [date_day, package_name, store_listing_acquisitions, store_listing_conversion_rate, store_listing_visitors, traffic_source]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 69
        tables:
          int_app_health_metrics:
            weight: 1
            compare_cols: [app_name, crash_count, crash_rate_30d_avg, crash_rate_7d_avg, crash_rate_per_thousand, crash_rate_trend_7d, crashes_30d_sum, daily_average_rating, data_quality_flag, date_day, health_score, health_status, installs, installs_30d_sum, is_declining_quality, is_high_performing, is_stability_degrading, needs_immediate_attention, platform, rating_7d_avg, rating_trend_7d, total_activity, total_average_rating, uninstall_rate_7d_avg, uninstall_rate_percentage, uninstalls, volume_tier]
          int_apple_store__app_version:
            weight: 0
            compare_cols: []
          int_apple_store__country:
            weight: 0
            compare_cols: []
          int_apple_store__device:
            weight: 0
            compare_cols: []
          int_apple_store__os_version:
            weight: 0
            compare_cols: []
          int_apple_store__overview:
            weight: 0
            compare_cols: []
          int_apple_store__traffic_source:
            weight: 0
            compare_cols: []
          int_channel_performance:
            weight: 0
            compare_cols: []
          int_competitive_gap_assessment:
            weight: 2
            compare_cols: [app_name, competitive_gap_score]
          int_competitor_benchmarking:
            weight: 3
            compare_cols: [app_name]
          int_google_play__app_version:
            weight: 0
            compare_cols: []
          int_google_play__country:
            weight: 0
            compare_cols: []
          int_google_play__device:
            weight: 0
            compare_cols: []
          int_google_play__os_version:
            weight: 0
            compare_cols: []
          int_google_play__overview:
            weight: 0
            compare_cols: []
          int_google_play__traffic_source:
            weight: 0
            compare_cols: []
          int_market_position_analysis:
            weight: 3
            compare_cols: [app_name, market_position_rank]
          int_user_lifecycle_analysis:
            weight: 0
            compare_cols: []
          int_user_rfm_analysis:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          app_reporting__app_health_monitoring_report:
            weight: 0
            compare_cols: []
          app_reporting__app_version_report:
            weight: 0
            compare_cols: []
          app_reporting__channel_effectiveness_report:
            weight: 0
            compare_cols: []
          app_reporting__competitive_intelligence_report:
            weight: 1
            compare_cols: [app_name, market_share_category]
          app_reporting__country_report:
            weight: 0
            compare_cols: []
          app_reporting__device_report:
            weight: 0
            compare_cols: []
          app_reporting__os_version_report:
            weight: 0
            compare_cols: []
          app_reporting__overview_report:
            weight: 1
            compare_cols: [app_name, app_platform, crashes, date_day, deletions, downloads, page_views]
          app_reporting__traffic_source_report:
            weight: 0
            compare_cols: []
          app_reporting__user_lifecycle_report:
            weight: 0
            compare_cols: []
          app_reporting__user_value_segmentation_report:
            weight: 0
            compare_cols: []
  dacomp-de-evol-017:
    database_file: asana.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_asana__project:
            weight: 1
            compare_cols: [current_status, due_date, is_archived, is_public, modified_at, notes, owner_user_id, project_id, project_name, team_id, workspace_id]
          stg_asana__project_task:
            weight: 1
            compare_cols: [project_id, task_id]
          stg_asana__section:
            weight: 1
            compare_cols: [project_id, section_id, section_name]
          stg_asana__story:
            weight: 1
            compare_cols: [created_by_user_id, source, story_id, story_text, story_type, target_id]
          stg_asana__tag:
            weight: 1
            compare_cols: [color, tag_id, tag_name, tag_notes, workspace_id]
          stg_asana__task:
            weight: 1
            compare_cols: [assignee_user_id, completed_at, completed_by_user_id, due_date, is_completed, modified_at, parent_task_id, start_date, task_description, task_id, task_name, workspace_id]
          stg_asana__task_follower:
            weight: 1
            compare_cols: [task_id, user_id]
          stg_asana__task_section:
            weight: 1
            compare_cols: [section_id, task_id]
          stg_asana__task_tag:
            weight: 1
            compare_cols: [tag_id, task_id]
          stg_asana__team:
            weight: 1
            compare_cols: [organization_id, team_id, team_name]
          stg_asana__user:
            weight: 1
            compare_cols: [email, user_id, user_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 79
        tables:
          int_asana__project_health_indicators:
            weight: 0
            compare_cols: []
          int_asana__project_task_metrics:
            weight: 0
            compare_cols: []
          int_asana__project_user:
            weight: 0
            compare_cols: []
          int_asana__real_time_task_status:
            weight: 2
            compare_cols: [is_completed, task_id, task_name]
          int_asana__sprint_cycles:
            weight: 3
            compare_cols: [sprint_end_date, sprint_start_date]
          int_asana__subtask_parent:
            weight: 0
            compare_cols: []
          int_asana__task_assignee:
            weight: 0
            compare_cols: []
          int_asana__task_comments:
            weight: 0
            compare_cols: []
          int_asana__task_dependencies:
            weight: 3
            compare_cols: [dependency_type]
          int_asana__task_first_modifier:
            weight: 0
            compare_cols: []
          int_asana__task_followers:
            weight: 0
            compare_cols: []
          int_asana__task_open_length:
            weight: 0
            compare_cols: []
          int_asana__task_performance_metrics:
            weight: 0
            compare_cols: []
          int_asana__task_projects:
            weight: 0
            compare_cols: []
          int_asana__task_story:
            weight: 0
            compare_cols: []
          int_asana__task_tags:
            weight: 0
            compare_cols: []
          int_asana__user_productivity_trends:
            weight: 1
            compare_cols: [completion_rate_pct, quality_rate_pct, tasks_completed, total_tasks_assigned, user_id]
          int_asana__user_task_metrics:
            weight: 0
            compare_cols: []
          int_asana__workload_forecasting:
            weight: 2
            compare_cols: [team_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 20
        tables:
          asana__daily_metrics:
            weight: 0
            compare_cols: []
          asana__project:
            weight: 0
            compare_cols: []
          asana__project_analytics:
            weight: 0
            compare_cols: []
          asana__tag:
            weight: 0
            compare_cols: []
          asana__task:
            weight: 0
            compare_cols: []
          asana__task_lifecycle_analysis:
            weight: 0
            compare_cols: []
          asana__team:
            weight: 0
            compare_cols: []
          asana__team_efficiency_metrics:
            weight: 1
            compare_cols: [team_name]
          asana__user:
            weight: 0
            compare_cols: []
          asana__user_performance_dashboard:
            weight: 1
            compare_cols: [active_tasks_count, email, user_id, user_name]
  dacomp-de-evol-018:
    database_file: asana.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_asana__project:
            weight: 1
            compare_cols: [current_status, due_date, is_archived, is_public, modified_at, notes, owner_user_id, project_id, project_name, team_id, workspace_id]
          stg_asana__project_task:
            weight: 1
            compare_cols: [project_id, task_id]
          stg_asana__section:
            weight: 1
            compare_cols: [project_id, section_id, section_name]
          stg_asana__story:
            weight: 1
            compare_cols: [created_by_user_id, source, story_id, story_text, story_type, target_id]
          stg_asana__tag:
            weight: 1
            compare_cols: [color, tag_id, tag_name, tag_notes, workspace_id]
          stg_asana__task:
            weight: 1
            compare_cols: [assignee_user_id, completed_at, completed_by_user_id, due_date, is_completed, modified_at, parent_task_id, start_date, task_description, task_id, task_name, workspace_id]
          stg_asana__task_follower:
            weight: 1
            compare_cols: [task_id, user_id]
          stg_asana__task_section:
            weight: 1
            compare_cols: [section_id, task_id]
          stg_asana__task_tag:
            weight: 1
            compare_cols: [tag_id, task_id]
          stg_asana__team:
            weight: 1
            compare_cols: [organization_id, team_id, team_name]
          stg_asana__user:
            weight: 1
            compare_cols: [email, user_id, user_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 69
        tables:
          int_asana__dynamic_billing_rates:
            weight: 3
            compare_cols: []
          int_asana__project_cost_allocation:
            weight: 2
            compare_cols: [project_id]
          int_asana__project_health_indicators:
            weight: 0
            compare_cols: []
          int_asana__project_task_metrics:
            weight: 1
            compare_cols: [number_of_assigned_open_tasks, number_of_open_tasks, number_of_tasks_completed, project_id]
          int_asana__project_user:
            weight: 0
            compare_cols: []
          int_asana__resource_utilization_analysis:
            weight: 4
            compare_cols: []
          int_asana__subtask_parent:
            weight: 0
            compare_cols: []
          int_asana__task_assignee:
            weight: 0
            compare_cols: []
          int_asana__task_comments:
            weight: 0
            compare_cols: []
          int_asana__task_first_modifier:
            weight: 0
            compare_cols: []
          int_asana__task_followers:
            weight: 0
            compare_cols: []
          int_asana__task_open_length:
            weight: 0
            compare_cols: []
          int_asana__task_performance_metrics:
            weight: 0
            compare_cols: []
          int_asana__task_projects:
            weight: 0
            compare_cols: []
          int_asana__task_story:
            weight: 0
            compare_cols: []
          int_asana__task_tags:
            weight: 0
            compare_cols: []
          int_asana__user_productivity_trends:
            weight: 0
            compare_cols: []
          int_asana__user_task_metrics:
            weight: 0
            compare_cols: []
          int_asana__work_time_costing:
            weight: 2
            compare_cols: [task_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          asana__daily_metrics:
            weight: 0
            compare_cols: []
          asana__project:
            weight: 0
            compare_cols: []
          asana__project_analytics:
            weight: 1
            compare_cols: [project_id, project_name, team_name]
          asana__tag:
            weight: 0
            compare_cols: []
          asana__task:
            weight: 0
            compare_cols: []
          asana__task_lifecycle_analysis:
            weight: 0
            compare_cols: []
          asana__team:
            weight: 0
            compare_cols: []
          asana__team_efficiency_metrics:
            weight: 1
            compare_cols: [team_id, team_name, total_projects]
          asana__user:
            weight: 0
            compare_cols: []
          asana__user_performance_dashboard:
            weight: 1
            compare_cols: [comprehensive_performance_score, current_completion_rate, current_quality_rate, email, performance_grade, performance_rank, user_id, user_name]
  dacomp-de-evol-019:
    database_file: google_play.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_google_play__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_name, numeric_code, region, sub_region]
          stg_google_play__earnings:
            weight: 1
            compare_cols: [_fivetran_synced, amount_buyer_currency, amount_merchant_currency, base_plan_id, buyer_country, buyer_currency, buyer_hardware, buyer_postal_code, buyer_state, currency_conversion_rate, merchant_currency, offer_id, order_id, package_name, product_title, product_type, refund_type, sku_id, tax_type, transaction_date, transaction_pt_timestamp, transaction_timezone, transaction_type]
          stg_google_play__stats_crashes_app_version:
            weight: 1
            compare_cols: [_fivetran_synced, android_os_version, anrs, app_version_code, crashes, date_day, package_name]
          stg_google_play__stats_crashes_os_version:
            weight: 1
            compare_cols: [_fivetran_synced, android_os_version, anrs, crashes, date_day, package_name]
          stg_google_play__stats_crashes_overview:
            weight: 1
            compare_cols: [_fivetran_synced, anrs, crashes, date_day, package_name]
          stg_google_play__stats_installs_app_version:
            weight: 1
            compare_cols: [_fivetran_synced, active_device_installs, android_os_version, app_version_code, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, device, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_country:
            weight: 1
            compare_cols: [_fivetran_synced, active_device_installs, country, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_device:
            weight: 1
            compare_cols: [_fivetran_synced, active_device_installs, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, device, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_os_version:
            weight: 1
            compare_cols: [_fivetran_synced, active_device_installs, android_os_version, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_installs_overview:
            weight: 1
            compare_cols: [_fivetran_synced, active_device_installs, current_device_installs, current_user_installs, daily_device_installs, daily_device_uninstalls, daily_device_upgrades, daily_user_installs, daily_user_uninstalls, date_day, install_events, package_name, total_user_installs, uninstall_events, update_events]
          stg_google_play__stats_ratings_app_version:
            weight: 1
            compare_cols: [_fivetran_synced, app_version_code, daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__stats_ratings_country:
            weight: 1
            compare_cols: [_fivetran_synced, country, daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__stats_ratings_device:
            weight: 1
            compare_cols: [_fivetran_synced, daily_average_rating, date_day, device, package_name, total_average_rating]
          stg_google_play__stats_ratings_os_version:
            weight: 1
            compare_cols: [_fivetran_synced, android_os_version, daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__stats_ratings_overview:
            weight: 1
            compare_cols: [_fivetran_synced, daily_average_rating, date_day, package_name, total_average_rating]
          stg_google_play__store_performance_country:
            weight: 1
            compare_cols: [_fivetran_synced, country, date_day, package_name, store_listing_conversion_rate, store_listing_installers, store_listing_visitors]
          stg_google_play__store_performance_source:
            weight: 1
            compare_cols: [_fivetran_synced, date_day, package_name, store_listing_conversion_rate, store_listing_installers, store_listing_visitors, traffic_source]
          stg_google_play__subscriptions_country:
            weight: 1
            compare_cols: [_fivetran_synced, cancelled_subscriptions, country, date_day, new_subscriptions, package_name, product_id, total_active_subscriptions]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_google_play__app_quality_metrics:
            weight: 1
            compare_cols: [anr_rate_per_1k_devices, package_name, quality_category, quality_score, stability_trend, total_stability_issues, version_with_most_crashes]
          int_google_play__device_ecosystem_analysis:
            weight: 3
            compare_cols: [device, device_category, device_performance_tier, device_user_quality_score, os_compatibility_score, package_name]
          int_google_play__earnings:
            weight: 0
            compare_cols: []
          int_google_play__latest_product_info:
            weight: 0
            compare_cols: []
          int_google_play__revenue_analytics:
            weight: 0
            compare_cols: []
          int_google_play__store_performance:
            weight: 0
            compare_cols: []
          int_google_play__traffic_source_performance:
            weight: 4
            compare_cols: [package_name, traffic_source]
          int_google_play__user_behavior_metrics:
            weight: 1
            compare_cols: [active_device_installs, country, daily_average_rating, daily_churn_rate, daily_device_installs, daily_device_uninstalls, growth_momentum, install_uninstall_ratio, market_maturity, package_name, rating_trend, user_engagement_level, weekly_install_growth_rate]
          int_google_play__user_retention_analysis:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          google_play__acquisition_intelligence_dashboard:
            weight: 6
            compare_cols: [package_name]
          google_play__app_version_report:
            weight: 0
            compare_cols: []
          google_play__comprehensive_performance_dashboard:
            weight: 1
            compare_cols: [accelerating_markets, active_devices, average_revenue_per_user, business_health_status, new_subscriptions, package_name, refund_rate, strong_retention_markets]
          google_play__country_report:
            weight: 0
            compare_cols: []
          google_play__device_report:
            weight: 0
            compare_cols: []
          google_play__finance_report:
            weight: 0
            compare_cols: []
          google_play__geo_market_analysis:
            weight: 0
            compare_cols: []
          google_play__os_version_report:
            weight: 0
            compare_cols: []
          google_play__overview_report:
            weight: 0
            compare_cols: []
          google_play__product_portfolio_analysis:
            weight: 0
            compare_cols: []
          google_play__time_series_trends:
            weight: 0
            compare_cols: []
  dacomp-de-evol-020:
    database_file: google_play.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 30
        tables:
          stg_google_play__country_codes:
            weight: 0
            compare_cols: []
          stg_google_play__earnings:
            weight: 0
            compare_cols: []
          stg_google_play__exchange_rates:
            weight: 2
            compare_cols: [currency_code]
          stg_google_play__stats_crashes_app_version:
            weight: 0
            compare_cols: []
          stg_google_play__stats_crashes_os_version:
            weight: 0
            compare_cols: []
          stg_google_play__stats_crashes_overview:
            weight: 0
            compare_cols: []
          stg_google_play__stats_installs_app_version:
            weight: 0
            compare_cols: []
          stg_google_play__stats_installs_country:
            weight: 0
            compare_cols: []
          stg_google_play__stats_installs_device:
            weight: 0
            compare_cols: []
          stg_google_play__stats_installs_os_version:
            weight: 0
            compare_cols: []
          stg_google_play__stats_installs_overview:
            weight: 0
            compare_cols: []
          stg_google_play__stats_ratings_app_version:
            weight: 0
            compare_cols: []
          stg_google_play__stats_ratings_country:
            weight: 0
            compare_cols: []
          stg_google_play__stats_ratings_device:
            weight: 0
            compare_cols: []
          stg_google_play__stats_ratings_os_version:
            weight: 0
            compare_cols: []
          stg_google_play__stats_ratings_overview:
            weight: 0
            compare_cols: []
          stg_google_play__store_performance_country:
            weight: 0
            compare_cols: []
          stg_google_play__store_performance_source:
            weight: 0
            compare_cols: []
          stg_google_play__subscriptions_country:
            weight: 0
            compare_cols: []
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 10
        tables:
          int_google_play__app_quality_metrics:
            weight: 0
            compare_cols: []
          int_google_play__earnings:
            weight: 0
            compare_cols: []
          int_google_play__latest_product_info:
            weight: 0
            compare_cols: []
          int_google_play__revenue_analytics:
            weight: 1
            compare_cols: [average_transaction_value, daily_paying_transactions, date_day, new_subscriptions, package_name, product_title, refund_rate, revenue_tier, sku_id, total_active_subscriptions, total_transactions, weekly_revenue_growth_rate]
          int_google_play__store_performance:
            weight: 0
            compare_cols: []
          int_google_play__user_behavior_metrics:
            weight: 0
            compare_cols: []
          int_google_play__user_retention_analysis:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          google_play__app_version_report:
            weight: 0
            compare_cols: []
          google_play__comprehensive_performance_dashboard:
            weight: 0
            compare_cols: []
          google_play__country_report:
            weight: 0
            compare_cols: []
          google_play__device_report:
            weight: 0
            compare_cols: []
          google_play__finance_report:
            weight: 1
            compare_cols: [package_name]
          google_play__financial_alerts_monitor:
            weight: 2
            compare_cols: [buyer_country, package_name, sku_id]
          google_play__financial_attribution_analysis:
            weight: 1
            compare_cols: [package_name, sku_id]
          google_play__geo_market_analysis:
            weight: 0
            compare_cols: []
          google_play__os_version_report:
            weight: 0
            compare_cols: []
          google_play__overview_report:
            weight: 0
            compare_cols: []
          google_play__product_portfolio_analysis:
            weight: 0
            compare_cols: []
          google_play__revenue_quality_dashboard:
            weight: 2
            compare_cols: [package_name]
          google_play__time_series_trends:
            weight: 0
            compare_cols: []
  dacomp-de-evol-021:
    database_file: hubspot.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marketing
      - pg_catalog
      - raw
      - sales
      - service
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_hubspot__company:
            weight: 1
            compare_cols: [address, address_2, annual_revenue, city, company_id, company_name, country, description, industry, is_company_deleted, state]
          stg_hubspot__contact:
            weight: 1
            compare_cols: [calculated_merged_vids, company_annual_revenue, contact_company, contact_id, email, first_conversion_date, first_name, is_contact_deleted, job_title, last_name]
          stg_hubspot__deal:
            weight: 1
            compare_cols: [amount, deal_id, deal_name, deal_pipeline_id, deal_pipeline_stage_id, description, is_deal_deleted, owner_id, portal_id]
          stg_hubspot__deal_contact:
            weight: 1
            compare_cols: [association_category, association_type_id, contact_id, deal_id]
          stg_hubspot__deal_pipeline:
            weight: 1
            compare_cols: [ created_timestamp, deal_pipeline_id, is_pipeline_active, pipeline_display_order, pipeline_label, updated_timestamp]
          stg_hubspot__deal_pipeline_stage:
            weight: 1
            compare_cols: [ created_timestamp, deal_pipeline_id, deal_pipeline_stage_id, is_closed_won, is_deal_pipeline_stage_deleted, is_stage_active, is_stage_closed, pipeline_stage_label, stage_display_order, stage_probability, updated_timestamp]
          stg_hubspot__email_event:
            weight: 1
            compare_cols: [ app_id, caused_by_created_timestamp, caused_by_id, created_timestamp, email_campaign_id, email_event_filtered, email_event_id, email_event_type, obsoleted_by_created_timestamp, obsoleted_by_id, portal_id, recipient_email_address, sent_by_created_timestamp, sent_by_id]
          stg_hubspot__email_event_click:
            weight: 1
            compare_cols: [click_browser, click_ip_address, click_location, click_referer, click_user_agent, clicked_url, email_event_id]
          stg_hubspot__email_event_open:
            weight: 1
            compare_cols: [ email_event_id, open_browser, open_duration, open_ip_address, open_location, open_user_agent]
          stg_hubspot__email_event_sent:
            weight: 1
            compare_cols: [ email_bcc, email_cc, email_event_id, email_from, email_reply_to, email_subject]
          stg_hubspot__email_event_status_change:
            weight: 1
            compare_cols: [email_event_id, is_bounced, status_change_requested_by, status_change_source, subscription_changes, subscription_status]
          stg_hubspot__engagement:
            weight: 1
            compare_cols: [engagement_id, engagement_type, portal_id]
          stg_hubspot__engagement_email:
            weight: 1
            compare_cols: [all_owner_ids, all_team_ids, email_subject, email_text, engagement_id, engagement_type, last_modified_date, modified_by, owner_id, team_id]
          stg_hubspot__form:
            weight: 1
            compare_cols: [follow_up_id, form_action, form_css_class, form_id, form_method, form_name, form_redirect, form_submit_text, form_type, lead_nurturing_campaign_id, notify_recipients, portal_id, updated_timestamp]
          stg_hubspot__owner:
            weight: 1
            compare_cols: [active_user_id, email_address, first_name, full_name, last_name, owner_id, owner_type, portal_id, updated_timestamp]
          stg_hubspot__ticket:
            weight: 1
            compare_cols: [closed_date, first_agent_reply_date, is_ticket_deleted, owner_id, ticket_category, ticket_content, ticket_id, ticket_pipeline_id, ticket_pipeline_stage_id, ticket_priority, ticket_subject]
          stg_hubspot__ticket_company:
            weight: 1
            compare_cols: [association_category, company_id, ticket_id]
          stg_hubspot__ticket_contact:
            weight: 1
            compare_cols: [association_category, contact_id, ticket_id]
          stg_hubspot__ticket_pipeline:
            weight: 1
            compare_cols: [is_pipeline_active, is_ticket_pipeline_deleted, object_type_id, pipeline_display_order, pipeline_label, ticket_pipeline_id, updated_timestamp]
          stg_hubspot__ticket_pipeline_stage:
            weight: 1
            compare_cols: [is_closed, is_stage_active, is_ticket_pipeline_stage_deleted, pipeline_stage_label, stage_display_order, ticket_pipeline_id, ticket_pipeline_stage_id, ticket_state, updated_timestamp]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 29
        tables:
          int_hubspot__contact_lifecycle_metrics:
            weight: 0
            compare_cols: []
          int_hubspot__contact_merge_adjust:
            weight: 0
            compare_cols: []
          int_hubspot__customer_experience_scoring:
            weight: 1
            compare_cols: [campaign_participation_score, classification_order_applied, contact_id, customer_experience_health_score, customer_risk_tier, data_window_end_date, data_window_start_date, email, email_click_score, email_open_score, marketing_engagement_score, marketing_pause_flag, pause_scope, pause_start_time, reset_count_in_period, resolution_delay_score, risk_classification_reason, support_pressure_score, ticket_frequency_score, ticket_priority_score, trend_comparison_available, trigger_ticket_id]
          int_hubspot__deal_performance_metrics:
            weight: 0
            compare_cols: []
          int_hubspot__deals_enhanced:
            weight: 0
            compare_cols: []
          int_hubspot__email_aggregate_status_change:
            weight: 0
            compare_cols: []
          int_hubspot__email_event_aggregates:
            weight: 0
            compare_cols: []
          int_hubspot__email_marketing_attribution:
            weight: 0
            compare_cols: []
          int_hubspot__owner_performance_metrics:
            weight: 0
            compare_cols: []
          int_hubspot__owners_enhanced:
            weight: 0
            compare_cols: []
      marketing:
        description: 'Custom layer: marketing'
        weight: 20
        tables:
          hubspot__campaign_performance_analysis:
            weight: 1
            compare_cols: []
          hubspot__contact_engagement_analysis:
            weight: 1
            compare_cols: [contact_id, email, days_to_conversion, contact_maturity_segment, conversion_status, conversion_velocity_score, total_emails_sent, total_emails_opened, total_emails_clicked, total_emails_bounced, email_open_rate, email_click_through_rate, total_associated_deals, total_closed_deals, total_deal_value, avg_deal_value, overall_engagement_score, engagement_tier, final_engagement_classification, email_campaigns_engaged, total_emails_opened, email_attributed_deals, engagement_recency_status, customer_value_segment, revenue_per_email_sent, mql_classification, email_attributed_revenue, sales_readiness_status, primary_attribution_type, revenue_per_day_known, comprehensive_engagement_score]
          hubspot__contacts:
            weight: 0
            compare_cols: []
          hubspot__email_event_sent:
            weight: 0
            compare_cols: []
          hubspot__email_sends:
            weight: 0
            compare_cols: []
      sales:
        description: 'Custom layer: sales'
        weight: 0
        tables:
          hubspot__companies:
            weight: 3
            compare_cols: [company_id, company_name, description, industry, address, address_2, city, state, country, annual_revenue]
          hubspot__deals:
            weight: 3
            compare_cols: [deal_id, deal_pipeline_id, deal_pipeline_stage_id, owner_id, portal_id, deal_name, description, amount, pipeline_label, is_pipeline_active, pipeline_stage_label, owner_active_user_id, owner_email_address, owner_full_name]
          hubspot__sales_performance_dashboard:
            weight: 3
            compare_cols: [created_year, created_quarter, deals_created_in_quarter, deals_won_in_quarter, deals_lost_in_quarter, deals_still_open, revenue_won_in_quarter, pipeline_value_in_quarter, total_open_pipeline, quarterly_win_rate, prev_quarter_win_rate, prev_quarter_revenue, revenue_growth_rate, avg_won_deal_size, p25_deal_size, p75_deal_size, active_sales_reps_in_quarter, revenue_per_sales_rep, weighted_pipeline_forecast, time_weighted_forecast, quarterly_performance_rating, quarterly_goal_status]
          hubspot__sales_rep_performance:
            weight: 3
            compare_cols: [owner_id, owner_name, owner_email, total_deals, won_deals, total_won_revenue, win_rate_percentage, avg_won_cycle_time, current_pipeline_value, enterprise_win_rate, large_deal_win_rate, enterprise_revenue, large_revenue, medium_revenue, small_revenue, revenue_rank, win_rate_rank, volume_rank, efficiency_rank, revenue_percentile, win_rate_percentile, volume_percentile, efficiency_percentile, overall_performance_score, performance_tier, sales_specialization, development_focus, pipeline_health_status, primary_deal_segment, segments_covered, activity_level, activity_consistency, recent_active_months, performance_trend, revenue_trend_percentage, win_rate_trend_points, revenue_volatility]
      service:
        description: 'Custom layer: service'
        weight: 20
        tables:
          hubspot__customer_support_analytics:
            weight: 1
            compare_cols: [ticket_id, ticket_subject, ticket_pipeline, ticket_stage, ticket_status, priority_level, days_open, sla_status, resolution_efficiency, urgency_score, risk_level, service_quality_rating, escalation_recommendation, agent_first_name, agent_last_name, agent_email, contact_first_name, contact_last_name, contact_email, contact_job_title, company_name, company_industry, company_annual_revenue, customer_segment]
          hubspot__tickets:
            weight: 0
            compare_cols: []
          hubspot__unified_customer_health_dashboard:
            weight: 5
            compare_cols: []
  dacomp-de-evol-022:
    database_file: hubspot.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marketing
      - pg_catalog
      - raw
      - sales
      - service
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_hubspot__company:
            weight: 1
            compare_cols: [address, address_2, annual_revenue, city, company_id, company_name, country, description, industry, is_company_deleted, state]
          stg_hubspot__contact:
            weight: 1
            compare_cols: [calculated_merged_vids, company_annual_revenue, contact_company, contact_id, email, first_conversion_date, first_name, is_contact_deleted, job_title, last_name]
          stg_hubspot__deal:
            weight: 1
            compare_cols: [amount, closed_date, deal_id, deal_name, deal_pipeline_id, deal_pipeline_stage_id, description, is_deal_deleted, owner_id, portal_id]
          stg_hubspot__deal_contact:
            weight: 1
            compare_cols: [association_category, association_type_id, contact_id, deal_id]
          stg_hubspot__deal_pipeline:
            weight: 1
            compare_cols: [created_timestamp, deal_pipeline_id, is_pipeline_active, pipeline_display_order, pipeline_label, updated_timestamp]
          stg_hubspot__deal_pipeline_stage:
            weight: 1
            compare_cols: [created_timestamp, deal_pipeline_id, deal_pipeline_stage_id, is_closed_won, is_deal_pipeline_stage_deleted, is_stage_active, is_stage_closed, pipeline_stage_label, stage_display_order, stage_probability, updated_timestamp]
          stg_hubspot__email_event:
            weight: 1
            compare_cols: [_fivetran_synced, app_id, caused_by_created_timestamp, caused_by_id, created_timestamp, email_campaign_id, email_event_filtered, email_event_id, email_event_type, obsoleted_by_created_timestamp, obsoleted_by_id, portal_id, recipient_email_address, sent_by_created_timestamp, sent_by_id]
          stg_hubspot__email_event_click:
            weight: 1
            compare_cols: [_fivetran_synced, click_browser, click_ip_address, click_location, click_referer, click_user_agent, clicked_url, email_event_id]
          stg_hubspot__email_event_open:
            weight: 1
            compare_cols: [_fivetran_synced, email_event_id, open_browser, open_duration, open_ip_address, open_location, open_user_agent]
          stg_hubspot__email_event_sent:
            weight: 1
            compare_cols: [_fivetran_synced, email_bcc, email_cc, email_event_id, email_from, email_reply_to, email_subject]
          stg_hubspot__email_event_status_change:
            weight: 1
            compare_cols: [email_event_id, is_bounced, status_change_requested_by, status_change_source, subscription_changes, subscription_status]
          stg_hubspot__engagement:
            weight: 1
            compare_cols: [_fivetran_synced, engagement_id, engagement_type, portal_id]
          stg_hubspot__engagement_email:
            weight: 1
            compare_cols: [_fivetran_synced, all_owner_ids, all_team_ids, email_subject, email_text, engagement_id, engagement_timestamp, engagement_type, last_modified_date, modified_by, owner_id, team_id]
          stg_hubspot__form:
            weight: 1
            compare_cols: [_fivetran_synced, created_timestamp, follow_up_id, form_action, form_css_class, form_id, form_method, form_name, form_redirect, form_submit_text, form_type, lead_nurturing_campaign_id, notify_recipients, portal_id, updated_timestamp]
          stg_hubspot__owner:
            weight: 1
            compare_cols: [_fivetran_synced, active_user_id, created_timestamp, email_address, first_name, full_name, last_name, owner_id, owner_type, portal_id, updated_timestamp]
          stg_hubspot__ticket:
            weight: 1
            compare_cols: [_fivetran_synced, closed_date, first_agent_reply_date, is_ticket_deleted, owner_id, ticket_category, ticket_content, ticket_id, ticket_pipeline_id, ticket_pipeline_stage_id, ticket_priority, ticket_subject]
          stg_hubspot__ticket_company:
            weight: 1
            compare_cols: [_fivetran_synced, association_category, company_id, ticket_id]
          stg_hubspot__ticket_contact:
            weight: 1
            compare_cols: [association_category, contact_id, ticket_id]
          stg_hubspot__ticket_pipeline:
            weight: 1
            compare_cols: [_fivetran_synced, created_timestamp, is_pipeline_active, is_ticket_pipeline_deleted, object_type_id, pipeline_display_order, pipeline_label, ticket_pipeline_id, updated_timestamp]
          stg_hubspot__ticket_pipeline_stage:
            weight: 1
            compare_cols: [_fivetran_synced, created_timestamp, is_closed, is_stage_active, is_ticket_pipeline_stage_deleted, pipeline_stage_label, stage_display_order, ticket_pipeline_id, ticket_pipeline_stage_id, ticket_state, updated_timestamp]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 99
        tables:
          int_hubspot__contact_lifecycle_metrics:
            weight: 0
            compare_cols: []
          int_hubspot__contact_merge_adjust:
            weight: 0
            compare_cols: []
          int_hubspot__deal_performance_metrics:
            weight: 0
            compare_cols: []
          int_hubspot__deals_enhanced:
            weight: 0
            compare_cols: []
          int_hubspot__email_aggregate_status_change:
            weight: 0
            compare_cols: []
          int_hubspot__email_event_aggregates:
            weight: 0
            compare_cols: []
          int_hubspot__email_marketing_attribution:
            weight: 1
            compare_cols: [attributed_deals, attributed_revenue, campaign_performance_tier, email_campaign_id, revenue_per_send, roi_tier, total_sends, unique_recipients]
          int_hubspot__email_segmentation_analysis:
            weight: 4
            compare_cols: []
          int_hubspot__owner_performance_metrics:
            weight: 1
            compare_cols: [avg_won_cycle_time, avg_won_deal_size, development_focus, first_deal_date, last_won_date, latest_deal_date, lost_deals, open_deals, overall_performance_score, owner_email, owner_id, owner_name, performance_tier, pipeline_value, revenue_rank, total_deals, total_won_revenue, win_rate_percentage, win_rate_rank, won_deals]
          int_hubspot__owners_enhanced:
            weight: 0
            compare_cols: []
          int_hubspot__revenue_recognition_tracking:
            weight: 0
            compare_cols: []
          int_hubspot__sales_activity_analysis:
            weight: 4
            compare_cols: [owner_id]
          int_hubspot__service_quality_metrics:
            weight: 0
            compare_cols: []
      marketing:
        description: 'Custom layer: marketing'
        weight: 0
        tables:
          hubspot__campaign_performance_analysis:
            weight: 3
            compare_cols: []
          hubspot__contact_engagement_analysis:
            weight: 3
            compare_cols: [contact_id, email, days_to_conversion, contact_maturity_segment, conversion_status, conversion_velocity_score, total_emails_sent, total_emails_opened, total_emails_clicked, total_emails_bounced, email_open_rate, email_click_through_rate, total_associated_deals, total_closed_deals, total_deal_value, avg_deal_value, overall_engagement_score, engagement_tier, final_engagement_classification, email_campaigns_engaged, total_emails_opened, email_attributed_deals, engagement_recency_status, customer_value_segment, revenue_per_email_sent, mql_classification, email_attributed_revenue, sales_readiness_status, primary_attribution_type, revenue_per_day_known, comprehensive_engagement_score]
          hubspot__contacts:
            weight: 3
            compare_cols: [contact_id, calculated_merged_vids, email, first_name, last_name, contact_company, job_title, company_annual_revenue, total_email_opens, total_email_clicks, total_email_bounces, total_unique_email_prints, total_unique_email_drops, total_email_deliveries, total_email_drops, total_email_forwards, total_unique_email_opens, total_unique_email_deliveries, total_unique_email_deferrals, total_email_spam_reports, total_unique_email_clicks, total_email_deferrals, total_unique_email_bounces, total_unique_email_spam_reports, total_email_unsubscribes, total_unique_email_unsubscribes, total_email_prints, total_unique_email_forwards]
          hubspot__email_event_sent:
            weight: 3
            compare_cols: [email_event_id, email_send_id, email_campaign_id, contact_id, recipient_email_address, email_from, email_reply_to, email_subject, email_bcc, email_cc]
          hubspot__email_sends:
            weight: 3
            compare_cols: [email_send_id, email_event_id, email_campaign_id, contact_id, recipient_email_address email_from, email_reply_to, email_subject, email_bcc, email_cc, was_delivered, was_opened, was_clicked, was_bounced, was_deferred, was_spam_reported, was_unsubscribed, was_forwarded, was_printed, opens, clicks, deliveries, bounces, deferrals, drops, forwards, prints, spam_reports, unsubscribes]
      sales:
        description: 'Custom layer: sales'
        weight: 0
        tables:
          hubspot__companies:
            weight: 3
            compare_cols: [company_id, company_name, description, industry, address, address_2, city, state, country, annual_revenue]
          hubspot__deals:
            weight: 3
            compare_cols: [deal_id, deal_pipeline_id, deal_pipeline_stage_id, owner_id, portal_id, deal_name, description, amount, pipeline_label, is_pipeline_active, pipeline_stage_label, owner_active_user_id, owner_email_address, owner_full_name]
          hubspot__sales_performance_dashboard:
            weight: 3
            compare_cols: [created_year, created_quarter, deals_created_in_quarter, deals_won_in_quarter, deals_lost_in_quarter, deals_still_open, revenue_won_in_quarter, pipeline_value_in_quarter, total_open_pipeline, quarterly_win_rate, prev_quarter_win_rate, prev_quarter_revenue, revenue_growth_rate, avg_won_deal_size, p25_deal_size, p75_deal_size, active_sales_reps_in_quarter, revenue_per_sales_rep, weighted_pipeline_forecast, time_weighted_forecast, quarterly_performance_rating, quarterly_goal_status]
          hubspot__sales_rep_performance:
            weight: 3
            compare_cols: [owner_id, owner_name, owner_email, total_deals, won_deals, total_won_revenue, win_rate_percentage, avg_won_cycle_time, current_pipeline_value, enterprise_win_rate, large_deal_win_rate, enterprise_revenue, large_revenue, medium_revenue, small_revenue, revenue_rank, win_rate_rank, volume_rank, efficiency_rank, revenue_percentile, win_rate_percentile, volume_percentile, efficiency_percentile, overall_performance_score, performance_tier, sales_specialization, development_focus, pipeline_health_status, primary_deal_segment, segments_covered, activity_level, activity_consistency, recent_active_months, performance_trend, revenue_trend_percentage, win_rate_trend_points, revenue_volatility]
      service:
        description: 'Custom layer: service'
        weight: 0
        tables:
          hubspot__customer_support_analytics:
            weight: 0
            compare_cols: []
          hubspot__tickets:
            weight: 0
            compare_cols: []
  dacomp-de-evol-023:
    database_file: jira.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_jira__comment:
            weight: 1
            compare_cols: [author_user_id, body, comment_id, is_public, issue_id, last_update_user_id, last_updated_at]
          stg_jira__component:
            weight: 1
            compare_cols: [component_description, component_id, component_name, project_id]
          stg_jira__field:
            weight: 1
            compare_cols: [field_id, field_name, is_array, is_custom]
          stg_jira__field_option:
            weight: 1
            compare_cols: [field_id, field_option_id, field_option_name]
          stg_jira__issue:
            weight: 1
            compare_cols: [assignee_user_id, creator_user_id, due_date, environment, issue_description, issue_id, issue_key, issue_name, issue_type_id, original_estimate_seconds, parent_issue_id, priority_id, project_id, remaining_estimate_seconds, reporter_user_id, resolution_id, resolved_at, status_changed_at, status_id, time_spent_seconds, updated_at, work_ratio]
          stg_jira__issue_field_history:
            weight: 1
            compare_cols: [field_id, field_value, is_active, issue_id, updated_at]
          stg_jira__issue_link:
            weight: 1
            compare_cols: [issue_id, related_issue_id]
          stg_jira__issue_multiselect_history:
            weight: 1
            compare_cols: [field_id, field_value, is_active, issue_id, updated_at]
          stg_jira__issue_type:
            weight: 1
            compare_cols: [description, is_subtask, issue_type_id, issue_type_name]
          stg_jira__priority:
            weight: 1
            compare_cols: [priority_description, priority_id, priority_name]
          stg_jira__project:
            weight: 1
            compare_cols: [permission_scheme_id, project_category_id, project_description, project_id, project_key, project_lead_user_id, project_name]
          stg_jira__resolution:
            weight: 1
            compare_cols: [resolution_description, resolution_id, resolution_name]
          stg_jira__sprint:
            weight: 1
            compare_cols: [board_id, completed_at, ended_at, sprint_id, sprint_name, started_at]
          stg_jira__status:
            weight: 1
            compare_cols: [status_category_id, status_description, status_id, status_name]
          stg_jira__status_category:
            weight: 1
            compare_cols: [status_category_id, status_category_name]
          stg_jira__user:
            weight: 1
            compare_cols: [email, is_active, locale, time_zone, user_display_name, user_id, username]
          stg_jira__version:
            weight: 1
            compare_cols: [description, is_archived, is_released, project_id, release_date, start_date, version_id, version_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 69
        tables:
          int_jira__daily_status_transitions:
            weight: 2
            compare_cols: [issue_id, status_id, status_name]
          int_jira__field_history_scd:
            weight: 0
            compare_cols: []
          int_jira__issue_assign_resolution:
            weight: 0
            compare_cols: []
          int_jira__issue_calendar_spine:
            weight: 0
            compare_cols: []
          int_jira__issue_comments:
            weight: 0
            compare_cols: []
          int_jira__issue_epic:
            weight: 0
            compare_cols: []
          int_jira__issue_field_history:
            weight: 0
            compare_cols: []
          int_jira__issue_join:
            weight: 0
            compare_cols: []
          int_jira__issue_lifecycle_analysis:
            weight: 0
            compare_cols: []
          int_jira__issue_multiselect_history:
            weight: 0
            compare_cols: []
          int_jira__issue_sprint:
            weight: 0
            compare_cols: []
          int_jira__issue_type_parents:
            weight: 0
            compare_cols: []
          int_jira__issue_users:
            weight: 0
            compare_cols: []
          int_jira__issue_versions:
            weight: 0
            compare_cols: []
          int_jira__pivot_daily_field_history:
            weight: 0
            compare_cols: []
          int_jira__project_health_scoring:
            weight: 0
            compare_cols: []
          int_jira__project_metrics:
            weight: 0
            compare_cols: []
          int_jira__sprint_performance_analytics:
            weight: 0
            compare_cols: []
          int_jira__user_activity_metrics:
            weight: 1
            compare_cols: [activity_velocity, at_churn_risk, consistency_score_30d, consistency_score_7d, daily_activity_score, rolling_7d_activity_score, user_id, user_pattern_type]
          int_jira__user_main_project:
            weight: 2
            compare_cols: [main_project_id, user_id]
          int_jira__user_metrics:
            weight: 0
            compare_cols: []
          int_jira__version_mapping:
            weight: 2
            compare_cols: [issue_id, project_id, version_id, version_name]
          int_jira__workload_saturation:
            weight: 2
            compare_cols: [resource_scarcity_index, user_id, workload_saturation_level]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          jira__daily_issue_field_history:
            weight: 0
            compare_cols: []
          jira__daily_sprint_issue_history:
            weight: 1
            compare_cols: [assignee_name, assignee_user_id, board_id, date_day, date_week, days_left_in_sprint, is_issue_open, is_issue_resolved_in_sprint, is_sprint_active, is_sprint_completed, issue_created_at, issue_id, issue_key, original_estimate_seconds, remaining_estimate_seconds, sprint_id, sprint_issue_day_id, sprint_name, status, story_point_estimate, story_points, time_spent_seconds]
          jira__issue_enhanced:
            weight: 0
            compare_cols: []
          jira__issue_intelligence_analytics:
            weight: 0
            compare_cols: []
          jira__issue_intelligence_simple:
            weight: 0
            compare_cols: []
          jira__project_enhanced:
            weight: 0
            compare_cols: []
          jira__project_risk_assessment:
            weight: 0
            compare_cols: []
          jira__project_risk_simple:
            weight: 0
            compare_cols: []
          jira__sprint_enhanced:
            weight: 0
            compare_cols: []
          jira__stakeholder_engagement_insights:
            weight: 0
            compare_cols: []
          jira__team_performance_dashboard:
            weight: 1
            compare_cols: [at_churn_risk, current_engagement_tier, current_lifecycle_stage, current_pattern_type, email, estimate_accuracy_percentage, overall_performance_score, performance_tier, project_id, project_name, resolution_rate_percentage, user_display_name, user_id]
          jira__team_performance_dashboard_simple:
            weight: 0
            compare_cols: []
          jira__user_enhanced:
            weight: 0
            compare_cols: []
          jira__version_delivery_analytics:
            weight: 2
            compare_cols: [completion_percentage, overdue_issues, project_id, resolved_issues, resource_scarcity_index, total_issues, version_completion_risk_score, version_id, version_name, version_risk_tier, version_status]
  dacomp-de-evol-024:
    database_file: jira.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_jira__comment:
            weight: 1
            compare_cols: [author_user_id, body, comment_id, is_public, issue_id, last_update_user_id]
          stg_jira__component:
            weight: 1
            compare_cols: [component_id, component_name, project_id]
          stg_jira__field:
            weight: 1
            compare_cols: [field_id, field_name, is_array, is_custom]
          stg_jira__field_option:
            weight: 1
            compare_cols: [field_id, field_option_name]
          stg_jira__issue:
            weight: 1
            compare_cols: [assignee_user_id, creator_user_id, due_date, environment, issue_description, issue_id, issue_key, issue_name, issue_type_id, original_estimate_seconds, parent_issue_id, priority_id, project_id, remaining_estimate_seconds, reporter_user_id, resolution_id, status_id, time_spent_seconds, work_ratio]
          stg_jira__issue_field_history:
            weight: 1
            compare_cols: [field_id, field_value, is_active, issue_id]
          stg_jira__issue_link:
            weight: 1
            compare_cols: [issue_id, link_type_id, related_issue_id]
          stg_jira__issue_multiselect_history:
            weight: 1
            compare_cols: [field_id, field_value, is_active, issue_id, updated_at]
          stg_jira__issue_type:
            weight: 1
            compare_cols: [description, is_subtask, issue_type_id, issue_type_name]
          stg_jira__priority:
            weight: 1
            compare_cols: [priority_description, priority_id, priority_name]
          stg_jira__project:
            weight: 1
            compare_cols: [permission_scheme_id, project_category_id, project_description, project_id, project_key, project_lead_user_id, project_name]
          stg_jira__resolution:
            weight: 1
            compare_cols: [resolution_description, resolution_id, resolution_name]
          stg_jira__sprint:
            weight: 1
            compare_cols: [board_id, sprint_id, sprint_name]
          stg_jira__status:
            weight: 1
            compare_cols: [status_category_id, status_description, status_id, status_name]
          stg_jira__status_category:
            weight: 1
            compare_cols: [status_category_id, status_category_name]
          stg_jira__user:
            weight: 1
            compare_cols: [email, is_active, locale, time_zone, user_display_name, user_id, username]
          stg_jira__version:
            weight: 1
            compare_cols: [description, is_archived, is_released, project_id, release_date, start_date, version_id, version_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 54
        tables:
          int_jira__capacity_baseline_calculation:
            weight: 2
            compare_cols: [sprint_id]
          int_jira__cross_sprint_dependency_analysis:
            weight: 3
            compare_cols: []
          int_jira__daily_issue_field_history:
            weight: 0
            compare_cols: []
          int_jira__field_history_scd:
            weight: 0
            compare_cols: []
          int_jira__issue_assign_resolution:
            weight: 0
            compare_cols: []
          int_jira__issue_calendar_spine:
            weight: 0
            compare_cols: []
          int_jira__issue_comments:
            weight: 0
            compare_cols: []
          int_jira__issue_epic:
            weight: 0
            compare_cols: []
          int_jira__issue_field_history:
            weight: 0
            compare_cols: []
          int_jira__issue_join:
            weight: 0
            compare_cols: []
          int_jira__issue_lifecycle_analysis:
            weight: 0
            compare_cols: []
          int_jira__issue_multiselect_history:
            weight: 0
            compare_cols: []
          int_jira__issue_sprint:
            weight: 0
            compare_cols: []
          int_jira__issue_type_parents:
            weight: 0
            compare_cols: []
          int_jira__issue_users:
            weight: 0
            compare_cols: []
          int_jira__issue_versions:
            weight: 0
            compare_cols: []
          int_jira__pivot_daily_field_history:
            weight: 0
            compare_cols: []
          int_jira__project_health_scoring:
            weight: 0
            compare_cols: []
          int_jira__project_metrics:
            weight: 0
            compare_cols: []
          int_jira__sprint_performance_analytics:
            weight: 1
            compare_cols: [sprint_id]
          int_jira__team_collaboration_metrics:
            weight: 3
            compare_cols: [project_id]
          int_jira__user_activity_metrics:
            weight: 1
            compare_cols: [user_id]
          int_jira__user_metrics:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 45
        tables:
          jira__daily_issue_field_history:
            weight: 0
            compare_cols: []
          jira__daily_sprint_issue_history:
            weight: 1
            compare_cols: [issue_id, sprint_id]
          jira__dependency_risk_monitor:
            weight: 4
            compare_cols: [dependency_risk_level]
          jira__issue_enhanced:
            weight: 0
            compare_cols: []
          jira__issue_intelligence_analytics:
            weight: 0
            compare_cols: []
          jira__issue_intelligence_simple:
            weight: 0
            compare_cols: []
          jira__project_enhanced:
            weight: 0
            compare_cols: []
          jira__project_risk_assessment:
            weight: 0
            compare_cols: []
          jira__project_risk_simple:
            weight: 0
            compare_cols: []
          jira__sprint_enhanced:
            weight: 0
            compare_cols: []
          jira__sprint_quality_dashboard:
            weight: 4
            compare_cols: [quality_efficiency_score, sprint_id, sprint_name]
          jira__stakeholder_engagement_insights:
            weight: 0
            compare_cols: []
          jira__team_performance_dashboard:
            weight: 1
            compare_cols: [at_churn_risk, avg_daily_activity_score, avg_resolution_days, avg_sprint_completion_rate, avg_weekly_activity_score, bug_issues, consistency_percentage, current_engagement_tier, current_lifecycle_stage, current_pattern_type, days_since_first_issue, email, epic_issues, estimate_accuracy_percentage, high_priority_issues, inactive_recently, issue_types_worked_on, leadership_indicator, linked_issues, overall_performance_score, performance_tier, poor_estimation, project_id, project_name, projects_contributed_to, resolution_rate_percentage, resolved_issues, sprint_count, total_assigned_issues, total_story_points_delivered, unique_collaborators_on_issues, user_display_name, user_id]
          jira__team_performance_dashboard_simple:
            weight: 0
            compare_cols: []
          jira__user_enhanced:
            weight: 0
            compare_cols: []
  dacomp-de-evol-025:
    database_file: marketo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
      - utils
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_marketo__activity_change_data_value:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, api_method_name, campaign_id, field_name, lead_id, modifying_user, new_value, old_value, primary_attribute_value_id, reason, request_id, source]
          stg_marketo__activity_click_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, click_device, click_link_url, click_platform, click_user_agent, email_send_id, email_template_id, is_mobile_device, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_delete_lead:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_email_bounced:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_email_delivered:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_merge_leads:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, lead_id, merged_lead_ids, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_open_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, is_mobile_device, lead_id, open_device, open_platform, open_user_agent, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_send_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_unsubscribe_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__campaigns:
            weight: 1
            compare_cols: [campaign_id, campaign_name, campaign_type, computed_url, created_timestamp, description, flow_id, folder_id, folder_type, is_active, is_communication_limit_enabled, is_requestable, is_system, max_members, program_id, qualification_rule_interval, qualification_rule_type, qualification_rule_unit, recurrence_day_of_month, recurrence_day_of_week, recurrence_end_at, recurrence_interval, recurrence_interval_type, recurrence_start_at, recurrence_week_of_month, recurrence_weekday_only, smart_list_id, status, updated_timestamp, workspace_name]
          stg_marketo__email_template_history:
            weight: 1
            compare_cols: [created_timestamp, description, email_template_id, email_template_name, email_template_status, folder_id, folder_type, from_email, from_name, is_most_recent_version, operational, program_id, publish_to_msi, reply_email, subject, template, text_only, updated_timestamp, url, version, web_view, workspace]
          stg_marketo__lead:
            weight: 1
            compare_cols: [created_timestamp, email, first_name, last_name, lead_id, updated_timestamp]
          stg_marketo__lead_describe:
            weight: 1
            compare_cols: [data_type, display_name, field_max_length, is_rest_readonly, is_soap_readonly, lead_describe_id, rest_name, rest_name_xf, soap_name]
          stg_marketo__program:
            weight: 1
            compare_cols: [channel, created_timestamp, description, end_date, program_id, program_name, program_status, program_type, sfdc_id, sfdc_name, start_date, updated_timestamp, url, workspace_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_marketo__lead:
            weight: 0
            compare_cols: []
          marketo__bounces__by_sent_email:
            weight: 1
            compare_cols: [count_bounces, email_send_id]
          marketo__change_data_details:
            weight: 0
            compare_cols: []
          marketo__change_data_pivot:
            weight: 0
            compare_cols: []
          marketo__change_data_scd:
            weight: 0
            compare_cols: []
          marketo__clicks__by_sent_email:
            weight: 0
            compare_cols: []
          marketo__deliverability_analysis:
            weight: 5
            compare_cols: [email_send_id, lead_id, campaign_id, email_template_id, send_hour, send_day_of_week, send_time_segment, was_delivered, was_opened, was_clicked, was_bounced, was_unsubscribed, count_bounces, count_opens]
          marketo__deliveries__by_sent_email:
            weight: 0
            compare_cols: []
          marketo__email_sends_deduped:
            weight: 0
            compare_cols: []
          marketo__lead_calendar_spine:
            weight: 0
            compare_cols: []
          marketo__opens__by_sent_email:
            weight: 0
            compare_cols: []
          marketo__recipient_domain_analysis:
            weight: 4
            compare_cols: [domain_reputation_tier, recipient_domain]
          marketo__unsubscribes__by_sent_email:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          marketo__campaigns:
            weight: 0
            compare_cols: []
          marketo__email_deliverability_dashboard:
            weight: 8
            compare_cols: []
          marketo__email_funnel_dashboard:
            weight: 1
            compare_cols: [analysis_type, period_identifier]
          marketo__email_sends:
            weight: 0
            compare_cols: []
          marketo__email_stats__by_campaign:
            weight: 0
            compare_cols: []
          marketo__email_stats__by_email_template:
            weight: 0
            compare_cols: []
          marketo__email_stats__by_lead:
            weight: 0
            compare_cols: []
          marketo__email_stats__by_program:
            weight: 0
            compare_cols: []
          marketo__email_templates:
            weight: 1
            compare_cols: [count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes, created_timestamp, description, email_template_id, email_template_name, email_template_status, folder_id, folder_type, from_email, from_name, is_most_recent_version, operational, program_id, publish_to_msi, reply_email, spam_likelihood_indicator, subject]
          marketo__lead_history:
            weight: 0
            compare_cols: []
          marketo__lead_intelligence_simple:
            weight: 0
            compare_cols: []
          marketo__leads:
            weight: 0
            compare_cols: []
          marketo__operational_health_simple:
            weight: 0
            compare_cols: []
          marketo__programs:
            weight: 0
            compare_cols: []
      utils:
        description: 'Custom layer: utils'
        weight: 20
        tables:
          marketo__calendar_spine:
            weight: 3
            compare_cols: []
  dacomp-de-evol-026:
    database_file: marketo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
      - utils
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_marketo__activity_change_data_value:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, api_method_name, campaign_id, field_name, lead_id, modifying_user, new_value, old_value, primary_attribute_value_id, reason, request_id, source]
          stg_marketo__activity_click_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, click_device, click_link_url, click_platform, click_user_agent, email_send_id, email_template_id, is_mobile_device, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_delete_lead:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_email_bounced:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_email_delivered:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_merge_leads:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, lead_id, merged_lead_ids, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_open_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, is_mobile_device, lead_id, open_device, open_platform, open_user_agent, primary_attribute_value, primary_attribute_value_id, step_id]
          stg_marketo__activity_send_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__activity_unsubscribe_email:
            weight: 1
            compare_cols: [activity_id, activity_timestamp, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, primary_attribute_value, primary_attribute_value_id]
          stg_marketo__campaigns:
            weight: 1
            compare_cols: [campaign_id, campaign_name, campaign_type, computed_url, created_timestamp, description, flow_id, folder_id, folder_type, is_active, is_communication_limit_enabled, is_requestable, is_system, max_members, program_id, qualification_rule_interval, qualification_rule_type, qualification_rule_unit, recurrence_day_of_month, recurrence_day_of_week, recurrence_end_at, recurrence_interval, recurrence_interval_type, recurrence_start_at, recurrence_week_of_month, recurrence_weekday_only, smart_list_id, status, updated_timestamp, workspace_name]
          stg_marketo__email_template_history:
            weight: 1
            compare_cols: [created_timestamp, description, email_template_id, email_template_name, email_template_status, folder_id, folder_type, from_email, from_name, is_most_recent_version, operational, program_id, publish_to_msi, reply_email, subject, template, text_only, updated_timestamp, url, version, web_view, workspace]
          stg_marketo__lead:
            weight: 1
            compare_cols: [created_timestamp, email, first_name, last_name, lead_id, updated_timestamp]
          stg_marketo__lead_describe:
            weight: 1
            compare_cols: [data_type, display_name, field_max_length, is_rest_readonly, is_soap_readonly, lead_describe_id, rest_name, rest_name_xf, soap_name]
          stg_marketo__program:
            weight: 1
            compare_cols: [channel, created_timestamp, description, end_date, program_id, program_name, program_status, program_type, sfdc_id, sfdc_name, start_date, updated_timestamp, url, workspace_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 40
        tables:
          int_marketo__lead:
            weight: 0
            compare_cols: []
          marketo__bounces__by_sent_email:
            weight: 0
            compare_cols: []
          marketo__change_data_details:
            weight: 0
            compare_cols: []
          marketo__change_data_pivot:
            weight: 0
            compare_cols: []
          marketo__change_data_scd:
            weight: 0
            compare_cols: []
          marketo__clicks__by_sent_email:
            weight: 0
            compare_cols: []
          marketo__deliveries__by_sent_email:
            weight: 0
            compare_cols: []
          marketo__email_sends_deduped:
            weight: 1
            compare_cols: [activity_id, activity_rank, activity_type_id, campaign_id, campaign_run_id, email_send_id, email_template_id, lead_id, partition_key_campaign_hash, partition_key_time_yyyymm, primary_attribute_value, primary_attribute_value_id]
          marketo__lead_calendar_spine:
            weight: 0
            compare_cols: []
          marketo__metrics_pre_aggregated_daily:
            weight: 4
            compare_cols: [aggregation_metrics_bitmap, campaign_id]
          marketo__metrics_pre_aggregated_hourly:
            weight: 5
            compare_cols: [aggregation_metrics_bitmap, campaign_id]
          marketo__opens__by_sent_email:
            weight: 0
            compare_cols: []
          marketo__unsubscribes__by_sent_email:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 20
        tables:
          marketo__campaigns:
            weight: 0
            compare_cols: []
          marketo__email_funnel_dashboard:
            weight: 0
            compare_cols: []
          marketo__email_sends:
            weight: 1
            compare_cols: [activity_id, activity_rank, activity_type_id, campaign_id, campaign_run_id, campaign_type, count_bounces, count_clicks, count_deliveries, count_opens, count_unsubscribes, data_tier_level, email_send_id, email_template_id, is_operational, late_arrival_compensation_flag, lead_id, partition_key_campaign_hash, partition_key_time_yyyymm, primary_attribute_value, primary_attribute_value_id, program_id, was_bounced]
          marketo__email_sends_archived:
            weight: 1
            compare_cols: [activity_id, campaign_id, campaign_type, count_bounces, count_clicks, count_deliveries, count_opens, count_unsubscribes, email_send_id, email_template_id, is_operational, lead_id, partition_key_campaign_hash, program_id, was_bounced, was_clicked, was_delivered, was_opened, was_unsubscribed]
          marketo__email_stats__by_campaign:
            weight: 1
            compare_cols: [campaign_id, count_bounces, count_clicks, count_deliveries, count_opens, count_sends, count_unique_clicks, count_unique_opens, count_unsubscribes]
          marketo__email_stats__by_email_template:
            weight: 0
            compare_cols: []
          marketo__email_stats__by_lead:
            weight: 0
            compare_cols: []
          marketo__email_stats__by_program:
            weight: 0
            compare_cols: []
          marketo__email_templates:
            weight: 0
            compare_cols: []
          marketo__lead_history:
            weight: 0
            compare_cols: []
          marketo__lead_intelligence_simple:
            weight: 0
            compare_cols: []
          marketo__leads:
            weight: 0
            compare_cols: []
          marketo__operational_health_simple:
            weight: 0
            compare_cols: []
          marketo__programs:
            weight: 0
            compare_cols: []
      utils:
        description: 'Custom layer: utils'
        weight: 39
        tables:
          marketo__calendar_spine:
            weight: 0
            compare_cols: []
          marketo__late_data_processor:
            weight: 3
            compare_cols: []
          marketo__migration_scheduler:
            weight: 0
            compare_cols: []
          marketo__partition_management:
            weight: 3
            compare_cols: []
  dacomp-de-evol-027:
    database_file: netsuite.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_netsuite2__account_types:
            weight: 1
            compare_cols: [account_type_id, is_balancesheet, is_leftside, type_name]
          stg_netsuite2__accounting_book_subsidiaries:
            weight: 1
            compare_cols: [accounting_book_id, status, subsidiary_id]
          stg_netsuite2__accounting_books:
            weight: 1
            compare_cols: [accounting_book_id, accounting_book_name, base_book_id, effective_period_id, is_adjustment_only, is_consolidated, is_primary]
          stg_netsuite2__accounting_period_fiscal_cal:
            weight: 1
            compare_cols: [accounting_period_id, fiscal_calendar_id, parent_id]
          stg_netsuite2__accounting_periods:
            weight: 1
            compare_cols: [accounting_period_id, closed_at, ending_at, is_adjustment, is_all_locked, is_ap_locked, is_ar_locked, is_closed, is_posting, is_quarter, is_year, name, parent_id, starting_at]
          stg_netsuite2__accounts:
            weight: 1
            compare_cols: [account_id, account_number, general_rate_type, is_balancesheet, is_leftside, name, parent_id, type_name]
          stg_netsuite2__classes:
            weight: 1
            compare_cols: [class_external_id, class_id, full_name, is_inactive, name]
          stg_netsuite2__consolidated_exchange_rates:
            weight: 1
            compare_cols: [accounting_book_id, accounting_period_id, average_rate, consolidated_exchange_rate_id, current_rate, from_currency_id, from_subsidiary_id, historical_rate, to_currency_id, to_subsidiary_id]
          stg_netsuite2__currencies:
            weight: 1
            compare_cols: [currency_id, name, symbol]
          stg_netsuite2__customers:
            weight: 1
            compare_cols: [alt_name, company_name, currency_id, customer_external_id, customer_id, date_first_order_at, default_billing_address_id, default_shipping_address_id, email_address, entity_id, first_name, is_person, last_name, parent_id, phone_number, receivables_account_id]
          stg_netsuite2__departments:
            weight: 1
            compare_cols: [department_id, full_name, is_inactive, name, parent_id, subsidiary_id]
          stg_netsuite2__employees:
            weight: 1
            compare_cols: [approval_limit, currency_id, department_id, email, employee_id, entity_id, expense_limit, first_name, is_inactive, last_name, purchase_order_approval_limit, purchase_order_limit, subsidiary_id, supervisor_id]
          stg_netsuite2__entities:
            weight: 1
            compare_cols: [contact_id, customer_id, employee_id, entity_id, entity_name, entity_type, is_person, job_id, parent_id, vendor_id]
          stg_netsuite2__entity_address:
            weight: 1
            compare_cols: [addr1, addr2, addr3, addressee, city, country, full_address, nkey, state, zipcode]
          stg_netsuite2__fiscal_calendar:
            weight: 1
            compare_cols: [fiscal_calendar_external_id, fiscal_calendar_id, fiscal_calendar_name, fiscal_month, is_default]
          stg_netsuite2__items:
            weight: 1
            compare_cols: [asset_account_id, class_id, deferral_account_id, department_id, description, expense_account_id, gain_loss_account_id, income_account_id, item_id, item_type, location_id, name, parent_id, subsidiary_id]
          stg_netsuite2__jobs:
            weight: 1
            compare_cols: [customer_id, default_billing_address_id, default_shipping_address_id, entity_id, job_external_id, job_id, parent_id]
          stg_netsuite2__location_main_address:
            weight: 1
            compare_cols: [addr1, addr2, addr3, addressee, city, country, full_address, nkey, state, zipcode]
          stg_netsuite2__locations:
            weight: 1
            compare_cols: [full_name, location_id, main_address_id, name, parent_id, subsidiary_id]
          stg_netsuite2__subsidiaries:
            weight: 1
            compare_cols: [country, currency_id, email, fiscal_calendar_id, full_name, is_elimination, main_address_id, name, parent_id, state, subsidiary_id]
          stg_netsuite2__transaction_accounting_lines:
            weight: 1
            compare_cols: [account_id, accounting_book_id, amount, credit_amount, debit_amount, exchange_rate, is_posting, net_amount, paid_amount, transaction_id, transaction_line_id, unpaid_amount]
          stg_netsuite2__transaction_lines:
            weight: 1
            compare_cols: [class_id, department_id, entity_id, is_billable, is_cleared, is_closed, is_cogs, is_commitment_firm, is_eliminate, is_main_line, is_tax_line, item_id, location_id, memo, netamount, subsidiary_id, transaction_id, transaction_line_id, transaction_line_number]
          stg_netsuite2__transactions:
            weight: 1
            compare_cols: [accounting_period_id, closed_at, currency_id, due_date_at, entity_id, is_posting, is_reversal, is_reversal_defer, memo, reversal_date, reversal_transaction_id, status, transaction_date, transaction_id, transaction_number, transaction_type]
          stg_netsuite2__vendor_categories:
            weight: 1
            compare_cols: [name, vendor_category_id]
          stg_netsuite2__vendors:
            weight: 1
            compare_cols: [alt_name, company_name, vendor_category_id, vendor_id]
          stg_netsuite__accounting_books:
            weight: 1
            compare_cols: [accounting_book_id, is_primary]
          stg_netsuite__accounting_periods:
            weight: 1
            compare_cols: [accounting_period_id, ending_at, fiscal_calendar_id, full_name, is_adjustment, is_closed, name, quarter, starting_at, year_0, year_id]
          stg_netsuite__accounts:
            weight: 1
            compare_cols: [account_id, account_number, general_rate_type, is_balancesheet, is_leftside, name, parent_id, type_name]
          stg_netsuite__classes:
            weight: 1
            compare_cols: [class_id, full_name]
          stg_netsuite__consolidated_exchange_rates:
            weight: 1
            compare_cols: [accounting_book_id, accounting_period_id, average_rate, consolidated_exchange_rate_id, current_rate, from_subsidiary_id, historical_rate, to_subsidiary_id]
          stg_netsuite__currencies:
            weight: 1
            compare_cols: [currency_id, name, symbol]
          stg_netsuite__customers:
            weight: 1
            compare_cols: [city, company_name, country, customer_external_id, customer_id, date_first_order_at, state, zipcode]
          stg_netsuite__departments:
            weight: 1
            compare_cols: [department_id, full_name, name]
          stg_netsuite__expense_accounts:
            weight: 1
            compare_cols: [account_number, expense_account_id, name, parent_id]
          stg_netsuite__income_accounts:
            weight: 1
            compare_cols: [account_number, income_account_id, name, parent_id]
          stg_netsuite__items:
            weight: 1
            compare_cols: [item_id, name, sales_description, type_name]
          stg_netsuite__locations:
            weight: 1
            compare_cols: [city, country, full_name, location_id, name]
          stg_netsuite__subsidiaries:
            weight: 1
            compare_cols: [fiscal_calendar_id, full_name, name, parent_id, subsidiary_id]
          stg_netsuite__transaction_lines:
            weight: 1
            compare_cols: [account_id, amount, class_id, company_id, department_id, item_id, location_id, memo, non_posting_line, subsidiary_id, transaction_id, transaction_line_id]
          stg_netsuite__transactions:
            weight: 1
            compare_cols: [accounting_period_id, currency_id, due_date_at, is_advanced_intercompany, is_intercompany, status, transaction_date, transaction_id, transaction_type]
          stg_netsuite__vendor_types:
            weight: 1
            compare_cols: [name, vendor_type_id]
          stg_netsuite__vendors:
            weight: 1
            compare_cols: [company_name, create_date_at, vendor_id, vendor_type_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_netsuite2__accounting_periods:
            weight: 0
            compare_cols: []
          int_netsuite2__accounts:
            weight: 0
            compare_cols: []
          int_netsuite2__acctxperiod_exchange_rate_map:
            weight: 0
            compare_cols: []
          int_netsuite2__ar_aging_analysis:
            weight: 0
            compare_cols: []
          int_netsuite2__balance_sheet:
            weight: 0
            compare_cols: []
          int_netsuite2__cash_flow_analysis:
            weight: 0
            compare_cols: []
          int_netsuite2__cash_flow_forecasting:
            weight: 3
            compare_cols: [cash_flow_forecast_id, subsidiary_id]
          int_netsuite2__customer_credit_risk:
            weight: 3
            compare_cols: [customer_email, customer_id, customer_name, recommended_credit_limit, subsidiary_id]
          int_netsuite2__customer_profitability:
            weight: 0
            compare_cols: []
          int_netsuite2__customers:
            weight: 0
            compare_cols: []
          int_netsuite2__data_quality_metrics:
            weight: 0
            compare_cols: []
          int_netsuite2__financial_ratios:
            weight: 0
            compare_cols: []
          int_netsuite2__income_statement:
            weight: 0
            compare_cols: []
          int_netsuite2__locations:
            weight: 0
            compare_cols: []
          int_netsuite2__supplier_credit_monitoring:
            weight: 4
            compare_cols: [subsidiary_id]
          int_netsuite2__tran_and_reporting_periods:
            weight: 0
            compare_cols: []
          int_netsuite2__tran_lines_w_accounting_period:
            weight: 0
            compare_cols: []
          int_netsuite2__tran_with_converted_amounts:
            weight: 0
            compare_cols: []
          int_netsuite2__transaction_details:
            weight: 0
            compare_cols: []
          int_netsuite2__transaction_lines:
            weight: 0
            compare_cols: []
          int_netsuite__accountxperiod_exchange_rate_map:
            weight: 0
            compare_cols: []
          int_netsuite__transaction_and_reporting_periods:
            weight: 0
            compare_cols: []
          int_netsuite__transaction_lines_w_accounting_period:
            weight: 0
            compare_cols: []
          int_netsuite__transactions_with_converted_amounts:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          netsuite2_balance_sheet:
            weight: 0
            compare_cols: []
          netsuite2_customer_analytics:
            weight: 1
            compare_cols: [activity_status, avg_transactions_per_month, comprehensive_customer_score, customer_age_days, customer_analytics_id, customer_email, customer_id, customer_name, engagement_frequency, growth_potential, lifecycle_stage, net_profit, profitability_segment, q1_transactions, q2_transactions, q3_transactions, q4_transactions, recommended_action, retention_category, retention_probability, seasonal_preference, segmentation_date, subsidiary_id, total_revenue, transaction_consistency, transaction_count, transaction_value_volatility, value_tier]
          netsuite2_financial_dashboard:
            weight: 1
            compare_cols: [accounting_period_id, average_customer_value, avg_current_ratio, avg_financial_health, avg_net_margin, cash_flow_consistency_percentage, cash_flow_health, cash_flow_risk_level, collection_performance, current_ratio, dashboard_date, dashboard_id, financial_health_grade, financial_health_volatility, gross_margin_ratio, liquidity_performance, net_cash_flow, net_profit_margin, operating_cash_flow, overall_financial_health_score, overall_rating, overdue_amount, overdue_percentage, predicted_next_month_cash_flow, primary_risk_factor, profitability_performance, quick_ratio, return_on_equity, risk_level, roe_performance, subsidiary_id, total_risk_score, weighted_average_days_outstanding]
          netsuite2_income_statement:
            weight: 0
            compare_cols: []
          netsuite2_integrated_risk_dashboard:
            weight: 6
            compare_cols: [cash_shortage_probability, subsidiary_id]
          netsuite2_operational_metrics:
            weight: 0
            compare_cols: []
          netsuite2_transaction_details:
            weight: 0
            compare_cols: []
          netsuite2_transaction_details_original:
            weight: 0
            compare_cols: []
          netsuite2_transaction_details_simple:
            weight: 0
            compare_cols: []
          netsuite2_vendor_risk_analysis:
            weight: 1
            compare_cols: [active_months, activity_status, avg_payable_amount, avg_payment_delay, business_impact_level, contract_recommendation, days_since_last_transaction, dependency_level, first_transaction_date, last_transaction_date, management_priority, max_transaction_amount, overdue_invoices, overdue_payment_percentage, payment_recommendation, recommended_action, relationship_stability, risk_level, spend_concentration_ratio, subsidiary_id, supplier_tier, total_expenses, total_payable_invoices, total_payables, total_transactions, total_vendor_spend, vendor_category_name, vendor_email, vendor_id, vendor_name, vendor_relationship_days, vendor_risk_analysis_id, vendor_risk_score]
  dacomp-de-evol-028:
    database_file: netsuite.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_netsuite2__account_types:
            weight: 1
            compare_cols: [account_type_id, is_balancesheet, is_leftside, type_name]
          stg_netsuite2__accounting_book_subsidiaries:
            weight: 1
            compare_cols: [status]
          stg_netsuite2__accounting_books:
            weight: 1
            compare_cols: [accounting_book_name, base_book_id, effective_period_id, is_consolidated, is_primary]
          stg_netsuite2__accounting_period_fiscal_cal:
            weight: 1
            compare_cols: [accounting_period_id]
          stg_netsuite2__accounting_periods:
            weight: 1
            compare_cols: [accounting_period_id, closed_at, is_adjustment, is_all_locked, is_ap_locked, is_ar_locked, is_closed, is_posting, is_quarter, is_year, name, parent_id]
          stg_netsuite2__accounts:
            weight: 1
            compare_cols: [account_number, general_rate_type, is_balancesheet, is_leftside, name, parent_id, type_name]
          stg_netsuite2__classes:
            weight: 1
            compare_cols: [full_name, is_inactive, name]
          stg_netsuite2__consolidated_exchange_rates:
            weight: 1
            compare_cols: [accounting_book_id, accounting_period_id, consolidated_exchange_rate_id, from_currency_id, from_subsidiary_id, to_currency_id, to_subsidiary_id]
          stg_netsuite2__currencies:
            weight: 1
            compare_cols: [name, symbol]
          stg_netsuite2__customers:
            weight: 1
            compare_cols: [alt_name, company_name, currency_id, customer_external_id, customer_id, date_first_order_at, default_billing_address_id, default_shipping_address_id, email_address, entity_id, first_name, is_person, last_name, parent_id, phone_number, receivables_account_id]
          stg_netsuite2__departments:
            weight: 1
            compare_cols: [full_name, is_inactive, name, parent_id, subsidiary_id]
          stg_netsuite2__employees:
            weight: 1
            compare_cols: [approval_limit, currency_id, department_id, expense_limit, first_name, is_inactive, last_name, purchase_order_approval_limit, purchase_order_limit, subsidiary_id, supervisor_id]
          stg_netsuite2__entities:
            weight: 1
            compare_cols: [is_person]
          stg_netsuite2__entity_address:
            weight: 1
            compare_cols: [nkey]
          stg_netsuite2__fiscal_calendar:
            weight: 1
            compare_cols: [fiscal_calendar_name, is_default]
          stg_netsuite2__items:
            weight: 1
            compare_cols: [asset_account_id, class_id, deferral_account_id, department_id, description, expense_account_id, gain_loss_account_id, income_account_id, item_type, location_id, name, parent_id, subsidiary_id]
          stg_netsuite2__jobs:
            weight: 1
            compare_cols: [customer_id, default_billing_address_id, default_shipping_address_id, entity_id, job_external_id, job_id, parent_id]
          stg_netsuite2__location_main_address:
            weight: 1
            compare_cols: [full_address]
          stg_netsuite2__locations:
            weight: 1
            compare_cols: [full_name, main_address_id, name, parent_id, subsidiary_id]
          stg_netsuite2__subsidiaries:
            weight: 1
            compare_cols: [country, currency_id, email, fiscal_calendar_id, full_name, is_elimination, main_address_id, name, parent_id, state, subsidiary_id]
          stg_netsuite2__transaction_accounting_lines:
            weight: 1
            compare_cols: [is_posting]
          stg_netsuite2__transaction_lines:
            weight: 1
            compare_cols: [is_cleared, is_commitment_firm, is_tax_line, is_eliminate]
          stg_netsuite2__transactions:
            weight: 1
            compare_cols: [accounting_period_id, currency_id, entity_id, memo, status, transaction_date, transaction_id, transaction_number, transaction_type, is_posting, is_reversal, reversal_transaction_id, reversal_date, is_reversal_defer]
          stg_netsuite2__vendor_categories:
            weight: 1
            compare_cols: [name]
          stg_netsuite2__vendors:
            weight: 1
            compare_cols: [alt_name, vendor_category_id]
          stg_netsuite__accounting_books:
            weight: 1
            compare_cols: [accounting_book_id, is_primary]
          stg_netsuite__accounting_periods:
            weight: 1
            compare_cols: [accounting_period_id, fiscal_calendar_id, full_name, is_adjustment, is_closed, name, year_id]
          stg_netsuite__accounts:
            weight: 1
            compare_cols: [account_id, general_rate_type, is_balancesheet, is_leftside, name, type_name]
          stg_netsuite__classes:
            weight: 1
            compare_cols: [class_id]
          stg_netsuite__consolidated_exchange_rates:
            weight: 1
            compare_cols: [accounting_period_id, consolidated_exchange_rate_id, from_subsidiary_id, to_subsidiary_id]
          stg_netsuite__currencies:
            weight: 1
            compare_cols: [name, symbol]
          stg_netsuite__customers:
            weight: 1
            compare_cols: [company_name, customer_id]
          stg_netsuite__departments:
            weight: 1
            compare_cols: [department_id]
          stg_netsuite__expense_accounts:
            weight: 1
            compare_cols: [expense_account_id]
          stg_netsuite__income_accounts:
            weight: 1
            compare_cols: [account_number, income_account_id, name]
          stg_netsuite__items:
            weight: 1
            compare_cols: [item_id]
          stg_netsuite__locations:
            weight: 1
            compare_cols: [location_id]
          stg_netsuite__subsidiaries:
            weight: 1
            compare_cols: [fiscal_calendar_id, full_name, name, parent_id, subsidiary_id]
          stg_netsuite__transaction_lines:
            weight: 1
            compare_cols: [class_id, department_id, item_id, location_id, memo, subsidiary_id]
          stg_netsuite__transactions:
            weight: 1
            compare_cols: [accounting_period_id]
          stg_netsuite__vendor_types:
            weight: 1
            compare_cols: [vendor_type_id]
          stg_netsuite__vendors:
            weight: 1
            compare_cols: [vendor_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_netsuite2__accounting_periods:
            weight: 0
            compare_cols: []
          int_netsuite2__accounts:
            weight: 0
            compare_cols: []
          int_netsuite2__acctxperiod_exchange_rate_map:
            weight: 0
            compare_cols: []
          int_netsuite2__ar_aging_analysis:
            weight: 0
            compare_cols: []
          int_netsuite2__cash_flow_analysis:
            weight: 0
            compare_cols: []
          int_netsuite2__customer_profitability:
            weight: 0
            compare_cols: []
          int_netsuite2__customers:
            weight: 0
            compare_cols: []
          int_netsuite2__data_quality_metrics:
            weight: 0
            compare_cols: []
          int_netsuite2__financial_ratios:
            weight: 0
            compare_cols: []
          int_netsuite2__fx_adjusted_procurement_costs:
            weight: 2
            compare_cols: [subsidiary_id, item_category_id, vendor_currency, currency_exposure_type, fx_volatility_level, current_total_quantity, current_total_base_amount, current_total_fx_adjusted_amount, current_total_fx_impact]
          int_netsuite2__locations:
            weight: 0
            compare_cols: []
          int_netsuite2__procurement_price_analysis:
            weight: 4
            compare_cols: [cost_trend_direction, price_change_pct_mom, price_change_pct_yoy, price_volatility_indicator]
          int_netsuite2__supplier_pricing_comparison:
            weight: 3
            compare_cols: [vendor_id]
          int_netsuite2__tran_and_reporting_periods:
            weight: 0
            compare_cols: []
          int_netsuite2__tran_lines_w_accounting_period:
            weight: 1
            compare_cols: [unconverted_amount]
          int_netsuite2__tran_with_converted_amounts:
            weight: 0
            compare_cols: []
          int_netsuite2__transaction_lines:
            weight: 0
            compare_cols: []
          int_netsuite__accountxperiod_exchange_rate_map:
            weight: 0
            compare_cols: []
          int_netsuite__transaction_and_reporting_periods:
            weight: 0
            compare_cols: []
          int_netsuite__transaction_lines_w_accounting_period:
            weight: 0
            compare_cols: []
          int_netsuite__transactions_with_converted_amounts:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          netsuite2_balance_sheet:
            weight: 0
            compare_cols: []
          netsuite2_customer_analytics:
            weight: 0
            compare_cols: []
          netsuite2_financial_dashboard:
            weight: 0
            compare_cols: []
          netsuite2_income_statement:
            weight: 0
            compare_cols: []
          netsuite2_operational_metrics:
            weight: 0
            compare_cols: []
          netsuite2_procurement_compliance_dashboard:
            weight: 5
            compare_cols: [primary_compliance_issue, remediation_recommendation, avg_budget_compliance_rate, total_transactions_requiring_approval, total_unapproved_transactions, total_unapproved_amount, pricing_compliance_rate, total_pricing_excess_costs, vendor_approval_compliance_rate, total_unapproved_vendor_amount, total_compliance_cost_impact, compliance_performance_grade, compliance_trend, alert_status, compliance_dashboard_id]
          netsuite2_procurement_optimization:
            weight: 4
            compare_cols: [cost_trend_direction, item_category_id, price_change_pct_mom, price_change_pct_yoy, price_volatility_indicator]
          netsuite2_transaction_details:
            weight: 0
            compare_cols: []
          netsuite2_transaction_details_original:
            weight: 0
            compare_cols: []
          netsuite2_transaction_details_simple:
            weight: 0
            compare_cols: []
          netsuite2_vendor_risk_analysis:
            weight: 1
            compare_cols: [activity_status, days_since_last_transaction, overdue_payment_percentage, subsidiary_id, total_vendor_spend, vendor_email, vendor_id, vendor_name, vendor_risk_analysis_id]
          netsuite__balance_sheet:
            weight: 0
            compare_cols: []
          netsuite__income_statement:
            weight: 0
            compare_cols: []
          netsuite__transaction_details:
            weight: 0
            compare_cols: []
  dacomp-de-evol-029:
    database_file: qualtrics.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_qualtrics__block:
            weight: 1
            compare_cols: [block_id, block_visibility, description, is_locked, randomize_questions, survey_id, type]
          stg_qualtrics__block_question:
            weight: 1
            compare_cols: [block_id, question_id, survey_id]
          stg_qualtrics__contact_mailing_list_membership:
            weight: 1
            compare_cols: [contact_id, contact_lookup_id, directory_id, is_unsubscribed, mailing_list_id, name, owner_user_id, unsubscribed_at]
          stg_qualtrics__core_contact:
            weight: 1
            compare_cols: [contact_id, email, email_domain, external_data_reference, first_name, is_unsubscribed, language, last_name, mailing_list_id]
          stg_qualtrics__core_mailing_list:
            weight: 1
            compare_cols: [category, folder, library_id, mailing_list_id, name]
          stg_qualtrics__directory:
            weight: 1
            compare_cols: [directory_id, is_deduped_on_email, is_deduped_on_ext_ref, is_deduped_on_first_name, is_deduped_on_last_name, is_deduped_on_phone, is_default, name]
          stg_qualtrics__directory_contact:
            weight: 1
            compare_cols: [contact_id, directory_id, email, email_domain, ext_ref, first_name, is_unsubscribed_from_directory, language, last_modified_at, last_name, phone, unsubscribed_from_directory_at]
          stg_qualtrics__directory_mailing_list:
            weight: 1
            compare_cols: [created_at, directory_id, last_modified_at, mailing_list_id, name, owner_user_id]
          stg_qualtrics__distribution:
            weight: 1
            compare_cols: [created_at, distribution_id, header_from_email, header_from_name, header_reply_to_email, header_subject, last_modified_at, message_id, message_library_id, message_text, organization_id, owner_user_id, parent_distribution_id, recipient_contact_id, recipient_library_id, recipient_mailing_list_id, recipient_sample_id, request_status, request_type, send_at, survey_id, survey_link_expires_at, survey_link_type]
          stg_qualtrics__distribution_contact:
            weight: 1
            compare_cols: [contact_frequency_rule_id, contact_id, contact_lookup_id, distribution_id, opened_at, response_completed_at, response_id, response_started_at, sent_at, status, survey_link, survey_session_id]
          stg_qualtrics__question:
            weight: 1
            compare_cols: [data_export_tag, is_data_hidden, is_data_private, next_answer_id, next_choice_id, question_description, question_description_option, question_id, question_text, question_text_unsafe, question_type, selector, sub_selector, survey_id, validation_setting_force_response, validation_setting_force_response_type, validation_setting_type]
          stg_qualtrics__question_option:
            weight: 1
            compare_cols: [key, question_id, recode_value, survey_id, text]
          stg_qualtrics__question_response:
            weight: 1
            compare_cols: [loop_id, question, question_id, question_option_key, response_id, response_text, sub_question_key, sub_question_text, value]
          stg_qualtrics__sub_question:
            weight: 1
            compare_cols: [choice_data_export_tag, key, question_id, survey_id, text]
          stg_qualtrics__survey:
            weight: 1
            compare_cols: [auto_scoring_category, brand_base_url, brand_id, bundle_short_name, composition_type, creator_user_id, default_scoring_category, division_id, last_accessed_at, last_activated_at, last_modified_at, owner_user_id, project_category, project_type, registry_sha, registry_version, schema_version, scoring_summary_after_questions, scoring_summary_after_survey, scoring_summary_category, survey_id, survey_name, survey_status]
          stg_qualtrics__survey_embedded_data:
            weight: 1
            compare_cols: [import_id, key, response_id, value]
          stg_qualtrics__survey_response:
            weight: 1
            compare_cols: [distribution_channel, duration_in_seconds, finished_at, ip_address, is_finished, last_modified_at, location_latitude, location_longitude, progress, recipient_email, recipient_first_name, recipient_last_name, recorded_date, response_id, started_at, status, survey_id, user_language]
          stg_qualtrics__survey_version:
            weight: 1
            compare_cols: [created_at, is_published, publisher_user_id, survey_id, version_description, version_id, version_number, was_published]
          stg_qualtrics__user:
            weight: 1
            compare_cols: [account_created_at, account_expires_at, account_status, division_id, email, first_name, is_unsubscribed, language, last_login_at, last_name, organization_id, password_expires_at, password_last_changed_at, response_count_auditable, response_count_deleted, response_count_generated, time_zone, user_id, user_type, username]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_qualtrics__contacts:
            weight: 0
            compare_cols: []
          int_qualtrics__partial_response_value:
            weight: 5
            compare_cols: [partial_value_score, survey_id]
          int_qualtrics__question:
            weight: 0
            compare_cols: []
          int_qualtrics__question_analytics:
            weight: 4
            compare_cols: [question_complexity_score, question_id, question_response_rate]
          int_qualtrics__response_quality:
            weight: 0
            compare_cols: []
          int_qualtrics__responses:
            weight: 1
            compare_cols: [distribution_channel, duration_in_seconds, is_finished_with_survey, loop_id, question_id, question_option_key, question_response_id, question_text, response_text, sub_question_key, sub_question_text, survey_id, survey_progress, survey_response_id, survey_response_status, value]
          int_qualtrics__survey:
            weight: 0
            compare_cols: []
          int_qualtrics__survey_embedded_data:
            weight: 0
            compare_cols: []
          int_qualtrics__survey_performance:
            weight: 0
            compare_cols: []
          int_qualtrics__user_engagement:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          qualtrics__channel_performance:
            weight: 0
            compare_cols: []
          qualtrics__contact:
            weight: 0
            compare_cols: []
          qualtrics__daily_breakdown:
            weight: 0
            compare_cols: []
          qualtrics__directory:
            weight: 0
            compare_cols: []
          qualtrics__distribution:
            weight: 0
            compare_cols: []
          qualtrics__question_funnel_analysis:
            weight: 9
            compare_cols: []
          qualtrics__response:
            weight: 0
            compare_cols: []
          qualtrics__survey:
            weight: 0
            compare_cols: []
          qualtrics__survey_analytics:
            weight: 1
            compare_cols: [avg_partial_value_score, avg_quality_score, avg_question_response_rate, completed_responses, completion_rate, survey_id, survey_name, survey_status, total_responses]
          qualtrics__user_cohort_analysis:
            weight: 0
            compare_cols: []
  dacomp-de-evol-030:
    database_file: quickbooks.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_quickbooks__account:
            weight: 1
            compare_cols: [account_id, account_number, account_sub_type, account_type, balance, balance_with_sub_accounts, classification, currency_id, description, fully_qualified_name, is_active, is_sub_account, name, parent_account_id, sync_token, tax_code_id, updated_at]
          stg_quickbooks__bill:
            weight: 1
            compare_cols: [balance, bill_id, currency_id, department_id, doc_number, due_date, exchange_rate, global_tax_calculation, home_balance, payable_account_id, private_note, sales_term_id, sync_token, total_amount, transaction_date, updated_at, vendor_id]
          stg_quickbooks__bill_line:
            weight: 1
            compare_cols: [account_expense_account_id, account_expense_billable_status, account_expense_class_id, account_expense_customer_id, account_expense_tax_amount, account_expense_tax_code_id, amount, bill_id, description, index, item_expense_billable_status, item_expense_class_id, item_expense_customer_id, item_expense_item_id, item_expense_quantity, item_expense_tax_code_id, item_expense_unit_price, source_relation]
          stg_quickbooks__customer:
            weight: 1
            compare_cols: [balance, balance_with_jobs, bill_with_parent, company_name, credit_limit, currency_id, customer_id, display_name, fully_qualified_name, is_active, is_job, is_taxable, name, notes, parent_customer_id, payment_method_id, print_on_check_name, sales_term_id, sync_token, tax_code_id, updated_at]
          stg_quickbooks__department:
            weight: 1
            compare_cols: [created_at, department_id, fully_qualified_name, is_active, is_sub_department, name, parent_department_id, sync_token, updated_at]
          stg_quickbooks__invoice:
            weight: 1
            compare_cols: [allow_ipnpayment, allow_online_achpayment, allow_online_credit_card_payment, allow_online_payment, apply_tax_after_discount, balance, billing_address_id, billing_bcc_email, billing_cc_email, billing_email, class_id, currency_id, custom_p_o_number, custom_sales_rep, customer_id, customer_memo, delivery_time, delivery_type, department_id, deposit, deposit_to_account_id, doc_number, due_date, email_status, exchange_rate, global_tax_calculation, home_balance, home_total_amount, invoice_id, print_status, private_note, sales_term_id, ship_date, shipping_address_id, sync_token, tax_code_id, total_amount, total_tax, tracking_number, transaction_date, transaction_source, updated_at]
          stg_quickbooks__invoice_line:
            weight: 1
            compare_cols: [account_id, amount, bundle_id, description, detail_type, discount_account_id, discount_class_id, discount_discount_amount, discount_percent, discount_tax_code_id, group_line_detail_group_item_id, group_line_detail_quantity, index, invoice_id, sales_item_account_id, sales_item_class_id, sales_item_discount_amount, sales_item_discount_rate, sales_item_item_id, sales_item_quantity, sales_item_tax_code_id, sales_item_unit_price, source_relation]
          stg_quickbooks__item:
            weight: 1
            compare_cols: [asset_account_id, description, expense_account_id, fully_qualified_name, income_account_id, is_active, is_taxable, item_id, name, parent_item_id, purchase_cost, purchase_tax_code_id, quantity_on_hand, sales_tax_code_id, sku, sync_token, tax_code_id, track_quantity_on_hand, type, unit_price, updated_at]
          stg_quickbooks__journal_entry:
            weight: 1
            compare_cols: [created_at, currency_id, department_id, doc_number, exchange_rate, home_total_amount, is_adjustment, journal_entry_id, private_note, sync_token, total_amount, transaction_date, updated_at]
          stg_quickbooks__journal_entry_line:
            weight: 1
            compare_cols: [account_id, amount, billable_status, class_id, customer_id, department_id, description, home_amount, index, journal_entry_id, posting_type, tax_amount, tax_applicable_on, tax_code_id, vendor_id]
          stg_quickbooks__payment:
            weight: 1
            compare_cols: [created_at, currency_id, customer_id, department_id, deposit_to_account_id, exchange_rate, payment_id, payment_method_id, payment_ref_number, private_note, receivable_account_id, sync_token, total_amount, transaction_date, unapplied_amount, updated_at]
          stg_quickbooks__payment_line:
            weight: 1
            compare_cols: [amount, index, linked_txn_payment_id, payment_id, source_relation]
          stg_quickbooks__vendor:
            weight: 1
            compare_cols: [acct_num, balance, company_name, currency_id, display_name, is_active, is_taxable, name, print_on_check_name, sales_term_id, sync_token, tax_code_id, updated_at, vendor_1099, vendor_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_quickbooks__account_classifications:
            weight: 0
            compare_cols: []
          int_quickbooks__bill_double_entry:
            weight: 0
            compare_cols: []
          int_quickbooks__cashflow_analysis:
            weight: 1
            compare_cols: [cash_flow_direction, counterparty_id, counterparty_type, total_amount, transaction_date, transaction_id, transaction_type]
          int_quickbooks__credit_scoring:
            weight: 3
            compare_cols: [business_stability_score, credit_score, customer_id, is_estimated, payment_timeliness_score, transaction_volume_score]
          int_quickbooks__customer_lifecycle:
            weight: 1
            compare_cols: [customer_id, customer_name, days_since_last_invoice, first_invoice_date, last_invoice_date, last_payment_date, lifecycle_stage, outstanding_balance, total_invoice_amount, total_invoices]
          int_quickbooks__data_quality_metrics:
            weight: 2
            compare_cols: [entity_type, source_relation]
          int_quickbooks__invoice_double_entry:
            weight: 0
            compare_cols: []
          int_quickbooks__journal_entry_double_entry:
            weight: 0
            compare_cols: []
          int_quickbooks__payment_double_entry:
            weight: 0
            compare_cols: []
          int_quickbooks__payment_optimization:
            weight: 2
            compare_cols: [bill_id, discount_days, discount_value, total_amount, vendor_id, vendor_name]
          int_quickbooks__revenue_analysis:
            weight: 0
            compare_cols: []
          int_quickbooks__vendor_spend_analysis:
            weight: 1
            compare_cols: [aging_status, bill_date, bill_id, due_date, outstanding_balance, paid_amount, payment_risk_level, payment_status, spend_month_start, total_amount, vendor_display_name, vendor_id, vendor_name]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          quickbooks__balance_sheet:
            weight: 0
            compare_cols: []
          quickbooks__cash_flow_forecast:
            weight: 7
            compare_cols: [seasonal_factor]
          quickbooks__cashflow_forecast:
            weight: 0
            compare_cols: []
          quickbooks__customer_analytics:
            weight: 1
            compare_cols: [credit_score, customer_id, customer_name, data_completeness_score, days_since_last_invoice, lifecycle_stage, outstanding_balance, total_invoice_amount, total_invoices]
          quickbooks__financial_dashboard:
            weight: 1
            compare_cols: [active_customers, active_customers_count, active_vendors_count, avg_bill_amount, avg_customer_value, avg_invoice_amount, bill_count, business_health_score, cash_flow_status, cash_inflow, cash_outflow, collected_revenue, collection_per_invoice, collection_rate_percentage, collection_risk_level, dashboard_month, dashboard_month_num, dashboard_quarter, dashboard_year, gross_margin_percentage, gross_profit, high_risk_transactions, high_value_customers, highly_active_customers, invoice_count, lost_customers, net_cash_flow, new_customers, outstanding_payables, outstanding_receivables, overdue_amount, paid_amount, payables_days_outstanding, receivables_days_outstanding, revenue_growth_rate, revenue_per_customer, spend_growth_rate, total_customer_value, total_customers, total_revenue, total_spend]
          quickbooks__general_ledger:
            weight: 0
            compare_cols: []
          quickbooks__profitability_analysis:
            weight: 0
            compare_cols: []
          quickbooks__vendor_performance:
            weight: 1
            compare_cols: [avg_bill_amount, on_time_payment_rate, overall_performance_score, payment_completion_rate, payment_risk_level, vendor_display_name, vendor_id, vendor_name]
  dacomp-de-evol-031:
    database_file: workday.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_workday__job_family:
            weight: 1
            compare_cols: [effective_start, is_inactive, job_family_code, job_family_id, job_family_name, source_relation]
          stg_workday__job_family_group:
            weight: 1
            compare_cols: [effective_start, is_inactive, job_family_group_code, job_family_group_id, job_family_group_name, source_relation]
          stg_workday__job_family_job_family_group:
            weight: 1
            compare_cols: [job_family_group_id, job_family_id, source_relation]
          stg_workday__job_family_job_profile:
            weight: 1
            compare_cols: [job_family_id, job_profile_id, source_relation]
          stg_workday__job_profile:
            weight: 1
            compare_cols: [compensation_grade_id, is_union_eligible, is_work_shift_required, job_profile_code, job_profile_id, job_profile_summary, job_profile_title, management_level, source_relation]
          stg_workday__military_service:
            weight: 1
            compare_cols: [discharge_date, military_status, rank, service, status_begin_date, worker_id]
          stg_workday__organization:
            weight: 1
            compare_cols: [effective_start, is_inactive, organization_code, organization_id, organization_name, organization_sub_type, organization_type, staffing_model, visibility]
          stg_workday__organization_job_family:
            weight: 1
            compare_cols: [job_family_group_id, job_family_id, organization_id, source_relation]
          stg_workday__organization_role:
            weight: 1
            compare_cols: [organization_id, organization_role_code, organization_role_id, source_relation]
          stg_workday__organization_role_worker:
            weight: 1
            compare_cols: [organization_id, organization_worker_code, role_id, source_relation]
          stg_workday__person_contact_email_address:
            weight: 1
            compare_cols: [email_address, email_code, email_comment, email_id, worker_id]
          stg_workday__person_name:
            weight: 1
            compare_cols: [country, first_name, full_name, last_name, name_id, person_name_type, worker_id]
          stg_workday__personal_information:
            weight: 1
            compare_cols: [city_of_birth, country_of_birth, date_of_birth, last_medical_exam_date, marital_status, personal_info_history_id, political_affiliation, worker_id]
          stg_workday__personal_information_ethnicity:
            weight: 1
            compare_cols: [ethnicity, ethnicity_group, is_hispanic_or_latino, record_type, verification_source, worker_id]
          stg_workday__position:
            weight: 1
            compare_cols: [business_title, default_weekly_hours, effective_start, employee_type, position_id, source_relation]
          stg_workday__position_job_profile:
            weight: 1
            compare_cols: [job_profile_id, position_id, source_relation]
          stg_workday__position_organization:
            weight: 1
            compare_cols: [effective_end, effective_start, organization_id, position_id, source_relation]
          stg_workday__worker:
            weight: 1
            compare_cols: [effective_end, effective_start, event_type, worker_history_id, worker_id]
          stg_workday__worker_leave_status:
            weight: 1
            compare_cols: [end_date, leave_status, leave_type, start_date, worker_id]
          stg_workday__worker_position:
            weight: 1
            compare_cols: [effective_end, effective_start, position_id, worker_id]
          stg_workday__worker_position_organization:
            weight: 1
            compare_cols: [effective_end, effective_start, organization_id, position_id, worker_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 69
        tables:
          int_workday__career_progression:
            weight: 0
            compare_cols: []
          int_workday__churn_prediction:
            weight: 3
            compare_cols: [churn_probability_score, high_value_churn_risk_flag, worker_id]
          int_workday__compensation_equity:
            weight: 3
            compare_cols: [compensation_equity_score, compensation_gap_indicator, compensation_gap_penalty, peer_compensation_percentile, worker_id]
          int_workday__employee_lifecycle:
            weight: 0
            compare_cols: []
          int_workday__organization_metrics:
            weight: 1
            compare_cols: [annual_turnover_rate, contingent_employees, current_employee_count, data_quality_flag, departures_last_year, directors_count, individual_contributors, intern_employees, internal_transfers_in, internal_transfers_out, management_ratio, managers_count, most_common_grade, new_hires_last_year, organization_code, organization_health_score, organization_id, organization_name, organization_size_category, organization_sub_type, organization_type, performance_category, position_fill_rate, regular_employees, retention_driver_scores, senior_managers_count, shift_required_positions, staffing_model, total_positions, total_weekly_hours, union_eligible_positions, unique_compensation_grades, unique_job_families, unique_job_family_groups]
          int_workday__personal_details:
            weight: 0
            compare_cols: []
          int_workday__worker_details:
            weight: 0
            compare_cols: []
          int_workday__worker_employee_enhanced:
            weight: 0
            compare_cols: []
          int_workday__worker_position_enriched:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          workday__employee_overview:
            weight: 1
            compare_cols: [age, business_title, career_development_score, career_growth_pace, career_phase, career_stability_category, churn_probability_score, churn_risk_category, city_of_birth, compensation_equity_score, compensation_grade_id, compensation_tier, comprehensive_data_quality_flag, country_of_birth, date_of_birth, departure_category, departure_date, dept_health_score, dept_management_ratio, dept_performance_category, dept_size, dept_size_category, email_address, employee_id, employee_maturity_segment, employee_risk_level, employee_type, employee_value_segment, ethnicity_codes, event_type, fast_promotions, first_name, full_name, high_value_churn_risk_flag, highest_management_level_reached, hire_date, hire_month, hire_quarter_cohort, hire_season, hire_year_cohort, is_current_employee_five_years, is_current_employee_one_year, is_current_employee_ten_years, is_employed, is_employed_five_years, is_employed_one_year, is_employed_ten_years, is_military_service, is_union_eligible, is_work_shift_required, last_name, lateral_moves, management_positions_held, marital_status, military_status, organization_id, organization_name, organization_sub_type, organization_type, overall_employee_score, peer_compensation_percentile, position_end_date, position_id, position_start_date, retained_1_year, retained_30_days, retained_3_years, retained_90_days, retention_stability_score, tenure_group, tenure_years, total_demotions, total_positions_held, total_promotions, work_conditions_score, worker_history_id, worker_id]
          workday__job_overview:
            weight: 0
            compare_cols: []
          workday__organization_overview:
            weight: 0
            compare_cols: []
          workday__organization_performance:
            weight: 1
            compare_cols: [annual_turnover_rate, avg_career_development_score, avg_employee_age, avg_employee_satisfaction_proxy, avg_weekly_hours, avg_weekly_hours_per_employee, contingent_employees, current_employee_count, data_quality_flag, departures_last_year, development_required_count, directors_count, enhanced_organization_effectiveness_score, ethnic_diversity_count, fast_track_count, high_achiever_percentage, high_achievers_count, high_risk_employees, high_risk_percentage, high_value_flight_risk_count, high_value_retained_count, high_value_retention_rate, individual_contributors, intern_employees, internal_transfers_in, internal_transfers_out, low_risk_employees, management_ratio, managers_count, medium_risk_employees, mid_career_professionals_count, military_veterans_count, most_common_grade, new_hires_last_year, organization_code, organization_health_score, organization_id, organization_maturity, organization_name, organization_risk_level, organization_size_category, organization_sub_type, organization_type, performance_category, position_fill_rate, pre_retirement_professionals_count, recommended_action, recommended_retention_actions, regular_employee_percentage, regular_employees, senior_managers_count, senior_professionals_count, span_of_control, stable_development_count, staffing_model, talent_density_ratio, talent_flight_risk_rate, top_retention_risk_factors, total_positions, total_weekly_hours, unique_compensation_grades, unique_job_families, unique_job_family_groups, young_professionals_count]
          workday__position_overview:
            weight: 0
            compare_cols: []
          workday__workforce_analytics:
            weight: 0
            compare_cols: []
  dacomp-de-evol-032:
    database_file: greenhouse.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - mart
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_greenhouse__activity:
            weight: 1
            compare_cols: [activity_id, body, candidate_id, subject, user_id]
          stg_greenhouse__application:
            weight: 1
            compare_cols: [application_id, applied_at, candidate_id, current_stage_id, last_activity_at, rejected_at, source_id, status]
          stg_greenhouse__application_history:
            weight: 0
            compare_cols: []
          stg_greenhouse__attachment:
            weight: 0
            compare_cols: []
          stg_greenhouse__business_rules:
            weight: 0
            compare_cols: []
          stg_greenhouse__candidate:
            weight: 1
            compare_cols: [candidate_id, first_name, full_name, is_private, last_name]
          stg_greenhouse__candidate_tag:
            weight: 0
            compare_cols: []
          stg_greenhouse__department:
            weight: 0
            compare_cols: []
          stg_greenhouse__eeoc:
            weight: 0
            compare_cols: []
          stg_greenhouse__email_address:
            weight: 0
            compare_cols: []
          stg_greenhouse__hiring_team:
            weight: 0
            compare_cols: []
          stg_greenhouse__interview:
            weight: 0
            compare_cols: []
          stg_greenhouse__job:
            weight: 0
            compare_cols: []
          stg_greenhouse__job_application:
            weight: 0
            compare_cols: []
          stg_greenhouse__job_department:
            weight: 0
            compare_cols: []
          stg_greenhouse__job_office:
            weight: 0
            compare_cols: []
          stg_greenhouse__job_opening:
            weight: 0
            compare_cols: []
          stg_greenhouse__job_post:
            weight: 0
            compare_cols: []
          stg_greenhouse__job_stage:
            weight: 0
            compare_cols: []
          stg_greenhouse__office:
            weight: 0
            compare_cols: []
          stg_greenhouse__phone_number:
            weight: 0
            compare_cols: []
          stg_greenhouse__prospect_pool:
            weight: 0
            compare_cols: []
          stg_greenhouse__prospect_stage:
            weight: 0
            compare_cols: []
          stg_greenhouse__scheduled_interview:
            weight: 0
            compare_cols: []
          stg_greenhouse__scheduled_interviewer:
            weight: 0
            compare_cols: []
          stg_greenhouse__scorecard:
            weight: 0
            compare_cols: []
          stg_greenhouse__scorecard_attribute:
            weight: 0
            compare_cols: []
          stg_greenhouse__social_media_address:
            weight: 0
            compare_cols: []
          stg_greenhouse__source:
            weight: 0
            compare_cols: []
          stg_greenhouse__tag:
            weight: 0
            compare_cols: []
          stg_greenhouse__timezone_mapping:
            weight: 0
            compare_cols: []
          stg_greenhouse__user:
            weight: 0
            compare_cols: []
          stg_greenhouse__user_email:
            weight: 0
            compare_cols: []
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_greenhouse__advanced_candidate_deduplication:
            weight: 3
            compare_cols: [candidate_id, full_name, primary_email, primary_phone, current_company, duplicate_cluster_id, master_candidate_id, is_potential_duplicate, is_master_record, duplicate_classification, duplicate_confidence_score, cross_subsidiary_duplicate_flag, recommended_action]
          int_greenhouse__anomaly_detection_rules:
            weight: 3
            compare_cols: [rule_name, rule_category, anomaly_detected, alert_severity, alert_message, recommended_actions, severity_score, anomaly_details]
          int_greenhouse__application_info:
            weight: 0
            compare_cols: []
          int_greenhouse__application_users:
            weight: 0
            compare_cols: []
          int_greenhouse__calculation_audit_log:
            weight: 3
            compare_cols: [audit_calculation_log]
          int_greenhouse__candidate_contacts:
            weight: 0
            compare_cols: []
          int_greenhouse__candidate_tags:
            weight: 0
            compare_cols: []
          int_greenhouse__candidate_users:
            weight: 0
            compare_cols: []
          int_greenhouse__configurable_evaluation_framework:
            weight: 3
            compare_cols: [candidate_id]
          int_greenhouse__conflict_resolution_engine:
            weight: 3
            compare_cols: [conflict_resolution_strategy]
          int_greenhouse__cross_system_consistency_scoring:
            weight: 0
            compare_cols: []
          int_greenhouse__cross_system_data_unification:
            weight: 3
            compare_cols: [candidate_id]
          int_greenhouse__data_lineage_tracking:
            weight: 3
            compare_cols: []
          int_greenhouse__heterogeneous_source_mapping:
            weight: 3
            compare_cols: [application_id, compliance_audit_checkpoint, heterogeneous_data_mapping_schema, real_time_sync_status, source_system]
          int_greenhouse__hiring_team:
            weight: 0
            compare_cols: []
          int_greenhouse__industry_specific_quality_matrix:
            weight: 3
            compare_cols: []
          int_greenhouse__interview_scorecard:
            weight: 0
            compare_cols: []
          int_greenhouse__interview_users:
            weight: 0
            compare_cols: []
          int_greenhouse__job_departments:
            weight: 0
            compare_cols: []
          int_greenhouse__job_info:
            weight: 0
            compare_cols: []
          int_greenhouse__job_offices:
            weight: 0
            compare_cols: []
          int_greenhouse__real_time_quality_monitoring:
            weight: 3
            compare_cols: [metric_name, alert_severity, alert_message, recommended_action, current_avg_quality]
          int_greenhouse__user_emails:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 30
        tables:
          greenhouse__application_enhanced:
            weight: 0
            compare_cols: []
          greenhouse__application_history:
            weight: 0
            compare_cols: []
          greenhouse__candidate_summary:
            weight: 0
            compare_cols: []
          greenhouse__compliance_audit_dashboard:
            weight: 3
            compare_cols: [industry_classification, matched_business_unit, total_candidate_records, overall_compliance_score, compliance_rating, compliance_risk_level, compliance_trend, data_completeness_compliance_rate, quality_score_compliance_rate, framework_compliance_rate, duplicate_rate, deduplication_compliance_status]
          greenhouse__cross_business_quality_analytics:
            weight: 3
            compare_cols: [matched_business_unit, improvement_focus_areas, competitive_position, primary_recommendation, business_unit_health_score]
          greenhouse__data_governance_insights:
            weight: 3
            compare_cols: [overall_governance_score, governance_maturity_level, governance_risk_assessment, compliance_readiness_status, operational_excellence_rating, industry_benchmark_position, lineage_governance_score, calculation_governance_score, data_quality_governance_score, monitoring_governance_score, anomaly_governance_score, total_tracked_tables, compliant_lineage_tables, total_calculations_tracked, audit_compliant_calculations, anomaly_checks_performed, anomalies_detected]
          greenhouse__diversity_metrics:
            weight: 0
            compare_cols: []
          greenhouse__interview_enhanced:
            weight: 0
            compare_cols: []
          greenhouse__interview_scorecard_detail:
            weight: 0
            compare_cols: []
          greenhouse__job_enhanced:
            weight: 0
            compare_cols: []
          greenhouse__recruitment_performance:
            weight: 0
            compare_cols: []
          greenhouse__talent_pipeline_simplified:
            weight: 1
            compare_cols: [rejected_applications]
          greenhouse__unified_candidate_quality_hub:
            weight: 3
            compare_cols: [candidate_id]
  dacomp-de-evol-033:
    database_file: apple_store.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_apple_store__app_crash_daily:
            weight: 1
            compare_cols: [app_id, app_version, crashes, date_day, device, platform_version, source_type, unique_devices]
          stg_apple_store__app_session_daily:
            weight: 1
            compare_cols: [app_download_date, app_id, app_version, date_day, device, page_type, platform_version, sessions, source_type, territory, total_session_duration, unique_devices]
          stg_apple_store__app_store_app:
            weight: 1
            compare_cols: [app_id, app_name, subscription_status_url]
          stg_apple_store__app_store_discovery_and_engagement_daily:
            weight: 1
            compare_cols: [app_id, counts, date_day, device, engagement_type, event, page_type, platform_version, source_type, territory, unique_counts]
          stg_apple_store__app_store_download_daily:
            weight: 1
            compare_cols: [app_id, app_version, counts, date_day, device, download_type, page_type, platform_version, pre_order, source_type, territory]
          stg_apple_store__app_store_installation_and_deletion_daily:
            weight: 1
            compare_cols: [app_download_date, app_id, app_version, counts, date_day, device, download_type, event, page_type, platform_version, source_type, territory, unique_devices]
          stg_apple_store__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_code_numeric, country_name, region, region_code, sub_region, sub_region_code]
          stg_apple_store__sales_subscription_events:
            weight: 1
            compare_cols: [app_apple_id, app_name, cancellation_reason, client, consecutive_paid_periods, country, date_day, days_before_canceling, days_canceled, device, event, marketing_opt_in, marketing_opt_in_duration, original_start_date, paid_service_days_recovered, preserved_pricing, previous_subscription_apple_id, previous_subscription_name, proceeds_reason, promotional_offer_id, promotional_offer_name, quantity, source_type, standard_subscription_duration, state, subscription_apple_id, subscription_group_id, subscription_name, subscription_offer_duration, subscription_offer_type, vendor_number]
          stg_apple_store__sales_subscription_summary:
            weight: 1
            compare_cols: [active_free_trial_introductory_offer_subscriptions, active_pay_as_you_go_introductory_offer_subscriptions, active_pay_up_front_introductory_offer_subscriptions, active_standard_price_subscriptions, app_apple_id, app_name, billing_retry, client, country, customer_currency, customer_price, date_day, developer_proceeds, device, free_trial_offer_code_subscriptions, free_trial_promotional_offer_subscriptions, grace_period, marketing_opt_ins, pay_as_you_go_offer_code_subscriptions, pay_as_you_go_promotional_offer_subscriptions, pay_up_front_offer_code_subscriptions, pay_up_front_promotional_offer_subscriptions, preserved_pricing, proceeds_currency, proceeds_reason, promotional_offer_id, source_type, standard_subscription_duration, state, subscribers, subscription_apple_id, subscription_group_id, subscription_name, subscription_offer_name, vendor_number]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 39
        tables:
          int_apple_store__app:
            weight: 0
            compare_cols: []
          int_apple_store__app_dim:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_app_crashes:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_report:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__country_codes:
            weight: 0
            compare_cols: []
          int_apple_store__crash_daily:
            weight: 0
            compare_cols: []
          int_apple_store__date_spine:
            weight: 0
            compare_cols: []
          int_apple_store__device_app_crashes:
            weight: 0
            compare_cols: []
          int_apple_store__device_downloads_daily:
            weight: 0
            compare_cols: []
          int_apple_store__device_impressions_page_views:
            weight: 0
            compare_cols: []
          int_apple_store__device_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__device_report:
            weight: 0
            compare_cols: []
          int_apple_store__device_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__discovery_and_engagement_daily:
            weight: 0
            compare_cols: []
          int_apple_store__download_daily:
            weight: 0
            compare_cols: []
          int_apple_store__installation_and_deletion_daily:
            weight: 2
            compare_cols: [app_id, app_version, device, page_type, platform_version, source_type, territory]
          int_apple_store__net_installs_daily:
            weight: 4
            compare_cols: [app_id, app_version, device, net_installs_7d, page_type, platform_version, source_type, territory_standardized]
          int_apple_store__platform_version_app_crashes:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_downloads_daily:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_impressions_pv:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_report:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__session_daily:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_impressions_page_views:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_report:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__subscription_events:
            weight: 0
            compare_cols: []
          int_apple_store__subscription_report:
            weight: 0
            compare_cols: []
          int_apple_store__subscription_summary:
            weight: 0
            compare_cols: []
          int_apple_store__territory_downloads_daily:
            weight: 0
            compare_cols: []
          int_apple_store__territory_impressions_page_views:
            weight: 0
            compare_cols: []
          int_apple_store__territory_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__territory_report:
            weight: 2
            compare_cols: [app_id, sub_region, territory_name_long, territory_standardized]
          int_apple_store__territory_sessions_activity:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          apple_store__app_version_report:
            weight: 2
            compare_cols: [active_devices, app_id, app_name, app_version, crashes, date_day, deletions, installations, net_installs_7d, sessions, source_type]
          apple_store__device_report:
            weight: 2
            compare_cols: [active_devices, app_id, app_name, crashes, date_day, deletions, device, first_time_downloads, impressions, impressions_unique_device, installations, net_installs_7d, page_views, page_views_unique_device, redownloads, sessions, source_type, total_downloads]
          apple_store__overview_report:
            weight: 2
            compare_cols: [active_devices, app_id, app_name, crashes, date_day, deletions, first_time_downloads, impressions, installations, net_installs_7d, page_views, redownloads, sessions, total_downloads]
          apple_store__platform_version_report:
            weight: 2
            compare_cols: [active_devices, app_id, app_name, crashes, date_day, deletions, first_time_downloads, impressions, impressions_unique_device, platform_version, redownloads, sessions, source_type, total_downloads]
          apple_store__source_type_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, date_day, deletions, impressions, installations, net_installs_7d, page_views, sessions, source_type]
          apple_store__subscription_report:
            weight: 2
            compare_cols: [date_day, region, sub_region]
          apple_store__territory_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, date_day, deletions, first_time_downloads, impressions, impressions_unique_device, installations, page_views, page_views_unique_device, redownloads, region, sessions, source_type, sub_region, total_downloads]
  dacomp-de-evol-034:
    database_file: apple_store.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_apple_store__app_crash_daily:
            weight: 1
            compare_cols: [app_id, app_version, crashes, date_day, device, platform_version, source_type, unique_devices]
          stg_apple_store__app_session_daily:
            weight: 1
            compare_cols: [app_download_date, app_id, app_version, date_day, device, page_type, platform_version, sessions, source_type, territory, total_session_duration, unique_devices]
          stg_apple_store__app_store_app:
            weight: 1
            compare_cols: [app_id, app_name, subscription_status_url]
          stg_apple_store__app_store_discovery_and_engagement_daily:
            weight: 1
            compare_cols: [app_id, counts, date_day, device, engagement_type, event, page_type, platform_version, source_type, territory, unique_counts]
          stg_apple_store__app_store_download_daily:
            weight: 1
            compare_cols: [app_id, app_version, counts, date_day, device, download_type, page_type, platform_version, pre_order, source_type, territory]
          stg_apple_store__app_store_installation_and_deletion_daily:
            weight: 1
            compare_cols: [app_download_date, app_id, app_version, counts, date_day, device, download_type, event, page_type, platform_version, source_type, territory, unique_devices]
          stg_apple_store__country_codes:
            weight: 1
            compare_cols: [alternative_country_name, country_code_alpha_2, country_code_alpha_3, country_code_numeric, country_name, region, region_code, sub_region, sub_region_code]
          stg_apple_store__sales_subscription_events:
            weight: 1
            compare_cols: [app_apple_id, app_name, cancellation_reason, client, consecutive_paid_periods, country, date_day, days_before_canceling, days_canceled, device, event, marketing_opt_in, marketing_opt_in_duration, original_start_date, paid_service_days_recovered, preserved_pricing, previous_subscription_apple_id, previous_subscription_name, proceeds_reason, promotional_offer_id, promotional_offer_name, quantity, source_type, standard_subscription_duration, state, subscription_apple_id, subscription_group_id, subscription_name, subscription_offer_duration, subscription_offer_type, vendor_number]
          stg_apple_store__sales_subscription_summary:
            weight: 1
            compare_cols: [active_free_trial_introductory_offer_subscriptions, active_pay_as_you_go_introductory_offer_subscriptions, active_pay_up_front_introductory_offer_subscriptions, active_standard_price_subscriptions, app_apple_id, app_name, billing_retry, client, country, customer_currency, customer_price, date_day, developer_proceeds, device, free_trial_offer_code_subscriptions, free_trial_promotional_offer_subscriptions, grace_period, marketing_opt_ins, pay_as_you_go_offer_code_subscriptions, pay_as_you_go_promotional_offer_subscriptions, pay_up_front_offer_code_subscriptions, pay_up_front_promotional_offer_subscriptions, preserved_pricing, proceeds_currency, proceeds_reason, promotional_offer_id, source_type, standard_subscription_duration, state, subscribers, subscription_apple_id, subscription_group_id, subscription_name, subscription_offer_name, vendor_number]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 50
        tables:
          int_apple_store__app:
            weight: 0
            compare_cols: []
          int_apple_store__app_dim:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_app_crashes:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_report:
            weight: 0
            compare_cols: []
          int_apple_store__app_version_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__conversion_report:
            weight: 4
            compare_cols: [app_id]
          int_apple_store__country_codes:
            weight: 0
            compare_cols: []
          int_apple_store__crash_daily:
            weight: 0
            compare_cols: []
          int_apple_store__date_spine:
            weight: 0
            compare_cols: []
          int_apple_store__device_app_crashes:
            weight: 0
            compare_cols: []
          int_apple_store__device_downloads_daily:
            weight: 0
            compare_cols: []
          int_apple_store__device_impressions_page_views:
            weight: 0
            compare_cols: []
          int_apple_store__device_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__device_report:
            weight: 0
            compare_cols: []
          int_apple_store__device_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__discovery_and_engagement_daily:
            weight: 2
            compare_cols: [app_id, device, engagement_type, impressions, impressions_unique_device, page_type, page_views, page_views_product_page, page_views_unique_device, platform_version, source_type, territory]
          int_apple_store__download_daily:
            weight: 2
            compare_cols: [app_id, app_version, counts, device, download_type, first_time_downloads, first_time_downloads_excl_preorder, flag_preorder_unknown, page_type, platform_version, redownloads, territory, total_downloads]
          int_apple_store__installation_and_deletion_daily:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_app_crashes:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_downloads_daily:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_impressions_pv:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_report:
            weight: 0
            compare_cols: []
          int_apple_store__platform_version_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__session_daily:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_impressions_page_views:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_report:
            weight: 0
            compare_cols: []
          int_apple_store__source_type_sessions_activity:
            weight: 0
            compare_cols: []
          int_apple_store__subscription_events:
            weight: 0
            compare_cols: []
          int_apple_store__subscription_report:
            weight: 0
            compare_cols: []
          int_apple_store__subscription_summary:
            weight: 0
            compare_cols: []
          int_apple_store__territory_downloads_daily:
            weight: 0
            compare_cols: []
          int_apple_store__territory_impressions_page_views:
            weight: 0
            compare_cols: []
          int_apple_store__territory_install_deletions:
            weight: 0
            compare_cols: []
          int_apple_store__territory_report:
            weight: 0
            compare_cols: []
          int_apple_store__territory_sessions_activity:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 49
        tables:
          apple_store__app_version_report:
            weight: 0
            compare_cols: []
          apple_store__device_report:
            weight: 2
            compare_cols: [active_devices, app_id, app_name, crash_rate_per_active_device, crash_rate_per_session, crashes, date_day, deletions, device, first_time_downloads, impressions, impressions_unique_device, installations, page_views, page_views_unique_device, ppv_to_install_rate, redownloads, sessions, source_type, total_downloads]
          apple_store__overview_report:
            weight: 2
            compare_cols: [active_devices, app_id, app_name, crash_rate_per_active_device, crash_rate_per_session, crashes, date_day, deletions, first_time_downloads, impressions, installations, page_views, redownloads, sessions, total_downloads]
          apple_store__platform_version_report:
            weight: 2
            compare_cols: [active_devices, app_id, app_name, crash_rate_per_active_device, crash_rate_per_session, crashes, date_day, deletions, first_time_downloads, impressions, impressions_unique_device, installations, page_views, page_views_unique_device, platform_version, ppv_to_install_rate, redownloads, sessions, source_type, total_downloads]
          apple_store__source_type_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, deletions, impressions, installations, page_views, sessions, source_type]
          apple_store__subscription_report:
            weight: 0
            compare_cols: []
          apple_store__territory_report:
            weight: 1
            compare_cols: [active_devices, app_id, app_name, deletions, first_time_downloads, impressions, impressions_unique_device, installations, page_views, page_views_unique_device, ppv_to_install_rate, redownloads, region, sessions, source_type, sub_region, territory_long, territory_short, total_downloads]
  dacomp-de-evol-035:
    database_file: intercom.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_intercom__admin:
            weight: 1
            compare_cols: []
          stg_intercom__company_history:
            weight: 1
            compare_cols: [company_id, company_name, industry, monthly_spend, plan_id, plan_name, session_count, updated_at, user_count, website]
          stg_intercom__company_tag_history:
            weight: 1
            compare_cols: [company_id, company_updated_at, tag_id]
          stg_intercom__contact_company_history:
            weight: 1
            compare_cols: [company_id, contact_id]
          stg_intercom__contact_history:
            weight: 1
            compare_cols: [admin_id, contact_email, contact_id, contact_name, contact_role, is_unsubscribed_from_emails, last_contacted_at, last_email_clicked_at, last_email_opened_at, last_replied_at, signed_up_at, updated_at]
          stg_intercom__contact_tag_history:
            weight: 1
            compare_cols: [contact_id, tag_id]
          stg_intercom__conversation_contact_history:
            weight: 1
            compare_cols: [contact_id, conversation_id]
          stg_intercom__conversation_history:
            weight: 1
            compare_cols: [assignee_id, assignee_type, conversation_id, conversation_rating_remark, conversation_rating_value, first_contact_reply_created_at, first_contact_reply_type, is_read, sla_name, sla_status, snoozed_until, source_author_id, source_author_type, source_delivered_as, source_subject, source_type, state, updated_at, waiting_since]
          stg_intercom__conversation_part_history:
            weight: 1
            compare_cols: [author_id, author_type, body, conversation_id, conversation_part_id, part_type, updated_at]
          stg_intercom__conversation_tag_history:
            weight: 1
            compare_cols: [conversation_id, tag_id]
          stg_intercom__tag:
            weight: 1
            compare_cols: [name, tag_id]
          stg_intercom__team:
            weight: 1
            compare_cols: []
          stg_intercom__team_admin:
            weight: 1
            compare_cols: []
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 45
        tables:
          int_intercom__admin:
            weight: 0
            compare_cols: []
          int_intercom__company_history:
            weight: 0
            compare_cols: []
          int_intercom__company_tags_aggregate:
            weight: 0
            compare_cols: []
          int_intercom__contact_company_history:
            weight: 0
            compare_cols: []
          int_intercom__contact_company_names:
            weight: 0
            compare_cols: []
          int_intercom__contact_latest:
            weight: 0
            compare_cols: []
          int_intercom__contact_tags_aggregate:
            weight: 0
            compare_cols: []
          int_intercom__conversation_company_attribution:
            weight: 4
            compare_cols: [conversation_id]
          int_intercom__conversation_exclusion_flags:
            weight: 4
            compare_cols: [conversation_id, exclusion_reason, matched_rule]
          int_intercom__conversation_part_aggregates:
            weight: 0
            compare_cols: []
          int_intercom__conversation_part_events:
            weight: 0
            compare_cols: []
          int_intercom__conversation_string_aggregates:
            weight: 0
            compare_cols: []
          int_intercom__conversation_tags_aggregate:
            weight: 0
            compare_cols: []
          int_intercom__latest_conversation:
            weight: 0
            compare_cols: []
          int_intercom__team:
            weight: 0
            compare_cols: []
          int_intercom__team_admin:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 54
        tables:
          intercom__admin_metrics:
            weight: 0
            compare_cols: []
          intercom__company_enhanced:
            weight: 0
            compare_cols: []
          intercom__company_metrics:
            weight: 3
            compare_cols: [avg_conversation_parts, avg_conversation_rating, company_id, company_name, contacts_total, conv_rate_email, conv_rate_messenger, conv_rate_other, conv_rate_overall, industry, is_date_continuous, missing_days, p50_reopens, p50_time_to_first_close_min, p50_time_to_first_response_min, p50_time_to_last_close_min, plan_id, plan_name, total_conversations, total_conversations_closed, website]
          intercom__contact_enhanced:
            weight: 0
            compare_cols: []
          intercom__conversation_enhanced:
            weight: 2
            compare_cols: [all_contact_company_names, all_conversation_admins, all_conversation_contacts, all_conversation_tags, company_id_at_conversation, company_name_at_conversation, conversation_assignee_type, conversation_author_type, conversation_created_at, conversation_id, conversation_initiated_type, conversation_last_updated_at, conversation_rating, conversation_remark, conversation_state, conversation_subject, conversation_type, exclusion_reason, first_admin_close_at, first_close_at, first_close_by_admin_id, first_close_by_author_id, first_contact_author_id, is_internal_test, is_read, last_admin_close_at, last_close_at, last_close_by_admin_id, last_close_by_author_id, last_contact_author_id, matched_rule, sla_name, sla_status, snoozed_until, waiting_since]
          intercom__conversation_metrics:
            weight: 3
            compare_cols: [conversation_assignee_type, conversation_author_type, conversation_id, conversation_initiated_type, conversation_last_updated_at, conversation_rating, conversation_rating_remark, conversation_state, conversation_subject, conversation_type, count_reopens, count_total_parts, first_close_by_admin_id, first_close_by_author_id, first_contact_author_id, first_contact_reply_at, first_reopen_at, is_read, last_admin_response_at, last_assignment_at, last_close_by_admin_id, last_close_by_author_id, last_contact_author_id, last_contact_reply_at, last_reopen_at, sla_name, sla_status, snoozed_until, time_to_admin_first_close_minutes, time_to_admin_last_close_minutes, time_to_first_assignment_minutes, time_to_first_close_minutes, time_to_first_response_minutes, time_to_last_assignment_minutes, time_to_last_close_minutes, waiting_since]
  dacomp-de-evol-036:
    database_file: intercom.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_intercom__admin:
            weight: 1
            compare_cols: [admin_id, job_title, name]
          stg_intercom__company_history:
            weight: 1
            compare_cols: [company_id, company_name, industry, monthly_spend, plan_id, plan_name, session_count, updated_at, user_count, website]
          stg_intercom__company_tag_history:
            weight: 1
            compare_cols: [company_id, tag_id]
          stg_intercom__contact_company_history:
            weight: 1
            compare_cols: [company_id, contact_id]
          stg_intercom__contact_history:
            weight: 1
            compare_cols: [admin_id, contact_email, contact_id, contact_name, contact_role, is_unsubscribed_from_emails, phone]
          stg_intercom__contact_tag_history:
            weight: 1
            compare_cols: [contact_id, contact_updated_at, tag_id]
          stg_intercom__conversation_contact_history:
            weight: 1
            compare_cols: [contact_id, conversation_id]
          stg_intercom__conversation_history:
            weight: 1
            compare_cols: [assignee_id, assignee_type, conversation_id, conversation_rating_remark, conversation_rating_value, first_contact_reply_created_at, first_contact_reply_type, is_read, sla_name, sla_status, snoozed_until, source_author_id, source_author_type, source_delivered_as, source_subject, source_type, state, updated_at, waiting_since]
          stg_intercom__conversation_part_history:
            weight: 1
            compare_cols: [author_id, author_type, body, conversation_id, conversation_part_id, part_type]
          stg_intercom__conversation_tag_history:
            weight: 1
            compare_cols: [conversation_id, tag_id]
          stg_intercom__tag:
            weight: 1
            compare_cols: [name, tag_id]
          stg_intercom__team:
            weight: 1
            compare_cols: [name, team_id]
          stg_intercom__team_admin:
            weight: 1
            compare_cols: [admin_id, team_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 45
        tables:
          int_intercom__admin:
            weight: 0
            compare_cols: []
          int_intercom__company_history:
            weight: 0
            compare_cols: []
          int_intercom__company_tags_aggregate:
            weight: 0
            compare_cols: []
          int_intercom__contact_company_history:
            weight: 0
            compare_cols: []
          int_intercom__contact_company_names:
            weight: 0
            compare_cols: []
          int_intercom__contact_latest:
            weight: 0
            compare_cols: []
          int_intercom__contact_tags_aggregate:
            weight: 0
            compare_cols: []
          int_intercom__conversation_business_time:
            weight: 4
            compare_cols: [business_minutes_to_first_close, business_minutes_to_first_response, business_minutes_to_last_close, conversation_id, is_first_response_within_sla, is_resolution_within_sla]
          int_intercom__conversation_part_aggregates:
            weight: 2
            compare_cols: [conversation_id, count_assignments, count_reopens, count_total_parts, first_contact_reply_at, reopens_under_5m_count]
          int_intercom__conversation_part_events:
            weight: 0
            compare_cols: []
          int_intercom__conversation_responsible_team:
            weight: 4
            compare_cols: [conversation_id, responsible_team_id, responsible_team_name]
          int_intercom__conversation_string_aggregates:
            weight: 0
            compare_cols: []
          int_intercom__conversation_tags_aggregate:
            weight: 0
            compare_cols: []
          int_intercom__latest_conversation:
            weight: 0
            compare_cols: []
          int_intercom__team:
            weight: 0
            compare_cols: []
          int_intercom__team_admin:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 54
        tables:
          intercom__admin_metrics:
            weight: 2
            compare_cols: [admin_id, admin_name, average_conversation_parts, average_conversation_rating, close_rate, job_title, median_conversation_assignments, median_conversations_reopened, median_time_to_first_close_minutes, median_time_to_first_response_time_minutes, median_time_to_last_close_minutes, team_id, team_name, total_conversations, total_conversations_closed]
          intercom__company_enhanced:
            weight: 0
            compare_cols: []
          intercom__company_metrics:
            weight: 2
            compare_cols: [avg_conversation_parts, avg_conversation_rating, company_id, company_name, contacts_active_30d, contacts_active_7d, contacts_total, conv_rate_email, conv_rate_messenger, conv_rate_other, conv_rate_overall, industry, is_date_continuous, missing_days, p50_business_time_to_first_close_min, p50_business_time_to_first_response_min, p50_reopens, plan_id, plan_name, registration_retention_30d, registration_retention_7d, resolution_sla_compliance_rate, total_conversations, total_conversations_closed, website]
          intercom__contact_enhanced:
            weight: 0
            compare_cols: []
          intercom__conversation_enhanced:
            weight: 0
            compare_cols: []
          intercom__conversation_metrics:
            weight: 2
            compare_cols: [business_minutes_to_first_close, business_minutes_to_first_response, business_minutes_to_last_close, close_rate_excluding_quick_reopens, conversation_assignee_type, conversation_author_type, conversation_id, conversation_initiated_type, conversation_rating, conversation_rating_remark, conversation_state, conversation_subject, conversation_type, count_assignments, count_reopens, count_total_parts, is_first_response_within_sla, is_read, is_resolution_within_sla, reopens_under_5m_count, sla_name, sla_status, time_to_admin_first_close_minutes, time_to_admin_last_close_minutes, time_to_first_assignment_minutes, time_to_first_close_minutes, time_to_first_response_minutes, time_to_last_assignment_minutes, time_to_last_close_minutes]
          intercom__team_metrics:
            weight: 2
            compare_cols: [average_conversation_parts, team_id, team_name, total_conversations, total_conversations_closed]
  dacomp-de-evol-037:
    database_file: klaviyo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_klaviyo__campaign:
            weight: 1
            compare_cols: [campaign_id, campaign_name, CAMPAIGN_TYPE, EMAIL_TEMPLATE_ID, from_email, FROM_NAME, is_archived, scheduled_at, scheduled_to_send_at, SENT_AT, STATUS, STATUS_ID, SUBJECT, updated_at]
          stg_klaviyo__event:
            weight: 1
            compare_cols: [campaign_id, event_attribution, event_id, flow_id, FLOW_MESSAGE_ID, metric_id, numeric_value, occurred_on, person_id, property_compare_at_price, property_price, type, UUID, variation_id]
          stg_klaviyo__flow:
            weight: 1
            compare_cols: [flow_id, flow_name, is_archived, status, trigger_type]
          stg_klaviyo__metric:
            weight: 1
            compare_cols: [integration_category, integration_id, integration_name, metric_id, metric_name]
          stg_klaviyo__person:
            weight: 1
            compare_cols: [email, full_name, LAST_EVENT_DATE, LATITUDE, LONGITUDE, ORGANIZATION, person_id, phone_number]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 59
        tables:
          int_klaviyo__campaign_flow_metrics:
            weight: 0
            compare_cols: []
          int_klaviyo__campaigns_enriched:
            weight: 2
            compare_cols: [campaign_id, campaign_variation_key, email_click_to_open_rate, email_delivered_unique, email_open_rate, gmv_gross, gmv_net, STATUS, variation_id]
          int_klaviyo__event_attribution:
            weight: 0
            compare_cols: []
          int_klaviyo__event_attribution_trail:
            weight: 4
            compare_cols: [candidate_touch_id, candidate_touch_ts, candidate_touch_type, event_id, is_chosen, proximity_rank]
          int_klaviyo__event_attribution_windows:
            weight: 4
            compare_cols: [attributed_amount_negative, attributed_amount_positive, attributed_net_revenue, attribution_window, event_id]
          int_klaviyo__events:
            weight: 0
            compare_cols: []
          int_klaviyo__flows_enriched:
            weight: 2
            compare_cols: [email_click_to_open_rate, email_delivered_unique, flow_id, flow_variation_key, gmv_gross, gmv_net, status, trigger_type, variation_id]
          int_klaviyo__person_campaign_flow:
            weight: 0
            compare_cols: []
          int_klaviyo__person_metrics:
            weight: 0
            compare_cols: []
          int_klaviyo__persons_enriched:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          klaviyo__campaigns:
            weight: 2
            compare_cols: [campaign_id, campaign_variation_key, email_click_to_open_rate, email_delivered_unique, email_open_rate, gmv_gross, gmv_net, net_revenue_attributed, variation_id]
          klaviyo__campaigns_daily:
            weight: 0
            compare_cols: []
          klaviyo__events:
            weight: 2
            compare_cols: [amount_negative, amount_positive, campaign_name, campaign_subject_line, day_clicked_email, day_net_revenue, day_net_revenue_attributed, day_opened_email, day_ordered_product, day_placed_order, event_attributed_net_revenue, event_attribution, event_attribution_window, event_id, flow_name, integration_category, integration_id, integration_name, inter_event_minutes, is_engagement_event, last_touch_campaign_id, last_touch_flow_id, last_touch_id, metric_id, numeric_value, prev_occurred_on, session_seq, session_touch_type, touch_id, touch_type, type, variation_id]
          klaviyo__flows:
            weight: 2
            compare_cols: [email_delivered_unique, email_open_rate, flow_id, flow_variation_key, gmv_gross, gmv_net, net_revenue_attributed, revenue_attributed_click_7d, revenue_attributed_open_1d, status, trigger_type, variation_id]
          klaviyo__flows_daily:
            weight: 0
            compare_cols: []
          klaviyo__person_campaign_flow:
            weight: 0
            compare_cols: []
          klaviyo__persons:
            weight: 0
            compare_cols: []
  dacomp-de-evol-038:
    database_file: klaviyo.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_klaviyo__campaign:
            weight: 1
            compare_cols: [campaign_id, campaign_name, CAMPAIGN_TYPE, EMAIL_TEMPLATE_ID, from_email, FROM_NAME, is_archived, scheduled_at, scheduled_to_send_at, SENT_AT, STATUS, STATUS_ID, SUBJECT, updated_at]
          stg_klaviyo__event:
            weight: 1
            compare_cols: [campaign_id, event_attribution, event_id, flow_id, FLOW_MESSAGE_ID, metric_id, numeric_value, occurred_on, person_id, property_compare_at_price, property_price, type, UUID, variation_id]
          stg_klaviyo__flow:
            weight: 1
            compare_cols: [flow_id, flow_name, is_archived, status, trigger_type]
          stg_klaviyo__metric:
            weight: 1
            compare_cols: [integration_category, integration_id, integration_name, metric_id, metric_name]
          stg_klaviyo__person:
            weight: 1
            compare_cols: [email, full_name, person_id, phone_number, REGION, timezone]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 54
        tables:
          int_klaviyo__campaign_flow_metrics:
            weight: 2
            compare_cols: [count_active_on_site, count_clicked_email, count_clicked_sms, count_marked_email_as_spam, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_received_sms, count_refunded_order, count_sent_sms, count_unsubscribed, count_unsubscribed_from_sms, count_viewed_product, email_click_to_open_rate, email_open_rate, first_event_at, gmv_gross, gmv_net, last_event_at, last_touch_campaign_id, last_touch_flow_id, product_view_to_order_rate, site_to_order_rate, sum_revenue_cancelled_order, sum_revenue_checkout_started, sum_revenue_ordered_product, sum_revenue_placed_order, sum_revenue_refunded_order, total_count_unique_people, unique_count_active_on_site, unique_count_clicked_email, unique_count_clicked_sms, unique_count_marked_email_as_spam, unique_count_opened_email, unique_count_ordered_product, unique_count_placed_order, unique_count_received_email, unique_count_received_sms, unique_count_refunded_order, unique_count_sent_sms, unique_count_unsubscribed, unique_count_unsubscribed_from_sms, unique_count_viewed_product, variation_id]
          int_klaviyo__campaigns_enriched:
            weight: 2
            compare_cols: [campaign_id, campaign_name, CAMPAIGN_TYPE, campaign_variation_key, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, email_click_to_open_rate, email_open_rate, gmv_gross, gmv_net, is_archived, scheduled_at, scheduled_to_send_at, SENT_AT, STATUS, STATUS_ID, SUBJECT, total_count_unique_people, updated_at, variation_id]
          int_klaviyo__event_attribution:
            weight: 0
            compare_cols: []
          int_klaviyo__events:
            weight: 3
            compare_cols: [amount_negative, amount_positive, campaign_name, campaign_subject_line, CAMPAIGN_TYPE, event_attribution, event_id, flow_name, integration_category, integration_id, integration_name, inter_event_minutes, invalid_reason, is_engagement_event, last_touch_campaign_id, last_touch_flow_id, last_touch_id, metric_id, numeric_value, occurred_at, occurred_at_tz, occurred_on, occurred_on_tz, person_city, person_country, person_email, person_id, person_region, person_timezone, prev_event_at, session_seq, session_touch_type, timezone_source, touch_id, touch_type, type, UUID, variation_id]
          int_klaviyo__flows_enriched:
            weight: 0
            compare_cols: []
          int_klaviyo__multi_touch_assist:
            weight: 4
            compare_cols: [assist_usage_count_over_window, assisted_conversion_flag, assisted_net_revenue, assisted_touch_id, assisted_touch_type, attributed_window_end, attributed_window_start, conversion_event_id, tie_breaker_rule]
          int_klaviyo__person_campaign_flow:
            weight: 0
            compare_cols: []
          int_klaviyo__person_metrics:
            weight: 2
            compare_cols: [active_months, active_weeks, count_active_on_site, count_clicked_email, count_clicked_sms, count_marked_email_as_spam, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_received_sms, count_refunded_order, count_sent_sms, count_unsubscribed, count_unsubscribed_from_sms, count_viewed_product, email_click_to_open_rate, email_open_rate, first_event_on, last_event_on, missing_day_count, person_id, product_view_to_order_rate, site_to_order_rate, sum_revenue_cancelled_order, sum_revenue_ordered_product, sum_revenue_placed_order, sum_revenue_refunded_order]
          int_klaviyo__persons_enriched:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 45
        tables:
          klaviyo__campaigns:
            weight: 2
            compare_cols: [campaign_id, campaign_name, CAMPAIGN_TYPE, campaign_variation_key, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, email_click_to_open_rate, email_open_rate, total_amount_positive, total_count_unique_people, total_placed_orders]
          klaviyo__campaigns_primary_only:
            weight: 0
            compare_cols: []
          klaviyo__events:
            weight: 2
            compare_cols: [campaign_name, day_click_to_open_rate, event_id, flow_name, is_engagement_event, last_touch_campaign_id, last_touch_flow_id, occurred_at, occurred_at_tz, occurred_on_tz, person_city, person_country, person_email, person_id, type]
          klaviyo__flows:
            weight: 2
            compare_cols: [count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_refunded_order, email_click_to_open_rate, email_open_rate, flow_id, flow_name, flow_variation_key, gmv_gross, gmv_net, gmv_net_flow, is_archived, product_view_to_order_rate_flow, status, total_amount_negative, total_amount_positive, total_count_unique_people, total_placed_orders, trigger_type, updated_at, variation_id]
          klaviyo__person_campaign_flow:
            weight: 0
            compare_cols: []
          klaviyo__persons:
            weight: 2
            compare_cols: [active_months, active_weeks, count_active_on_site, count_clicked_email, count_opened_email, count_ordered_product, count_placed_order, count_received_email, count_viewed_product, COUNTRY, email, email_open_rate, first_event_on]
  dacomp-de-evol-039:
    database_file: recharge.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 10
        tables:
          stg_recharge__address:
            weight: 1
            compare_cols: [address1, address2, address_id, city, company, country, country_code, country_name, customer_id, default_address, first_name, last_name, name, phone, province, province_code, subscription_id, updated_at, zip]
          stg_recharge__address_discounts:
            weight: 1
            compare_cols: [address_discount_id, address_id, discount_id, updated_at]
          stg_recharge__address_shipping_line:
            weight: 1
            compare_cols: [address_id, shipping_rate_id, shipping_zone_id]
          stg_recharge__charge:
            weight: 2
            compare_cols: [address_id, charge_id, charge_status, created_at_src_tz, customer_id, processed_at, processed_at_src_tz, scheduled_at, scheduled_at_src_tz, src_timezone, updated_at, updated_at_src_tz]
          stg_recharge__charge_discount:
            weight: 1
            compare_cols: [charge_id, discount_id, updated_at]
          stg_recharge__charge_line_item:
            weight: 1
            compare_cols: [charge_id, charge_line_item_id, price, quantity, subscription_id, variant_title]
          stg_recharge__charge_order_attribute:
            weight: 1
            compare_cols: [charge_id, name, value]
          stg_recharge__charge_shipping_line:
            weight: 1
            compare_cols: [charge_id, charge_shipping_line_id, code, price, shipping_rate_id, title]
          stg_recharge__charge_tax_line:
            weight: 1
            compare_cols: [charge_id, charge_tax_line_id, price, rate, title]
          stg_recharge__checkout:
            weight: 1
            compare_cols: [checkout_completed_at, checkout_created_at, checkout_id, checkout_updated_at, customer_id, delivery_date, note, shipping_date, shopify_cart_token, shopify_checkout_id]
          stg_recharge__customer:
            weight: 1
            compare_cols: [customer_created_at, customer_hash, customer_id, customer_updated_at, email, shopify_customer_id]
          stg_recharge__discount:
            weight: 1
            compare_cols: [discount_id]
          stg_recharge__one_time_product:
            weight: 1
            compare_cols: [charge_id, one_time_created_at, one_time_product_id, one_time_updated_at, price, product_title, quantity, shopify_product_id, shopify_variant_id, variant_title]
          stg_recharge__order:
            weight: 1
            compare_cols: [charge_id, customer_id, order_created_at, order_id, order_processed_at, order_updated_at]
          stg_recharge__order_line_item:
            weight: 1
            compare_cols: [charge_id, order_line_item_id, price, product_title, quantity, shopify_product_id, shopify_variant_id, subscription_id, updated_at, variant_title]
          stg_recharge__subscription:
            weight: 1
            compare_cols: [address_id, cancellation_reason, customer_id, expire_after_specific_number_of_charges, order_day_of_month, order_day_of_week, order_interval_frequency, order_interval_unit, price, product_title, quantity, shopify_product_id, shopify_variant_id, sku, subscription_cancelled_at, subscription_created_at, subscription_id, subscription_status, subscription_updated_at]
          stg_recharge__subscription_history:
            weight: 1
            compare_cols: [is_most_recent_record, subscription_created_at, subscription_id, subscription_status, subscription_updated_at]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 50
        tables:
          int_recharge__billing_history:
            weight: 2
            compare_cols: [calculated_order_total_price_realized, charge_id, customer_id, event_time_utc, is_charge_success]
          int_recharge__calendar_spine:
            weight: 0
            compare_cols: []
          int_recharge__charge_line_item_history:
            weight: 2
            compare_cols: [charge_id, customer_id]
          int_recharge__customer_daily_rollup:
            weight: 0
            compare_cols: []
          int_recharge__customer_details:
            weight: 0
            compare_cols: []
          int_recharge__subscription_enriched:
            weight: 4
            compare_cols: [charge_interval_frequency_days, count_queued_charges, count_successful_charges, customer_id, is_current, subscription_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 40
        tables:
          recharge__billing_history:
            weight: 2
            compare_cols: [calculated_order_total_price_realized, calculated_order_total_price_realized_net_of_tax, charge_id, chargeback_amount_realized, customer_id, date_day, date_month, is_charge_success, order_item_quantity, refund_amount_realized]
          recharge__charge_line_item_history:
            weight: 2
            compare_cols: [charge_id, customer_id]
          recharge__customer_daily_rollup:
            weight: 2
            compare_cols: [customer_id, date_week, date_year]
          recharge__customer_details:
            weight: 0
            compare_cols: []
          recharge__monthly_recurring_revenue:
            weight: 2
            compare_cols: [customer_id, date_month]
          recharge__subscription_overview:
            weight: 2
            compare_cols: [charge_interval_frequency_days, count_queued_charges, count_successful_charges, customer_id, is_current, subscription_id]
  dacomp-de-evol-040:
    database_file: recharge.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_recharge__address:
            weight: 1
            compare_cols: [address1, address2, address_id, city, company, country, country_code, country_name, customer_id, default_address, first_name, last_name, name, phone, province, province_code, subscription_id, updated_at, zip]
          stg_recharge__address_discounts:
            weight: 1
            compare_cols: [address_discount_id, address_id, discount_id, updated_at]
          stg_recharge__address_shipping_line:
            weight: 1
            compare_cols: [address_id, shipping_rate_id, shipping_zone_id]
          stg_recharge__charge:
            weight: 1
            compare_cols: [address_id, charge_id, charge_status, customer_id, last_attempt_error, name, note, processed_at, retry_at, retry_count, scheduled_at, shopify_order_id, updated_at]
          stg_recharge__charge_discount:
            weight: 1
            compare_cols: [charge_id, discount_id, updated_at]
          stg_recharge__charge_line_item:
            weight: 1
            compare_cols: [charge_id, charge_line_item_id, price, product_title, quantity, shopify_order_line_item_id, shopify_product_id, shopify_variant_id, subscription_id, updated_at, variant_title]
          stg_recharge__charge_order_attribute:
            weight: 1
            compare_cols: [charge_id, name, value]
          stg_recharge__charge_shipping_line:
            weight: 1
            compare_cols: [charge_id, charge_shipping_line_id, code, price, shipping_rate_id, title]
          stg_recharge__charge_tax_line:
            weight: 1
            compare_cols: [charge_id, charge_tax_line_id, price, rate, title]
          stg_recharge__checkout:
            weight: 1
            compare_cols: [checkout_completed_at, checkout_created_at, checkout_id, checkout_updated_at, customer_id, delivery_date, note, shipping_date, shopify_cart_token, shopify_checkout_id]
          stg_recharge__customer:
            weight: 1
            compare_cols: [customer_created_at, customer_hash, customer_id, customer_updated_at, email, shopify_customer_id]
          stg_recharge__discount:
            weight: 1
            compare_cols: [applies_to_product_type, discount_created_at, discount_id, discount_type, discount_updated_at, duration, duration_usage_limit, max_subsequent_contracts, shipping_product_title, shipping_variant_title, value, value_type]
          stg_recharge__one_time_product:
            weight: 1
            compare_cols: [charge_id, one_time_created_at, one_time_product_id, one_time_updated_at, price, product_title, quantity, shopify_product_id, shopify_variant_id, variant_title]
          stg_recharge__order:
            weight: 1
            compare_cols: [charge_id, customer_id, order_created_at, order_id, order_processed_at, order_updated_at]
          stg_recharge__order_line_item:
            weight: 1
            compare_cols: [charge_id, order_line_item_id, price, product_title, quantity, shopify_product_id, shopify_variant_id, subscription_id, updated_at, variant_title]
          stg_recharge__subscription:
            weight: 1
            compare_cols: [address_id, cancellation_reason, cancellation_reason_comments, charge_interval_frequency, customer_id, expire_after_specific_number_of_charges, external_product_id_ecommerce, external_variant_id_ecommerce, order_day_of_month, order_day_of_week, order_interval_frequency, order_interval_unit, price, product_title, quantity, shopify_product_id, shopify_variant_id, sku, subscription_cancelled_at, subscription_created_at, subscription_id, subscription_next_charge_scheduled_at, subscription_status, subscription_updated_at, variant_title]
          stg_recharge__subscription_history:
            weight: 1
            compare_cols: [is_most_recent_record, subscription_created_at, subscription_id, subscription_status, subscription_updated_at]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 50
        tables:
          int_recharge__calendar_spine:
            weight: 0
            compare_cols: []
          int_recharge__charge_components_union:
            weight: 0
            compare_cols: []
          int_recharge__customer_cohort_dates:
            weight: 4
            compare_cols: [customer_id]
          int_recharge__customer_daily_rollup:
            weight: 0
            compare_cols: []
          int_recharge__customer_details:
            weight: 0
            compare_cols: []
          int_recharge__order_facts:
            weight: 0
            compare_cols: []
          int_recharge__subscription_base:
            weight: 0
            compare_cols: []
          int_recharge__subscription_status_daily:
            weight: 4
            compare_cols: [customer_id, is_active_day, is_churn_day, is_reactivated_day, next_charge_due_day, status_at_day, subscription_id]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 49
        tables:
          recharge__billing_history:
            weight: 0
            compare_cols: []
          recharge__charge_line_item_history:
            weight: 0
            compare_cols: []
          recharge__customer_daily_rollup:
            weight: 3
            compare_cols: [customer_id, date_day]
          recharge__customer_details:
            weight: 0
            compare_cols: []
          recharge__monthly_recurring_revenue:
            weight: 2
            compare_cols: [calculated_net_order_mrr_active, date_month]
          recharge__subscription_overview:
            weight: 2
            compare_cols: [active_days_in_month, charge_interval_frequency_days, churned_day, count_successful_charges_active, reactivated_day, subscription_id]
  dacomp-de-evol-041:
    database_file: social_media_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_social_media__account_history:
            weight: 0
            compare_cols: []
          stg_social_media__config_params:
            weight: 0
            compare_cols: []
          stg_social_media__facebook_posts:
            weight: 0
            compare_cols: []
          stg_social_media__instagram_posts:
            weight: 0
            compare_cols: []
          stg_social_media__linkedin_posts:
            weight: 0
            compare_cols: []
          stg_social_media__page_timezone:
            weight: 4
            compare_cols: [page_id, iana_timezone]
          stg_social_media__platform_domain_whitelist:
            weight: 0
            compare_cols: []
          stg_social_media__twitter_organic_tweets:
            weight: 0
            compare_cols: []
          stg_social_media__twitter_user_history:
            weight: 0
            compare_cols: []
          stg_social_media__youtube_videos:
            weight: 0
            compare_cols: []
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          social_media_reporting__facebook_posts_reporting:
            weight: 1
            compare_cols: [clicks, comments, created_timestamp, day, impressions, likes, month, page_id, page_name, platform, post_id, post_message, post_url, shares, week]
          social_media_reporting__instagram_posts_reporting:
            weight: 1
            compare_cols: [clicks, comments, created_timestamp, impressions, likes, page_id, page_name, platform, post_id, post_message, post_url, shares]
          social_media_reporting__linkedin_posts_reporting:
            weight: 1
            compare_cols: [clicks, comments, created_timestamp, impressions, likes, page_id, page_name, platform, post_id, post_message, post_url, shares]
          social_media_reporting__twitter_posts_reporting:
            weight: 1
            compare_cols: [clicks, comments, created_timestamp, impressions, likes, page_id, page_name, platform, post_id, post_message, post_url, shares]
          social_media_reporting__youtube_videos_reporting:
            weight: 1
            compare_cols: [clicks, comments, created_timestamp, impressions, likes, page_id, page_name, platform, post_id, post_message, post_url, shares]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          social_media_reporting__ctr_by_platform:
            weight: 1
            compare_cols: [active_accounts_count, month, platform, posts_count]
          social_media_reporting__daily_kpis:
            weight: 1
            compare_cols: [active_accounts_count, clicks, comments, ctr, day, engagement_rate, impressions, likes, platform, posts_count, shares]
          social_media_reporting__retention_kpis:
            weight: 1
            compare_cols: [cohort_pages, cohort_week, platform, retained_pages, retention_rate, target_week, week_offset]
          social_media_reporting__rollup_report:
            weight: 1
            compare_cols: [clicks, comments, created_timestamp, daily_platform_rank, engagement_rate, impressions, likes, page_id, page_name, platform, platform_lifetime_rank, post_id, post_message, post_url, shares]
  dacomp-de-evol-042:
    database_file: social_media_reporting.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_social_media__account_history:
            weight: 1
            compare_cols: [approval_status, business_id, business_name, deleted, id, industry_type, name, salt, timezone, timezone_switch_at, updated_at]
          stg_social_media__facebook_posts:
            weight: 1
            compare_cols: [created_timestamp, id, impressions, is_eligible_for_promotion, is_instagram_eligible, page_category, page_followers, page_id, page_name, page_username, post_id, post_message, post_url, privacy_value, shares, status_type]
          stg_social_media__instagram_posts:
            weight: 1
            compare_cols: [_fivetran_synced, account_followers, account_media_count, account_username, comments, created_timestamp, engagement, engagement_rate, ig_post_id, impressions, impressions_override, likes, media_type, media_type_category, media_url, page_id, page_name, post_caption, post_id, post_url, reach, saves, shares]
          stg_social_media__linkedin_posts:
            weight: 1
            compare_cols: [content_type, created_timestamp, organization_id, platform, post_id, post_message, post_url]
          stg_social_media__page_timezone:
            weight: 1
            compare_cols: []
          stg_social_media__twitter_organic_tweets:
            weight: 1
            compare_cols: [_fivetran_synced, account_id, app_clicks, card_engagements, carousel_swipes, clicks, date, engagement_rate, engagements, follows, impressions, lang, likes, organic_tweet_id, placement, poll_card_vote, qualified_impressions, replies, retweets, screen_name, tweet_text, tweets_send, unfollows, url_clicks, user_name, video_15_s_views, video_3_s_100_pct_views, video_6_s_views, video_content_starts, video_cta_clicks, video_total_views, video_views_100, video_views_25, video_views_50, video_views_75]
          stg_social_media__twitter_user_history:
            weight: 1
            compare_cols: [_fivetran_synced, default_profile, default_profile_image, description, favourites_count, followers_count, following_count, id, lang, listed_count, location, protected, screen_name, statuses_count, time_zone, url, verified]
          stg_social_media__weight_config:
            weight: 1
            compare_cols: []
          stg_social_media__youtube_videos:
            weight: 1
            compare_cols: [_fivetran_synced, channel_id, channel_title, clicks, comments, engagement_rate, estimated_shares, impressions, likes, page_name, post_url, privacy_status, subscribers, video_description, video_id, video_title]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 45
        tables:
          social_media_reporting__facebook_posts_reporting:
            weight: 0
            compare_cols: []
          social_media_reporting__instagram_posts_reporting:
            weight: 0
            compare_cols: []
          social_media_reporting__linkedin_posts_reporting:
            weight: 0
            compare_cols: []
          social_media_reporting__quality_reference_windows:
            weight: 4
            compare_cols: [platform]
          social_media_reporting__sanitized_daily_metrics:
            weight: 4
            compare_cols: [anomaly_flag, boundary_flag, platform]
          social_media_reporting__twitter_posts_reporting:
            weight: 0
            compare_cols: []
          social_media_reporting__youtube_videos_reporting:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 54
        tables:
          social_media_reporting__ctr_by_platform:
            weight: 1
            compare_cols: [active_accounts_count, content_type, ctr, engagement_rate, month, platform, posts_count]
          social_media_reporting__daily_kpis:
            weight: 1
            compare_cols: [active_accounts_count, clicks, comments, ctr, day, engagement_rate, impressions, likes, platform, posts_count, shares]
          social_media_reporting__retention_kpis:
            weight: 1
            compare_cols: [cohort_pages, cohort_week, platform, retained_pages, retention_rate, target_week, week_offset]
          social_media_reporting__rollup_report:
            weight: 1
            compare_cols: [clicks, comments, engagement_rate, impressions, likes, low_exposure_flag, page_id, page_name, platform, post_id, post_message, post_url, shares]
  dacomp-de-evol-043:
    database_file: tiktok_ads.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_tiktok_ads__ad_group_history:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertiser_id, age_groups, audience_type, budget, budget_mode, campaign_id, creative_material_mode, frequency, frequency_schedule, gender, interest_category, is_most_recent_record, landing_page_url, languages, secondary_optimization_event, updated_at]
          stg_tiktok_ads__ad_group_report_hourly:
            weight: 1
            compare_cols: [ad_group_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_tiktok_ads__ad_history:
            weight: 1
            compare_cols: [ad_group_id, ad_id, ad_name, advertiser_id, base_url, call_to_action, campaign_id, click_tracking_url, impression_tracking_url, is_most_recent_record, landing_page_url, updated_at, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
          stg_tiktok_ads__ad_report_hourly:
            weight: 1
            compare_cols: [ad_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_tiktok_ads__advertiser:
            weight: 1
            compare_cols: [address, advertiser_id, advertiser_name, balance, cellphone_number, company, contacter, country, currency, description, email, industry, language, telephone_number, timezone]
          stg_tiktok_ads__campaign_country_report:
            weight: 1
            compare_cols: [campaign_id, clicks, conversion, conversion_rate, cost_per_conversion, country_code, cpc, cpm, ctr, impressions, real_time_conversion, spend, stat_time_day]
          stg_tiktok_ads__campaign_history:
            weight: 1
            compare_cols: [advertiser_id, budget, budget_mode, campaign_id, campaign_name, campaign_type, is_most_recent_record, is_new_structure, objective_type, split_test_variable, status, updated_at]
          stg_tiktok_ads__campaign_report_hourly:
            weight: 1
            compare_cols: [average_video_play, average_video_play_per_user, campaign_id, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 49
        tables:
          int_tiktok_ads__ad_group_history_latest:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_group_report_hourly:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_group_report_hourly_localized:
            weight: 4
            compare_cols: [ad_group_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, date_local_day, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, timezone_resolved, total_purchase_value, total_sales_lead_value, video_play_actions,]
          int_tiktok_ads__ad_history_latest:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_report_hourly:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_report_hourly_localized:
            weight: 4
            compare_cols: [ad_id, average_video_play, average_video_play_per_user, clicks, comments, impressions, likes, profile_visits, reach, real_time_conversion]
          int_tiktok_ads__advertiser:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_country_report:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_history_latest:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_report_hourly:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_report_hourly_localized:
            weight: 4
            compare_cols: [average_video_play, average_video_play_per_user, campaign_id, clicks, comments, conversion, conversion_rate, cost_per_conversion, timezone_resolved, total_purchase_value, total_sales_lead_value, video_play_actions]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 50
        tables:
          tiktok_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertiser_id, advertiser_name, audience_type, budget, campaign_id, campaign_name, clicks, comments, conversion, currency, engagement_score, follows, gender, impressions, interest_category, likes, profile_visits, reach, real_time_conversion]
          tiktok_ads__ad_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, ad_id, ad_name, advertiser_id, advertiser_name, audience_type, budget, campaign_id, campaign_name, clicks, comments, conversion, currency, engagement_score, follows, gender, impressions]
          tiktok_ads__advertiser_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, clicks, comments, conversion, currency, engagement_score, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, total_purchase_value, total_sales_lead_value]
          tiktok_ads__campaign_country_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, budget, budget_mode, campaign_id, campaign_name, campaign_type, clicks, conversion, country_code, currency, daily_cpc, daily_cpm, daily_ctr, date_day, impressions, objective_type, real_time_conversion, spend, split_test_variable, status]
          tiktok_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, campaign_id, campaign_name, clicks, comments, conversion, currency, engagement_score, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, total_purchase_value, total_sales_lead_value]
          tiktok_ads__url_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, ad_id, ad_name, advertiser_id, advertiser_name, audience_type, base_url, budget, campaign_id, campaign_name, clicks, comments, conversion, currency, engagement_score, follows, gender, impressions, interest_category, likes, profile_visits, reach, real_time_conversion, shares, spend, total_purchase_value, total_sales_lead_value, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
  dacomp-de-evol-044:
    database_file: tiktok_ads.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_tiktok_ads__ad_group_history:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertiser_id, age_groups, audience_type, budget, budget_mode, campaign_id, creative_material_mode, frequency, frequency_schedule, gender, interest_category, is_most_recent_record, landing_page_url, languages, secondary_optimization_event, updated_at]
          stg_tiktok_ads__ad_group_report_hourly:
            weight: 1
            compare_cols: [ad_group_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_tiktok_ads__ad_history:
            weight: 1
            compare_cols: [ad_group_id, ad_id, ad_name, advertiser_id, base_url, call_to_action, campaign_id, click_tracking_url, impression_tracking_url, is_most_recent_record, landing_page_url, updated_at, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
          stg_tiktok_ads__ad_report_hourly:
            weight: 1
            compare_cols: [ad_id, average_video_play, average_video_play_per_user, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
          stg_tiktok_ads__advertiser:
            weight: 1
            compare_cols: [address, advertiser_id, advertiser_name, balance, cellphone_number, company, contacter, country, currency, description, email, industry, language, telephone_number, timezone]
          stg_tiktok_ads__campaign_country_report:
            weight: 1
            compare_cols: [campaign_id, clicks, conversion, conversion_rate, cost_per_conversion, country_code, cpc, cpm, ctr, impressions, real_time_conversion, spend, stat_time_day]
          stg_tiktok_ads__campaign_history:
            weight: 1
            compare_cols: [advertiser_id, budget, budget_mode, campaign_id, campaign_name, campaign_type, is_most_recent_record, is_new_structure, objective_type, split_test_variable, status, updated_at]
          stg_tiktok_ads__campaign_report_hourly:
            weight: 1
            compare_cols: [average_video_play, average_video_play_per_user, campaign_id, clicks, comments, conversion, conversion_rate, cost_per_conversion, cpc, cpm, ctr, follows, impressions, likes, profile_visits, reach, real_time_conversion, shares, spend, stat_time_hour, total_purchase_value, total_sales_lead_value, video_play_actions, video_views_p_25, video_views_p_50, video_views_p_75, video_watched_2_s, video_watched_6_s]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 50
        tables:
          int_tiktok_ads__ad_group_budget_daily_local:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_group_history_latest:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_group_report_hourly:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_group_report_hourly_local:
            weight: 4
            compare_cols: [ad_group_id, clicks, date_day_local, impressions, is_local_day_mapped, spend, stat_time_hour, timezone_effective_start_date, timezone_name_effective]
          int_tiktok_ads__ad_history_latest:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_report_hourly:
            weight: 0
            compare_cols: []
          int_tiktok_ads__ad_report_hourly_local:
            weight: 4
            compare_cols: [ad_id, clicks, date_day_local, impressions, spend, stat_time_hour]
          int_tiktok_ads__advertiser:
            weight: 0
            compare_cols: []
          int_tiktok_ads__advertiser_timezone_history:
            weight: 4
            compare_cols: [advertiser_id]
          int_tiktok_ads__campaign_budget_daily_local:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_country_report:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_history_latest:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_report_hourly:
            weight: 0
            compare_cols: []
          int_tiktok_ads__campaign_report_hourly_local:
            weight: 4
            compare_cols: [campaign_id, clicks, date_day_local, impressions, spend, stat_time_hour]
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 49
        tables:
          tiktok_ads__ad_group_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, advertiser_id, advertiser_name, budget_effective_day]
          tiktok_ads__ad_report:
            weight: 1
            compare_cols: [ad_id, ad_name, advertiser_id, advertiser_name, clicks, currency, daily_cpc, daily_cpm, daily_ctr, date_day, impressions, spend]
          tiktok_ads__advertiser_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, clicks, currency, daily_cpc, daily_cpm, daily_ctr, date_day, impressions, spend]
          tiktok_ads__campaign_country_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, budget, budget_mode, campaign_id, campaign_name, campaign_type, clicks, conversion, country_code, real_time_conversion, spend, split_test_variable, status]
          tiktok_ads__campaign_report:
            weight: 1
            compare_cols: [advertiser_id, advertiser_name, budget_effective_day, budget_utilization, campaign_id, campaign_name, clicks, currency, daily_cpc, daily_cpm, daily_ctr, date_day, impressions, spend]
          tiktok_ads__url_report:
            weight: 1
            compare_cols: [ad_group_id, ad_group_name, ad_id, ad_name, advertiser_id, advertiser_name, base_url, campaign_id, campaign_name, clicks, utm_source, utm_term]
  dacomp-de-evol-045:
    database_file: twilio.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_twilio__account_history:
            weight: 1
            compare_cols: [account_id, friendly_name, owner_account_id, status, type, updated_at]
          stg_twilio__address:
            weight: 1
            compare_cols: [account_id, address_sid, city, country_code, customer_name, emergency_enabled, postal_code, region, street, street_secondary, updated_at, validated, verified]
          stg_twilio__call:
            weight: 1
            compare_cols: [account_id, annotation, answered_by, call_duration_s, call_ended_at, call_id, call_started_at, caller_name, contact_phone_number, direction, forwarded_from, group_id, has_talked, parent_call_id, price_in_usd, price_unit, raw_price, start_date, status, updated_at, user_phone_number]
          stg_twilio__incoming_phone_number:
            weight: 1
            compare_cols: [account_id, address_requirements, beta, capability_mms, capability_sms, capability_voice, emergency_status, friendly_name, incoming_phone_number_id, phone_number, updated_at, voice_caller_id_lookup, voice_url]
          stg_twilio__message:
            weight: 1
            compare_cols: [account_id, body, direction, error_code, error_message, message_from, message_id, message_to, messaging_service_id, num_media, num_segments, price, price_unit, status, timestamp_sent, updated_at]
          stg_twilio__messaging_service:
            weight: 1
            compare_cols: [account_id, friendly_name, inbound_method, inbound_request_url, messaging_service_id, messaging_service_name, status_callback, status_callback_method, updated_at, us_app_to_person_registered, use_case, use_inbound_webhook_on_number]
          stg_twilio__outgoing_caller_id:
            weight: 1
            compare_cols: [created_at, friendly_name, outgoing_caller_id_id, phone_number, updated_at]
          stg_twilio__usage_record:
            weight: 1
            compare_cols: [account_id, category, count, count_unit, price, price_unit, usage, usage_unit]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 49
        tables:
          int_twilio__account_latest:
            weight: 0
            compare_cols: []
          int_twilio__account_metrics:
            weight: 0
            compare_cols: []
          int_twilio__first_response_pairs:
            weight: 2
            compare_cols: [account_id, conversation_key, first_outbound_ts, inbound_ts, is_production, phone_number, response_seconds, sla_15m_met]
          int_twilio__messages:
            weight: 2
            compare_cols: [account_id, body, body_no_spaces, direction, is_production, message_id, messaging_service_id, num_characters, num_media]
          int_twilio__messaging_service:
            weight: 0
            compare_cols: []
          int_twilio__usage_record_daily:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 50
        tables:
          twilio__account_overview:
            weight: 2
            compare_cols: [account_id, account_name, account_status, account_type, median_first_response_seconds, price_unit, prod_delivered_messages, prod_delivery_rate, prod_failed_messages, prod_message_spend_usd, prod_total_messages, prod_total_spend_usd, sla_respond_within_15m_rate, total_accepted_messages, total_canceled_messages, total_delivered_messages, total_failed_messages, total_inbound_messages, total_messages, total_messages_spend, total_outbound_messages, total_queued_messages, total_read_messages, total_received_messages, total_receiving_messages, total_scheduled_messages, total_sending_messages, total_sent_messages, total_undelivered_messages]
          twilio__message_enhanced:
            weight: 0
            compare_cols: []
          twilio__number_overview:
            weight: 1
            compare_cols: [phone_number, total_inbound_messages, total_messages, total_outbound_messages]
          twilio__response_time_daily:
            weight: 1
            compare_cols: [account_id, median_first_response_seconds, p90_first_response_seconds, sample_size]
  dacomp-de-evol-046:
    database_file: twitter.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 15
        tables:
          stg_twitter_ads__account_history:
            weight: 0
            compare_cols: []
          stg_twitter_ads__account_timezone_effective:
            weight: 4
            compare_cols: [account_id, account_timezone_name]
          stg_twitter_ads__campaign_history:
            weight: 0
            compare_cols: []
          stg_twitter_ads__campaign_locations_report:
            weight: 0
            compare_cols: []
          stg_twitter_ads__campaign_regions_report:
            weight: 0
            compare_cols: []
          stg_twitter_ads__campaign_report:
            weight: 0
            compare_cols: []
          stg_twitter_ads__line_item_history:
            weight: 0
            compare_cols: []
          stg_twitter_ads__line_item_keywords_report:
            weight: 0
            compare_cols: []
          stg_twitter_ads__line_item_report:
            weight: 0
            compare_cols: []
          stg_twitter_ads__promoted_tweet_history:
            weight: 0
            compare_cols: []
          stg_twitter_ads__promoted_tweet_report:
            weight: 0
            compare_cols: []
          stg_twitter_ads__tweet:
            weight: 0
            compare_cols: []
          stg_twitter_ads__tweet_url:
            weight: 0
            compare_cols: []
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 25
        tables:
          int_twitter_ads__accounts:
            weight: 0
            compare_cols: []
          int_twitter_ads__campaign_locations_report_base:
            weight: 2
            compare_cols: [account_id, campaign_id, clicks, country, date_day_local, impressions, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__campaign_regions_report_base:
            weight: 2
            compare_cols: [account_id, campaign_id, clicks, country, date_day_local, impressions, placement, region, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__campaign_report_base:
            weight: 2
            compare_cols: [account_id, campaign_id, clicks, date_day_local, impressions, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__campaigns:
            weight: 0
            compare_cols: []
          int_twitter_ads__keyword_report_base:
            weight: 2
            compare_cols: [account_id, clicks, date_day_local, impressions, keyword, keyword_id, line_item_id, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__line_item_report_base:
            weight: 2
            compare_cols: [account_id, clicks, date_day_local, impressions, line_item_id, placement, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__line_items:
            weight: 0
            compare_cols: []
          int_twitter_ads__promoted_tweet_report_base:
            weight: 2
            compare_cols: [account_id, clicks, date_day_local, impressions, placement, promoted_tweet_id, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          int_twitter_ads__promoted_tweets:
            weight: 0
            compare_cols: []
          int_twitter_ads__tweet_url_first:
            weight: 0
            compare_cols: []
          int_twitter_ads__tweets:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 60
        tables:
          twitter_ads__account_report:
            weight: 1
            compare_cols: [account_id, account_name, approval_status, business_id, business_name, clicks, cpa, cpc, cpm, created_timestamp, ctr, date_day, impressions, industry_type, is_deleted, placement, roas, spend, spend_micro]
          twitter_ads__campaign_country_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_created_timestamp, campaign_currency, campaign_daily_budget_amount, campaign_end_timestamp, campaign_frequency_cap, campaign_funding_instrument_id]
          twitter_ads__campaign_region_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_created_timestamp, campaign_currency, campaign_daily_budget_amount, campaign_end_timestamp, campaign_frequency_cap, campaign_funding_instrument_id, is_campaign_servable, is_campaign_standard_delivery, placement, region, roas, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          twitter_ads__campaign_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_id, campaign_name, campaign_status, clicks, cpa, cpc, cpm, created_timestamp, ctr, currency, daily_budget_amount, date_day, spend_micro, start_timestamp, url_clicks]
          twitter_ads__keyword_report:
            weight: 1
            compare_cols: [account_id, account_name, campaign_id, line_item_id, line_item_name, placement, roas, spend, spend_micro, total_conversions, total_conversions_sale_amount, url_clicks]
          twitter_ads__line_item_report:
            weight: 1
            compare_cols: [account_id, account_name, advertiser_domain, advertiser_user_id, bid_amount, bid_type, bid_unit, campaign_id, campaign_name, campaign_status, charge_by, clicks, cpa, cpc, cpm, created_timestamp, ctr, currency, date_day, product_type, roas, spend, spend_micro, start_timestamp, target_cpa, total_budget_amount, total_conversions, total_conversions_sale_amount, updated_timestamp, url_clicks]
          twitter_ads__promoted_tweet_report:
            weight: 1
            compare_cols: [account_id, account_name, approval_status, campaign_id, campaign_name, campaign_status, clicks, cpa, cpc, cpm, created_timestamp, ctr, currency, date_day, impressions, is_deleted, line_item_id, line_item_name, line_item_status, total_conversions_sale_amount, tweet_full_text, tweet_id, tweet_name, updated_timestamp, url_clicks]
          twitter_ads__url_report:
            weight: 1
            compare_cols: [account_id, account_name, base_url, campaign_id, campaign_name, clicks, cpa, cpc, cpm, ctr, currency, date_day, display_url, expanded_url, impressions, line_item_id, line_item_name, placement, promoted_tweet_id, roas, spend, spend_micro, total_conversions, total_conversions_sale_amount, tweet_full_text, tweet_id, tweet_name, url_clicks, url_host, url_path, utm_campaign, utm_content, utm_medium, utm_source, utm_term]
  dacomp-de-evol-047:
    database_file: xero.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_xero__account:
            weight: 1
            compare_cols: [account_class, account_code, account_id, account_name, account_type]
          stg_xero__bank_transaction:
            weight: 1
            compare_cols: [bank_transaction_id, contact_id]
          stg_xero__contact:
            weight: 1
            compare_cols: [contact_id, contact_name]
          stg_xero__credit_note:
            weight: 1
            compare_cols: [contact_id, credit_note_id]
          stg_xero__invoice:
            weight: 1
            compare_cols: [contact_id, invoice_date, invoice_id]
          stg_xero__invoice_line_item:
            weight: 1
            compare_cols: [account_code, description, discount_entered_as_percent, discount_rate, invoice_id, item_code, line_amount, line_item_id, quantity, tax_amount, tax_type, unit_amount]
          stg_xero__invoice_line_item_has_tracking_category:
            weight: 1
            compare_cols: [_fivetran_synced, invoice_id, line_item_id, tracking_category_id, tracking_option]
          stg_xero__journal:
            weight: 1
            compare_cols: [created_date_utc, journal_date, journal_id, journal_number, reference, source_id, source_type]
          stg_xero__journal_line:
            weight: 1
            compare_cols: [account_code, account_id, account_name, account_type, description, gross_amount, journal_id, journal_line_id, net_amount, tax_amount, tax_name, tax_type]
          stg_xero__journal_line_has_tracking_category:
            weight: 1
            compare_cols: [journal_id, journal_line_id, tracking_category_id, tracking_option]
          stg_xero__organization:
            weight: 1
            compare_cols: [financial_year_end_day, financial_year_end_month, organisation_id]
          stg_xero__tracking_category:
            weight: 1
            compare_cols: [status, tracking_category_id, tracking_category_name]
          stg_xero__tracking_category_has_option:
            weight: 1
            compare_cols: [_fivetran_synced, tracking_category_id, tracking_option_id]
          stg_xero__tracking_category_option:
            weight: 1
            compare_cols: [is_active, is_archived, status, tracking_option_id, tracking_option_name]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 54
        tables:
          int_xero__fiscal_calendar:
            weight: 4
            compare_cols: [fallback_applied, fiscal_month, fiscal_year, health_status]
          int_xero__general_ledger_fact:
            weight: 2
            compare_cols: [account_class, account_code, account_id, account_name, account_type, class, contact_id, contact_name, cost_center, created_date_utc, journal_date, journal_id, journal_line_id, journal_number, location, net_amount, project, reference, region, source_id, source_type, tax_amount, tax_name, tax_type]
          int_xero__invoice_line_item_pivoted_tracking_categories:
            weight: 0
            compare_cols: []
          int_xero__invoice_line_items_enriched:
            weight: 0
            compare_cols: []
          int_xero__journal_line_pivoted_tracking_categories:
            weight: 0
            compare_cols: []
          int_xero__tracking_categories_with_options:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 45
        tables:
          xero__balance_sheet_report:
            weight: 2
            compare_cols: [account_code, account_name]
          xero__general_ledger:
            weight: 0
            compare_cols: []
          xero__invoice_line_items:
            weight: 0
            compare_cols: []
          xero__profit_and_loss_report:
            weight: 2
            compare_cols: [account_code, account_name, fiscal_month, fiscal_year, net_amount, ttm_insufficient_periods, ttm_net_amount, ytd_net_amount]
  dacomp-de-evol-048:
    database_file: youtube_analytics.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_youtube__channel_basic:
            weight: 1
            compare_cols: [annotation_click_through_rate, annotation_clickable_impressions, annotation_clicks, annotation_closable_impressions, annotation_close_rate, annotation_closes, annotation_impressions, average_time_in_playlist, average_time_in_video, average_view_duration_percentage, average_view_duration_seconds, card_click_rate, card_clickable_impressions, card_clicks, card_impressions, channel_id, channel_title, dislikes, estimated_minutes_watched, views_percentage]
          stg_youtube__channel_demographics:
            weight: 1
            compare_cols: [age_group, channel_id, country_code, gender, video_id, views_percentage]
          stg_youtube__video:
            weight: 1
            compare_cols: [channel_id, channel_title, id, snippet_published_at, video_caption, video_category_id, video_default_audio_language, video_default_language, video_definition, video_description, video_dimension, video_duration, video_embeddable, video_failure_reason, video_has_custom_thumbnail, video_id, video_license, video_licensed_content, video_live_broadcast_content, video_privacy_status, video_projection, video_public_stats_viewable, video_publish_at, video_region_restriction_allowed, video_region_restriction_blocked, video_rejection_reason, video_statistics_like_count, video_statistics_view_count, video_tags, video_thumbnails, video_title, video_upload_status]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 54
        tables:
          int_youtube__age_pivot:
            weight: 2
            compare_cols: [age_unknown_view_percentage, video_id]
          int_youtube__channel_basic:
            weight: 0
            compare_cols: []
          int_youtube__channel_demographics:
            weight: 0
            compare_cols: []
          int_youtube__demographics_completeness:
            weight: 4
            compare_cols: [country_code, demographics_completeness_rate, video_id]
          int_youtube__gender_pivot:
            weight: 2
            compare_cols: [country_code, female_view_percentage, gender_other_view_percentage, male_view_percentage, video_id]
          int_youtube__video:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 45
        tables:
          youtube__age_demographics_pivot:
            weight: 2
            compare_cols: [age_unknown_view_percentage, demographics_completeness_rate, video_id, video_published_date, video_title]
          youtube__demographics_report:
            weight: 2
            compare_cols: [demographics_completeness_rate, video_id, video_published_date, video_title]
          youtube__gender_demographics_pivot:
            weight: 2
            compare_cols: [female_view_percentage, gender_other_view_percentage, male_view_percentage, video_id, video_published_date, video_title]
          youtube__video_metadata:
            weight: 0
            compare_cols: []
          youtube__video_report:
            weight: 0
            compare_cols: []
  dacomp-de-evol-049:
    database_file: zendesk.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_zendesk__brand:
            weight: 1
            compare_cols: [active, brand_id, has_help_center, name, subdomain, url]
          stg_zendesk__daylight_time:
            weight: 1
            compare_cols: [daylight_end_utc, daylight_offset, daylight_start_utc, time_zone, year]
          stg_zendesk__domain_name:
            weight: 1
            compare_cols: [domain_name, organization_id]
          stg_zendesk__group:
            weight: 1
            compare_cols: [group_id, name]
          stg_zendesk__organization:
            weight: 1
            compare_cols: [details, external_id, name, organization_id]
          stg_zendesk__organization_tag:
            weight: 1
            compare_cols: [organization_id, tag]
          stg_zendesk__schedule:
            weight: 1
            compare_cols: [end_time, end_time_utc, name, schedule_id, start_time, start_time_utc, time_zone]
          stg_zendesk__schedule_holiday:
            weight: 1
            compare_cols: [end_date, name, schedule_holiday_id, schedule_id, start_date]
          stg_zendesk__ticket:
            weight: 1
            compare_cols: [assignee_id, brand_id, created_channel, description, due_at, external_id, group_id, is_public, organization_id, priority, problem_id, recipient, requester_id, source_from_id, source_from_title, source_rel, source_to_address, source_to_name, status, subject]
          stg_zendesk__ticket_chat:
            weight: 1
            compare_cols: [authenticated, backend, channel, chat_id, conversation_id, initiator, integration_id, tags, ticket_id, user_id, visitor_id, webpath]
          stg_zendesk__ticket_chat_event:
            weight: 1
            compare_cols: [actor_id, chat_id, chat_index, external_message_id, parent_message_id, reason, size, status]
          stg_zendesk__ticket_comment:
            weight: 1
            compare_cols: [body, is_facebook_comment, ticket_id, user_id]
          stg_zendesk__ticket_field_history:
            weight: 1
            compare_cols: [field_name, ticket_id, updated, user_id, value]
          stg_zendesk__ticket_form_history:
            weight: 1
            compare_cols: [active, display_name, end_user_visible, name, ticket_form_id]
          stg_zendesk__ticket_schedule:
            weight: 1
            compare_cols: [created_at, schedule_id, ticket_id]
          stg_zendesk__ticket_tag:
            weight: 1
            compare_cols: [tags, ticket_id]
          stg_zendesk__time_zone:
            weight: 1
            compare_cols: [standard_offset, time_zone]
          stg_zendesk__user:
            weight: 1
            compare_cols: [created_at, email, external_id, is_active, is_suspended, last_login_at, locale, name, organization_id, phone, role, ticket_restriction, time_zone, updated_at, user_id]
          stg_zendesk__user_tag:
            weight: 1
            compare_cols: [tag, user_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 55
        tables:
          int_zendesk__assignee_updates:
            weight: 0
            compare_cols: []
          int_zendesk__business_calendar:
            weight: 4
            compare_cols: [schedule_id]
          int_zendesk__channel_brand_metrics:
            weight: 4
            compare_cols: [brand_resolution_minutes, last_channel, primary_channel, ticket_id]
          int_zendesk__latest_ticket_form:
            weight: 0
            compare_cols: []
          int_zendesk__organization_aggregates:
            weight: 0
            compare_cols: []
          int_zendesk__requester_updates:
            weight: 0
            compare_cols: []
          int_zendesk__ticket_aggregates:
            weight: 0
            compare_cols: []
          int_zendesk__ticket_business_time:
            weight: 4
            compare_cols: [business_age_days, business_resolution_minutes, business_response_minutes, ticket_id]
          int_zendesk__ticket_comment_stats:
            weight: 0
            compare_cols: []
          int_zendesk__ticket_historical_satisfaction:
            weight: 0
            compare_cols: []
          int_zendesk__ticket_metrics:
            weight: 2
            compare_cols: [ticket_id]
          int_zendesk__ticket_status_transitions:
            weight: 0
            compare_cols: []
          int_zendesk__updates:
            weight: 0
            compare_cols: []
          int_zendesk__user_aggregates:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 44
        tables:
          zendesk__channel_brand_summary:
            weight: 4
            compare_cols: [primary_channel]
          zendesk__ticket_enriched:
            weight: 1
            compare_cols: [assignee_email, assignee_is_internal, assignee_name, assignee_tags, brand_id, created_channel, description, group_id, organization_name, organization_tags, priority, requester_email]
          zendesk__ticket_metrics:
            weight: 1
            compare_cols: [ticket_id]
          zendesk__ticket_summary:
            weight: 1
            compare_cols: [distinct_assignees, distinct_requesters, priority, status, ticket_count]
  dacomp-de-evol-050:
    database_file: zuora.duckdb
    expected_schemas:
      - intermediate
      - main
      - main
      - main
      - marts
      - pg_catalog
      - raw
      - staging
    layers:
      staging:
        description: Normalized raw data layer - cleans and normalizes raw data from source systems
        weight: 1
        tables:
          stg_zuora__account:
            weight: 1
            compare_cols: [account_id, account_number, auto_pay, balance, batch, bill_cycle_day, bill_to_contact_id, created_by_id, credit_balance, crm_id, currency, default_payment_method_id, is_most_recent_record, last_invoice_date, mrr, name, notes, parent_account_id, payment_term, sold_to_contact_id, status, total_debit_memo_balance, total_invoice_balance, updated_by_id, updated_date, vatid]
          stg_zuora__amendment:
            weight: 1
            compare_cols: [amendment_id, auto_renew, booking_date, code, contract_effective_date, created_by_id, current_term, current_term_period_type, customer_acceptance_date, description, effective_date, is_most_recent_record, name, new_rate_plan_id, removed_rate_plan_id, renewal_setting, renewal_term, renewal_term_period_type]
          stg_zuora__contact:
            weight: 1
            compare_cols: [account_id, address_1, address_2, city, contact_id, country, created_by_id, description, first_name, is_most_recent_account_contact, is_most_recent_record, last_name, mobile_phone, postal_code, state, updated_by_id, updated_date, work_email, work_phone]
          stg_zuora__credit_balance_adjustment:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amount, amount_home_currency, bill_to_contact_id, cancelled_on, comment, created_by_id, credit_balance_adjustment_id, default_payment_method_id, exchange_rate, exchange_rate_date, home_currency, invoice_id, is_most_recent_record, journal_entry_id, number, parent_account_id, reason_code, reference_id, sold_to_contact_id, source_transaction_id, source_transaction_number, source_transaction_type, status, transaction_currency, transferred_to_accounting]
          stg_zuora__invoice:
            weight: 1
            compare_cols: [account_id, adjustment_amount, amount, amount_home_currency, amount_without_tax, amount_without_tax_home_currency, auto_pay, balance, bill_to_contact_id, comments, created_by_id, credit_memo_amount, default_payment_method_id, due_date, home_currency, includes_one_time, includes_recurring, includes_usage, invoice_date, invoice_id, invoice_number, is_most_recent_record, last_email_sent_date, parent_account_id, payment_amount, payment_term, posted_by, posted_date, refund_amount, sold_to_contact_id, source]
          stg_zuora__invoice_item:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amendment_id, applied_to_invoice_item_id, balance, bill_to_contact_id, charge_amount, charge_amount_home_currency, charge_name, created_by_id, deferred_revenue_accounting_code_id, home_currency, invoice_id, invoice_item_id, is_most_recent_record, journal_entry_id, parent_account_id, processing_type, product_id, product_rate_plan_charge_id, product_rate_plan_id, quantity, rate_plan_charge_id, rate_plan_id, recognized_revenue_accounting_code_id]
          stg_zuora__invoice_payment:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_period_id, amount, amount_currency_rounding, amount_home_currency, bill_to_contact_id, cash_accounting_code_id, created_by_id, default_payment_method_id, exchange_rate, exchange_rate_date, home_currency, invoice_id, invoice_payment_id, is_most_recent_record, journal_entry_id, journal_run_id, parent_account_id, payment_id, payment_method_id, provider_exchange_rate_date, refund_amount, sold_to_contact_id, transaction_currency, updated_by_id, updated_date]
          stg_zuora__order:
            weight: 1
            compare_cols: [account_id, bill_to_contact_id, category, created_by_id, default_payment_method_id, description, error_code, error_message, is_most_recent_record, order_date, order_id, order_number, response, scheduled_date, sold_to_contact_id, state, status, updated_by_id, updated_date]
          stg_zuora__payment:
            weight: 1
            compare_cols: [account_id, accounting_code, amount, amount_home_currency, applied_amount, applied_credit_balance_amount, bill_to_contact_id, cancelled_on, comment, created_by_id, currency, effective_date, exchange_rate, exchange_rate_date, home_currency, is_most_recent_record, parent_account_id, payment_id, payment_method_id, payment_number, refund_amount, settled_on, sold_to_contact_id]
          stg_zuora__payment_method:
            weight: 1
            compare_cols: [account_id, ach_account_type, active, bank_transfer_account_type, created_by_id, credit_card_type, is_most_recent_record, last_failed_sale_transaction_date, last_transaction_date_time, last_transaction_status, max_consecutive_payment_failures, num_consecutive_failures, payment_method_id, payment_method_name, payment_method_status, payment_method_type, paypal_type, sub_type]
          stg_zuora__product:
            weight: 1
            compare_cols: [category, created_by_id, description, effective_end_date, is_most_recent_record, name, product_id, sku, updated_by_id, updated_date]
          stg_zuora__product_rate_plan:
            weight: 1
            compare_cols: [created_by_id, description, effective_end_date, is_most_recent_record, name, product_id, product_rate_plan_id, updated_by_id, updated_date]
          stg_zuora__rate_plan:
            weight: 1
            compare_cols: [account_id, amendment_id, bill_to_contact_id, created_by_id, default_payment_method_id, is_most_recent_record, name, original_rate_plan_id, product_id, product_rate_plan_id, rate_plan_id, sold_to_contact_id, subscription_id, updated_by_id, updated_date]
          stg_zuora__rate_plan_charge:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amended_by_order_on, amendment_id, apply_discount_to, bill_cycle_day, bill_cycle_type, bill_to_contact_id, bill_to_contact_snapshot_id, billing_period, billing_timing, booking_exchange_rate, booking_exchange_rate_date, charge_model, charge_number, charge_type, charged_through_date, created_by_id, credit_option, default_payment_method_id, deferred_revenue_accounting_code_id, description, discount_level, dmrc, dmrchome_currency, dtcv, dtcvhome_currency, effective_end_date, effective_start_date, end_date_condition, exchange_rate, exchange_rate_date, home_currency, is_most_recent_record, is_prepaid, is_processed, mrr, mrrhome_currency, name, number_of_periods, original_id, original_order_date, price_change_option, price_increase_percentage, processed_through_date, product_id, product_rate_plan_charge_id, product_rate_plan_id, quantity, rate_plan_charge_id, rate_plan_id, recognized_revenue_accounting_code_id, segment, sold_to_contact_id, specific_billing_period, specific_end_date, specific_list_price_base, subscription_id, tcv, tcvhome_currency, transaction_currency, trigger_date, trigger_event, uom, up_to_periods, up_to_periods_type, updated_by_id, updated_date, version, weekly_bill_cycle_day]
          stg_zuora__refund:
            weight: 1
            compare_cols: [accounting_code, amount, cancelled_on, comment, created_by_id, is_most_recent_record, method_type, payment_method_id, refund_date, refund_id, refund_number, refund_transaction_time, source_type, status, submitted_on, transferred_to_accounting, type, updated_by_id, updated_date]
          stg_zuora__refund_invoice_payment:
            weight: 1
            compare_cols: [created_by_id, is_most_recent_record, refund_amount, refund_invoice_payment_id, updated_by_id, updated_date]
          stg_zuora__subscription:
            weight: 1
            compare_cols: [account_id, auto_renew, bill_to_contact_id, cancel_reason, cancelled_date, contract_acceptance_date, contract_effective_date, created_by_id, current_term, current_term_period_type, default_payment_method_id, externally_managed_by, initial_term, initial_term_period_type, invoice_owner_id, is_invoice_separate, is_latest_version, is_most_recent_record, last_booking_date, notes]
          stg_zuora__taxation_item:
            weight: 1
            compare_cols: [account_id, account_receivable_accounting_code_id, accounting_code, amendment_id, balance, bill_to_contact_id, created_by_id, credit_amount, exchange_rate, exchange_rate_date, exempt_amount, exempt_amount_home_currency, home_currency, invoice_id, invoice_item_id, is_most_recent_record, journal_entry_id, name, payment_amount, product_id, product_rate_plan_charge_id]
      intermediate:
        description: Middle layer - business logic and data aggregation processing
        weight: 44
        tables:
          int_zuora__account_current:
            weight: 0
            compare_cols: []
          int_zuora__account_enriched:
            weight: 0
            compare_cols: []
          int_zuora__account_partitions:
            weight: 0
            compare_cols: []
          int_zuora__account_rolling_totals:
            weight: 0
            compare_cols: []
          int_zuora__account_running_totals:
            weight: 0
            compare_cols: []
          int_zuora__amendment_current:
            weight: 0
            compare_cols: []
          int_zuora__billing_enriched:
            weight: 2
            compare_cols: [credit_balance_adjustment_amount_home_currency, credit_balance_adjustments, discount_charges, discount_charges_home_currency, invoice_amount_paid_home_currency, invoice_id, invoice_items]
          int_zuora__contact_current:
            weight: 0
            compare_cols: []
          int_zuora__invoice_aging_base:
            weight: 4
            compare_cols: [account_id, credit_balance_applied_home_currency, invoice_amount_home_currency, invoice_days_past_due_snapshot, invoice_id, invoice_net_past_due_home_currency, invoice_unpaid_home_currency, refund_applied_home_currency]
          int_zuora__invoice_base:
            weight: 0
            compare_cols: []
          int_zuora__invoice_item_base:
            weight: 0
            compare_cols: []
          int_zuora__invoice_payment_current:
            weight: 0
            compare_cols: []
          int_zuora__mrr_date_spine:
            weight: 0
            compare_cols: []
          int_zuora__payment_current:
            weight: 0
            compare_cols: []
          int_zuora__payment_method_current:
            weight: 0
            compare_cols: []
          int_zuora__product_current:
            weight: 0
            compare_cols: []
          int_zuora__product_rate_plan_current:
            weight: 0
            compare_cols: []
          int_zuora__rate_plan_charge_current:
            weight: 0
            compare_cols: []
          int_zuora__rate_plan_current:
            weight: 0
            compare_cols: []
          int_zuora__subscription_current:
            weight: 0
            compare_cols: []
          int_zuora__transaction_date_spine:
            weight: 0
            compare_cols: []
          int_zuora__transactions_grouped:
            weight: 0
            compare_cols: []
      marts:
        description: Data mart layer - analytics-ready business view
        weight: 55
        tables:
          zuora__account_aging_snapshot:
            weight: 4
            compare_cols: [account_days_past_due_snapshot, account_id, account_net_past_due_home_currency, aging_bucket, snapshot_day, snapshot_month]
          zuora__account_aging_trajectory:
            weight: 4
            compare_cols: [account_days_past_due_snapshot, account_id, account_net_past_due_home_currency, aging_bucket, bucket_entered, net_past_due_delta]
          zuora__account_daily_overview:
            weight: 1
            compare_cols: [account_country, account_created_at, account_email, account_first_name, account_id, account_last_name, account_name, account_number, account_postal_code, account_state, account_status, daily_invoice_amount, daily_invoice_amount_paid, daily_invoice_amount_unpaid, daily_invoice_items, daily_invoices, daily_refunds]
          zuora__account_overview:
            weight: 1
            compare_cols: [account_city, account_country, account_created_at, account_credit_balance, account_email, account_first_name, account_id, account_last_name, account_name, account_number]
          zuora__billing_history:
            weight: 0
            compare_cols: []
          zuora__line_item_enhanced:
            weight: 0
            compare_cols: []
          zuora__line_item_history:
            weight: 0
            compare_cols: []
          zuora__monthly_recurring_revenue:
            weight: 0
            compare_cols: []
          zuora__subscription_overview:
            weight: 0
            compare_cols: []
scoring:
  threshold_check:
    run_py_execution: 100
    schema_validation: 100
  core_accuracy:
    full_match: 100
  partial_evaluation:
    layer_weights:
      staging: 15
      intermediate: 25
      marts: 60
