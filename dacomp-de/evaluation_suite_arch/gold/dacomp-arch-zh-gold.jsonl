{"id": "dacomp-de-arch-001-zh", "question": "为什么我们某些岗位的每次成功招聘成本高达$50,000，而有些只要$5,000？我听说这跟我们的'候选人质量预测'和'招聘渠道ROI优化'有关系，但现在我们完全是黑盒操作。我需要一个能够实时计算真实招聘成本的系统，不仅要考虑时间成本、面试官工资、候选人体验影响等隐性成本，还要能预测出哪些候选人值得我们花大价钱去争取，哪些渠道应该砍掉预算。董事会下个月要看到具体的数据和优化建议。", "rubric": "# 招聘成本与候选人价值优化 评估标准（严格复杂版）\n\n## [总分 | 34 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（27 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（27 分）\n\n### 标准 1.1（最高 24 分）：功能点覆盖\n- 路径 1.1.A（24 分）：**完整覆盖**\n  - 小标准 1.1.A.1：【1 分】候选人体验透明度度量｜判定：存在 `transparency_score`（数值 0–100；not_null；tests 存在）。  \n  - 小标准 1.1.A.2：【1 分】面试体验质量｜判定：存在 `interview_experience_score`（数值 0–100；类型 DOUBLE；tests 存在）。  \n  - 小标准 1.1.A.3：【1 分】面试负担类别｜判定：存在 `interview_burden_category`（枚举 {Low,Medium,High}；tests 约束枚举）。  \n  - 小标准 1.1.A.4：【1 分】面试一致性评分｜判定：存在 `interview_consistency_score`（数值 0–1；跨表一致）。  \n  - 小标准 1.1.A.5：【1 分】结果公平性评分｜判定：存在 `outcome_fairness_score`（范围 0–100）。  \n  - 小标准 1.1.A.6：【1 分】时间线体验评分｜判定：存在 `timeline_experience_score`（范围 0–100）。  \n  - 小标准 1.1.A.7：【1 分】候选人总体体验分｜判定：存在 `overall_candidate_experience_score`（必须为聚合列，等于前述体验指标的加权或组合）。  \n  - 小标准 1.1.A.8：【1 分】体验等级｜判定：存在 `experience_grade`（枚举 A–E 或 High/Medium/Low）。  \n  - 小标准 1.1.A.9：【1 分】面试完成率%｜判定：存在 `interview_completion_rate_pct`（范围 0–100；tests BETWEEN）。  \n  - 小标准 1.1.A.10：【1 分】平均面试时长｜判定：存在 `avg_interview_duration_minutes`（≥0；单位分钟；tests non_negative）。  \n  - 小标准 1.1.A.11：【1 分】申请到上次联系/晋级天数｜判定：存在 `days_from_application_to_last_contact`、`days_since_last_advancement`（≥0；单位天）。  \n  - 小标准 1.1.A.12：【1 分】总面试次数｜判定：存在 `total_interviews`（≥0 整数）。  \n  - 小标准 1.1.A.13：【1 分】候选人质量分布与分位数｜判定：存在 `overall_avg_quality_score`、`median_quality_score`、`p75_quality_score`；且数值范围固定 0–5 或 0–100（tests 必须一致）。  \n  - 小标准 1.1.A.14：【1 分】最佳渠道/部门/级别｜判定：存在 `best_source_type`、`best_department`、`best_job_level`；值域有枚举/层级定义。  \n  - 小标准 1.1.A.15：【1 分】漏斗转化率链路｜判定：存在 `application_to_screening_rate`→`offer_to_hired_rate`；中间环节齐全且顺序正确。  \n  - 小标准 1.1.A.16：【1 分】漏斗平均时长｜判定：存在 `avg_days_to_screening`、`avg_days_screening_to_technical`、`avg_total_days_to_hire`；均 ≥0。  \n  - 小标准 1.1.A.17：【1 分】漏斗瓶颈标识/效率等级｜判定：存在 `primary_bottleneck`（枚举阶段名）、`hiring_efficiency_grade`（等级枚举）。  \n  - 小标准 1.1.A.18：【1 分】岗位表现与参与度指标｜判定：`posting_analytics` 至少含 `total_applications`、`unique_candidates`、`total_interview_time_minutes`；缺一项即 0 分。  \n  - 小标准 1.1.A.19：【1 分】岗位转化率族｜判定：存在 `application_to_interview_rate`、`application_to_offer_rate`、`application_to_hire_rate`、`offer_to_hire_rate`；定义口径一致。  \n  - 小标准 1.1.A.20：【1 分】岗位首个申请时长｜判定：存在 `days_to_first_application`（≥0；单位天）。  \n  - 小标准 1.1.A.21：【1 分】部门层级维度集｜判定：存在 `department`/`team`/`location`/`level`/`commitment_type`，且均为非空可 join。  \n  - 小标准 1.1.A.22：【1 分】部门成本效率分层｜判定：存在 `cost_efficiency_tier`（枚举 High/Medium/Low）；tests 枚举。  \n  - 小标准 1.1.A.23：【1 分】经理绩效看板关键比率｜判定：存在 `avg_posting_conversion_rate`、`candidate_hire_rate`、`overall_performance_score`、`performance_tier`；tests 范围非负。  \n  - 小标准 1.1.A.24：【1 分】阶段历史与时间界限｜判定：存在 `valid_from`、`valid_ending_at`；需保证时间不交叉、范围合理。  \n\n- 路径 1.1.B（3 分）：**基础覆盖**\n  - 小标准 1.1.B.1：【1 分】实体覆盖｜判定：`Opportunity`/`Posting`/`Interview`/`Department`/`HiringManager` 至少三类有主键与核心列。  \n  - 小标准 1.1.B.2：【1 分】时间维度覆盖｜判定：`report_date`/`generated_at`/`valid_from`/`valid_ending_at` 至少两列存在。  \n  - 小标准 1.1.B.3：【1 分】聚合/统计覆盖｜判定：至少 3 项百分比或平均数（如 conversion_rate、avg_days、rate_pct）；否则 0 分。  \n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：**口径清晰**\n  - 小标准 1.2.A.1：【1 分】输出项需含“主体+时间”｜示例：`lever__hiring_dashboard` 的 `report_date` + 最近 30 天计数。  \n  - 小标准 1.2.A.2：【1 分】异常/缺失处理｜判定：tests 约束至少两处（如 not_null、unique、非负、时间不可未来）。  \n  - 小标准 1.2.A.3：【1 分】跨输出项口径一致｜判定：`int_lever__hiring_funnel_metrics` 与 `posting_analytics` 漏斗转化率均为百分比（同一分母/链路）；否则 0 分。  \n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：**模型最小四要素**\n  - 小标准 2.1.A.1：【1 分】模型标识/依赖/粒度｜判定：模型 `name`、`source_models`、`grain` 三要素必须存在。  \n  - 小标准 2.1.A.2：【1 分】字段定义+类型｜判定：`columns` 下所有列必须含 `name`+`data_type`，缺失即 0 分。  \n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：**可构建依赖图**\n  - 小标准 2.2.A.1：【1 分】无循环/自引用｜判定：mart 仅依赖 intermediate/staging；发现环路 → 0 分。  \n  - 小标准 2.2.A.2：【1 分】外部来源边界清晰｜判定：stg 层来源实体（opportunity/posting/interview）必须在 intermediate 的 `source_models` 明确引用；否则 0 分。  \n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准 3.1.1：【1 分】命名规则｜判定：统一使用 snake_case；分层前缀 `stg_`/`int_`/`lever__`；双下划线分隔系统与主题；否则 0 分。  \n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准 3.2.1：【1 分】分层职责清晰｜判定：intermediate 聚合业务口径，marts 仅输出分析口径；否则 0 分。  \n- 小标准 3.2.2：【1 分】避免“上帝表”｜判定：岗位、候选人、经理、部门分别拆分模型；单表不混杂多个主题；否则 0 分。  \n\n## 评分须知\n- 每个小标准严格 **1/0** 计分。  \n- **无证据（字段/SQL/契约/tests）即 0 分**。  \n- ALLOW_MULTI_MODEL=YES：允许多模型分工，但每分项必须能在某一模型中定位证据；跨模型推断不计分。  \n"}
{"id": "dacomp-de-arch-002-zh", "question": "我们现在面临一个很现实的问题。董事会下个月要审核我们的产品投资策略，他们想知道我们这100多个应用程序到底哪些在赚钱，哪些在亏钱。更关键的是，我们需要基于用户行为数据和收入贡献来重新定义我们的应用程序投资组合策略。现在销售说某些enterprise客户威胁要降级到pro套餐，产品说用户粘性数据看起来不错，但财务说ROI计算出来有问题。我需要一个能把用户行为、应用程序成本、客户收入潜力这三个维度整合起来的分析，告诉我们每个应用程序的真实商业价值，以及我们应该在哪些应用上加大投入，哪些应该考虑停止开发或者合并。这个分析要能支撑我们向董事会证明，我们的产品决策是有数据驱动的，而不是拍脑袋决定的。", "rubric": "# 应用组合真实商业价值评估 评估标准（严格复杂版）\n\n## [总分 | 35 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（28 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（28 分）\n\n### 标准 1.1（最高 20 分）：功能点覆盖\n- 路径 1.1.A（20 分）：**完整覆盖**\n  - 小标准（每项 1 分，满足即得，证据须在 `docs/gold.yaml` 或模型定义中明确出现；无法定位则记 0 分）：\n    1. 子公司/客户实体标识【1 分｜判定条件】存在 `account_id` 与 `visitor_id`，并能与 `app_id/feature_id/page_id` 建立外键或 join 映射。\n    2. 财务期（日级）对齐【1 分｜判定条件】存在 `date_day` 或 `occurred_on`，可作为日粒度主键；引用示例：`int_pendo__calendar_spine.date_day`。\n    3. 用户活跃与粘性指标【1 分｜判定条件】字段必须包含 `count_active_visitors`、`count_active_days`、`sessions_per_user`、`avg_session_duration`，且全部 ≥0。\n    4. 漏斗转化指标【1 分｜判定条件】存在 `page_to_feature_conversion_rate`、`feature_to_deep_conversion_rate`、`overall_conversion_rate`，值域在 0–1 或 0–100。\n    5. 留存指标【1 分｜判定条件】存在 `retention_7d`、`retention_30d`、`retention_90d`，三者必须成组出现。\n    6. NPS 与满意度指标【1 分｜判定条件】存在 `net_promoter_score` 与至少两个相关分项（`promoter_rate`、`detractor_rate`、`total_nps_responses`、`latest_nps_rating`）。\n    7. 功能采用与深度使用指标【1 分｜判定条件】存在 `feature_adoption_rate`、`feature_depth_adoption_rate`，且辅以 `avg_features_per_user` 或 `sum_clicks`。\n    8. 页面使用与黏性指标【1 分｜判定条件】存在 `sum_pageviews`、`avg_visitor_pageviews`、`percent_of_daily_pageviews`。\n    9. 账号层日度聚合【1 分｜判定条件】存在 `pendo__account_daily_metrics` 或 `int_pendo__account_daily_metrics`（grain: account_id + date_day）。\n    10. 用户生命周期分段与流失风险【1 分｜判定条件】存在 `lifecycle_stage`、`engagement_trend`、`churn_risk_level`。\n    11. RFM 与价值分层【1 分｜判定条件】存在 `recency_score`、`frequency_score`、`magnitude_score`，并有 `rfm_segment` 或 `customer_value_tier`。\n    12. 客户重要性/影响力【1 分｜判定条件】存在 `customer_importance_level` 或 `account_influence_level`，枚举字段必须有定义。\n    13. 高价值/高风险账户聚合【1 分｜判定条件】存在 `high_risk_accounts`、`medium_risk_accounts`、`low_risk_accounts` 或 `excellent_revenue_accounts` 等聚合输出。\n    14. 投资建议/纠偏动作【1 分｜判定条件】存在 `optimization_recommendation`、`recommended_strategy`、`recommended_next_action` 或 `investment_expectation`。\n    15. 应用/功能/页面互映【1 分｜判定条件】存在 `app_id`、`feature_id`、`page_id`，且在 marts 层可 join。\n    16. 贡献占比/份额【1 分｜判定条件】存在 `percent_of_daily_feature_clicks`、`percent_of_daily_visitors`、`percent_of_daily_accounts`，范围必须在 0–1 或百分比。\n    17. 行为强度与深度参与指标【1 分｜判定条件】存在 `power_user_rate`、`highly_active_user_rate`、`deep_engagement_session_rate`。\n    18. 趋势/波动性指标【1 分｜判定条件】存在 `conversion_rate_trend`、`user_activity_volatility` 或 `engagement_velocity`。\n    19. 指标计算时间【1 分｜判定条件】存在 `calculated_at` 或 `generated_at`，格式为 timestamp。\n    20. 首末事件时间【1 分｜判定条件】存在 `first_event_on/first_event_at` 与 `last_event_on/last_event_at`，时间逻辑需符合先后顺序。\n\n### 标准 1.2（最高 8 分）：指标/特征口径\n- 路径 1.2.A（8 分）：**口径清晰**\n  - 小标准 1.2.A.1：【1 分】每个输出项至少包含两类要素：主体（account_id/visitor_id/app_id 等）、时间（date_day/occurred_on）、统计口径（count/sum/rate）；缺少任一类记 0 分。\n  - 小标准 1.2.A.2：【1 分】缺失/异常/重复/未来时间处理规则明确；如 `latest_*` 字段取最近值、not_null/unique/非负 tests 存在。\n  - 小标准 1.2.A.3：【1 分】跨模型指标命名/单位一致：如 `sum_minutes` vs `num_minutes` 不得混用。\n  - 小标准 1.2.A.4：【1 分】分段枚举一致：如 `lifecycle_stage`（New/Active/Churned）、`value_tier`、`risk_level` 定义一致。\n  - 小标准 1.2.A.5：【1 分】转化率/占比字段范围统一（0–1 或 0–100），tests 存在范围约束。\n  - 小标准 1.2.A.6：【1 分】留存期指标必须统一为 7/30/90 天一组，不得出现不一致命名。\n  - 小标准 1.2.A.7：【1 分】趋势/波动指标需有定义字段（如增长率公式、波动率说明），并在 YAML 中明确。\n  - 小标准 1.2.A.8：【1 分】“计算时间”与“发生时间”分离：必须同时存在 `calculated_at/generated_at` 与 `occurred_on/date_day`。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：**模型最小四要素**\n  - 小标准 2.1.A.1：【1 分】模型定义含 `name` 与 `source_models`，缺一项即 0 分。\n  - 小标准 2.1.A.2：【1 分】字段定义完整：`columns` 中每个列必须声明 `name:type`。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：**可构建依赖图**\n  - 小标准 2.2.A.1：【1 分】无循环/自引用；若存在环路即 0 分。\n  - 小标准 2.2.A.2：【1 分】外部来源边界清晰：所有来源必须标注为 `stg_pendo__*`；直接跳过 staging 的引用记 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准 3.1.1：【1 分】模型与字段命名语义化；必须直指业务含义（如 `feature_daily_metrics` 表示“功能 × 日”），避免歧义。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准 3.2.1：【1 分】分层职责清晰：`staging` 负责原始入仓，`intermediate` 聚合业务逻辑，`marts` 负责暴露分析指标。\n- 小标准 3.2.2：【1 分】避免“上帝表”：主题表应内聚（如 daily_metrics、latest_history、info、analytics 各自独立），单表不得混杂多主题。\n\n## 评分须知\n- 每个小标准按 1/0 计分；找不到明确证据即 0 分。  \n- ALLOW_MULTI_MODEL=YES：允许由多个模型协同覆盖，但必须能定位到对应字段/约束，不可凭逻辑推断计分。  \n"}
{"id": "dacomp-de-arch-003-zh", "question": "我们发现最近几个月有不少高价值客户在付费转化后的30-90天内就停止了所有系统活动，看起来像是流失了。但奇怪的是，这些客户在Marketo里显示参与度很高，Stripe显示他们还在正常付费，可Zendesk里却几乎没有任何支持请求记录。我需要你帮我建立一个完整的\"沉默客户风险预警系统\"，能够识别这种表面正常但实际可能存在问题的客户，并且能够通过跨系统的行为模式变化来预测他们可能的流失风险。", "rubric": "# 沉默客户风险预警系统（Customer360）评估标准（严格编号版）\n\n## [总分 | 34 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（27 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n> 评分总则  \n> - 证据优先：字段/YAML/SQL/tests/数据字典中**可定位证据**方可得分；任何“推测/口头说明/截图无字段名”一律 0 分。  \n> - 类型与范围：若要求的**类型/范围/枚举**缺失或与说明不一致，记 0 分。  \n> - 时间口径：时间戳必须为 timestamp；天粒度为 date；窗口含义需文档化。  \n> - **互斥说明**：1.1.A 与 1.1.B **互斥**（二选一计分）。1.1 总分上限 24 分。\n\n\n## 需求 I：业务对齐与语义准确性（27 分）\n\n### 标准 1.1（最高 24 分）：功能点覆盖\n- 路径 1.1.A（24 分）：**完整覆盖**（逐项 1 分）\n  - 1.1.A.1【1 分】身份解析三源主键：存在 `marketo_lead_id`、`stripe_customer_id`、`zendesk_user_id`（均非空可关联）；任一缺失 → 0 分。\n  - 1.1.A.2【1 分】三源时间字段：存在各源 `created_at`、`updated_at`（timestamp），且注明时区；任一缺失或类型不符 → 0 分。\n  - 1.1.A.3【1 分】三渠道参与度：存在 `marketo_engagement`、`stripe_engagement`、`zendesk_engagement`（数值 ≥0；口径说明可定位）。\n  - 1.1.A.4【1 分】复合参与度分：存在 `composite_engagement_score`（计算口径/权重可定位；范围约束 tests）。\n  - 1.1.A.5【1 分】渠道覆盖标记：存在 `in_marketo`、`in_stripe`、`in_zendesk`（布尔 {true,false}；枚举/类型一致）。\n  - 1.1.A.6【1 分】组织与联系方式质量：存在 `organization_data_quality`、`has_contact_phone`、`address_data_quality`（取值域文档化）。\n  - 1.1.A.7【1 分】跨阶段用时：存在 `marketing_to_sales_days`、`sales_to_support_days`（单位=天、≥0；计算路径可追溯）。\n  - 1.1.A.8【1 分】账户年龄/成熟度：存在 `account_age_days`（≥0）与 `customer_maturity`（枚举分层定义）。\n  - 1.1.A.9【1 分】旅程模式：存在 `customer_journey_pattern`（枚举或聚类标签；生成逻辑可定位）。\n  - 1.1.A.10【1 分】支付可靠性：存在 `payment_reliability`（分数/等级，值域文档化）。\n  - 1.1.A.11【1 分】分群与风险等级：存在 `customer_segment`、`churn_risk_level`（枚举集合固定；一致性 tests）。\n  - 1.1.A.12【1 分】推荐行动：存在 `recommended_action`（枚举/文案模板，来源逻辑可定位）。\n  - 1.1.A.13【1 分】生命周期指标-窗口：存在 `customer_last_activity`（timestamp）与 `active_30/60/90/180/365_days`（布尔/数值，窗口定义说明）。\n  - 1.1.A.14【1 分】距上次活动天数：存在 `days_since_last_activity`（≥0；与 last_activity 一致性 tests）。\n  - 1.1.A.15【1 分】平台一致性/健康分：存在 `platform_consistency_score`、`customer_health_score`（范围与算法说明可定位）。\n  - 1.1.A.16【1 分】价值与留存：存在 `estimated_customer_value`、`estimated_customer_ltv`（数值 ≥0），`retention_probability`、`churn_probability`（0–1），`revenue_at_risk`（≥0）。\n  - 1.1.A.17【1 分】风险构成与分类：存在 `risk_category`、`primary_risk_factor`、`risk_trend`、`total_risk_score`，覆盖 `activity_decline/platform_abandonment/lifecycle_transition/email_engagement` 至少两类。\n  - 1.1.A.18【1 分】支付状态与稳定性：存在 `is_delinquent`、`stripe_deleted`（布尔），`payment_behavior_risk`、`account_stability_risk`（等级/分数定义可定位）。\n  - 1.1.A.19【1 分】客服状态与时间：存在 `zendesk_active`、`zendesk_suspended`、`zendesk_deleted`（布尔）、`organization_id`（可关联），并具备状态时间戳。\n  - 1.1.A.20【1 分】干预建议与成功率：存在 `recommended_intervention`、`intervention_success_probability`（0–1）、`intervention_timeline`、`intervention_roi`（≥0；算法说明可定位）。\n  - 1.1.A.21【1 分】高价值风险/严重告警：存在 `critical_alert_flag`、`high_value_at_risk_flag`、`engagement_warning_flag`（布尔；规则文档可定位）。\n  - 1.1.A.22【1 分】统一主键与映射：存在 `customer360_id`、`customer360_organization_id`、`source_ids`（含三源 id 与各自时间戳；外键完整性 tests）。\n  - 1.1.A.23【1 分】客户主表信息：包含邮件、姓名、组织、地址、电话及营销/销售/客服摘要（字段齐全、类型规范）。\n  - 1.1.A.24【1 分】明细域表覆盖：地址/邮件/姓名/组织/电话/状态/概要/更新追踪等域表存在且有主键与更新戳（SCD/变更策略说明）。\n\n- 路径 1.1.B（3 分）：**基础覆盖（与 1.1.A 互斥，仅在未满足 A 时启用）**\n  - 1.1.B.1【1 分】实体覆盖：至少提供统一 id 映射与任一源系统 id（如 `customer360__mapping` 可用且可 join）。\n  - 1.1.B.2【1 分】时间覆盖：至少提供最近活动/窗口活跃/阶段用时之一（如 `days_since_last_activity` 或 `active_30/60/90` 或 `marketing_to_sales_days`）。\n  - 1.1.B.3【1 分】聚合/评分类：至少提供 `engagement/health/risk/LTV` 中任一聚合/分数（如 `composite_engagement_score`）。\n\n> 注：1.1 总分上限 24 分。若 1.1.A 评分 > 0，则不再计入 1.1.B 得分。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：**口径清晰**（逐项 1 分）\n  - 1.2.A.1【1 分】粒度+时间/口径：每个输出项**至少包含两类**要素（主体 id / 时间范围或对齐 / 统计或聚合规则）。示例：身份解析含主体与 `created_at/updated_at`；行为/生命周期含窗口或阶段。缺一类 → 0 分。\n  - 1.2.A.2【1 分】异常/缺失/重复/负值/未来时间处理：在文档或 tests 中明确**默认处理与忽略策略**（如删除/保留标志、邮箱质量过滤、时间不可未来、数值非负、主键去重规则）。任一缺失 → 0 分。\n  - 1.2.A.3【1 分】跨项一致性：相同概念（如 “最近活动/账户年龄/参与度分”）在不同输出/模型中的命名、单位、分母/分子与时间口径**保持一致**；不一致 → 0 分。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：**模型最小四要素**\n  - 2.1.A.1【1 分】字段定义：所有模型均提供 `columns`（字段名+数据类型+注释/含义）；缺列或缺类型 → 0 分。\n  - 2.1.A.2【1 分】测试约束：存在 tests（唯一性/非空/引用完整性/范围/枚举）；任一核心键无 tests → 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：**可构建依赖图**\n  - 2.2.A.1【1 分】无循环/自引用：依赖图可拓扑排序（raw/stg → int → marts）；发现环 → 0 分。\n  - 2.2.A.2【1 分】外部来源边界：raw/stg/int/marts 分层清晰，来源在文档/目录结构可定位；禁止跳层或跨层写入；不符合 → 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1【1 分】命名规则一致：`*_updated_at`、`*_created_at`、`*_engagement` 等后缀一致；snake_case；系统/主题前缀一致；不一致 → 0 分。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1【1 分】层次职责清晰：raw（原始）/stg（标准化）/int（业务加工）/marts（分析暴露）边界明确（路径或前缀可验证）。\n- 3.2.2【1 分】避免“上帝表”：地址/邮件/电话/状态/摘要按域表拆分；模块内聚、依赖单向清晰；混杂或跨域堆叠 → 0 分。\n\n## 评分须知\n- **1/0 计分**：每小项必须有可定位证据（字段、SQL、YAML、tests、数据字典）。  \n- **强约束**：类型/范围/枚举/时间口径/时区/粒度不一致 → 直接 0 分。  \n- **ALLOW_MULTI_MODEL=YES**：允许多模型协作覆盖，但每分项**必须**在至少一个模型/文档中找到明确证据，跨模型“合理推断”不计分。\n"}
{"id": "dacomp-de-arch-004-zh", "question": "能不能给每个销售代表建立一个'真实业绩画像'？我想知道他们不仅仅是卖了多少钱，更重要的是他们获得的客户质量怎么样？这些客户后续还会不会继续和我们做生意？销售过程中的一些细节行为（比如机会推进的节奏、客户沟通频率等）是否会影响客户的长期价值？", "rubric": "# 销售代表“真实业绩画像”评估标准\n\n## [总分 | 19 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（12 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（12 分）\n\n### 标准 1.1（最高 9 分）：功能点覆盖\n- 路径 1.1.A（9 分）：完整覆盖\n  - 小标准（子公司｜1 分）：存在账户层级或附属公司标识，能按子公司维度分析。判定条件：出现 grain 对应账户粒度，且包含与 parent_id 等价的层级列。\n  - 小标准（财务期｜1 分）：存在财务期字段（fiscal_quarter、fiscal_year）用于按期分析。判定条件：模型包含财务季度与财务年度列或同义字段。\n  - 小标准（现金流｜1 分）：存在用于现金流（现金流入/流出）分析的表或列。判定条件：出现现金流相关度量/列 → 缺失记 0 分。\n  - 小标准（AR 账龄｜1 分）：存在应收账款余额与账龄分层字段。判定条件：出现 AR aging 相关列→ 缺失记 0 分。\n  - 小标准（毛利｜1 分）：存在收入与成本（或产品成本）以支持毛利/毛利率分析。判定条件：出现收入与成本相关列 → 缺失记 0 分。\n  - 小标准（费用｜1 分）：存在各类费用（销售/管理/运营等）字段以支持费用分析。判定条件：出现费用相关列→ 缺失记 0 分。\n  - 小标准（供应商付款｜1 分）：存在供应商付款记录或应付相关字段。判定条件：出现供应商付款相关列→ 缺失记 0 分。\n  - 小标准（贡献占比｜1 分）：存在贡献度或占比（如按销售代表/客户/产品维度）字段。判定条件：出现贡献占比相关列→ 缺失记 0 分。\n  - 小标准（纠偏动作｜1 分）：存在数据质量纠偏动作配置（correct/delete_row/nullify_field）并在字段级给出规则。判定条件：出现质量动作与字段级规则键。\n\n- 路径 1.1.B（3 分）：基础覆盖（实体/时间/聚合）\n  - 小标准（实体覆盖｜1 分）：至少包含账户与联系人两类实体模型的列定义。判定条件：出现账户与联系人实体的模型与列。\n  - 小标准（时间覆盖｜1 分）：存在对齐到日期/快照的时间维度（如 snapshot_date 或 created_date）。判定条件：出现日期/快照维度列。\n  - 小标准（聚合覆盖｜1 分）：存在计数/求和/平均类输出口径（如转化率、数量、金额等）对应的列或可派生列。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 小标准（口径要素完整｜1 分）：每个输出项同时包含“按谁（如账户/联系人/机会/销售代表）+时间范围或对齐（如 snapshot_date/fiscal_year）+统计规则或度量类型”的至少两类要素。判定条件：模型/列描述显式体现主体与时间要素。\n  - 小标准（异常/缺失处理｜1 分）：对缺失/异常/重复/未来时间给默认处理或约束（参考 docs/data_contract.yaml 字段级 validation_rules，如未来日期删行/空值处理。判定条件：存在相应规则键并覆盖日期/布尔/文本等关键字段。\n  - 小标准（跨模型口径一致｜1 分）：同名或同义字段在不同模型口径一致。判定条件：相同概念不出现冲突描述。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 小标准（上游依赖 source_models｜1 分）：声明上游模型（如指向 staging 或 intermediate）。判定条件：每个业务模型提供上游引用键。\n  - 小标准（粒度定义 grain｜1 分）：存在 grain 键且语义明确（如“一行/账户/日”、“一行/联系人/日”、“一行/线索”。判定条件 : 所有模型均有 grain。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 小标准（无循环/自引用｜1 分）：依赖图无环。判定条件：模型间引用不形成循环或自引用。\n  - 小标准（外部来源边界｜1 分）：引用外部来源（如 raw.*）需明确边界说明与作用域。判定条件：外部来源均注明。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准（名称语义化｜1 分）：模型与列名称语义明确。判定条件：无黑话/歧义命名。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准（分层职责清晰｜1 分）：原始/staging/中间/intermediate/集市/marts 职责边界清晰。判定条件：层级职责描述到位。\n- 小标准（业务口径集中｜1 分）：业务规则集中在相应层。判定条件：不散落。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-005-zh", "question": "我们的广告账户现在有个大问题：同一个用户在不同设备上的行为我们完全没法串联起来。比如用户在手机上看到我们的广告，然后在电脑上搜索并转化，我们就认为手机广告没效果，电脑广告很牛。这样算下来，我们可能错杀了很多有效的广告位，也可能过度投资了一些'虚高'的渠道。\n现在CFO要求我们提供更精准的ROI数据，我需要一套跨设备用户行为串联分析系统。我想知道：一个用户从第一次看到广告到最终转化，中间跨了哪些设备？哪些广告真正起到了'种草'作用？哪些起到了'收割'作用？我们的预算应该怎么在这些不同作用的触点之间分配？\n关键是要能识别出同一个用户的跨设备行为轨迹，然后重新评估每个触点的真实价值。现在的报表看起来手机端ROI很低，但可能手机端承担的是awareness功能，真正的conversion在desktop完成。", "rubric": "# dacomp-de-arch-005-google_ads-001-1 评估标准\n\n## [总分 | 38 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（31 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（31 分）\n\n### 标准 1.1（最高 28 分）：功能点覆盖\n- 路径 1.1.A（28 分）：完整覆盖\n  - 【1 分｜判定条件】存在账户日粒度汇总模型，粒度为“每账户每日”。\n  - 【1 分｜判定条件】账户报表包含 date_day 且非空。\n  - 【1 分｜判定条件】账户维度字段齐全：account_id、account_name。\n  - 【1 分｜判定条件】账户货币/时区字段：currency_code（受限枚举）、time_zone\n  - 【1 分｜判定条件】账户级核心指标：spend、clicks、impressions\n  - 【1 分｜判定条件】账户级转化指标：conversions、conversions_value、view_through_conversions\n  - 【1 分｜判定条件】存在广告系列日粒度模型，粒度“每活动每日”\n  - 【1 分｜判定条件】活动维度字段：campaign_id、campaign_name、status\n  - 【1 分｜判定条件】活动渠道字段：advertising_channel_type/subtype\n  - 【1 分｜判定条件】活动级指标：spend、clicks、impressions、conversions、conversions_value、view_through_conversions\n  - 【1 分｜判定条件】存在广告组日粒度模型，含 ad_group_id/name/type/status\n  - 【1 分｜判定条件】广告组级指标齐全：spend、clicks、impressions、conversions、conversions_value、view_through_conversions\n  - 【1 分｜判定条件】存在广告日粒度模型，含 ad_id、ad_name、ad_type、status、display_url\n  - 【1 分｜判定条件】广告级指标齐全：spend、clicks、impressions、conversions、conversions_value、view_through_conversions\n  - 【1 分｜判定条件】存在关键词日粒度模型，含 criterion_id（keyword_id）、keyword_match_type（受限枚举）、keyword_text\n  - 【1 分｜判定条件】关键词级指标齐全：spend、clicks、impressions、conversions、conversions_value、view_through_conversions\n  - 【1 分｜判定条件】存在搜索词日粒度模型，含 search_term、search_term_match_type（受限枚举）并关联 criterion_id\n  - 【1 分｜判定条件】搜索词级指标齐全：spend、clicks、impressions、conversions、conversions_value、view_through_conversions\n  - 【1 分｜判定条件】存在 URL 日粒度模型，含 base_url、url_host、url_path 及 UTM 五参\n  - 【1 分｜判定条件】URL 级指标齐全：spend、clicks、impressions、conversions、conversions_value、view_through_conversions\n  - 【1 分｜判定条件】存在渠道-设备分析模型，含 advertising_channel_type/subtype、ad_network_type、device 三维\n  - 【1 分｜判定条件】渠道-设备级核心指标齐全：total_spend/clicks/impressions/conversions/conversions_value\n  - 【1 分｜判定条件】贡献占比（Share）指标齐全：spend_share_pct、clicks_share_pct、conversions_share_pct\n  - 【1 分｜判定条件】渠道/设备基准与对比：channel_benchmark_ctr/roas、device_benchmark_ctr/cpa 及 vs_% 指标\n  - 【1 分｜判定条件】渠道组合健康与层级：active_campaigns、lifecycle 分类计数、top/bottom/underperforming 及对应占比\n  - 【1 分｜判定条件】投资层级与策略输出：channel_investment_tier、channel_efficiency_score、strategic_recommendation、各类告警旗标\n  - 【1 分｜判定条件】客户获客分析：acquisition_cohort、days_since_first_conversion、account/customer_maturity_stage\n  - 【1 分｜判定条件】获客效率与回收：customer_acquisition_cost、average_customer_ltv、ltv_cac_ratio、estimated_payback_days\n  - 【1 分｜判定条件】获客累计与对标：cumulative_acquisition_cost/conversions/ltv、cohort_avg_cac/ltv、vs_%、百分位与分层\n  - 【1 分｜判定条件】获客策略与告警：strategic_customer_segment、acquisition_recommendation、negative_roi_alert、high_cac_alert、scale_opportunity、retention_risk\n  - 【1 分｜判定条件】高层看板时间对齐：包含 week-over-week 与 month-over-month 变化\n  - 【1 分｜判定条件】高层看板结构健康：premium 投资与占比、活动/关键词计数、平均效率分、总体表现分/层级及多类告警\n\n- 路径 1.1.B（3 分）：基础覆盖（若未满足 1.1.A，则按基础覆盖计分）\n  - 【1 分｜判定条件】实体维度至少覆盖两类以上（如账户/活动/关键词/渠道/设备任两类）。\n  - 【1 分｜判定条件】时间维度具备日粒度且有至少一种环比/同比类指标（WoW/MoM 任一）。\n  - 【1 分｜判定条件】聚合口径至少覆盖一类核心指标组（曝光/点击/花费/转化 任一组且含≥2 指标）。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 【1 分｜判定条件】每个输出项至少包含“按谁（实体维度）+时间范围（日粒度）”或“对齐规则+统计口径”的两类要素\n  - 【1 分｜判定条件】对缺失/异常/负值提供默认处理或约束（如 not_null、>=0、枚举 tests 存在；示例：currency_code 枚举\n  - 【1 分｜判定条件】跨输出项口径一致（如 device/advertising_channel_type/status 等枚举在各模型中保持一致约束\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 【1 分｜判定条件】每个模型均有模型标识 name,每个模型显式粒度 grain\n  - 【1 分｜判定条件】每个模型给出字段定义+类型（columns 内含 name 与 data_type，贯穿全部模型）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 【1 分｜判定条件】无循环/自引用（模型 DAG 不出现环）。\n  - 【1 分｜判定条件】外部来源边界清晰（stg_* 视为外部清洗输出或上游阶段，引用时需有明确来源名称且不混用别名）。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 【1 分｜判定条件】缩写/命名规则一致（如使用 advertising_channel_type、view_through_conversions 一致风格）。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 【1 分｜判定条件】业务口径集中（如 cohort、maturity_stage、efficiency/score 等口径集中在相应主题模型，不散落）。\n- 【1 分｜判定条件】避免“上帝表”，模块内聚，依赖清晰（主题模型围绕实体/问题聚合，不将不相干口径堆入单表）。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-006-zh", "question": "我们的CFO昨天紧急找到我，说审计发现我们的广告预算执行存在严重问题。董事会批准的年度1200万美元广告预算，现在8月份就已经花了980万，但收入目标只完成了65%。更糟糕的是，我们发现同一个客户在不同平台重复转化被多次计算，导致ROAS数据严重失真。CFO要求立即建立一套\"预算燃烧率预警系统\"，能够实时监控每个平台的预算使用效率，预测月底和年底的预算超支风险，还要能识别出哪些营销活动在\"烧钱但不赚钱\"。她说如果下周一看不到具体的预算控制方案，就要考虑暂停部分广告投放。", "rubric": "# 广告预算燃烧率预警系统 评估标准\n\n## [总分 | 26 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（19 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n> **评分原则**\n> - **证据优先**：仅当字段在模型定义（YAML/SQL/数据字典/tests）中存在且可定位时计分；口头推断不计。\n> - **强约束**：数值字段需声明非负/范围，枚举字段需列出合法值，时间字段需有类型定义。\n> - **grain 明确**：所有涉及时间/实体的输出必须声明粒度（如 “per account_id per day”）。\n> - **找不到证据 → 0 分**。\n\n\n## 需求 I：业务对齐与语义准确性（19 分）\n\n### 标准 1.1（最高 16 分）：功能点覆盖\n- 路径 1.1.A（16 分）：完整覆盖（每条 1 分）\n\n  - 【1 分｜平台维度】存在 `platform` 字段，非空字符串枚举，值域如 {\"google_ads\",\"facebook_ads\",…}；tests 中需有枚举校验。\n  - 【1 分｜账户维度】存在 `account_id` 字段，类型为字符串/整型，非空唯一，可与平台 join。\n  - 【1 分｜活动维度】存在 `campaign_id` 字段，非空唯一，整型/字符串，跨报表一致。\n  - 【1 分｜广告组维度】存在 `ad_group_id` 字段，类型一致，至少在 ad_group/keyword/search/url 报表中出现。\n  - 【1 分｜日粒度时间】存在 `report_date` 或 `date_day` 字段，类型为 DATE，grain 必须明确为 “per entity per day”。\n  - 【1 分｜月粒度时间】存在 `report_month` 或 `performance_month` 字段，类型为 DATE 或字符串 YYYY-MM，grain 文档化为 “per entity per month”。\n  - 【1 分｜地理维度】存在 `region` 或 `country_code`；`country_code` 必须为 ISO 两位码（tests：长度=2，全大写）。\n  - 【1 分｜预算目标】存在 `daily_budget` 字段，数值 ≥0，货币单位固定（如 USD）；tests 校验非负。\n  - 【1 分｜支出指标】存在 `spend` 或 `cost`，数值 ≥0；tests 非负。\n  - 【1 分｜收入/转化价值】存在 `conversions_value`，数值 ≥0，货币单位一致。\n  - 【1 分｜转化数】存在 `conversions`，整数 ≥0。\n  - 【1 分｜ROAS】存在 `roas` 或 `return_on_ad_spend`；范围 ≥0；公式（收入/支出）可追溯。\n  - 【1 分｜核心效率指标组】存在 `ctr_percent`（0–100%）、`cpc`（≥0）、`cpm`（≥0）、`cpa`（≥0）；单位/范围在文档中固定。\n  - 【1 分｜燃烧趋势预测】存在 `spend_30d_trend_forecast`；说明口径为过去 30 天趋势预测；数值 ≥0。\n  - 【1 分｜风险/预警字段】存在 `forecast_risk_level`（枚举 High/Medium/Low）、`requires_investigation`（布尔）、`forecast_confidence`（0–1）、`anomaly_probability_next_month`（0–1）；tests 校验范围。\n  - 【1 分｜效率分层】存在 `investment_efficiency_grade` 或 `cost_efficiency_tier`；枚举值明确（如 A/B/C 或 High/Medium/Low）；映射逻辑可追溯。\n\n- 路径 1.1.B（3 分）：基础覆盖  \n  - 【1 分｜实体维度】至少有 platform/account_id/campaign_id 任两列；且字段类型与 join 规则明确。\n  - 【1 分｜时间维度】至少有日/月其中之一；字段类型 DATE/STRING 且有粒度声明。\n  - 【1 分｜聚合指标】至少有 spend/cost 与 conversions/conversions_value 任一；字段类型数值且 tests 非负。\n\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰（每条 1 分）\n\n  - 【1 分｜输出项两类要素】每输出项需包含：实体维度（如 account_id/campaign_id）+ 时间范围（date_day/report_month）+ 聚合规则（如 sum/spend）；grain 必须在文档显式声明。\n  - 【1 分｜异常与缺失处理】文档/tests 中必须有至少两项约束：非负（spend ≥0）、比率范围（roas ≥0、ctr_percent 0–100）、唯一性（account_id+date_day）、未来时间过滤。\n  - 【1 分｜跨模型一致性】同名指标口径一致，如 `roas` 定义=conversions_value/spend，不能在部分模型中用 gross_value/spend；`ctr_percent` 在各模型均为百分比（0–100%）。\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）\n  - 【1 分｜模型标识】每模型必须定义唯一 `name`，`source_models` 指向合法上游；缺失即 0 分。\n  - 【1 分｜字段与类型】所有字段在 `columns` 中定义并声明 `data_type`（STRING/INT/DOUBLE/DATE/BOOLEAN）；若缺类型则 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）\n  - 【1 分｜无循环/自引用】依赖图可拓扑排序，若出现自我依赖或循环引用 → 0 分。\n  - 【1 分｜外部来源边界】所有外部来源必须有明确前缀（raw_/stg_/int_/marts_），无未定义外部依赖。\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 【1 分｜缩写规则一致】如 CTR/CPC/CPM/CPA 缩写统一、大小写规范，且不混用同义（如 roas/return_on_ad_spend 必须有统一命名规范）。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 【1 分｜业务口径集中】中间层/集市层聚合业务逻辑；核心指标不可散落在 staging 层。\n- 【1 分｜避免上帝表】单表职责单一，模型划分清晰；若发现某表跨主题（如支出+用户画像+预测全混），记 0 分。\n\n\n## 评分须知\n- 每个小标准严格 **1/0 计分**，找不到证据或字段 → 0 分。\n- **ALLOW_MULTI_MODEL=YES**：多个模型联合满足亦可，但必须在至少一个模型中找到明确字段与口径证据。\n"}
{"id": "dacomp-de-arch-007-zh", "question": "我们最近发现用户留存率在不同地区和设备类型之间存在巨大差异，而且这些差异模式在两个应用商店平台之间完全不一致。比如我们的游戏应用在日本iOS设备上表现很好，但Android设备上用户几乎不回归。更糟糕的是，我们无法精确追踪用户在跨平台使用时的真实价值贡献。现在投资人要求我们在下季度董事会上提供一份综合的用户留存与价值创造关联分析报告，能够解释为什么我们在某些细分市场投入巨大但回报微薄，以及如何优化我们的获客投资组合。这个分析需要考虑用户的完整生命周期路径、地域文化差异、设备偏好，还要能够预测不同用户群体的未来价值潜力。", "rubric": "# App Reporting（用户留存与价值分析）评估标准（严格化版）\n\n## [总分 | 42 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（35 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n> 评分总则\n> - **证据优先**：仅当模型 YAML/SQL/数据字典/tests 中可定位到明确字段/约束时才能得分。推测或非正式描述不计分。\n> - **类型/范围强约束**：指标字段必须符合数值/百分比/布尔/枚举要求，否则记 0 分。\n> - **互斥说明**：1.1.A（完整覆盖）与 1.1.B（基础覆盖）二选一计分，不能叠加。\n> - **跨表一致性**：相同字段跨模型必须在定义/单位/范围/枚举上保持一致，否则记 0 分。\n\n## 需求 I：业务对齐与语义准确性（35 分）\n\n### 标准 1.1（最高 32 分）：功能点覆盖\n- 路径 1.1.A（32 分）：**完整覆盖**（逐项 1 分）\n  - 1.1.A.1 应用实体与平台维度【1 分】存在 `app_id`/`app_name`/包名字段 + `platform`，且平台枚举 = {google_play, apple_store}，grain 说明中明确含平台。\n  - 1.1.A.2 日期日粒度【1 分】存在 `date_day`（date 类型），所有事实表度量按日对齐。\n  - 1.1.A.3 生命周期分段【1 分】存在 `user_lifecycle_stage`，枚举完整 = {'New User','Growing User','Established User','Mature User','Veteran User'}。\n  - 1.1.A.4 活跃度等级【1 分】存在 `user_activity_level`，枚举完整 = {'Highly Active','Moderately Active','Low Active','Inactive'}。\n  - 1.1.A.5 留存状态分类【1 分】存在 `user_status`，枚举完整 = {'New User','Continuous User','Returning User','Reactivated User','Long Dormant'}。\n  - 1.1.A.6 价值分段【1 分】存在 `user_value_segment`，枚举完整 = {'High Value','Medium Value','Low Value','Potential Churn'}。\n  - 1.1.A.7 滚动活跃天数【1 分】存在 `active_days_l7`、`active_days_l30`（整数 ≥0），窗口口径 = 最近滚动 7/30 天。\n  - 1.1.A.8 首次安装日期【1 分】存在 `first_install_date`（date 类型，非空约束）。\n  - 1.1.A.9 用户年龄天【1 分】存在 `user_age_days`（整数 ≥0）。\n  - 1.1.A.10 生命周期留存率【1 分】存在 `user_retention_rate`（0–100%，tests 保证范围）。\n  - 1.1.A.11 风险标识与等级【1 分】存在 `is_at_risk`（布尔）与 `churn_risk_level`（High/Medium/Low）。\n  - 1.1.A.12 高价值占比【1 分】存在 `high_value_percentage`（0–100%，百分比约束）。\n  - 1.1.A.13 RFM 三要素【1 分】存在 `recency_days`、`frequency_count`、`monetary_value`（数值 ≥0）。\n  - 1.1.A.14 RFM 评分与段码【1 分】存在 `recency_score`、`frequency_score`、`monetary_score`、`rfm_score`、`rfm_segment_code`、`customer_segment`。\n  - 1.1.A.15 CLV 指标【1 分】存在 `estimated_clv`（货币型，非负）。\n  - 1.1.A.16 交易时间边界【1 分】存在 `first_transaction_date`、`last_transaction_date`（date 类型）、`customer_lifetime_days`（≥0）。\n  - 1.1.A.17 收入贡献占比【1 分】存在 `revenue_contribution_percentage`（0–100%）。\n  - 1.1.A.18 渠道来源与分类【1 分】存在 `traffic_source` 与 `channel_category`（统一枚举分类，跨表一致）。\n  - 1.1.A.19 转化率与访客/安装【1 分】存在 `conversion_rate_percentage`（0–100%）、`store_visitors`/`visitors`、`installers`/`acquisitions`。\n  - 1.1.A.20 市场份额贡献【1 分】存在 `market_share_percentage`（0–100%）。\n  - 1.1.A.21 渠道效率分【1 分】存在 `channel_efficiency_score`（0–100，整型或浮点型）。\n  - 1.1.A.22 ROI 相关【1 分】存在 `estimated_acquisition_cost`、`estimated_user_value`、`estimated_roi_percentage`（0–100%）、`roi_tier`（枚举）。\n  - 1.1.A.23 投资建议与动作【1 分】存在 `investment_recommendation`、`strategic_action`、`recommended_actions`。\n  - 1.1.A.24 地理维度【1 分】存在 `country`（ISO 两位或三位标准）。\n  - 1.1.A.25 设备维度【1 分】存在 `device`。\n  - 1.1.A.26 OS 版本维度【1 分】存在 `os_version`。\n  - 1.1.A.27 App 版本维度【1 分】存在 `app_version`。\n  - 1.1.A.28 健康评分与状态【1 分】存在 `health_score`（0–100）与 `health_status`（枚举分类）。\n  - 1.1.A.29 卸载率与趋势【1 分】存在 `uninstall_rate_percentage`、`uninstall_rate_7d_avg`（范围 0–100%）。\n  - 1.1.A.30 崩溃率与趋势【1 分】存在 `crash_rate_per_thousand`、`crash_rate_7d_avg`、`crash_rate_30d_avg`、`crash_rate_trend_7d`。\n  - 1.1.A.31 评分与趋势【1 分】存在 `daily_average_rating`、`rating_7d_avg`、`total_average_rating`、`rating_trend_7d`（范围 0–5）。\n  - 1.1.A.32 平台对齐/一致性与分层报告【1 分】平台枚举定义一致，且存在 overview/country/device/os_version/app_version/traffic_source/user_lifecycle/user_value_segmentation/app_health/channel_effectiveness 等分层事实表。\n\n- 路径 1.1.B（8 分）：**基础覆盖（互斥，若 1.1.A 已得分则不计）**\n  - 1.1.B.1 实体覆盖【1 分】至少有 app + 平台/渠道/地域/设备任意两类。\n  - 1.1.B.2 时间覆盖【1 分】至少有 `date_day` + 7d/30d 滚动指标。\n  - 1.1.B.3 聚合覆盖【1 分】至少有占比/排名/评分/效率分/ROI 任意二项。\n  - 1.1.B.4 留存覆盖【1 分】至少有生命周期分段或留存率。\n  - 1.1.B.5 价值覆盖【1 分】至少有 RFM 或 CLV。\n  - 1.1.B.6 健康覆盖【1 分】至少有 health_score 或崩溃/卸载率。\n  - 1.1.B.7 渠道覆盖【1 分】至少有 conversion/visitors/installers + 来源维度。\n  - 1.1.B.8 建议覆盖【1 分】至少有 investment_recommendation/strategic_action。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 1.2.A.1【1 分】输出项需包含“对象（谁）+时间范围/对齐+统计规则”中至少两类要素。\n- 1.2.A.2【1 分】异常处理：缺失/异常/负值/重复/未来时间均有约束或默认处理字段（如 not_null、范围 tests）。\n- 1.2.A.3【1 分】跨表一致：同名/同义指标在所有模型定义一致，不得出现“conversion_rate_percentage”与“conversion_rate_pct”并存且无说明。\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 2.1.A.1【1 分】grain 声明完整（例：“每应用/每平台/每天”）。\n- 2.1.A.2【1 分】columns 中含字段名+data_type+描述，类型合理（百分比类为 FLOAT/DECIMAL）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 2.2.A.1【1 分】无循环/自引用，DAG 可拓扑。\n- 2.2.A.2【1 分】外部来源边界清晰（如 stg_appstore__*，stg_playstore__* 作为输入）。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 【1 分】全局命名一致：snake_case，缩写规范，平台/维度/指标不混用多口径。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1【1 分】分层职责清晰：raw（采集）→ int（加工）→ marts（分析）。\n- 3.2.2【1 分】业务口径集中：复杂口径集中在 int 层/统一模型，避免零散分布。\n\n## 评分须知\n- 每小项 1/0 计分；**找不到证据 → 0 分**。  \n- **1.1.A 与 1.1.B 互斥**。  \n- **ALLOW_MULTI_MODEL=YES**：允许跨模型满足条件，但证据必须明确。  \n"}
{"id": "dacomp-de-arch-008-zh", "question": "我们每年在项目管理上投入了大量人力成本，但到底哪些投入是真正产生价值的，哪些是纯粹的浪费？她发现我们缺乏一个完整的\"项目投资回报分析体系\"。比如说，我们需要知道每个项目从启动到交付的真实成本构成（人力投入、时间成本、协作成本等），哪些项目类型的投资效率最高，不同团队和不同复杂度的项目的成本效益差异，以及最关键的——如何基于历史数据建立\"项目投资决策模型\"，在项目启动前就能预测其投资回报率和资源需求。她要求我们在下季度预算会议前，建立一套完整的项目财务分析体系，能够支持未来的项目投资决策和资源分配优化。", "rubric": "# 项目投资与资源决策分析（Asana）评估标准（严格化版）\n\n## [总分 | 38 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（31 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n> **评分原则**\n> - **证据优先**：仅当字段在模型定义（YAML/SQL/schema/tests）中可定位时计分。\n> - **强约束**：数值字段需声明非负/范围，枚举字段需列出合法值，时间字段需有类型与粒度定义。\n> - **grain 明确**：必须在模型文档中声明 “per project per day” 或类似。\n> - **找不到证据 → 0 分**。\n\n## 需求 I：业务对齐与语义准确性（31 分）\n\n### 标准 1.1（最高 28 分）：功能点覆盖\n- 路径 1.1.A（28 分）：完整覆盖（每项 1 分）\n  - 【1 分】项目级投资效率：字段 `roi_efficiency_ratio`，DOUBLE ≥0，tests 校验非负。\n  - 【1 分】项目任务规模：字段 `total_tasks`，INT ≥0。\n  - 【1 分】完成率：字段 `completion_percentage`，0–100%。\n  - 【1 分】逾期任务量：字段 `overdue_tasks`，INT ≥0。\n  - 【1 分】活跃任务量：字段 `active_tasks`，INT ≥0。\n  - 【1 分】唯一参与人数：字段 `unique_assignees`，INT ≥0。\n  - 【1 分】协作评分：字段 `collaboration_score`，0–100。\n  - 【1 分】效率评分：字段 `efficiency_score`，0–100。\n  - 【1 分】风险占比：字段 `risk_percentage`，0–100%。\n  - 【1 分】任务人均负载：字段 `avg_tasks_per_assignee`，DOUBLE ≥0。\n  - 【1 分】进度/效率/健康排名：字段 `progress_rank`、`efficiency_rank`、`health_rank`，INT ≥1，口径明确为排名。\n  - 【1 分】复杂度因子：字段 `complexity_factor`（DOUBLE ≥0）或 `project_complexity_level`（枚举 Low/Medium/High）。\n  - 【1 分】进度预测：字段 `schedule_forecast` 或 `project_forecast`，类型 JSON/STRING，必须有预测时间范围说明。\n  - 【1 分】管理优先级：字段 `management_priority`，枚举 High/Medium/Low。\n  - 【1 分】改进建议与关注域：字段 `improvement_opportunities`、`focus_areas`、`success_factors`，STRING/ARRAY。\n  - 【1 分】剩余/估算工期：字段 `estimated_days_to_completion` 或 `remaining_days`，INT ≥0。\n  - 【1 分】项目期限维度：字段 `project_deadline`，DATE，tests 检查大于当前时间。\n  - 【1 分】团队规模类别：字段 `team_size_category`，枚举 {Small, Medium, Large}。\n  - 【1 分】项目成熟阶段：字段 `project_maturity_phase`，枚举 {Initiation, Growth, Mature, Decline}。\n  - 【1 分】投资分析-总投入时长：字段 `total_investment_hours`，DOUBLE ≥0。\n  - 【1 分】投资分析-ROI：字段 `actual_roi_ratio`，DOUBLE ≥0。\n  - 【1 分】投资分析-产出效率：字段 `output_per_hour`，DOUBLE ≥0。\n  - 【1 分】投资分析-人均投入：字段 `investment_per_person`，DOUBLE ≥0。\n  - 【1 分】成本结构占比：字段 `direct_cost_percentage`、`collaboration_cost_percentage`、`management_cost_percentage`，各 0–100%，总和≤100。\n  - 【1 分】风险调整等级与预算建议：字段 `risk_adjusted_investment_grade`（枚举 A/B/C）或 `budget_recommendation`（STRING）。\n  - 【1 分】投资优先级与关键洞察：字段 `investment_priority_score`（DOUBLE ≥0）或 `key_insight`（STRING）。\n  - 【1 分】未来投资建议：字段 `future_investment_advice`，STRING。\n  - 【1 分】预测因子-成功预测与分层：字段 `roi_success_prediction`（概率 0–1）、`expected_roi_tier`（枚举 High/Medium/Low）。\n  - 【1 分】预测因子-主要风险因素与建议：字段 `primary_risk_factor`（STRING）、`investment_recommendation`（STRING）。\n  - 【1 分】预测因子-时序标签：字段 `start_quarter`（Q1–Q4）、`season`（枚举 Spring/Summer/Fall/Winter）、`timing_type`（STRING）。\n  - 【1 分】决策模型-成功率与期望收益：字段 `success_rate`（0–1）、`return_expectation`（DOUBLE ≥0）。\n  - 【1 分】决策模型-投资波动与平均投入：字段 `roi_volatility`（DOUBLE ≥0）、`avg_investment_hours`（DOUBLE ≥0）。\n  - 【1 分】决策模型-资源分配与风险评估：字段 `allocation_recommendation`（STRING）、`risk_assessment`（STRING/枚举）。\n  - 【1 分】新项目预测模板-投资与成功概率：字段 `estimated_investment_hours`（≥0）、`expected_roi`（≥0）、`success_probability`（0–1）。\n  - 【1 分】新项目预测模板-团队效率与人均目标：字段 `recommended_team_efficiency`（0–100）、`target_investment_per_person`（≥0）。\n  - 【1 分】新项目预测模板-置信度：字段 `prediction_confidence`，0–1。\n  - 【1 分】用户月度生产力趋势：字段 `activity_month`（YYYY-MM）、`completion_rate_pct`（0–100）、`avg_completion_time`（≥0）、`avg_health_score`（0–100）。\n  - 【1 分】日级任务活动：字段 `date_day`（DATE）、`tasks_created`（≥0）、`tasks_completed`（≥0）、`net_task_change`（可正可负）。\n\n- 路径 1.1.B（3 分）：基础覆盖（任选，不叠加）\n  - 【1 分】实体覆盖：至少有两类实体（项目/任务/团队/用户）的关键字段。\n  - 【1 分】时间覆盖：至少有 `date_day` 或 `activity_month`。\n  - 【1 分】聚合覆盖：至少有 1 个比率类字段（如 completion_percentage）+ 1 个总量或均值类字段（如 total_investment_hours）。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）\n  - 【1 分】每个输出项需包含 “按谁 + 时间 + 聚合口径”；grain 必须在文档中声明。\n  - 【1 分】异常与缺失处理：需有显式列（如 `is_valid_record`/`anomaly_flag`）或 tests，校验负值、未来日期、重复记录。\n  - 【1 分】跨表一致性：如 `completion_percentage` 与 `completion_rate_pct`，口径说明一致（分母=总任务数）。\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 【1 分】每个模型有唯一 `name` 和 `source_models`。\n- 【1 分】每个模型有 `columns`，所有字段带 `data_type`。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 【1 分】依赖无循环/自引用。\n- 【1 分】外部来源有明确边界说明（raw_/stg_/int_/marts_）。\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 【1 分】命名统一：`avg_` 前缀均为均值，`pct` 为百分比，`rank` 为排序，ROI 字段不混用不同拼写。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 【1 分】业务口径集中：投资/ROI 逻辑集中在 `int_asana__project_investment_metrics`、`asana__project_investment_analysis`、`asana__investment_decision_model`。\n- 【1 分】避免上帝表：实体/主题表拆分清晰，聚合逻辑仅在 mart 层。\n\n## 评分须知\n- 每个小标准 **严格 1/0** 计分；无证据或无 tests → 0 分。\n- **ALLOW_MULTI_MODEL=YES**：多个模型联合满足可得分，但必须在至少一个模型中找到明确证据。\n"}
{"id": "dacomp-de-arch-009-zh", "question": "我们的市场推广经理李总最近很头疼一个问题。公司有3个应用：游戏应用、社交应用、和教育应用，每个月的推广预算是固定的10万美元。现在老板要求我们优化预算分配，但是我们发现一个很现实的问题：虽然游戏应用的下载量最高，但是教育应用的付费用户更多；社交应用虽然用户活跃度不错，但是老是有人退款。更复杂的是，我们发现不同渠道的获客成本差别很大 - Google Play搜索来的用户质量高但数量少，推荐算法带来的用户多但留存率低。现在李总每个月都要做预算分配决策，但是缺乏数据支撑。她需要知道：1）每个应用从不同渠道获得的用户，平均能带来多少收入？2）哪个渠道的投入产出比最高？3）如果把更多预算投给某个应用或某个渠道，预期能增加多少收入？4）现在的预算分配是否合理，有没有明显浪费的地方？她希望能有一个简单明了的月度报告，帮助她做出数据驱动的预算分配决策。", "rubric": "# Google Play 营销预算分配分析 评估标准（严格化版）\n\n## [总分 | 31 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（24 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n> 评分总则（适用于全表）\n> - **证据优先**：仅当模型 YAML/SQL/数据字典或 tests 中能定位到字段与口径说明时得分；口头说明/推断不计分。\n> - **类型/范围强约束**：百分比/比率范围、代码/枚举、日期/时间类型必须符合要求；不符合即 0 分。\n> - **grain 明确**：凡提及“按日/按周/按月”的度量或派生维度，需在文档中有明确 grain 描述与计算口径。\n\n## 需求 I：业务对齐与语义准确性（24 分）\n\n### 标准 1.1（最高 22 分）：功能点覆盖\n- 路径 1.1.A（22 分）：完整覆盖（每条 1 分；均需满足“字段存在 + 类型/范围正确 + 可定位证据”，否则 0 分）\n\n  - 【1 分｜判定条件】应用标识 `package_name` 存在，作为统一主键维度之一；`package_name` 为非空字符串，跨模型可 join，有唯一性/非空 tests。\n  - 【1 分｜判定条件】日粒度 `date_day` 存在，类型为 DATE，作为关键时间维度；相关事实表 grain 文档化为 “per package_name per day”。\n  - 【1 分｜判定条件】周/月时间维度用于“月度报告”：存在 `day_name` 或 `week_of_year` 或 `month_name` 至少一项；类型/取值域正确（`week_of_year` 在 1–53，有范围 tests）。\n  - 【1 分｜判定条件】渠道维度 `traffic_source` 存在；枚举或字典化（如 organic/paid/referral 等）在文档中列出；空值处理策略明确。\n  - 【1 分｜判定条件】门店访客 `store_listing_visitors` 存在，整数 ≥0；聚合口径与去重规则文档化。\n  - 【1 分｜判定条件】门店安装量 `store_listing_installers` 存在，整数 ≥0；与访客定义口径一致（同一粒度）。\n  - 【1 分｜判定条件】门店转化率 `store_listing_conversion_rate` 存在，范围 **0–1**（或 0–100%，二者其一，需在全局统一）；tests 需校验范围。\n  - 【1 分｜判定条件】每日净收入 `daily_net_revenue` 存在，数值型 ≥0；净额口径说明可定位（如 `gross - refunds` 等）。\n  - 【1 分｜判定条件】每日毛/总收入 `daily_gross_revenue` 存在，数值型 ≥0；货币单位在文档固定（如 USD）。\n  - 【1 分｜判定条件】每日退款金额 `daily_refunds` 存在，数值型 ≥0；负数禁止（tests）。\n  - 【1 分｜判定条件】退款率 `refund_rate` 存在，范围 **0–1**（或 0–100%，需统一）；分母口径（订单数/收入额）在文档中明确。\n  - 【1 分｜判定条件】每日付费交易数 `daily_paying_transactions` 存在，整数 ≥0；与收入类字段关联可复算（允许 ≤0.1% 误差）。\n  - 【1 分｜判定条件】平均交易额 `average_transaction_value` 存在，数值型 ≥0；计算公式（净额/交易数或毛额/交易数）文档化。\n  - 【1 分｜判定条件】净收入移动平均存在：`avg_7d_net_revenue` 或 `avg_30d_net_revenue` 至少其一；滚动窗定义与边界处理（不足窗期）文档化。\n  - 【1 分｜判定条件】留存率（至少 `day_30_retention_rate`）存在；范围 0–1 或 0–100%，与其他率/占比单位保持全局一致。\n  - 【1 分｜判定条件】日流失率 `daily_churn_rate` 存在，范围 0–1（或 0–100%）；计算口径（定义分母与时间窗）可定位。\n  - 【1 分｜判定条件】质量/稳定性与得分：存在 `daily_crashes` 或 `daily_anrs`（整数 ≥0）与 `quality_score`（0–100）；得分算法/权重说明可定位。\n  - 【1 分｜判定条件】国家维度 `country` 存在，ISO 两位码（长度=2 的 tests）；大小写规范统一（如大写）。\n  - 【1 分｜判定条件】收入侧 `buyer_country` 存在，用于与市场国家口径对齐；存在对齐策略说明（如汇总到 `country` 的规则或区分展示）。\n  - 【1 分｜判定条件】周/周环比增长率存在：`wow_install_growth_rate` 或 `wow_revenue_growth_rate` 至少其一；计算口径（上周 vs 本周，周定义/时区）可定位；范围允许负值，单位（比例或百分比）统一。\n  - 【1 分｜判定条件】业务健康/总体评分存在：`business_health_status`（枚举）或 `overall_performance_score`（0–100）；分级/映射规则可定位。\n  - 【1 分｜判定条件】投资/投放建议标签存在：`investment_recommendation` 或 `investment_priority` 至少其一；枚举或文本模板与触发逻辑说明可定位。\n\n### 标准 1.2（最高 2 分）：指标/特征口径\n- 路径 1.2.A（2 分）：口径清晰（每条 1 分；缺任一要求记 0 分）\n  - 【1 分｜判定条件】**对象+时间/规则**：各输出项至少包含两类要素并在文档可定位：  \n    - 对象（如 `package_name`/`traffic_source`/`country`）；  \n    - 时间（`date_day`/周/月对齐与 `DATE_TRUNC` 规则）；  \n    - 统计/聚合规则（分子/分母/去重/滚动窗）。  \n    必须在 YAML/注释/SQL 中明确 grain（如 “per package_name per day”）。\n  - 【1 分｜判定条件】**异常/缺失/边界处理**：tests 或文档中明确以下至少三项约束与默认处理：  \n    - 比率/百分比范围（如 `refund_rate` ∈ [0,1] 或 [0,100] 且全局唯一口径）；  \n    - 评分/指数范围（如 `quality_score`、`overall_performance_score` ∈ [0,100]）；  \n    - 代码长度与格式（`country` 长度=2，ISO 规范）；  \n    - 时间枚举（`week_of_year` ∈ [1,53]）；  \n    - 金额与计数非负；  \n    - 缺失值/重复记录处理策略（去重主键及排序规则）。\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素（每条 1 分）\n  - 【1 分｜判定条件】每个模型均声明 `name`、`grain`、`source_models`；grain 必须清晰（例：per package_name per day / per package_name per country per day）。\n  - 【1 分｜判定条件】在 `columns` 中定义字段列表与 `data_type`（至少给出一个模型的完整列清单示例）；缺字段类型/描述则 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图（每条 1 分）\n  - 【1 分｜判定条件】**无循环/自引用**：`int_*` 仅作为上游供给 `marts_*`；依赖图可拓扑排序；发现环路/自依赖 → 0 分。\n  - 【1 分｜判定条件】**外部来源边界清晰**：仅引用已知前缀（`stg_google_play__*` / `int_google_play__*` 等），不存在未定义外部依赖；目录或文档能定位来源边界。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 【1 分｜判定条件】同一概念不混用多口径：如 `refund_rate`、`average_rating`、`quality_score` 的单位/范围在模型间保持一致；若出现 `rate` 有的用 0–1、有的用 0–100% 且无统一声明 → 0 分。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 【1 分｜判定条件】分层职责清晰：`staging → intermediate → marts`；staging 负责清洗标准化，intermediate 聚合单主题口径，marts 面向场景输出；文档/目录结构可证明。\n- 【1 分｜判定条件】模块内聚、依赖清晰：`int_*` 聚合**单一主题**（行为/收入/留存/质量/商店），`marts_*` 组合多主题输出；若 `int_*` 出现多主题混杂或双向依赖 → 0 分。\n\n## 评分须知\n- **逐条 1/0 计分**；**找不到证据 → 0 分**。  \n- **ALLOW_MULTI_MODEL=YES**：允许多模型共同满足，但每条必须能在至少一个模型/YAML/SQL/tests 中**精确定位**到字段与口径说明。  \n"}
{"id": "dacomp-de-arch-010-zh", "question": "公司的邮件营销投入产出比出现了严重问题。虽然我们每个月发送几十万封营销邮件，但发现很多高价值的潜在客户从来没有收到过我们的邮件，而一些已经购买多次的老客户却还在收到新客户的促销邮件。更要命的是，我们发现不同的营销活动之间存在严重的受众重叠，同一个人在一周内可能收到 5-6封内容相似的邮件，导致大量取消订阅。现在需要建立一个精准的营销受众管理和邮件冲突避免系统，能够根据客户的生命周期阶段、购买历史、行为特征来动态调整邮件内容和发送频率，确保每个客户在合适的时间收到最相关的邮件，同时避免过度骚扰和内容重复。", "rubric": "# 精准营销受众管理与邮件冲突避免 评估标准\n\n## [总分 | 25 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（18 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（18 分）\n\n### 标准 1.1（最高 12 分）：功能点覆盖\n- 路径 1.1.A（12 分）：完整覆盖\n  - 小标准：【1 分｜判定条件】存在联系人唯一标识与去重键（如 contact_id、calculated_merged_vids、email），粒度为“每联系人一行”（hubspot__contacts 与 int_hubspot__contact_merge_adjust）。\n  - 小标准：【1 分｜判定条件】包含联系人生命周期分段与转化状态（如 contact_maturity_segment、conversion_status），并能关联创建/首次转化时间（created_date、first_conversion_date），粒度为“每联系人一行”（hubspot__contact_engagement_analysis 与 int_hubspot__contact_lifecycle_metrics）。\n  - 小标准：【1 分｜判定条件】具备邮件行为事件聚合（opens、clicks、bounces、spam_reports、deliveries），并可按联系人汇总（int_hubspot__email_event_aggregates，hubspot__contact_engagement_analysis）。\n  - 小标准：【1 分｜判定条件】具备单次邮件发送事件记录及状态布尔位（was_delivered、was_opened、was_clicked、was_bounced、was_spam_reported、was_unsubscribed），含 email_send_timestamp（hubspot__email_sends / hubspot__email_event_sent）。\n  - 小标准：【1 分｜判定条件】包含退订/垃圾举报度量（unsubscribes、spam_reports）并可按活动聚合（int_hubspot__email_aggregate_status_change、hubspot__campaign_performance_analysis）。\n  - 小标准：【1 分｜判定条件】具备联系人邮件互动口径（email_open_rate、email_click_through_rate、last_engagement_date）用于近因与频次评估（hubspot__contact_engagement_analysis、int_hubspot__contact_lifecycle_metrics）。\n  - 小标准：【1 分｜判定条件】具备与交易/购买相关的代理特征（total_associated_deals、total_closed_deals、total_deal_value、avg_deal_value、last_deal_closed_date），粒度为“每联系人一行”（hubspot__contact_engagement_analysis）。\n  - 小标准：【1 分｜判定条件】具备邮件归因指标（email_attributed_deals、email_attributed_revenue、revenue_per_email_sent、avg_attribution_window_days），支持评估邮件-交易关系（hubspot__contact_engagement_analysis、int_hubspot__email_marketing_attribution）。\n  - 小标准：【1 分｜判定条件】具备联系人分层/评分（overall_engagement_score、engagement_tier、final_engagement_classification、customer_value_segment、mql_classification、comprehensive_engagement_score），用于受众优先级（hubspot__contact_engagement_analysis）。\n  - 小标准：【1 分｜判定条件】具备活动级绩效与质量度量（open_rate、click_through_rate、attributed_revenue、lead_conversion_rate、avg_days_to_conversion、unsubscribe_rate、bounce_rate、delivery_rate、campaign_performance_tier、roi_tier）（hubspot__campaign_performance_analysis）。\n  - 小标准：【1 分｜判定条件】具备发送时间字段以支持频控/静默窗口（email_send_timestamp），并可按联系人/活动进行时间约束（hubspot__email_sends / hubspot__email_event_sent）。\n\n### 标准 1.2（最高 6 分）：指标/特征口径\n- 路径 1.2.A（6 分）：口径清晰\n  - 小标准：【1 分｜判定条件】每项输出至少包含两类要素（按谁/时间范围或对齐/统计或聚合规则），如“contact_id + attribution_window_days”。\n  - 小标准：【1 分｜判定条件】对缺失/异常/重复/负值/未来时间给出默认处理的列或逻辑说明（如删除标记 is_contact_deleted、退订/垃圾举报为合规屏蔽信号）。\n  - 小标准：【1 分｜判定条件】跨输出项口径一致（如 open_rate、click_through_rate 在活动与联系人口径一致）。\n  - 小标准：【1 分｜判定条件】存在“近因/频次”可替换字段（如 last_engagement_date + total_emails_sent）覆盖行为强弱评估。\n  - 小标准：【1 分｜判定条件】存在“价值/转化”可替换字段（如 total_deal_value、email_attributed_revenue）覆盖收益评估。\n  - 小标准：【1 分｜判定条件】存在“合规/抑制”可替换字段（如 was_unsubscribed、spam_reports、is_contact_deleted）。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 小标准：【1 分｜判定条件】模型标识（name）在 gold.yaml 中明确列出,上游依赖（source_models）在 gold.yaml 中完整列出。\n  - 小标准：【1 分｜判定条件】字段定义（columns）在 gold.yaml 中可检索并具语义。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 小标准：【1 分｜判定条件】无悬空引用（所有 source_models 在 gold.yaml 或 stg_* 中可找到）,无循环/自引用（依赖为分层有向）。\n  - 小标准：【1 分｜判定条件】外部来源（staging）有明确指向与边界说明（stg_hubspot__* 系列）。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准：【1 分｜判定条件】名称语义化、避免歧义（如 hubspot__contact_engagement_analysis 明确表达分析语义）。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准：【1 分｜判定条件】分层职责清晰（staging→intermediate→marketing/sales/service→marts），模型依赖清楚。\n- 小标准：【1 分｜判定条件】业务口径集中（如邮件归因与互动在专属模型集中呈现），避免“上帝表”与无序散落。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-011-zh", "question": "最近冲刺看着都完成了，但承诺和实际完成差距不小，且中途新增/移出、优先级变化很频繁，影响交付稳定性。请按项目与团队，给出每个冲刺的承诺稳定性评估：开始承诺 vs 结束完成的偏差、变更集中发生的时间窗、分配/重新分配导致的等待耗时是否在变更高峰附近显著增加，并列出异常冲刺的Top名单与主要责任人/组件集中度。", "rubric": "# 冲刺承诺稳定性评估 评估标准\n\n## [总分 | 31 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（24 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（24 分）\n\n### 标准 1.1（最高 20 分）：功能点覆盖\n- 路径 1.1.A（20 分）：**完整覆盖**\n  - 1.1.A.1 【1 分】存在冲刺实体与标识：`sprint_id`、`sprint_name`、`board_id` 三者均存在，且 grain 定义明确（如 \"one row per sprint per day\"）；缺任一或粒度模糊 → 0 分。\n  - 1.1.A.2 【1 分】冲刺时间窗口：`sprint_started_at`、`sprint_ended_at`、`sprint_completed_at` 字段均存在且类型为 timestamp；缺任一 → 0 分。\n  - 1.1.A.3 【1 分】开始承诺的工作量：存在 `story_points_committed` 或 `story_point_estimate_committed`，以及 `issues_committed`；缺口径或字段 → 0 分。\n  - 1.1.A.4 【1 分】结束完成的工作量：存在 `story_points_end` 或 `story_point_estimate_end`，以及 `resolved_sprint_issues`；缺任一 → 0 分。\n  - 1.1.A.5 【1 分】冲刺内日粒度进度：至少包含 `issues_completed`、`issues_remaining`、`story_points_completed`、`story_points_remaining`、`completion_ratio`；字段不全 → 0 分。\n  - 1.1.A.6 【1 分】承诺 vs 完成偏差可计算：同模型同时含 committed 与 end/completed 列，且覆盖 story_points_* 与 issues_*；缺一类 → 0 分。\n  - 1.1.A.7 【1 分】范围变更量：存在 `scope_change_points`、`scope_change_issues` 或 `burndown_variance`；无则 0 分。\n  - 1.1.A.8 【1 分】变更时间窗可定位：存在 `snapshot_date`/`day_number` 或 `timeline_progress_ratio`/`velocity_trend_3d`，可标记变更集中时段；否则 0 分。\n  - 1.1.A.9 【1 分】分配/重新分配等待耗时：存在 `any_assignment_duration_seconds`、`last_assignment_duration_seconds`，以及时间戳 `first_assigned_at`、`last_assigned_at`；缺任一 → 0 分。\n  - 1.1.A.10 【1 分】等待耗时与变更关联：有日级记录，能与 scope_change_* 或 timeline 字段 join/对齐；否则 0 分。\n  - 1.1.A.11 【1 分】风险/健康信号：存在至少一项 `sprint_health_score`、`sprint_risk_status`、`performance_index`、`velocity_category`；缺失 → 0 分。\n  - 1.1.A.12 【1 分】Top 异常冲刺排序：产出含排序依据列（如 `performance_index`、`sprint_health_score`、`burndown_variance`、`completion_ratio`）；否则 0 分。\n  - 1.1.A.13 【1 分】责任人维度：`assignee_user_id`、`assignee_name` 存在且可在冲刺聚合；否则 0 分。\n  - 1.1.A.14 【1 分】组件维度：存在 `components` 列并可聚合；否则 0 分。\n  - 1.1.A.15 【1 分】项目/团队维度：存在 `project_id`、`project_name`，并能与冲刺相关联（如 `sprints_participated`）；否则 0 分。\n  - 1.1.A.16 【1 分】优先级与类型维度：存在 `current_priority`/`priority_id` 与 `issue_type`；缺失 → 0 分。\n  - 1.1.A.17 【1 分】估算与实际工时：存在 `original_estimate_seconds`、`remaining_estimate_seconds`、`time_spent_seconds`；缺失 → 0 分。\n  - 1.1.A.18 【1 分】故事点与估点并存：`story_points` 与 `story_point_estimate` 同时存在；缺任一 → 0 分。\n  - 1.1.A.19 【1 分】冲刺活跃状态：存在 `is_sprint_active` 与 `sprint_phase`，且枚举值文档化；否则 0 分。\n  - 1.1.A.20 【1 分】跨模型唯一键与时间：`sprint_id`、`issue_id`、`date_day`/`snapshot_date` 必须在相关模型均可解析；缺失 → 0 分。\n\n### 标准 1.2（最高 4 分）：指标/特征口径\n- 路径 1.2.A（4 分）：**口径清晰**\n  - 1.2.A.1 【1 分】每个输出项含 **主体+时间**：如 `sprint_id+snapshot_date`、`issue_id+date_day`；若缺一类 → 0 分。\n  - 1.2.A.2 【1 分】缺失/异常容错：存在 tests 或约束（如数值 ≥0，枚举取值集，时间不晚于当前日期）；若无明确 tests → 0 分。\n  - 1.2.A.3 【1 分】跨输出项口径一致：`story_points*`、`story_point_estimate*`、`issues_*` 在日级与冲刺级定义一致（命名+单位）；不一致 → 0 分。\n  - 1.2.A.4 【1 分】状态/阶段统一：`is_sprint_active`、`sprint_phase`、`current_status` 在不同表的语义一致（枚举集相同）；否则 0 分。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 2.1.A.1 【1 分】上游依赖 (`source_models`) 声明完整，且 grain 定义明确（例：\"One row per sprint per day\"）；缺失 → 0 分。\n- 2.1.A.2 【1 分】字段定义 (`columns`) 包含 name+data_type 全部列出；缺一则 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 2.2.A.1 【1 分】无循环/自引用：依赖方向为 stg → int → marts；检测到环 → 0 分。\n- 2.2.A.2 【1 分】外部来源明确：所有原始输入来自 `stg_*`，未绕过中间层直达 marts；否则 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 【1 分】命名规范：snake_case、一致单位（*_seconds、*_days）；同一概念不混用（如 story_points vs story_point_estimate 区分清晰且一致）；否则 0 分。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 【1 分】业务口径集中：冲刺度量聚合在 int 层和 marts 层（如 `int_jira__sprint_performance_analytics`、`jira__daily_sprint_issue_history`、`jira__sprint_enhanced`）；否则 0 分。\n- 3.2.2 【1 分】避免“上帝表”：模块内聚（issue/项目/用户/冲刺各自成系），依赖清晰；发现所有维度混入单表则 0 分。\n\n## 评分须知\n- 每小标准 1/0 打分；**无证据 = 0 分**。\n- 强约束：唯一键一致、命名规范、依赖单向；任何不一致 → 0 分。\n- `ALLOW_MULTI_MODEL=YES`：允许跨模型满足，但必须能在模型/契约中找到字段/逻辑的明确证据。\n"}
{"id": "dacomp-de-arch-012-zh", "question": "我们最近在复盘邮件运营时发现，同一渠道里、相同活动类型的模板组合，周度“打开→点击”的转化效率有明显波动，导致资源投放很难稳住效果。请按“渠道×活动类型×邮件模板”拆开，在过去一个完整周期里做周维度的漏斗评估：哪些组合既高转化又稳定，哪些组合高转化但波动大（需要降权或A/B复验），哪些组合低波动但点击弱（适合作保底模板）。同时把异常周标出来，并给出可能的结构性原因（模板更换、受众规模变化、投放密度变化）。", "rubric": "# 邮件运营周漏斗评估（渠道×活动类型×模板） 评估标准\n\n## [总分 | 35 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（28 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（28 分）\n\n### 标准 1.1（最高 25 分）：功能点覆盖\n- 路径 1.1.A（25 分）：完整覆盖\n  - 小标准 1.1.A.1：【1 分｜维度】`channel` 可用于切片与汇总：产出中**必须**可追溯 `program_id`→`channel`（如 `marts.marketo__programs.channel`）；`program_id` 非空可联结；否则 0 分。\n  - 小标准 1.1.A.2：【1 分｜维度】`campaign_type` 可用：事实/维度表**必须**提供 `campaign_type`（证据示例：`stg_marketo__campaigns.campaign_type` 且在 `email_sends` 可联结/引用）；否则 0 分。\n  - 小标准 1.1.A.3：【1 分｜维度】`email_template_id` 可用：事实层与漏斗输出**均可引用**（列存在且类型一致）；否则 0 分。\n  - 小标准 1.1.A.4：【1 分｜维度】`campaign_id` 可用：在漏斗/事实层**均可引用**（证据：漏斗层出现该列或可由业务键映射得到）；否则 0 分。\n  - 小标准 1.1.A.5：【1 分｜周期】支持**周粒度**：产出包含 `analysis_type='weekly'` 与周标识 `period_identifier`（不可为空）；否则 0 分。\n  - 小标准 1.1.A.6：【1 分｜时间对齐】**周定义一致**：计算一律使用 `DATE_TRUNC('week', <timestamp>)`（或等价函数）并在文档声明时区；若发现混用日历周/ISO 周或时区不一致则 0 分。\n  - 小标准 1.1.A.7：【1 分｜指标】`period_emails_sent` 周内发送量：字段存在、非负（≥0），类型为整数；否则 0 分。\n  - 小标准 1.1.A.8：【1 分｜指标】`period_emails_delivered` 周内送达量：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.9：【1 分｜指标】`period_emails_opened` 周内打开量：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.10：【1 分｜指标】`period_emails_clicked` 周内点击量：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.11：【1 分｜指标】`period_unique_recipients` 周唯一收件人：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.12：【1 分｜指标】`period_unique_opened` 周唯一打开：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.13：【1 分｜指标】`period_unique_clicked` 周唯一点击：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.14：【1 分｜补充】`total_open_actions`：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.15：【1 分｜补充】`total_click_actions`：字段存在、非负，整数；否则 0 分。\n  - 小标准 1.1.A.16：【1 分｜率】`period_delivery_rate`（%）：字段存在、数值型、范围 **0–100**；若超界或单位不明则 0 分。\n  - 小标准 1.1.A.17：【1 分｜率】`period_open_rate`（%）：字段存在、数值型、范围 **0–100**；否则 0 分。\n  - 小标准 1.1.A.18：【1 分｜率】`period_click_through_rate`（打开→点击，%）：字段存在、数值型、范围 **0–100**，基于**周口径**计算；否则 0 分。\n  - 小标准 1.1.A.19：【1 分｜环比】`prev_period_comparison`：**必须**存在至少一个 WoW 对比字段（如 rate_diff_wow、count_diff_wow 或 prev_period_value）；未提供则 0 分。\n  - 小标准 1.1.A.20：【1 分｜稳定性】波动/稳定性信号可得：**至少具备** `prev_period_comparison` 或 `volatility`（如 `operational_health.rate_volatility`），且在文档中说明算法（如标准差/变异系数）；否则 0 分。\n  - 小标准 1.1.A.21：【1 分｜异常识别】有**异常周标注依据**：基于 weekly 指标+WoW（或波动指标）形成布尔/等级标识（如 `is_anomalous_week`/`anomaly_tier`）并在产出中可见；否则 0 分。\n  - 小标准 1.1.A.22：【1 分｜结构性原因】模板更换可溯源：存在模板版本信息（如 `stg_email_template_history.version`/`is_most_recent_version` 或 `marts.email_templates` 对应列）；否则 0 分。\n  - 小标准 1.1.A.23：【1 分｜结构性原因】受众规模变化可判定：`period_unique_recipients` 或等价受众规模指标可用，且与周口径一致；否则 0 分。\n  - 小标准 1.1.A.24：【1 分｜结构性原因】投放密度变化可判定：存在 `active_send_days`/`campaign_active_days`（如 `template_funnel.active_send_days`、`campaign_funnel.campaign_active_days`）；否则 0 分。\n  - 小标准 1.1.A.25：【1 分｜组合分析】`channel × campaign_type × email_template_id` 可联合切片：维度链路完整（`program_id→channel`、`campaign_type`、`email_template_id`），并在同一粒度可聚合；否则 0 分。\n\n- 路径 1.1.B（3 分）：基础覆盖\n  - 小标准 1.1.B.1：【1 分｜实体】三维度中至少覆盖**任意两类**（`channel`/`campaign_type`/`email_template_id`），且可在产出中切片；否则 0 分。\n  - 小标准 1.1.B.2：【1 分｜时间】具备周粒度（`analysis_type='weekly'` 与 `period_identifier` 同时存在）；否则 0 分。\n  - 小标准 1.1.B.3：【1 分｜指标】至少覆盖**计数**（如 sent/delivered）与**一项率**（open 或 click_through）；否则 0 分。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 小标准 1.2.A.1：【1 分】输出项**必须同时**体现：按谁（`campaign`/`template`/`channel`）、按何时（weekly，`DATE_TRUNC('week', …)` 与 `period_identifier` 一致）、按何法（计数与率定义）；需在业务逻辑/模型注释中可定位；否则 0 分。\n  - 小标准 1.2.A.2：【1 分】缺失/异常/重复处理口径**必须**落在数据契约或测试：去重键（如 `email_sends_deduped` 的主键与排序）、数值非负约束、率的范围（0–100）；缺任一则 0 分。\n  - 小标准 1.2.A.3：【1 分】跨输出项口径一致：日/周换算与率计算一致（分母分子一致、去重口径一致、时区一致）；若发现周口径与日聚合不一致或单位混用则 0 分。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 3 分）：format/结构检查\n- 路径 2.1.A（3 分）：模型最小四要素\n  - 小标准 2.1.A.1：【1 分】**有模型标识**（`name`），如 `marketo__email_funnel_dashboard`；缺失则 0 分。\n  - 小标准 2.1.A.2：【1 分】**有上游依赖**（`source_models`），至少引用 `marketo__email_sends` 或等价来源；未声明则 0 分。\n  - 小标准 2.1.A.3：【1 分】**有字段定义+类型/约束**（`columns`）：列清单、数据类型、约束（非空/范围/枚举）齐全；缺任一则 0 分。\n\n### 标准 2.2（最高 1 分）：依赖闭合\n- 路径 2.2.A（1 分）：可构建依赖图\n  - 小标准 2.2.A.1：【1 分】**无悬空引用**：所有上游模型在项目中有定义且可解析（含 `email_sends` 及其上游）；如有未解析依赖或外链未说明则 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 2 分）：命名清晰\n- 小标准 3.1.1：【1 分】名称语义化、避免歧义：如 `analysis_type`、`period_identifier`、`period_open_rate` 直陈含义；否则 0 分。\n- 小标准 3.1.2：【1 分】同一概念不混用多口径：`open_rate`、`click_through_rate` 的定义、单位（%）和分层位置一致；否则 0 分。\n\n### 标准 3.2（最高 1 分）：分层合理\n- 小标准 3.2.1：【1 分】业务口径集中、不散落：漏斗业务口径集中于 `marts.marketo__email_funnel_dashboard`；如将核心口径下沉到 staging/intermediate 且未文档化，或分散多模型难以追踪，则 0 分。\n\n## 评分须知\n- **打分为 1/0**：每条小标准必须在模型/YAML/数据契约/测试中找到**明确证据**（字段存在、类型/范围约束、SQL 片段、文档说明）；找不到证据 → 0 分。\n- **时区/口径一致性强约束**：如周定义或时区不一致，一票否决相关条目。\n- **去重与分母一致性强约束**：去重键、汇总口径、率的分子分母必须在文档中可追溯；不透明 → 0 分。\n- `ALLOW_MULTI_MODEL=YES`：允许多模型共同满足，但每条评分仍以**证据可定位**为前提。\n"}
{"id": "dacomp-de-arch-013-zh", "question": "过去四个财务期里，部分子公司现金流由正转负，但财务团队意见不一。请你把“现金流转负”的主因拆清楚：到底是收款变慢（AR账龄恶化）、毛利被蚕食（部门/地点的费用结构异常）、还是供应商付款延迟导致的出血？我需要按子公司维度列出Top 5风险主体，并在部门-地点-月的细颗粒上，给出每类主因的贡献占比和明确的纠偏动作（收款优先级、费用控制点、供应商重谈建议），且要基于我们现有数仓直接算出来。", "rubric": "# 现金流转负主因拆解 评估标准\n\n## [总分 | 27 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（20 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（20 分）\n\n### 标准 1.1（最高 17 分）：功能点覆盖\n- 路径 1.1.A（17 分）：**完整覆盖**\n  - 1.1.A.1 【1 分】子公司维度：必须同时存在 `subsidiary_id`、`subsidiary_name`、`subsidiary_full_name`；任意缺失 → 0 分。证据：`int_netsuite2__transaction_details`、`netsuite2_financial_dashboard`。\n  - 1.1.A.2 【1 分】财务期对齐：必须有 `accounting_period_id` 与 `accounting_period_ending`/`name`，或 `analysis_month`/`performance_month`；缺任一 → 0 分。\n  - 1.1.A.3 【1 分】现金流四类：`operating_cash_flow`、`investing_cash_flow`、`financing_cash_flow`、`net_cash_flow` 同时存在，且 inflow/outflow 可区分；缺任何一类 → 0 分。\n  - 1.1.A.4 【1 分】四期窗口：存在 period 或 month 粒度字段，支持取最近 4 期；若粒度无法对齐 → 0 分。\n  - 1.1.A.5 【1 分】AR 账龄分桶：必须全覆盖 `current_amount` 至 `over_180_days_amount` 六个桶；缺任一 → 0 分。\n  - 1.1.A.6 【1 分】AR 占比与恶化：必须含 `overdue_amount`、`overdue_percentage`、`weighted_average_days_outstanding`、`customer_risk_score`；缺任一 → 0 分。\n  - 1.1.A.7 【1 分】毛利链路：同时有收入、成本、毛利、毛利率（`total_revenue`、`total_cogs`、`gross_profit`、`gross_margin_pct`/`gross_margin_ratio`）；缺任一 → 0 分。\n  - 1.1.A.8 【1 分】费用口径：必须存在 `revenue_to_expense_ratio` 或 `converted_amount`+科目分类；缺失 → 0 分。\n  - 1.1.A.9 【1 分】部门维度：存在 `department_id`、`department_name`、`department_full_name`；缺任一 → 0 分。\n  - 1.1.A.10 【1 分】地点维度：存在 `location_id`、`location_name`、`location_full_name`；缺任一 → 0 分。\n  - 1.1.A.11 【1 分】月粒度：必须能通过 `performance_month`/`analysis_month`/`accounting_period_*` 支持“部门-地点-月”；缺任一 → 0 分。\n  - 1.1.A.12 【1 分】供应商付款延迟：必须同时具备 `avg_payment_delay_days`、`overdue_payment_percentage`、`outstanding_balance`/`total_payables`；缺任一 → 0 分。\n  - 1.1.A.13 【1 分】供应商维度：`vendor_id`、`vendor_name`、`vendor_category_name` 全部存在；缺任一 → 0 分。\n  - 1.1.A.14 【1 分】贡献占比：必须有至少一类 ratio/percentage（如 `gross_margin_percentage`、`overdue_percentage`、`spend_concentration_ratio`）；否则 0 分。\n  - 1.1.A.15 【1 分】子公司 Top5 风险：存在按子公司可排序的风险列（`customer_risk_score`、`vendor_risk_score` 或 `overdue_amount`/`avg_payment_delay`）；否则 0 分。\n  - 1.1.A.16 【1 分】纠偏动作：必须存在 `recommended_action` 或等价字段（`collection_priority`、`payment_recommendation`、`improvement_recommendation`）；否则 0 分。\n  - 1.1.A.17 【1 分】多模型协同：现金流/AR/毛利/费用/供应商模型均存在，且至少通过 `subsidiary_id` + `accounting_period_id`/`month` 可 join；否则 0 分。\n\n- 路径 1.1.B（3 分）：**基础覆盖**\n  - 1.1.B.1 【1 分】实体类覆盖：至少有子公司（subsidiary_*）+ 主体（customer/vendor/department/location）中的任意 2 类；否则 0 分。\n  - 1.1.B.2 【1 分】时间类覆盖：至少有 `accounting_period_*` 或 `analysis_month/performance_month` 中的任意 2 项；否则 0 分。\n  - 1.1.B.3 【1 分】聚合类覆盖：现金流/AR/毛利/费用/供应商支付中的任意 2 类指标存在；否则 0 分。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：**口径清晰**\n  - 1.2.A.1 【1 分】每个输出项必须含主体 + 时间（如 `subsidiary_id+accounting_period_id`）；缺任一 → 0 分。\n  - 1.2.A.2 【1 分】必须有异常/缺失/负值处理（tests: not_null、unique、>=0 或 data_quality_metrics）；无测试 → 0 分。\n  - 1.2.A.3 【1 分】跨输出项口径一致：period vs month 命名一致；现金流/AR/利润/费用字段在各模型定义不冲突；冲突 → 0 分。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 2.1.A.1 【1 分】grain 定义必须明确（例：\"one row per subsidiary per month\"）；缺失 → 0 分。\n- 2.1.A.2 【1 分】所有字段必须在 columns 下声明 name+data_type；缺失 → 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 2.2.A.1 【1 分】无悬空引用：source_models 指向的 stg/int/netsuite2_* 在合同内均存在；缺失 → 0 分。\n- 2.2.A.2 【1 分】外部来源边界明确：所有原始输入来自 `stg_netsuite2__*` 或 `stg_netsuite__*`，禁止直接跨到 marts；不符合 → 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 2 分）：命名清晰\n- 3.1.1 【1 分】字段名语义化（如 operating_cash_flow、overdue_amount），避免缩写黑话。\n- 3.1.2 【1 分】命名规则一致：*_id、*_amount、*_percentage、*_ratio、*_month 等统一；同一概念跨模型不混用（如 gross_margin_pct vs gross_margin_ratio 必须一一对应）。\n\n### 标准 3.2（最高 1 分）：分层合理\n- 3.2.1 【1 分】分层清晰：stg 原始 → int 加工 → netsuite2_* 集市；同一主题指标不散落，跨主题通过键（subsidiary_id/accounting_period_id）关联；否则 0 分。\n\n## 评分须知\n- 每个小标准严格 1/0 计分；**无证据 = 0 分**。\n- 任何字段缺失、tests 缺失、跨模型口径不一致 → 一律 0 分。\n- `ALLOW_MULTI_MODEL=YES`：允许跨模型满足，但必须能在模型或契约中找到**明确字段/规则证据**。\n"}
{"id": "dacomp-de-arch-014-zh", "question": "我们现在每条问卷都在多个渠道（邮件、匿名链接、社群等）并行投放。请帮我把“实际完成问卷且质量达标”的响应，按投放渠道和联系人来源目录维度，做一个按周的归因分析：在同一个调查（survey_id）内，当一个联系人同时收到多个分发（distribution_id）或通过不同渠道进入时，把该联系人的最终“合格完成”只归因到他第一次接触的渠道与分发；如果联系人被目录去重合并了多个账号（同邮箱），以邮箱为粒度做归因去重。最后我需要每个调查、每周、每渠道的“合格完成数”“渠道市场份额”“渠道效率得分排名”，以及按目录（directory_id）分层看不同目录在各渠道的质量完成贡献，方便我们决定下周预算如何在渠道和目录上做倾斜。", "rubric": "# 周度渠道归因（Qualtrics）评估标准\n\n## [总分 | 36 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（29 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（29 分）\n\n### 标准 1.1（最高 26 分）：功能点覆盖\n- 路径 1.1.A（26 分）：**完整覆盖**\n  - 小标准：调查主键存在【1 分｜判定条件】含列 survey_id\n  - 小标准：分发主键存在【1 分｜判定条件】含列 distribution_id\n  - 小标准：渠道枚举有效【1 分｜判定条件】含列 distribution_channel 且值域为 'email','web','mobile','social','sms','qr','anonymous'\n  - 小标准：联系人与邮箱标识存在【1 分｜判定条件】含列 contact_id、email\n  - 小标准：目录维度存在【1 分｜判定条件】含列 directory_id\n  - 小标准：响应完成标记存在（完成 vs 未完成）【1 分｜判定条件】含列 is_finished\n  - 小标准：响应质量合格标记存在【1 分｜判定条件】含列 include_in_analysis（合格）\n  - 小标准：响应进度与时长存在【1 分｜判定条件】含列 progress、duration_in_seconds\n  - 小标准：响应日期（日粒度）存在【1 分｜判定条件】含列 recorded_date 或 date_day（集市）\n  - 小标准：周维度可由日聚合获得【1 分｜判定条件】含列 date_day 可派生 week_start（派生维度可计分）\n  - 小标准：按渠道的每日“完成响应数”存在【1 分｜判定条件】email/smsinvite/qr/gl/social/anonymous 完成计数列存在\n  - 小标准：渠道总响应与完成率存在【1 分｜判定条件】含列 total_responses、completed_responses、completion_rate\n  - 小标准：渠道市场份额存在【1 分｜判定条件】含列 market_share\n  - 小标准：渠道效率得分存在【1 分｜判定条件】含列 efficiency_score\n  - 小标准：渠道效率/完成排名存在【1 分｜判定条件】含列 efficiency_rank、completion_rank\n  - 小标准：调查使用渠道数量存在【1 分｜判定条件】含列 unique_channels_used（或同义）\n  - 小标准：联系人分发时间事件存在（sent/opened/started/completed）【1 分｜判定条件】含列 sent_at、opened_at、response_started_at、response_completed_at\n  - 小标准：邮箱归一与校验存在【1 分｜判定条件】含列 recipient_email 标准化/格式校验\n  - 小标准：目录去重标记存在（按邮箱等）【1 分｜判定条件】含列 is_deduped_on_email 等\n  - 小标准：按目录的渠道贡献可映射【1 分｜判定条件】目录模型与渠道/响应模型的维度键可关联（directory_id×distribution_channel×date_day）；\n  - 小标准：调查层渠道绩效存在【1 分｜判定条件】int_qualtrics__survey_performance 含渠道评估逻辑\n  - 小标准：筛除（screened_out）计数存在【1 分｜判定条件】含列 current_count_surveys_surveyscreenedout；\n  - 小标准：用户参与度模型存在（用于参与者唯一计数）【1 分｜判定条件】int_qualtrics__user_engagement 模型与唯一参与者列；\n  - 小标准：调查元数据存在（分类/类型）【1 分｜判定条件】含列 project_category、project_type 或同义\n- 路径 1.1.B（1 分）：**基础覆盖**\n  - 小标准：至少覆盖实体、时间、聚合三大类中的任意两类【1 分｜判定条件】存在维度键（如 survey_id、distribution_channel）、时间（日或周）、聚合指标（如 completion_rate、market_share）任两类\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：**口径清晰**\n  - 小标准：每输出项至少包含两类要素（按谁/时间范围或对齐/统计或聚合规则）【1 分｜判定条件】grain+维度键（survey_id、distribution_channel、directory_id）与时间（日/周）或聚合指标并存\n  - 小标准：对缺失/异常/重复/负值/未来时间给出默认处理【1 分｜判定条件】数据契约含 tests/约束或字段说明体现默认处理策略（如 completion_rate BETWEEN 0 AND 1；email 校验）\n  - 小标准：跨输出项的口径一致，不矛盾【1 分｜判定条件】相同指标定义一致（如 completion_rate、market_share 在各模型一致）\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：**模型最小四要素**\n  - 小标准：有模型标识（name）【1 分｜判定条件】各模型定义含 name\n  - 小标准：有粒度定义（grain）【1 分｜判定条件】各模型定义 grain（如 qualtrics__daily_breakdown：一行/日）\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：**可构建依赖图**\n  - 小标准：无悬空引用【1 分｜判定条件】source_models 全部可解析到具体模型\n  - 小标准：无循环/自引用【1 分｜判定条件】依赖图无环\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准：名称语义化，避免黑话/歧义【1 分｜判定条件】模型/字段名直观表达业务含义（如 distribution_channel、completion_rate、efficiency_score），命名规范一致（stg_/int_/qualtrics__* 前缀分层）\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准：分层职责清晰（原始/中间/集市）【1 分｜判定条件】raw/staging→int_qualtrics__*→qualtrics__* 体系完整；关键业务口径集中于中间层与集市层的专用模型（如 response_quality、channel_performance、daily_breakdown）\n- 小标准：避免“上帝表”，模块内聚，依赖清晰【1 分｜判定条件】模型划分恰当，无超大混杂表，依赖单向清晰\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。"}
{"id": "dacomp-de-arch-015-zh", "question": "我们想锁定一批“正在走下坡路、且可能拖累现金流”的客户：具体是过去一个季度收入环比下滑，同时应收账款逾期额在上升，且其历史支付率低于70%。请按客户维度给出这批客户的完整画像，并附上系统内推荐的跟进动作，要求能直接落地到销售与财务协同的行动清单。\n", "rubric": "# 下滑且拖累现金流客户识别与行动清单 评估标准\n\n## [总分 | 36 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（29 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（29 分）\n\n### 标准 1.1（最高 26 分）：功能点覆盖\n- 路径 1.1.A（26 分）：完整覆盖\n  - 小标准【1 分｜判定条件】：客户粒度输出存在（如 quickbooks__customer_analytics 粒度为“每客户一行”）。\n  - 小标准【1 分｜判定条件】：季度口径字段齐全（revenue_quarter, revenue_quarter_start 或 transaction_quarter, transaction_quarter_start）。\n  - 小标准【1 分｜判定条件】：QoQ 收入对比字段具备（revenue_current_quarter, revenue_prev_quarter 或 revenue_growth_qoq_pct）。\n  - 小标准【1 分｜判定条件】：客户级历史支付率字段（payment_rate_percentage 或 customer_collection_rate）。\n  - 小标准【1 分｜判定条件】：应收余额字段（outstanding_balance，客户或发票层）。\n  - 小标准【1 分｜判定条件】：AR 账龄分桶字段（aging_bucket 或等价的逾期状态）。\n  - 小标准【1 分｜判定条件】：逾期识别字段（collection_status 或 cash_flow_status 包含 Overdue/Past Due）。\n  - 小标准【1 分｜判定条件】：时间序列粒度支持“逾期额上升”判断（月/季对齐字段，如 revenue_month_start 或 transaction_month_start）。\n  - 小标准【1 分｜判定条件】：现金流方向/金额字段（cash_flow_direction, net_cash_flow_amount, net_outstanding_amount）。\n  - 小标准【1 分｜判定条件】：现金流预期时点字段（expected_cash_date）。\n  - 小标准【1 分｜判定条件】：现金流风险/健康度字段（liquidity_risk_level 或 cash_flow_health）。\n  - 小标准【1 分｜判定条件】：推荐行动字段（recommended_action 客户侧，或 management_recommendation 资金侧，任一满足）。\n  - 小标准【1 分｜判定条件】：客户画像基本信息字段（customer_name/company_name/display_name）。\n  - 小标准【1 分｜判定条件】：客户生命周期/活跃度字段（lifecycle_stage, activity_status）。\n  - 小标准【1 分｜判定条件】：客户价值/行为分层字段（customer_value_segment, payment_behavior）。\n  - 小标准【1 分｜判定条件】：供应商付款相关指标（用于现金压力侧观测，如 vendor_on_time_payment_rate 或 paid_amount）。\n  - 小标准【1 分｜判定条件】：费用/支出指标（total_spend/monthly_total_spend 等）。\n  - 小标准【1 分｜判定条件】：毛利/毛利率指标（gross_profit, invoice_gross_margin_pct 或 monthly_gross_profit）。\n  - 小标准【1 分｜判定条件】：贡献占比所需要素齐备（同一期间“客户收入指标”+“组织总收入指标”可获取，如客户侧 revenue_current_quarter 与组织侧 total_revenue/月聚合可上卷）。\n  - 小标准【1 分｜判定条件】：子公司/部门维度（department_id 或等价，含维表如 stg_quickbooks__department）。\n  - 小标准【1 分｜判定条件】：发票收款状态字段（collected_amount/collection_status）。\n  - 小标准【1 分｜判定条件】：跨模型关联键一致（customer_id 在 revenue/cashflow/customer_analytics 中可联通）。\n  - 小标准【1 分｜判定条件】：行动清单可落地的标识字段（customer_id 及公司/展示名用于下发）。\n  - 小标准【1 分｜判定条件】：风险/优先级排序依据（如 business_health_score 或 liquidity_risk_level）。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 小标准【1 分｜判定条件】：每个输出项包含至少两类要素（按谁+时间范围/对齐 或 统计/聚合规则），且与模型 grain 一致（示例：各模型 grain 定义）。\n  - 小标准【1 分｜判定条件】：对缺失/异常/重复/负值/未来时间给出默认处理或约束（列级 constraints/数据类型约束可被识别为测试口径）。\n  - 小标准【1 分｜判定条件】：跨输出项的口径一致（如“逾期/未收/支付率/季度”在不同模型含义一致，字段命名与描述保持一致性）。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 小标准【1 分｜判定条件】：有模型标识（name），有上游依赖（source_models），有粒度定义（grain），\n  - 小标准【1 分｜判定条件】：有字段定义+类型（columns）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 小标准【1 分｜判定条件】：无悬空引用，无循环/自引用（依赖图有向无环）\n  - 小标准【1 分｜判定条件】：外部来源有明确指向与边界说明（仅引用 stg_/int_/marts_ 范畴内模型或 raw_* 作为来源，边界清晰）。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准【1 分｜判定条件】：名称语义化（quickbooks__/int_quickbooks__/stg_quickbooks__ 前缀与实体一致），缩写/命名规则一致（双下划线、层级前缀一致）\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准【1 分｜判定条件】：分层职责清晰（staging→intermediate→marts，口径沉淀于中间/集市层）。\n- 小标准【1 分｜判定条件】：避免“上帝表”，模块内聚、依赖清晰（客户/供应商/科目等按域拆分）。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。"}
{"id": "dacomp-de-arch-016-zh", "question": "过去四个季度，我们各事业部在“经理及以上”岗位的用人到底稳不稳？给我一份季度榜单，要求按组织维度对比并能下钻到岗位/职位：同时看岗位填充率、岗位利用率、当季流失率、90天与一年留存率、平均任职时长，以及同岗12个月内的快速晋升比例。再把“高风险岗位”（高流失+低留存+低利用）标出来，并结合组织的综合绩效分类，给出建议动作，比如加速内部调配或暂停新增编制。", "rubric": "# Workday HR 稳定性季度榜单 评估标准\n\n## [总分 | 33 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（26 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（26 分）\n\n### 标准 1.1（最高 22 分）：功能点覆盖\n- 路径 1.1.A（22 分）：**完整覆盖**\n  - 小标准：【1 分｜判定条件】组织维度（部门/事业部）可对比：存在组织粒度与标识 columns/grain（如 workday__organization_overview: organization_id, organization_name，workday__organization_performance: organization_id）。\n  - 小标准：【1 分｜判定条件】岗位/职位下钻：存在职位粒度和关联（workday__position_overview: position_id 与 organization_id；workday__job_overview: job_profile_id）。\n  - 小标准：【1 分｜判定条件】岗位填充率：组织层 position_fill_rate（workday__organization_overview: position_fill_rate），且职位占用状态（workday__position_overview: position_occupancy_status）。\n  - 小标准：【1 分｜判定条件】岗位利用率：企业层 position_utilization_rate（workday__workforce_analytics: position_utilization_rate），或职位利用相关指标（current_workers_assigned/total_workers_ever_assigned）。\n  - 小标准：【1 分｜判定条件】当季流失率：组织层 annual_turnover_rate（workday__organization_overview: annual_turnover_rate），职位层 position_turnover_rate（workday__position_overview: position_turnover_rate）。\n  - 小标准：【1 分｜判定条件】90天留存率：保有 retained_90_days 明确来源（workday__employee_overview: retained_90_days；int_workday__employee_lifecycle 提供口径）。\n  - 小标准：【1 分｜判定条件】一年留存率：retained_1_year（workday__employee_overview: retained_1_year；int_workday__employee_lifecycle）。\n  - 小标准：【1 分｜判定条件】平均任职时长：avg_tenure_years（workday__organization_overview: avg_current_tenure_years/avg_former_tenure_years；workday__employee_overview: tenure_years）。\n  - 小标准：【1 分｜判定条件】同岗 12 个月内快速晋升比例：fast_promotions 或 fast_track_employees / 当前员工（workday__employee_overview: fast_promotions；workday__job_overview: fast_track_employees_count）。\n  - 小标准：【1 分｜判定条件】高风险岗位标识：高流失+低留存+低利用综合，存在岗位或组织风险分类（workday__position_overview: position_performance_category/position_efficiency_score；workday__organization_performance: organization_risk_level）。\n  - 小标准：【1 分｜判定条件】组织综合绩效分类：performance_category（workday__organization_overview: performance_category，workday__organization_performance: performance_category）。\n  - 小标准：【1 分｜判定条件】建议动作输出：recommended_action/management_recommendation（workday__organization_performance: recommended_action；workday__organization_overview: management_recommendation）。\n  - 小标准：【1 分｜判定条件】经理及以上岗位识别：管理层口径可用（workday__employee_overview: highest_management_level_reached、management_positions_held；workday__position_overview: management_level/management_level_numeric）。\n  - 小标准：【1 分｜判定条件】季度榜单时间维度：存在季度/分析日期字段以支持季度统计（workday__employee_overview: hire_quarter_cohort；workday__workforce_analytics: analysis_date）。\n  - 小标准：【1 分｜判定条件】员工风险分层：churn_risk_category（workday__employee_overview: churn_risk_category）。\n  - 小标准：【1 分｜判定条件】员工留存里程碑：retained_30_days/90_days/1_year/3_years（workday__employee_overview）。\n  - 小标准：【1 分｜判定条件】岗位/组织分层对齐：job_profile 与 position 对应组织（workday__position_overview: organization_id；workday__job_overview: organizations_using_job_count/primary_organization_id）。\n  - 小标准：【1 分｜判定条件】部门规模与管理比例：organization_size_category、management_ratio（workday__organization_overview）。\n  - 小标准：【1 分｜判定条件】员工价值分段：employee_value_segment（workday__employee_overview），与组织/岗位聚合（workday__organization_performance、workday__job_overview）。\n  - 小标准：【1 分｜判定条件】工作时长与负载：default_weekly_hours/avg_weekly_hours（workday__employee_overview、workday__organization_overview）。\n  - 小标准：【1 分｜判定条件】人口与多样性：age、ethnicity_codes、is_military_service（workday__employee_overview；组织/职位层聚合见 workday__organization_overview、workday__position_overview）。\n\n- 路径 1.1.B（3 分）：**基础覆盖**\n  - 小标准：【1 分｜判定条件】至少覆盖实体类两项：组织/岗位/职位/员工中的任意两类（存在各自 grain 与主键列）。\n  - 小标准：【1 分｜判定条件】至少覆盖时间类两项：analysis_date/quarter_cohort/period 之一在模型中出现并可对齐。\n  - 小标准：【1 分｜判定条件】至少覆盖聚合类两项：rate/score/count 等在模型中出现（如 position_fill_rate、annual_turnover_rate、organization_health_score）。\n\n### 标准 1.2（最高 4 分）：指标/特征口径\n- 路径 1.2.A（4 分）：**口径清晰**\n  - 小标准：【1 分｜判定条件】每个输出项包含主体与时间或统计规则（例如 retained_90_days 明确按谁与时间窗口；workday__organization_overview: annual_turnover_rate）。\n  - 小标准：【1 分｜判定条件】默认处理缺失/异常/重复/负值/未来时间（如 layer_dependencies 与 staging_contract 的 validation_rules；mart 层使用 nullif/round/coalesce）。\n  - 小标准：【1 分｜判定条件】跨输出项口径一致（如管理比例、留存率、周工时在各层一致使用百分比与范围 tests）。\n  - 小标准：【1 分｜判定条件】风险与绩效分类存在固定枚举或边界（organization_risk_level、performance_category、workforce_status_flag）。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：**模型最小四要素**\n  - 小标准：【1 分｜判定条件】有模型标识（name），有上游依赖（source_models），有粒度定义（grain）。\n  - 小标准：【1 分｜判定条件】有字段定义+类型（columns）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：**可构建依赖图**\n  - 小标准：【1 分｜判定条件】无悬空引用，无循环/自引用（staging→intermediate→marts 单向）\n  - 小标准：【1 分｜判定条件】外部来源有明确指向与边界说明。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准：【1 分｜判定条件】名称语义化，避免黑话/歧义（如 workday__organization_overview、position_occupancy_status），缩写/命名规则一致（stg_/int_/workday__ 前缀与下划线风格统一）。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准：【1 分｜判定条件】分层职责清晰（原始/中间/集市），业务口径集中，不散落（留存/风险/绩效口径集中在 int_workday__employee_lifecycle、int_workday__organization_metrics，再供 marts 聚合）\n- 小标准：【1 分｜判定条件】避免“上帝表”，模块内聚，依赖清晰（marts 以主题表划分：employee/job/position/organization/workforce）。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。"}
{"id": "dacomp-de-arch-017-zh", "question": "我们现在感觉招聘漏斗在不同部门和招聘经理之间“卡点”不一致——有的职位申请很多但面试推进慢，有的职位面试安排频繁但评分卡质量不高，offer发出后停留时间也偏长。请在不改变现有数据采集的情况下，按季度给出一个“职位×来源渠道×招聘经理”的漏斗诊断：分别计算从申请→首轮面试、首轮面试→发 offer、发 offer→录用三段的转化率，以及每段的平均停留天数；同时标记造成拖滞的关键环节（比如：面试安排次数高但积极推荐占比低、或该阶段候选人相关活动量不足）。最后输出当季 Top 滞后职位清单及对应的可行动建议（例如：优化面试人选、提高评分卡填写完整度、加密候选人触达等）。", "rubric": "# 职位×来源渠道×招聘经理季度漏斗诊断 评估标准（严格编号版）\n\n## [总分 | 30 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（23 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（23 分）\n\n### 标准 1.1（最高 20 分）：功能点覆盖\n- 路径 1.1.A（20 分）：**完整覆盖**\n  - 小标准 1.1.A.1：【1 分｜判定条件】必须存在职位标识字段（`job_id` 或 `requisition_id`），且非空唯一；`job_name` 可选但如存在需与 ID 一致映射。\n  - 小标准 1.1.A.2：【1 分｜判定条件】必须存在来源标识（`source_id`）与来源类型（`source_type`/`sourced_from_type`）；取值域需稳定（如 referral、job_board、internal 等）；否则 0 分。\n  - 小标准 1.1.A.3：【1 分｜判定条件】必须存在招聘经理字段（`hiring_managers` 或等价列），支持多招聘经理聚合；缺失则 0 分。\n  - 小标准 1.1.A.4：【1 分｜判定条件】必须存在季度时间维度：`application_year` 与 `application_quarter`；不允许仅存原始时间戳。\n  - 小标准 1.1.A.5：【1 分｜判定条件】必须存在部门/上级部门字段：`job_departments` 与 `job_parent_departments`；缺失任一则 0 分。\n  - 小标准 1.1.A.6：【1 分｜判定条件】申请→首面转化率必须存在：列名为 `application_to_interview_rate` 或 `interview_rate`；无则 0 分。\n  - 小标准 1.1.A.7：【1 分｜判定条件】首面→发 offer 转化率必须存在：显式列（如 `interview_to_offer_rate`），且 grain/列定义在 YAML 可查；否则 0 分。\n  - 小标准 1.1.A.8：【1 分｜判定条件】发 offer→录用转化率必须存在：显式列（如 `offer_to_hire_rate`）；若仅能间接计算，且无列定义，则 0 分。\n  - 小标准 1.1.A.9：【1 分｜判定条件】阶段一平均停留天数必须可由 `days_in_stage` 聚合得到，且能精确到“申请→首面”区间。\n  - 小标准 1.1.A.10：【1 分｜判定条件】阶段二平均停留天数必须可由 `days_in_stage` 聚合得到，区间为“首面→发 offer”。\n  - 小标准 1.1.A.11：【1 分｜判定条件】阶段三平均停留天数必须可由 `days_in_stage` 聚合得到，区间为“发 offer→录用”。\n  - 小标准 1.1.A.12：【1 分｜判定条件】必须存在面试安排次数列：`count_total_interviews` 或等价字段；否则 0 分。\n  - 小标准 1.1.A.13：【1 分｜判定条件】必须存在积极推荐占比列：`interview_success_rate` 或等价；值域 [0,1]。\n  - 小标准 1.1.A.14：【1 分｜判定条件】必须存在评分卡完整度列：如 `rating_completion_rate` 或 (`total_scorecards` 与 `count_interview_scorecards`)；否则 0 分。\n  - 小标准 1.1.A.15：【1 分｜判定条件】必须存在候选人活动量：如 `count_activities` 或 `count_activities_in_stage`；否则 0 分。\n  - 小标准 1.1.A.16：【1 分｜判定条件】必须存在招聘经理参与度布尔列：`has_interviewed_w_hiring_manager` 或等价；否则 0 分。\n  - 小标准 1.1.A.17：【1 分｜判定条件】必须存在滞后标记列：如 `performance_tier` 含 “Low Activity/Needs Improvement”；无则 0 分。\n  - 小标准 1.1.A.18：【1 分｜判定条件】必须存在“安排多但推荐低”的标志列，或等价规则标签（由 `interview_completion_rate` × `interview_success_rate` 生成）；必须能在 YAML 中定位；否则 0 分。\n  - 小标准 1.1.A.19：【1 分｜判定条件】必须支持输出当季滞后职位清单：能基于 `application_year`+`application_quarter` 与滞后标识生成排序列；否则 0 分。\n  - 小标准 1.1.A.20：【1 分｜判定条件】必须存在行动建议列：`recommended_actions` 或等价；在 YAML 中 grain/列定义可查；否则 0 分。\n\n- 路径 1.1.B（1 分）：**基础覆盖**\n  - 小标准 1.1.B.1：【1 分｜判定条件】三大类（实体维度/时间维度/聚合指标）中至少覆盖两类：  \n    - 实体（职位/来源/招聘经理）；  \n    - 时间（application_year/quarter）；  \n    - 聚合（转化率/停留天数/质量信号）；  \n    缺少则 0 分。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n  - 小标准 1.2.1：【1 分｜判定条件】输出必须包含主体维度（如 `job_id`、`source_id`、`hiring_managers`）与时间（`application_year`/`application_quarter`）；缺失则 0 分。\n  - 小标准 1.2.2：【1 分｜判定条件】缺失/异常/重复/负值/未来时间的处理逻辑必须在 `staging_contract` 中声明（validation_rules）；无文档或测试覆盖则 0 分。\n  - 小标准 1.2.3：【1 分｜判定条件】跨输出项口径必须一致：  \n    - `hire_rate`/`interview_rate` 定义一致；  \n    - 时间口径（季度、天数）一致；  \n    - 单位（转化率均为 [0,1]、停留均为天）；  \n    否则 0 分。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n  - 小标准 2.1.1：【1 分｜判定条件】模型必须声明上游依赖（`source_models` 或 `source_tables`）；否则 0 分。\n  - 小标准 2.1.2：【1 分｜判定条件】模型必须完整声明 `columns`（字段名+数据类型）；否则 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n  - 小标准 2.2.1：【1 分｜判定条件】不得有循环依赖或自引用；依赖图必须为单向（raw→staging→intermediate→marts）；否则 0 分。\n  - 小标准 2.2.2：【1 分｜判定条件】外部来源必须有明确边界说明：所有 raw_* 在 staging_contract:source_table 中映射，且说明过滤逻辑；否则 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n  - 小标准 3.1.1：【1 分｜判定条件】模型/字段命名必须直陈业务语义（如 `application_history`、`recruitment_performance`）；若存在模糊命名或缩写（如 `val`、`x1`）则 0 分。\n\n### 标准 3.2（最高 2 分）：分层合理\n  - 小标准 3.2.1：【1 分｜判定条件】分层职责必须清晰：staging（清洗/标准化）→ intermediate（派生/计算）→ marts（汇总暴露）；若跨层混用则 0 分。\n  - 小标准 3.2.2：【1 分｜判定条件】业务口径必须集中在 marts（如 `performance_tier`、转化率类）；不得分散在 staging 或 intermediate；否则 0 分。\n\n## 评分须知\n- 每个小标准按 1/0 计分；必须有文档/模型/数据契约证据；找不到证据 → 0 分。\n- 打分时禁止凭经验或推断，必须看到明确字段/定义。\n- `ALLOW_MULTI_MODEL=YES`。\n"}
{"id": "dacomp-de-arch-018-zh", "question": "这周我们别只看下载数了，我更关心“拉新质量”。请按国家和渠道，把平台版本和应用版本也分出来，做一个周粒度的 cohort 表：以“首次下载当周”为锚，给出7天活跃率（active_devices/first_time_downloads）、30天人均会话（sessions/active_devices）、7天删除率（deletions/first_time_downloads）和每千会话崩溃数（crashes per 1k sessions），同时对比净下载（installations−deletions）和重下载占比，帮我找出质量明显偏低的版本/平台组合，并列出前后10个问题地区和来源，告诉我是否需要暂停某版本的投放。", "rubric": "# Apple Store 拉新质量 Cohort 周报 评估标准\n\n## [总分 | 29 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（23 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（23 分）\n\n### 标准 1.1（最高 19 分）：功能点覆盖\n- 路径 1.1.A（19 分）：**完整覆盖**\n  - 小标准 1.1.A.1：【1 分｜判定条件】模型产出中 **必须显式存在** `date_day` 和 `first_time_downloads` 字段，且字段类型正确（`date_day` 为日期，`first_time_downloads` 为非负整数），否则 0 分。\n  - 小标准 1.1.A.2：【1 分｜判定条件】产出中 **必须同时存在** `territory_short` 与 `territory_long` 字段，且值域符合 ISO 国家码和标准国家名；缺一或命名不一致则 0 分。\n  - 小标准 1.1.A.3：【1 分｜判定条件】`source_type` 字段必须存在，且值域不超过 10 个预设渠道（如 organic、referral、paid 等）；若无说明则 0 分。\n  - 小标准 1.1.A.4：【1 分｜判定条件】`platform_version` 必须出现，且为字符串/版本号格式（如 iOS 17.0）；否则 0 分。\n  - 小标准 1.1.A.5：【1 分｜判定条件】`app_version` 必须出现，且在 `apple_store__app_version_report` 中能查询到；缺失则 0 分。\n  - 小标准 1.1.A.6：【1 分｜判定条件】`active_devices` 字段必须为日粒度度量，且存在 ≥30 天连续记录；否则 0 分。\n  - 小标准 1.1.A.7：【1 分｜判定条件】`sessions` 必须存在，日粒度且与 `active_devices` 维度对齐；否则 0 分。\n  - 小标准 1.1.A.8：【1 分｜判定条件】`deletions` 必须存在，日粒度，且无负值；否则 0 分。\n  - 小标准 1.1.A.9：【1 分｜判定条件】`crashes` 必须存在，日粒度，且支持与 `sessions` 结合计算崩溃率；否则 0 分。\n  - 小标准 1.1.A.10：【1 分｜判定条件】`installations` 必须存在且可用于净下载（`installations - deletions`）；缺失或命名不符则 0 分。\n  - 小标准 1.1.A.11：【1 分｜判定条件】`total_downloads` 必须存在，且总和 ≥ `first_time_downloads + redownloads`；否则 0 分。\n  - 小标准 1.1.A.12：【1 分｜判定条件】`redownloads` 必须存在，且均为非负整数；否则 0 分。\n  - 小标准 1.1.A.13：【1 分｜判定条件】能基于数据直接计算 **7 天活跃率**（`7d_active_devices / 7d_first_time_downloads`），且结果无除零/负值情况；否则 0 分。\n  - 小标准 1.1.A.14：【1 分｜判定条件】能基于数据直接计算 **30 天人均会话**（`30d_sessions / 30d_active_devices`），且结果合理；否则 0 分。\n  - 小标准 1.1.A.15：【1 分｜判定条件】能基于数据直接计算 **7 天删除率**（`7d_deletions / 7d_first_time_downloads`），且无负值；否则 0 分。\n  - 小标准 1.1.A.16：【1 分｜判定条件】能基于数据直接计算 **每千会话崩溃数**（`1000 * crashes / sessions`），且 sessions > 0；否则 0 分。\n  - 小标准 1.1.A.17：【1 分｜判定条件】能基于数据同时得到 **净下载与重下载占比**，且口径一致；否则 0 分。\n  - 小标准 1.1.A.18：【1 分｜判定条件】`apple_store__platform_version_report` 与 `apple_store__app_version_report` 必须存在，且至少一个字段能输出上述指标；否则 0 分。\n  - 小标准 1.1.A.19：【1 分｜判定条件】`apple_store__territory_report` 与 `apple_store__source_type_report` 必须存在，且任一指标能支持 top10/bottom10 排序；否则 0 分。\n\n- 路径 1.1.B（1 分）：**基础覆盖**\n  - 小标准 1.1.B.1：【1 分｜判定条件】至少存在 `app_id` 或 `app_name` 与 `date_day`，且包含 ≥1 个核心指标（如 `first_time_downloads` 或 `active_devices`）；否则 0 分。\n\n### 标准 1.2（最高 4 分）：指标/特征口径\n- 路径 1.2.A（4 分）：**口径清晰**\n  - 小标准 1.2.A.1：【1 分｜判定条件】输出项必须同时包含 **主体、时间、指标** 三要素；缺一则 0 分。\n  - 小标准 1.2.A.2：【1 分｜判定条件】模型文档必须显式说明缺失值/负值/未来时间处理逻辑（如 `not_null`、`>=0`、填充策略）；未说明则 0 分。\n  - 小标准 1.2.A.3：【1 分｜判定条件】同一指标命名与含义在所有模型中保持一致；如 `sessions` 在一个模型是“启动次数”、另一个是“活跃用户数”则 0 分。\n  - 小标准 1.2.A.4：【1 分｜判定条件】维度字段（如 `territory_short`、`source_type`、`platform_version`、`app_version`）必须语义统一，不得在不同模型用不同口径；否则 0 分。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：**模型最小四要素**\n  - 小标准 2.1.A.1：【1 分｜判定条件】模型必须具备 `name`，声明 `source_models` 且与实际依赖一致；缺一则 0 分。\n  - 小标准 2.1.A.2：【1 分｜判定条件】必须明确 `grain`，并列出所有 `columns`（字段名+类型+注释）；否则 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：**可构建依赖图**\n  - 小标准 2.2.A.1：【1 分｜判定条件】所有引用的模型/维表必须在 `data_contract` 中定义，且字段类型完全一致；缺失或不一致则 0 分。\n  - 小标准 2.2.A.2：【1 分｜判定条件】依赖图中不得出现循环依赖或自引用；否则 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准 3.1.1：【1 分｜判定条件】所有模型与字段命名必须符合业务语义，禁止缩写黑话（如 `x1`,`val`），同一概念不得混用多名称；否则 0 分。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准 3.2.1：【1 分｜判定条件】分层边界必须清晰：raw（原始）→ staging（清洗）→ intermediate（派生指标）→ marts（汇总暴露）；若跨层定义或职责模糊则 0 分。\n- 小标准 3.2.2：【1 分｜判定条件】业务核心口径必须集中在 intermediate，不得分散在 marts 或 staging；若出现口径下沉/上移则 0 分。\n\n## 评分须知\n- 每个小标准必须基于 **模型文档/数据结构/字段定义的直接证据** 进行评分；无法找到明确证据则记 0 分。\n- 打分不得依赖主观推断或合理假设。\n- `ALLOW_MULTI_MODEL=YES`。\n"}
{"id": "dacomp-de-arch-019-zh", "question": "过去90天里，企业版客户（plan_name=Enterprise）有没有出现“客服流程拉长”的信号？我需要一份按公司聚合的排查清单：看每家公司的SLA违约会话占比是否上升，并按渠道（email/messenger/other）拆分；同时给出该公司会话的复开中位数、首次/最后关闭的中位耗时、首次响应的中位耗时；再对比这类公司在7天/30天的活跃联系人规模和注册保留率是否偏低，并标注数据连续性（有没有缺失天数）。最后，请把这些问题公司按参与会话的管理员团队归因，列出Top 3 团队及其渠道分布，方便我们对接培训与排班优化。", "rubric": "# Intercom 客服流程拉长与 SLA 排查清单 评估标准\n\n## [总分 | 30 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（23 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（23 分）\n\n### 标准 1.1（最高 20 分）：功能点覆盖\n- 路径 1.1.A（20 分）：完整覆盖\n  - 小标准 1.1.A.1：【1 分｜判定条件】模型产出中必须存在 `company_id` 与 `company_name` 字段，且 `company_id` 唯一非空，`company_name` 为字符串，不存在缺失或重复；否则 0 分。\n  - 小标准 1.1.A.2：【1 分｜判定条件】必须存在公司级套餐字段 `plan_name`，且值域为预定义集合（如 free/pro/enterprise）；否则 0 分。\n  - 小标准 1.1.A.3：【1 分｜判定条件】必须存在会话级 SLA 状态字段 `sla_status`，且枚举值仅限于 [met, violated, pending]；否则 0 分。\n  - 小标准 1.1.A.4：【1 分｜判定条件】必须存在渠道维度字段 `conversation_type`，且取值域严格为 [email, messenger, other]；否则 0 分。\n  - 小标准 1.1.A.5：【1 分｜判定条件】必须存在会话创建时间 `conversation_created_at`，且支持基于此字段筛选近 90 天数据；否则 0 分。\n  - 小标准 1.1.A.6：【1 分｜判定条件】conversation 与 contact、company 的映射关系必须显式存在（即能通过外键 join），否则 0 分。\n  - 小标准 1.1.A.7：【1 分｜判定条件】必须可计算公司级 SLA 违约会话占比：依赖 `total_conversations` 与 `sla_status`；允许按渠道拆分；缺少任一列则 0 分。\n  - 小标准 1.1.A.8：【1 分｜判定条件】必须存在公司级复开中位数字段 `p50_reopens`，且数据类型为数值型；否则 0 分。\n  - 小标准 1.1.A.9：【1 分｜判定条件】必须存在公司级首次响应中位耗时 `p50_time_to_first_response_min`，且单位为分钟；否则 0 分。\n  - 小标准 1.1.A.10：【1 分｜判定条件】必须存在公司级首次关闭中位耗时 `p50_time_to_first_close_min`，单位为分钟；否则 0 分。\n  - 小标准 1.1.A.11：【1 分｜判定条件】必须存在公司级最后关闭中位耗时 `p50_time_to_last_close_min`，单位为分钟；否则 0 分。\n  - 小标准 1.1.A.12：【1 分｜判定条件】必须存在 7 天活跃联系人规模字段 `contacts_active_7d`，且非负；否则 0 分。\n  - 小标准 1.1.A.13：【1 分｜判定条件】必须存在 30 天活跃联系人规模字段 `contacts_active_30d`，且非负；否则 0 分。\n  - 小标准 1.1.A.14：【1 分｜判定条件】必须存在 7 天注册保留率 `registration_retention_7d`，值域 [0,1]；否则 0 分。\n  - 小标准 1.1.A.15：【1 分｜判定条件】必须存在 30 天注册保留率 `registration_retention_30d`，值域 [0,1]；否则 0 分。\n  - 小标准 1.1.A.16：【1 分｜判定条件】必须存在数据缺失天数字段 `missing_days`，且为整数；否则 0 分。\n  - 小标准 1.1.A.17：【1 分｜判定条件】必须存在连续性布尔标识 `is_date_continuous`，且仅取 [true, false]；否则 0 分。\n  - 小标准 1.1.A.18：【1 分｜判定条件】必须存在团队键 `team_id` 与 `team_name`，且 `team_id` 唯一；否则 0 分。\n  - 小标准 1.1.A.19：【1 分｜判定条件】必须存在管理员归因字段：`first_close_by_admin_id` 或 `last_close_by_admin_id` 至少一个；否则 0 分。\n  - 小标准 1.1.A.20：【1 分｜判定条件】必须可通过 `conversation_type` 与 admin→team 映射衔接出团队渠道分布；否则 0 分。\n\n- 路径 1.1.B（3 分）：基础覆盖\n  - 小标准 1.1.B.1：【1 分｜判定条件】至少存在公司（`company_id`）、管理员（`admin_id`）、团队（`team_id`）三类实体主键；否则 0 分。\n  - 小标准 1.1.B.2：【1 分｜判定条件】至少存在 `conversation_created_at` 与活跃/保留指标（7d 或 30d 任一）；否则 0 分。\n  - 小标准 1.1.B.3：【1 分｜判定条件】公司粒度存在至少一个中位数指标（`p50_time_*` 或 `p50_reopens`）；否则 0 分。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n  - 小标准 1.2.1：【1 分｜判定条件】输出项必须至少包含主体（公司/团队/管理员/渠道）与时间范围（如近 90 天/7 天/30 天）或统计口径（中位数/占比/计数）；否则 0 分。\n  - 小标准 1.2.2：【1 分｜判定条件】缺失/异常/负值/未来时间的处理逻辑必须在数据契约或测试中明确声明；无文档即 0 分。\n  - 小标准 1.2.3：【1 分｜判定条件】跨输出项口径必须一致：  \n    - 中位数口径均为分钟；  \n    - 渠道枚举统一为 [email, messenger, other]；  \n    - `sla_status` 定义一致；  \n    任一不一致则 0 分。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n  - 小标准 2.1.1：【1 分｜判定条件】模型必须具备 `name`，声明上游依赖（`source_models`），并定义粒度（`grain`）；否则 0 分。\n  - 小标准 2.1.2：【1 分｜判定条件】模型必须列出所有字段及类型（`columns`），缺失或类型不明则 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n  - 小标准 2.2.1：【1 分｜判定条件】所有引用的 source_models 必须在项目内定义，且无悬空引用；任意缺失即 0 分。\n  - 小标准 2.2.2：【1 分｜判定条件】依赖结构必须闭合：  \n    - 不得出现循环依赖或自引用；  \n    - raw_* 来源必须在 staging 层显式列出，并带删除/活跃过滤逻辑；  \n    否则 0 分。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n  - 小标准 3.1.1：【1 分｜判定条件】模型与字段命名必须清晰表达业务语义（如 `intercom__company_metrics`），禁止黑话/缩写；发现模糊命名则 0 分。\n\n### 标准 3.2（最高 2 分）：分层合理\n  - 小标准 3.2.1：【1 分｜判定条件】业务口径必须集中：公司级指标集中在 `intercom__company_metrics`，管理员集中在 `intercom__admin_metrics`；否则 0 分。\n  - 小标准 3.2.2：【1 分｜判定条件】避免“上帝表”：会话增强与会话指标分离，团队与管理员解耦；若混在单表或层级不清则 0 分。\n\n## 评分须知\n- 每个小标准必须基于模型文件、数据契约或文档中的直接证据进行评分；找不到证据 → 0 分。\n- 打分时禁止“合理推测”，必须看到字段/配置/文档明确存在。\n- `ALLOW_MULTI_MODEL=YES`。\n"}
{"id": "dacomp-de-arch-020-zh", "question": "我们最近在做预算复盘时发现，很多电邮活动的表现被“流程型消息”（例如购物车提醒、欢迎流程）稀释了。请你给我一份按“活动/流程变体”维度的归因清单：在过去90天里，针对每个变体，统计其被归因的事件结构化漏斗（展示/打开/点击/下单/退款），分别给出净GMV、转化率（打开率、点击率、下单率）、以及按“首次接触”和“最后接触”两种口径的归因差异。同时要求对同一用户的跨会话重复触达进行去重，避免把多次行为重复算在同一个变体头上；并把“活动”和“流程”放在一张统一的明细里，但要能区分两者。最后，把这些指标按周粒度滚动汇总，并标注每周相对于该变体过去四周的中位数的偏差幅度，这样我能一眼看到哪些变体在放大或拖累整体收入。", "rubric": "# Klaviyo 归因清单与变体度量 评估标准\n\n## [总分 | 37 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（30 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（30 分）\n\n### 标准 1.1（最高 27 分）：功能点覆盖\n- 路径 1.1.A（27 分）：**完整覆盖**\n  - 小标准：统一“活动/流程”明细（以类型区分）【1 分｜判定条件】存在区分类型的触达字段：session_touch_type ∈ {'campaign','flow'}，且联动 last_touch_campaign_id / last_touch_flow_id。\n  - 小标准：变体维度标识【1 分｜判定条件】variation_id 在事件与聚合模型中持续存在并作为分组键。\n  - 小标准：展示（email impression）计数【1 分｜判定条件】count_received_email。\n  - 小标准：打开计数【1 分｜判定条件】count_opened_email。\n  - 小标准：点击计数【1 分｜判定条件】count_clicked_email。\n  - 小标准：下单计数【1 分｜判定条件】count_placed_order。\n  - 小标准：退款计数【1 分｜判定条件】count_refunded_order。\n  - 小标准：商品下单（ordered product）计数【1 分｜判定条件】count_ordered_product。\n  - 小标准：净 GMV（touch 级别）【1 分｜判定条件】gmv_net。\n  - 小标准：毛 GMV（touch 级别）【1 分｜判定条件】gmv_gross。\n  - 小标准：事件级净收入【1 分｜判定条件】event_net_revenue。\n  - 小标准：打开率（opened/received）【1 分｜判定条件】email_open_rate。\n  - 小标准：点击至打开率（clicked/opened）【1 分｜判定条件】email_click_to_open_rate。\n  - 小标准：下单率（site→order）【1 分｜判定条件】site_to_order_rate。\n  - 小标准：商品浏览至下单率【1 分｜判定条件】product_view_to_order_rate。\n  - 小标准：最后接触归因标识【1 分｜判定条件】last_touch_id / session_touch_type 存在且与子事件归因解析对齐。\n  - 小标准：最后接触归因到“活动/流程”ID【1 分｜判定条件】last_touch_campaign_id / last_touch_flow_id。\n  - 小标准：人-触达-变体分组去重【1 分｜判定条件】klaviyo__person_campaign_flow 粒度为 person_id × last_touch_campaign_id/flow_id × variation_id × source_relation。\n  - 小标准：去重唯一人数（touch 级别）【1 分｜判定条件】total_count_unique_people 与 unique_count_* 系列存在。\n  - 小标准：日粒度滚动明细【1 分｜判定条件】klaviyo__events 含 day_* 系列。\n  - 小标准：统一明细表承载“活动/流程”两类【1 分｜判定条件】同一明细模型包含 last_touch_campaign_id 与 last_touch_flow_id 字段。\n  - 小标准：90 天窗口【1 分｜判定条件】存在明确 90 天过滤或窗口字段/逻辑（gold 口径要求）；若缺失则 0 分（当前 data_contract 未体现固定 90 天窗口）。\n  - 小标准：周粒度汇总（按变体）【1 分｜判定条件】存在按周聚合的指标输出（gold 口径要求）；若缺失则 0 分（当前为日粒度及跨度指标）。\n  - 小标准：4 周中位数偏差标注【1 分｜判定条件】存在“相对过去四周中位数的偏差幅度”字段或等价列（gold 口径要求）；若缺失则 0 分。\n  - 小标准：首次接触 vs 最后接触两口径对比【1 分｜判定条件】存在“首次接触”归因标识或字段，以便与“最后接触”对比（gold 口径要求）；若缺失则 0 分（当前仅明确 last_touch_*）。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：**口径清晰**\n  - 小标准：每个输出项至少包含两类要素（按谁/时间范围或对齐/统计规则）【1 分｜判定条件】例如 klaviyo__events 提供 person_id + occurred_on + 指标；touch 级模型提供 last_touch_* + variation_id + 指标。\n  - 小标准：缺失/异常/重复/负值/未来时间的默认处理口径【1 分｜判定条件】数值负向/正向拆分与净额；分母为 0 时比率为 NULL；价格字段非负校验。\n  - 小标准：跨输出项口径一致【1 分｜判定条件】email_open_rate、email_click_to_open_rate、product_view_to_order_rate、site_to_order_rate 在中间层和集市层定义一致。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：**模型最小四要素**\n  - 小标准：有上游依赖（source_models）【1 分｜判定条件】各层遵循依赖声明。\n  - 小标准：有字段定义+类型（columns）【1 分｜判定条件】各模型 columns 含 data_type。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：**可构建依赖图**\n  - 小标准：无悬空引用【1 分｜判定条件】引用的上游模型均在合同中定义。\n  - 小标准：外部来源有明确指向与边界说明【1 分｜判定条件】staging 仅引用 raw.*，且 source_table 明确。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 小标准：缩写/命名规则一致【1 分｜判定条件】email_open_rate / email_click_to_open_rate 命名一致性。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 小标准：分层职责清晰（原始/中间/集市）【1 分｜判定条件】raw→staging→intermediate→marts 明确且各司其职。\n- 小标准：避免“上帝表”，模块内聚，依赖清晰【1 分｜判定条件】事件、活动、流程、人物分表职责清晰，person-touch 单独模型。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。"}
{"id": "dacomp-de-arch-021-zh", "question": "过去六个月，我们的净MRR看起来在增长，但运营反馈“赚的多不一定是产品卖得好”，因为有些客户的账单里运费/税占比很高，同时订阅已经进入最后一个扣款周期，续费风险大。请按“客户×月份”做一份收入质量画像：拆分行项目、运费、税的占比，叠加订阅扣款进度，定位“净MRR高但距离到期扣款次数≤1且运费占比≥30%”的客户月份，并补充是否新客户、平均订单额作为排序维度，形成一份可以直接用于续费干预与物流优化的清单。", "rubric": "# 净MRR收入质量画像 评估标准\n\n## [总分 | 24 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（17 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（17 分）\n\n### 标准 1.1（最高 14 分）：功能点覆盖\n- 路径 1.1.A（14 分）：完整覆盖\n  - 1.1.A.1 小标准【1 分｜判定条件】存在“客户×月份”粒度的模型，必须同时包含 `customer_id` 与 `date_month` 两列，grain 明确为 *per customer per month*；仅存在日粒度或周粒度不可得分。\n  - 1.1.A.2 小标准【1 分｜判定条件】存在“净MRR”月度口径列（如 `calculated_net_order_mrr`），必须可作为筛选与排序指标，且字段需在 `columns` 中定义。\n  - 1.1.A.3 小标准【1 分｜判定条件】存在“行项目/运费/税”按“扣款（charge）组成项”的统一明细，必须具备 `line_item_type` 与 `amount` 两列，用于拆分占比。\n  - 1.1.A.4 小标准【1 分｜判定条件】`line_item_type` 至少覆盖 “charge line/商品行”、“shipping/运费”、“tax/税” 三类标识，缺失任一类即为 0 分。\n  - 1.1.A.5 小标准【1 分｜判定条件】具备每笔订单的运费金额与订单行汇总，必须同时存在 `total_shipping` 与 `order_line_item_total`，并可计算 `calculated_order_total_price`。\n  - 1.1.A.6 小标准【1 分｜判定条件】具备税额来源字段以支持“税占比”，必须存在 `line_item_type='tax'` 对应 `amount`；缺失即为 0 分。\n  - 1.1.A.7 小标准【1 分｜判定条件】具备“行项目金额”来源字段以支持“行项目占比”，如 `line_item_type='charge line'` 对应 `amount`，或订单级 `order_line_item_total`。\n  - 1.1.A.8 小标准【1 分｜判定条件】具备“订阅扣款进度”相关列，必须存在 `charges_until_expiration` 字段。\n  - 1.1.A.9 小标准【1 分｜判定条件】订阅模型必须含 `customer_id` 主键字段，可关联投射到“客户×月份”视图。\n  - 1.1.A.10 小标准【1 分｜判定条件】订阅进度必须包含成功/排队扣款计数及标准化扣款间隔天数，至少提供 `count_successful_charges`、`count_queued_charges`、`charge_interval_frequency_days` 中任意两项。\n  - 1.1.A.11 小标准【1 分｜判定条件】存在“是否新客户”标志字段，如 `is_new_customer`，必须在客户详情模型中定义。\n  - 1.1.A.12 小标准【1 分｜判定条件】存在“平均订单额”字段，如 `avg_order_amount`，必须在订单或客户模型的 `columns` 中定义。\n  - 1.1.A.13 小标准【1 分｜判定条件】存在“客户×日”与“周/月/年”派生时间锚点，必须至少同时提供 `date_day` 与 `date_month`，并保证二者有映射逻辑。\n  - 1.1.A.14 小标准【1 分｜判定条件】“已实现（realized）订单口径”的日聚合与月聚合必须上下贯通，要求 `calculated_order_total_price_realized` 可汇总为 `calculated_net_order_mrr`。\n\n- 路径 1.1.B（6 分）：基础覆盖（当无法达到完整覆盖时作为降级评分）\n  - 1.1.B.1 小标准【1 分｜判定条件】实体类覆盖：同时具备 `customer_id` 与 `subscription_id` 至少其中之一，且能通过 join 进行关联。\n  - 1.1.B.2 小标准【1 分｜判定条件】时间类覆盖：必须具备 `date_month` 或等价的月度时间锚点。\n  - 1.1.B.3 小标准【1 分｜判定条件】聚合类覆盖：存在月度金额聚合字段，如 `calculated_net_order_mrr`。\n  - 1.1.B.4 小标准【1 分｜判定条件】组成项覆盖：至少具备 `shipping` 或 `tax` 金额来源字段。\n  - 1.1.B.5 小标准【1 分｜判定条件】风险覆盖：至少具备 `subscription_status` 或 `charges_until_expiration`。\n  - 1.1.B.6 小标准【1 分｜判定条件】用户特征覆盖：至少具备 `is_new_customer` 或 `avg_order_amount`。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】每个输出项必须至少同时包含“主体（如 customer_id）+ 时间范围/对齐（如 date_month）+ 统计口径（如 calculated_net_order_mrr）”中的两类要素。\n  - 1.2.A.2 小标准【1 分｜判定条件】必须对缺失/异常值有默认处理（如金额缺失按 0、退款默认 0、负值过滤），并且在相关模型的 `business_logic` 或 `columns` 中可溯源。\n  - 1.2.A.3 小标准【1 分｜判定条件】跨输出项口径必须一致：如订单总额定义为“行项目合计 + 运费”，且“日→月”聚合逻辑需严格一致。\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】必须存在模型标识（`name`），且与业务语义匹配；必须存在上游依赖（`source_models`），且符合分层（staging→intermediate→marts）。\n  - 2.1.A.2 小标准【1 分｜判定条件】必须定义字段及其数据类型（`columns.data_type`），若缺失类型信息则为 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】依赖图必须无悬空引用，所有引用的上游模型名必须可解析。\n  - 2.2.A.2 小标准【1 分｜判定条件】外部来源有明确边界说明：staging 仅指向 raw，intermediate 仅指向 staging，marts 仅指向 intermediate。\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n  - 3.1.1 小标准【1 分｜判定条件】名称必须语义化，采用领域前缀与层次前缀（如 `stg_/int_/recharge__`），命名规则一致（snake_case，小写，双下划线主题命名），不得出现黑话或歧义。\n\n### 标准 3.2（最高 2 分）：分层合理\n  - 3.2.1 小标准【1 分｜判定条件】业务口径必须集中在对应模型描述或 business_logic 中，不得散落冲突（如 realized/订阅进度口径需集中定义）。\n  - 3.2.2 小标准【1 分｜判定条件】避免“上帝表”，要求模块内聚、依赖清晰（按功能拆分为 billing_history / charge_line_item_history / customer / subscription / mrr 等），不允许单一模型承载过多职责。\n\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-022-zh", "question": "过去两年里，我们希望在不增加发帖总量的前提下，通过调整每月的内容类型占比来提升各平台的点击率（至少+15%）且不牺牲新账号的12周留存。请给出按平台、按月的“建议内容组合”（例如 Twitter：Text 40% / Media 60%），对应的发帖频次上限，以及该组合的预期 CTR 与互动率；要求优先选择当月活跃账号数更高、日常表现更稳定的组合。", "rubric": "# 社交媒体内容组合建议评估标准（严格版）\n\n## [总分 | 22 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（16 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（2 分）\n\n\n## 需求 I：业务对齐与语义准确性（16 分）\n\n### 标准 1.1（最高 12 分）：功能点覆盖\n- 路径 1.1.A（12 分）：完整覆盖\n  - 1.1.A.1 小标准【1 分｜判定条件】平台维度 `platform` 必须存在，且在所有模型中保持一致；如出现拼写差异或缺失，则为 0 分。\n  - 1.1.A.2 小标准【1 分｜判定条件】存在月份粒度 `month` 字段，用于 CTR 汇总，且明确声明 grain = per platform per month。\n  - 1.1.A.3 小标准【1 分｜判定条件】存在内容类型维度 `content_type` 或 `content_format`，用于组合占比评估；必须可枚举映射。\n  - 1.1.A.4 小标准【1 分｜判定条件】存在点击量 `clicks`，必须为非负整数，并在不同平台间口径统一。\n  - 1.1.A.5 小标准【1 分｜判定条件】存在展示量 `impressions`，必须为非负，且 tests 中有范围校验。\n  - 1.1.A.6 小标准【1 分｜判定条件】存在 CTR（`ctr`），在月/日聚合模型均提供，且必须有测试约束范围 0–1。\n  - 1.1.A.7 小标准【1 分｜判定条件】存在互动率（`engagement_rate` 或 `calculated_engagement_rate`），并必须有 0–1 测试。\n  - 1.1.A.8 小标准【1 分｜判定条件】存在发帖频次 `posts_count`，按平台 × 月/日 × 内容类型输出。\n  - 1.1.A.9 小标准【1 分｜判定条件】存在活跃账号数 `active_accounts_count`，按平台 × 月/日 × 内容类型输出。\n  - 1.1.A.10 小标准【1 分｜判定条件】存在留存指标 `retention_rate`、`cohort_pages`、`retained_pages`，并含 `week_offset ≤ 12`，用于 12 周留存评估。\n  - 1.1.A.11 小标准【1 分｜判定条件】存在稳定性/质量代理指标（如 `daily_platform_rank` / `platform_lifetime_rank` / `content_quality_score`），且必须能用于“日常表现更稳定”的优先选择。\n  - 1.1.A.12 小标准【1 分｜判定条件】输出建议组合时，必须保证平台×月×内容类型三个维度齐全（platform, month, content_type），缺失任一维度即为 0 分。\n\n### 标准 1.2（最高 4 分）：指标/特征口径\n- 路径 1.2.A（4 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】每个输出项至少同时包含“主体（如 platform/content_type）+ 时间范围（如 month/day）+ 统计口径（如 ctr、engagement_rate）”中的两类要素。\n  - 1.2.A.2 小标准【1 分｜判定条件】对缺失/异常/重复/负值/未来时间必须有默认处理，且通过 tests 明示边界（如非空、范围 0–1、非负）。\n  - 1.2.A.3 小标准【1 分｜判定条件】跨输出项口径必须一致：点击/展示/互动率在日/月/平台维度定义一致，不能出现互相矛盾。\n  - 1.2.A.4 小标准【1 分｜判定条件】内容类型/格式在不同平台必须可映射，且能够用于组合评估，若仅存在部分平台定义则为 0 分。\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】每个模型必须有唯一标识 `name`，不可缺失或重复。\n  - 2.1.A.2 小标准【1 分｜判定条件】必须声明上游依赖 `source_models`，否则为 0 分。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】依赖图无循环/自引用，遵循 staging → intermediate → marts；若存在自循环即为 0 分。\n  - 2.2.A.2 小标准【1 分｜判定条件】外部来源边界必须明确：staging 仅指向 raw，intermediate 仅指向 staging，marts 仅指向 intermediate。\n\n## 需求 III：设计质量（2 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 小标准【1 分｜判定条件】名称必须语义化，采用统一规则，避免黑话/歧义（如 platform/page_id/post_id/created_timestamp/ctr/engagement_rate 等），不允许缩写混乱。\n\n### 标准 3.2（最高 1 分）：分层合理\n- 3.2.1 小标准【1 分｜判定条件】分层职责必须清晰：原始/中间/集市层各司其职；业务口径集中在中间层或 mart 层，避免“上帝表”；依赖必须单向（staging→intermediate→marts）。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-023-zh", "question": "我们最近的投放里，同一个广告素材被挂到了不同的落地页域名（以及不同的 UTM campaign 标识）。我想搞清楚一件很具体的事：在过去两个月里，哪些“域名 × UTM campaign”组合能在多个 campaign 上稳定拿到更高的转化价值效率（ROAS）同时不牺牲点击率（CTR）？请按周看趋势，并且别只看顶级 ROAS，要排除那些偶发高值、数据量太小的情况，给出在至少三个不同 campaign 中都表现稳定的组合名单及其波动区间。", "rubric": "# TikTok 广告「域名 × UTM campaign」周度 ROAS 与 CTR 稳定性分析 评估标准（严格版）\n\n## [总分 | 28 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（21 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（21 分）\n\n### 标准 1.1（最高 18 分）：功能点覆盖\n- 路径 1.1.A（18 分）：完整覆盖（逐项核对 gold.yaml 所体现的业务对象、指标、维度、粒度）\n  - 1.1.A.1 小标准【1 分｜判定条件】存在域名维度 `url_host`，在 URL 报表模型中必须提供且非空。\n  - 1.1.A.2 小标准【1 分｜判定条件】存在 UTM campaign 维度 `utm_campaign`，在 URL 报表模型中必须提供且非空。\n  - 1.1.A.3 小标准【1 分｜判定条件】存在 `base_url`，并带有 not_null 测试，缺失即为 0 分。\n  - 1.1.A.4 小标准【1 分｜判定条件】campaign 维度齐备，`campaign_id` 与 `campaign_name` 均必须存在。\n  - 1.1.A.5 小标准【1 分｜判定条件】ad_group 维度齐备，`ad_group_id` 与 `ad_group_name` 均必须存在。\n  - 1.1.A.6 小标准【1 分｜判定条件】ad 维度齐备，`ad_id` 与 `ad_name` 均必须存在。\n  - 1.1.A.7 小标准【1 分｜判定条件】日期粒度 `date_day` 存在且具备 not_null 测试，可用于周度聚合。\n  - 1.1.A.8 小标准【1 分｜判定条件】CTR 输出口径 `daily_ctr` 存在，并具 BETWEEN 0 AND 100 测试，且必须统一为百分比口径。\n  - 1.1.A.9 小标准【1 分｜判定条件】ROAS 计算所需字段齐备，必须同时存在 `spend` 与 `total_conversion_value`（或替代字段如 total_purchase_value/total_sales_lead_value）。\n  - 1.1.A.10 小标准【1 分｜判定条件】点击与展现字段齐备，必须存在 `clicks` 与 `impressions`。\n  - 1.1.A.11 小标准【1 分｜判定条件】样本规模字段具非负测试：`impressions >= 0` 且 `clicks >= 0`。\n  - 1.1.A.12 小标准【1 分｜判定条件】花费字段具非负测试：`spend >= 0`。\n  - 1.1.A.13 小标准【1 分｜判定条件】转化价值字段具非负测试：`total_conversion_value >= 0`。\n  - 1.1.A.14 小标准【1 分｜判定条件】登陆页 URL 必须存在约束，URL 模型仅包含 `landing_page_url` 非空记录。\n  - 1.1.A.15 小标准【1 分｜判定条件】创意标识字段存在，可用于判定“同素材”（如 `creative_material_mode` 或 `ad_name`）。\n  - 1.1.A.16 小标准【1 分｜判定条件】模型层次为 URL 明细，必须包含 `url_path` 与 `utm_*` 字段。\n  - 1.1.A.17 小标准【1 分｜判定条件】模型粒度必须包含 `campaign_id`，保证可跨 campaign 评估稳定性。\n  - 1.1.A.18 小标准【1 分｜判定条件】必须支持按周观察趋势，日度指标齐全且可聚合为周度。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】每个输出项必须同时包含主体维度（如 campaign/ad_group/ad）与时间维度（date_day）。\n  - 1.2.A.2 小标准【1 分｜判定条件】缺失/异常值处理必须明确（如默认 0、类型安全），并在中间层有说明或测试。\n  - 1.2.A.3 小标准【1 分｜判定条件】跨模型指标口径必须一致（如 daily_ctr、CPC、CPM 的定义边界一致），并有边界测试。\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】有上游依赖 `source_models`，且引用必须遵循层次规则。\n  - 2.1.A.2 小标准【1 分｜判定条件】有字段定义与类型，`columns` 必须声明 data_type。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】依赖关系无循环/自引用，严格遵循不可跨层/同层依赖。\n  - 2.2.A.2 小标准【1 分｜判定条件】外部来源必须有边界说明，staging 仅引用 raw，intermediate 仅引用 staging，marts 仅引用 intermediate。\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 小标准【1 分｜判定条件】同一概念不混用多口径，如 CTR 必须统一按百分比定义，并设定边界测试。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 小标准【1 分｜判定条件】分层职责清晰（原始/中间/集市），在 modeling_spec 中有明确定义。\n- 3.2.2 小标准【1 分｜判定条件】避免“上帝表”，模型需保持内聚，依赖单向清晰（不跨层/不同行引用）。\n\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-024-zh", "question": "我们最近在美国市场推进 A2P 合规，但我想看一个更“落地”的对账视图：按账号、按月份，把所有外发短信在“使用了已注册的 Messaging Service”和“未注册的 Messaging Service”两类里拆开，对比三件事——1) 投递表现：delivered rate、failed/undelivered 占比；2) 量：外发消息量与平均分段数；3) 成本效率：当月短信总花费（按 price_unit），以及每条投递成功消息的平均成本。特别是要能看出同一账号在注册前后、跨月份的趋势变化，方便我们评估 A2P 合规到底有没有提升投递和降低失败导致的重试/成本浪费。", "rubric": "# Twilio A2P 合规对账视图 评估标准\n\n## [总分 | 29 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（22 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（22 分）\n\n### 标准 1.1（最高 18 分）：功能点覆盖\n- 路径 1.1.A（18 分）：完整覆盖\n  - 1.1.A.1 小标准【1 分｜判定条件】存在 account_id，可按账号汇总。必须出现在输出模型且 not_null（如 twilio__account_overview.account_id）。\n  - 1.1.A.2 小标准【1 分｜判定条件】存在 date_month，可按月份对齐，必须为 YYYY-MM 格式，且带 not_null 测试。\n  - 1.1.A.3 小标准【1 分｜判定条件】存在 direction，可筛选外发（outbound），字段值范围需有限集（outbound/inbound）。\n  - 1.1.A.4 小标准【1 分｜判定条件】存在 messaging_service_id，可识别是否使用 Messaging Service，字段需可关联。\n  - 1.1.A.5 小标准【1 分｜判定条件】存在 us_app_to_person_registered，明确区分“已注册/未注册”，不得缺失。\n  - 1.1.A.6 小标准【1 分｜判定条件】存在 delivered 指标或计数，需统一来源（status=delivered 或 total_delivered_messages）。\n  - 1.1.A.7 小标准【1 分｜判定条件】存在 failed 指标或计数，定义一致，不得与 undelivered 混用。\n  - 1.1.A.8 小标准【1 分｜判定条件】存在 undelivered 指标或计数，定义明确，独立于 failed。\n  - 1.1.A.9 小标准【1 分｜判定条件】存在 sent 指标或计数，用于投递率分母，定义必须与 total_sent_messages 保持一致。\n  - 1.1.A.10 小标准【1 分｜判定条件】存在外发消息量指标，可由 direction=outbound 或 total_outbound_messages 提供。\n  - 1.1.A.11 小标准【1 分｜判定条件】存在 num_segments 或平均分段口径，需保证 ≥1 且为整数。\n  - 1.1.A.12 小标准【1 分｜判定条件】存在 price（短信价格），字段必须非空且数值 ≥0。\n  - 1.1.A.13 小标准【1 分｜判定条件】存在 price_unit（价格币种/单位），在所有模型层级一致保留。\n  - 1.1.A.14 小标准【1 分｜判定条件】存在当月短信总花费口径，可直接聚合得到，且与 price/price_unit 一致。\n  - 1.1.A.15 小标准【1 分｜判定条件】支持计算“每条投递成功消息的平均成本”，必须同时具备 delivered 计数与价格字段。\n  - 1.1.A.16 小标准【1 分｜判定条件】支持按“已注册/未注册 Messaging Service”进行拆分，需包含 account_id、date_month、us_app_to_person_registered，并能筛选 outbound。\n  - 1.1.A.17 小标准【1 分｜判定条件】支持跨月份趋势分析，必须保证 account_id + date_month 粒度连续可比。\n  - 1.1.A.18 小标准【1 分｜判定条件】账号上下文信息可关联展示，必须存在 account_name/account_status/account_type。\n\n- 路径 1.1.B（3 分）：基础覆盖（二选一评分路径，不与 1.1.A 累加）\n  - 1.1.B.1 小标准【1 分｜判定条件】实体类要素至少覆盖账号与消息服务之一（如 account_id、messaging_service_id）。\n  - 1.1.B.2 小标准【1 分｜判定条件】时间类要素必须包含月粒度（date_month）。\n  - 1.1.B.3 小标准【1 分｜判定条件】聚合类要素至少覆盖一项状态计数或费用（如 delivered/failed/undelivered/sent/total_messages_spend/price）。\n\n\n\n### 标准 1.2（最高 4 分）：指标/特征口径\n- 路径 1.2.A（4 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】每个输出项必须至少包含两类要素（按谁 + 时间 或 按谁 + 统计规则），例如 account_id + date_month + total_sent_messages。\n  - 1.2.A.2 小标准【1 分｜判定条件】对缺失/不存在的状态有默认处理规则，明确“若上游不存在则置 0”。\n  - 1.2.A.3 小标准【1 分｜判定条件】跨输出的币种口径一致，price_unit 在消息级与汇总级必须一致。\n  - 1.2.A.4 小标准【1 分｜判定条件】投递率/失败率分母口径一致，sent/total_messages 定义必须全局统一。\n\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】模型必须具备唯一标识（name）。\n  - 2.1.A.2 小标准【1 分｜判定条件】模型必须定义字段+类型（columns 含 data_type）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】无悬空引用，所有引用的模型/列均可在 contract 中解析。\n  - 2.2.A.2 小标准【1 分｜判定条件】外部来源有明确边界说明，staging 仅指向 raw，intermediate 仅指向 staging，marts 仅指向 intermediate。\n\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 小标准【1 分｜判定条件】模型与字段命名语义化，避免黑话/歧义，采用 twilio__ 前缀 + 下划线命名规范。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 小标准【1 分｜判定条件】业务口径集中，指标统一定义在聚合模型中，不分散到明细层。\n- 3.2.2 小标准【1 分｜判定条件】避免“上帝表”，保持模型内聚、依赖清晰，职责单一。\n\n\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-025-zh", "question": "过去两个月里，哪些 Twilio 账户在不改变流量结构（各 messaging service 的占比基本稳定）的情况下，单条“送达消息”的综合成本（消息花费 + usage 花费，USD）出现了超过 15% 的上升？请给出问题账户清单，并支持向下钻取到 messaging_service 和 phone_number 两层：分别指出是送达率下降、服务费率结构变化，还是 usage 花费抬升导致的成本上行；同时产出针对性的路由/号码整顿建议（应收敛或迁移的服务/号码及预期节省）。", "rubric": "# Twilio 两个月稳定占比下“送达消息综合成本上行”评估标准\n\n## [总分 | 35 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（28 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n\n## 需求 I：业务对齐与语义准确性（28 分）\n\n### 标准 1.1（最高 25 分）：功能点覆盖\n- 路径 1.1.A（25 分）：完整覆盖\n  - 1.1.A.1 小标准【1 分｜判定条件】存在 twilio__account_overview.account_id（not_null），主键非空且唯一。\n  - 1.1.A.2 小标准【1 分｜判定条件】存在 account_name/account_status/account_type 任一列，账号属性信息可展示。\n  - 1.1.A.3 小标准【1 分｜判定条件】存在 date_month（not_null），格式 YYYY-MM，保证月度对齐。\n  - 1.1.A.4 小标准【1 分｜判定条件】存在 date_week（not_null），范围 1–53。\n  - 1.1.A.5 小标准【1 分｜判定条件】存在 date_day（not_null），格式 YYYY-MM-DD。\n  - 1.1.A.6 小标准【1 分｜判定条件】存在 price_unit（not_null），在模型间保持一致。\n  - 1.1.A.7 小标准【1 分｜判定条件】存在 total_outbound_messages，≥0 测试。\n  - 1.1.A.8 小标准【1 分｜判定条件】存在 total_inbound_messages，≥0 测试。\n  - 1.1.A.9 小标准【1 分｜判定条件】存在 total_sent_messages，not_null，支持作为投递率分母。\n  - 1.1.A.10 小标准【1 分｜判定条件】存在 total_delivered_messages，not_null，支持作为投递率分子。\n  - 1.1.A.11 小标准【1 分｜判定条件】存在 total_failed_messages 或 total_undelivered_messages 任一列，字段非负。\n  - 1.1.A.12 小标准【1 分｜判定条件】存在 total_messages（≥0 测试），与 sent+delivered+failed 一致。\n  - 1.1.A.13 小标准【1 分｜判定条件】存在 total_messages_spend（消息花费），单位与 price_unit 保持一致。\n  - 1.1.A.14 小标准【1 分｜判定条件】存在 total_account_spend（usage 花费），与 total_messages_spend 可区分。\n  - 1.1.A.15 小标准【1 分｜判定条件】存在 messaging_service_id，支持服务维度下钻。\n  - 1.1.A.16 小标准【1 分｜判定条件】存在 friendly_name，提供服务可读名称。\n  - 1.1.A.17 小标准【1 分｜判定条件】存在 message_enhanced.date_month，用于服务/时间组合。\n  - 1.1.A.18 小标准【1 分｜判定条件】存在 status（delivered/failed/undelivered/sent），定义必须与全局一致。\n  - 1.1.A.19 小标准【1 分｜判定条件】存在 price 与 price_unit（消息单价与币种），均非空且 price ≥ 0。\n  - 1.1.A.20 小标准【1 分｜判定条件】存在 num_segments 或 num_media 任一列，≥1 且整型。\n  - 1.1.A.21 小标准【1 分｜判定条件】存在 int_twilio__messages.phone_number，方向统一后可追溯。\n  - 1.1.A.22 小标准【1 分｜判定条件】存在 number_overview.phone_number（not_null）。\n  - 1.1.A.23 小标准【1 分｜判定条件】存在 number_overview.total_messages，≥0 测试。\n  - 1.1.A.24 小标准【1 分｜判定条件】存在 number_overview.total_spend，≥0 且与 total_messages_spend 保持单位一致。\n  - 1.1.A.25 小标准【1 分｜判定条件】存在 int_twilio__usage_record_daily.start_date 与 daily_price，保证 usage 日粒度支出与月度对齐。\n\n\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】每个输出项至少包含“按谁（实体）+时间粒度”两类要素，例如 account_id + date_month。\n  - 1.2.A.2 小标准【1 分｜判定条件】对缺失/异常/重复/负值/未来时间均有默认处理或 tests（如 not_null、≥0、唯一性）。\n  - 1.2.A.3 小标准【1 分｜判定条件】跨输出口径一致：price 与 price_unit 定义不矛盾，status 枚举集一致，月度与日度聚合可对齐。\n\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】存在上游依赖（source_models），必须列明。\n  - 2.1.A.2 小标准【1 分｜判定条件】存在字段定义与类型（columns 含 data_type）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】无循环/自引用，依赖必须单向（staging→intermediate→marts）。\n  - 2.2.A.2 小标准【1 分｜判定条件】外部来源有明确边界说明（raw→staging），不可跨层混用。\n\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 小标准【1 分｜判定条件】缩写与命名规则一致（如 date_day/date_week/date_month；price_unit 保持统一）。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 小标准【1 分｜判定条件】分层职责清晰：staging（标准化）、intermediate（业务整形）、marts（分析视图）。\n- 3.2.2 小标准【1 分｜判定条件】避免“上帝表”，模型职责单一，依赖链路清晰，不跨层拼接。\n\n\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-026-zh", "question": "过去两个月，我们的 Twitter 广告点击率看着还不错，但下单收入（我们用 total_conversions_sale_amount 代表）一直拉不起来。请你按“创意 × 落地页/UTM”维度，把不同投放位（placement）下的表现拆开，找出这样一类问题：某些推广推文在 account/campaign 层面点击多、花费高，但导向的首个落地页（或特定 utm_campaign/utm_medium 组合）转化和 ROAS 明显低于同账户同期间平均值；进一步按日期查看是否集中在某些时间段或国家/地区。最后给出一个可执行名单：涉及的 promoted_tweet_id、tweet_text、base_url/utm 组合、对应的线索（例如 CPC/CTR 正常但 CVR/ROAS 显著偏低），便于市场同学先做落地页与素材排查。", "rubric": "# Twitter 广告“创意 × 落地页/UTM × 投放位 × 地域”评估标准（严格版）\n\n## [总分 | 27 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（20 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（20 分）\n\n### 标准 1.1（最高 17 分）：功能点覆盖\n- 路径 1.1.A（17 分）：完整覆盖\n  - 1.1.A.1 小标准【1 分｜判定条件】：存在“按天 × 账户 × 投放位”的账户报表模型，含 clicks、impressions、spend、url_clicks、total_conversions、total_conversions_sale_amount；grain = date_day, account_id, placement，字段均 not_null 且 ≥0。\n  - 1.1.A.2 小标准【1 分｜判定条件】：存在“按天 × 账户 × 活动 × 投放位”的活动报表模型；grain = date_day, account_id, campaign_id, placement。\n  - 1.1.A.3 小标准【1 分｜判定条件】：存在“按天 × 账户 × 活动 × 国家 × 投放位”的国家报表模型；含 country，值为 ISO 两位码。\n  - 1.1.A.4 小标准【1 分｜判定条件】：存在“按天 × 账户 × 活动 × 国家 × 地区 × 投放位”的地区报表模型；含 country, region，且 region 非空。\n  - 1.1.A.5 小标准【1 分｜判定条件】：存在“按天 × 账户 × 推广推文 × 投放位”的创意报表模型（marts.twitter_ads__promoted_tweet_report），粒度声明完整。\n  - 1.1.A.6 小标准【1 分｜判定条件】：存在 URL 报表模型（marts.twitter_ads__url_report），含 base_url、url_host、url_path、utm_source、utm_medium、utm_campaign、utm_content、utm_term；字段非空。\n  - 1.1.A.7 小标准【1 分｜判定条件】：tweet 文本可用于输出（tweet_full_text/tweet_name），且与 promoted_tweet_id 建立主键关联。\n  - 1.1.A.8 小标准【1 分｜判定条件】：placement 维度在所有相关报表中均存在，且为 grain 一部分；枚举值完整。\n  - 1.1.A.9 小标准【1 分｜判定条件】：支持“创意 × 首个落地页（base_url）/UTM 组合”的拆解（依赖 int_twitter_ads__tweet_url_first 与 url_report），组合列 not_null。\n  - 1.1.A.10 小标准【1 分｜判定条件】：可计算 ROAS（由 total_conversions_sale_amount 与 spend 定义，均 ≥0）。\n  - 1.1.A.11 小标准【1 分｜判定条件】：可计算 CTR、CPC、CVR（clicks、impressions、spend、url_clicks、total_conversions 非负约束，CTR=clicks/impressions BETWEEN 0 AND 1）。\n  - 1.1.A.12 小标准【1 分｜判定条件】：支持同账户同期间对比（account_id + date_day 粒度），不限制单账户。\n  - 1.1.A.13 小标准【1 分｜判定条件】：支持活动层面筛查（活动报表含 clicks、spend、total_conversions、ROAS，可与账户聚合对比）。\n  - 1.1.A.14 小标准【1 分｜判定条件】：支持按日期观察集中度（所有报表含 date_day，not_null）。\n  - 1.1.A.15 小标准【1 分｜判定条件】：支持按国家/地区观察集中度（campaign_country 与 campaign_region 报表含 country、region，非空）。\n  - 1.1.A.16 小标准【1 分｜判定条件】：可输出“可执行名单”：promoted_tweet_id、tweet_text、base_url/UTM 组合、placement、及关键指标字段；字段均 not_null。\n  - 1.1.A.17 小标准【1 分｜判定条件】：存在上游维表（accounts/campaigns/line_items/promoted_tweets/tweets），grain 明确且外键完整。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】：每个输出至少包含“按谁（实体标识）+ 时间（日）或投放位对齐 + 聚合口径”两类要素，例如 date_day + account_id/campaign_id/promoted_tweet_id + placement。\n  - 1.2.A.2 小标准【1 分｜判定条件】：所有指标具非负性测试（clicks/impressions/spend/url_clicks/total_conversions/total_conversions_sale_amount ≥0）；关键主键（account_id/campaign_id/promoted_tweet_id/base_url）均 not_null。\n  - 1.2.A.3 小标准【1 分｜判定条件】：跨模型口径一致：spend 与 spend_micro 单位一致；total_conversions 与 total_conversions_sale_amount 定义一致；CTR/ROAS 边界明确。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】：每个模型有上游依赖（source_models），引用 staging 或 intermediate。\n  - 2.1.A.2 小标准【1 分｜判定条件】：每个模型定义字段+类型（columns 含 data_type），并声明 tests（not_null、非负、范围校验）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】：无悬空引用（source_models 必须在同一项目存在）。\n  - 2.2.A.2 小标准【1 分｜判定条件】：遵循分层依赖（staging→intermediate→marts 单向），无跨层或同层循环。\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 小标准【1 分｜判定条件】：指标、维度命名与业务含义一致；同一概念不混用多口径（如 spend/spend_micro 单位明确，CTR 一律为 clicks/impressions ×100%）。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 小标准【1 分｜判定条件】：分层职责清晰（staging 清洗；intermediate 业务口径/维表；marts 分析报表输出）。\n- 3.2.2 小标准【1 分｜判定条件】：避免“上帝表”，模型内聚，依赖链清晰；URL 相关口径集中在 int_twitter_ads__tweet_url_first 与 twitter_ads__url_report。\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-027-zh", "question": "按“项目”维度看，今年Q3 的净利润相比 Q2 下滑了不少。请给我一个按项目的月度净额趋势，并把每个下滑超过 15% 的项目拆解到“导致下滑的前 10 个发票行项目”：这些行项目在各自发票中的贡献占比、对应的科目（账户）类型，以及关联的部门/地区标签。同时判断费用是否集中在少数科目（比如市场、差旅等），是否存在折扣或税率变化引发毛利侵蚀，最后为每个项目给出最可能的下滑驱动因素清单。", "rubric": "# 项目月度净额趋势与下滑驱动分析 评估标准\n\n## [总分 | 23 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（16 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n\n\n## 需求 I：业务对齐与语义准确性（16 分）\n\n### 标准 1.1（最高 13 分）：功能点覆盖\n- 路径 1.1.A（13 分）：完整覆盖  \n  - 1.1.A.1 项目维度（月度净额趋势）【1 分｜xero__profit_and_loss_report 的 grain 含 report_month + project，存在 net_amount，not_null】\n  - 1.1.A.2 财务期对齐【1 分｜存在 fiscal_year、fiscal_month、period_type，not_null】\n  - 1.1.A.3 收入/费用与净额【1 分｜存在 revenue、expenses、net_amount、cumulative_net，金额 ≥0】\n  - 1.1.A.4 发票行贡献占比【1 分｜存在 line_share_gross、line_share_net、invoice_gross_nonneg、invoice_net_nonneg、invoice_line_count，非负 tests】\n  - 1.1.A.5 发票内行序与累计【1 分｜存在 line_seq_in_invoice、invoice_cum_gross_nonneg，非负 tests】\n  - 1.1.A.6 账户（科目）分类【1 分｜存在 account_type、account_class、account_code/name，not_null】\n  - 1.1.A.7 部门/地区/项目标签【1 分｜存在 region、department、project，且在 int_/marts 层均出现】\n  - 1.1.A.8 折扣相关字段【1 分｜存在 discount_rate（发票行与 enriched 模型），范围 0–1】\n  - 1.1.A.9 税相关字段与有效税率【1 分｜存在 tax_amount、tax_type 与 effective_tax_rate，金额 ≥0】\n  - 1.1.A.10 毛利侵蚀判别【1 分｜int_xero__general_ledger_fact 含 gross_amount、net_amount、tax_amount，金额 ≥0】\n  - 1.1.A.11 下滑检测【1 分｜P&L 含 net_amount 与 report_month/fiscal_*，支持环比/同比对比（下滑阈值 15% 可计算）】\n  - 1.1.A.12 关联联系人/供应商上下文【1 分｜存在 contact_id、contact_name，not_null】\n  - 1.1.A.13 驱动因素清单【1 分｜int_xero__tracking_categories_with_options 含 tracking_category_name、option，not_null】\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰  \n\n  - 1.2.A.1 输出项要素齐全【1 分｜至少包含“按谁（project/region/department/account 等）+ 时间（report_month/fiscal_*）+ 指标（net_amount/revenue/expenses/line_share_*）”三类要素】\n  - 1.2.A.2 缺失/异常/负值处理【1 分｜存在非负 tests（line_amount_nonneg、tax_amount_nonneg、invoice_*_nonneg）与 not_null，缺失字段默认 0 或 NULL】\n  - 1.2.A.3 跨模型口径一致【1 分｜收入/费用/净额在 P&L 与 GL 一致；明确不重算、不重复标注】\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）  \n  - 2.1.A.1 上游依赖【1 分｜每个模型声明 source_models，跨层依赖受限】\n  - 2.1.A.2 粒度与字段定义【1 分｜每个模型声明 grain，columns 含字段名+类型，not_null/非负 tests】\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）  \n  - 2.2.A.1 无悬空引用【1 分｜所有 source_models 指向 staging/intermediate 合法模型】\n  - 2.2.A.2 无循环/跨层依赖【1 分｜DAG 闭合，staging→intermediate→marts 单向】\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 名称语义化【1 分｜模型与列名直观（如 xero__profit_and_loss_report、line_share_net、effective_tax_rate）】\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 分层职责清晰【1 分｜staging 仅做清洗；intermediate 聚合/补充；marts 输出分析】\n- 3.2.2 业务口径集中【1 分｜度量逻辑集中在 int_/marts；staging 不含业务规则】\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。  \n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-028-zh", "question": "我们最近几支长尾视频在“发布后第30天”这段窗口里净订阅数涨得不错，但管理层关心的是这是不是靠极少数国家的集中贡献、还是整体健康增长。请帮我按“视频-国家-日”粒度，把每个视频在其发布后第1–30天的每日净订阅数、观看时长和点赞率拆开看，识别出那些“净订阅稳步增长、观看时长提升但依赖单一国家观看占比过高”的视频。最后给出每条视频的风险评级：高（单一国家贡献≥70%且过去两周该国占比上升）、中（单一国家贡献50–70%或占比波动大）、低（国家分布均衡），并标注近两周滚动趋势。", "rubric": "# YouTube 视频-国家-日 30天增长与风险评估 评估标准（严格版）\n\n## [总分 | 23 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（16 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（16 分）\n\n### 标准 1.1（最高 13 分）：功能点覆盖\n- 路径 1.1.A（13 分）：完整覆盖\n  - 1.1.A.1 小标准【1 分｜判定条件】：粒度为“视频-国家-日”，需存在定义 video_id + country_code + date_day 的模型，字段均 not_null。\n  - 1.1.A.2 小标准【1 分｜判定条件】：存在视频标识 video_id，且为主键或主键组成部分，not_null。\n  - 1.1.A.3 小标准【1 分｜判定条件】：存在国家标识 country_code（ISO 两位），not_null。\n  - 1.1.A.4 小标准【1 分｜判定条件】：存在日期列 date_day（DATE 类型），not_null，且为日粒度对齐字段。\n  - 1.1.A.5 小标准【1 分｜判定条件】：存在视频发布日期 video_published_date，用于与 date_day 计算相对天数，not_null。\n  - 1.1.A.6 小标准【1 分｜判定条件】：存在净订阅数列 net_subscribers，非负，且与上游 youtube__video_report 口径一致。\n  - 1.1.A.7 小标准【1 分｜判定条件】：存在观看时长指标（total_watch_time_minutes 或 watch_time_minutes），非负。\n  - 1.1.A.8 小标准【1 分｜判定条件】：存在点赞率 like_rate，值需满足 BETWEEN 0 AND 1。\n  - 1.1.A.9 小标准【1 分｜判定条件】：存在国家观看占比（total_views_percentage），定义为该视频当日该国观看占比，需满足 BETWEEN 0 AND 1。\n  - 1.1.A.10 小标准【1 分｜判定条件】：定义发布后 1–30 天窗口（基于 video_published_date 与 date_day），窗口逻辑可计算。\n  - 1.1.A.11 小标准【1 分｜判定条件】：存在近 14 天滚动趋势要素（如 rolling_14d_* 指标），not_null。\n  - 1.1.A.12 小标准【1 分｜判定条件】：存在“稳步增长”识别要素（如增长标识/阈值字段），明确 ≥0 或布尔型。\n  - 1.1.A.13 小标准【1 分｜判定条件】：存在风险评级 risk_rating，取值限定为 {高, 中, 低} 枚举。\n\n- 路径 1.1.B（3 分）：基础覆盖（二选一评分，不与 1.1.A 累加）\n  - 1.1.B.1 小标准【1 分｜判定条件】：实体维度至少覆盖 video_id 与 country_code 中的两个字段。\n  - 1.1.B.2 小标准【1 分｜判定条件】：时间对齐维度至少包含 date_day 或 video_published_date。\n  - 1.1.B.3 小标准【1 分｜判定条件】：至少存在一个聚合/比例类指标（如 net_subscribers、watch_time_minutes、like_rate、views_percentage），字段非负或范围约束。\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】：输出项需包含两类要素（实体 + 时间或统计规则），如 video_id + date_day + 聚合指标。\n  - 1.2.A.2 小标准【1 分｜判定条件】：缺失/异常/重复/负值/未来时间均有约束（如 tests: not_null、≥0、BETWEEN 0 AND 1、日期 ≤ 当前日期）。\n  - 1.2.A.3 小标准【1 分｜判定条件】：跨模型口径一致（如 like_rate、net_subscribers 在中间层与 marts 保持相同定义与单位）。\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】：声明上游依赖（source_models），层级正确（staging→intermediate→marts）。\n  - 2.1.A.2 小标准【1 分｜判定条件】：每个字段定义含名称、data_type，并声明 tests（not_null/范围）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】：无悬空引用（所有上游模型存在并可解析）。\n  - 2.2.A.2 小标准【1 分｜判定条件】：外部来源边界清晰（raw/staging 来源声明完整，单向依赖）。\n\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 小标准【1 分｜判定条件】：模型与列名语义明确（如 youtube__video_report、like_rate、net_subscribers），避免歧义或混用。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 小标准【1 分｜判定条件】：分层职责清晰（staging 标准化；intermediate 业务整形；marts 分析汇总）。\n- 3.2.2 小标准【1 分｜判定条件】：业务口径集中在 marts 层，避免“上帝表”，模型职责单一、内聚。\n\n### 评分须知\n- 每个小标准按 1/0 计分；未找到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-029-zh", "question": "我们最近高优先级工单的解决周期拉得很长。请帮我看清楚：在不同组织和创建渠道下，工单的“转派次数”（同一工单经历多少次受理人变更）以及“公开/私密评论占比”分别如何影响最终的解决时长？我不需要学术论文，只要一个可以落地的结论：比如在哪些组织或渠道里，超过两次转派就会把解决时间中位数拉长多少，公开评论占比低于多少又会显著拖慢解决效率。这些发现要能直接指导我们调整分单策略和沟通规范。", "rubric": "# Zendesk 工单转派与评论占比对解决时长影响 评估标准\n\n## [总分 | 26 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（19 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n\n\n## 需求 I：业务对齐与语义准确性（19 分）\n\n### 标准 1.1（最高 16 分）：功能点覆盖\n- 路径 1.1.A（16 分）：完整覆盖\n  - 1.1.A.1 小标准【1 分｜判定条件】：提供工单粒度（ticket_id 唯一，not_null）。\n  - 1.1.A.2 小标准【1 分｜判定条件】：提供工单创建时间 created_at（not_null），用于解决时长起点。\n  - 1.1.A.3 小标准【1 分｜判定条件】：提供工单终态时间 resolved_at 或等价字段（not_null），来源 int_zendesk__ticket_status_transitions。\n  - 1.1.A.4 小标准【1 分｜判定条件】：提供解决时长 resolution_minutes（≥0 测试）。\n  - 1.1.A.5 小标准【1 分｜判定条件】：提供总评论数 comment_count（≥0 测试）。\n  - 1.1.A.6 小标准【1 分｜判定条件】：提供公开评论数 public_comment_count（≥0 测试）。\n  - 1.1.A.7 小标准【1 分｜判定条件】：提供私密评论数 private_comment_count（≥0 测试）。\n  - 1.1.A.8 小标准【1 分｜判定条件】：能得到公开评论占比 public_comment_share = public / total（允许派生，需满足 0–1）。\n  - 1.1.A.9 小标准【1 分｜判定条件】：提供受理人变更区间（assignee 连续区间，含起止时间列）。\n  - 1.1.A.10 小标准【1 分｜判定条件】：可得到转派次数 reassignment_count（基于 assignee 变更计数，≥0）。\n  - 1.1.A.11 小标准【1 分｜判定条件】：提供创建渠道 created_channel（not_null）。\n  - 1.1.A.12 小标准【1 分｜判定条件】：提供组织 ID organization_id（not_null）。\n  - 1.1.A.13 小标准【1 分｜判定条件】：提供组织名称或属性（organization_name、organization_tags）。\n  - 1.1.A.14 小标准【1 分｜判定条件】：同一分析中可切片组织 × 渠道（两者字段在同一粒度可合并使用）。\n  - 1.1.A.15 小标准【1 分｜判定条件】：终态判定遵循 solved/closed 的最早时间，口径与 transitions 模型一致。\n  - 1.1.A.16 小标准【1 分｜判定条件】：提供状态/优先级维度（status、priority），not_null。\n\n- 路径 1.1.B（8 分）：基础覆盖（二选一评分路径，不与 1.1.A 累加）\n  - 1.1.B.1 小标准【1 分｜判定条件】：至少覆盖工单 + 组织或渠道其中一类实体。\n  - 1.1.B.2 小标准【1 分｜判定条件】：至少覆盖 created_at 与 resolved_at/等价字段其中一类时间。\n  - 1.1.B.3 小标准【1 分｜判定条件】：至少覆盖解决时长或评论数其中之一。\n  - 1.1.B.4 小标准【1 分｜判定条件】：至少区分公开或私密评论一种。\n  - 1.1.B.5 小标准【1 分｜判定条件】：存在转派迹象（如 assignee 变更表）。\n  - 1.1.B.6 小标准【1 分｜判定条件】：可按组织或渠道进行分组。\n  - 1.1.B.7 小标准【1 分｜判定条件】：数据口径一致（解决时长与终态时间计算不矛盾）。\n  - 1.1.B.8 小标准【1 分｜判定条件】：度量字段具备非负约束 tests。\n\n\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 1.2.A.1 小标准【1 分｜判定条件】：输出项至少包含两类要素（对象/主体 + 时间范围或统计规则），如 ticket_id + created_at/resolved_at + resolution_minutes。\n  - 1.2.A.2 小标准【1 分｜判定条件】：缺失/异常值有默认处理或 tests（如 comment_count ≥0、resolution_minutes ≥0、not_null）。\n  - 1.2.A.3 小标准【1 分｜判定条件】：跨输出口径一致（终态时间与解决时长一致，公开/私密评论与总评论相容）。\n\n\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 小标准【1 分｜判定条件】：存在上游依赖 source_models。\n  - 2.1.A.2 小标准【1 分｜判定条件】：存在字段定义 + 类型（columns 含 data_type）。\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 小标准【1 分｜判定条件】：无循环/自引用（遵循 staging→intermediate→marts 单向）。\n  - 2.2.A.2 小标准【1 分｜判定条件】：外部来源边界清晰（staging.* 来源定义完整）。\n\n\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 小标准【1 分｜判定条件】：命名规则一致，前缀清晰（int_zendesk__/zendesk__），snake_case。\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 小标准【1 分｜判定条件】：分层职责清晰（staging 接原始，intermediate 承载业务，marts 暴露分析）。\n- 3.2.2 小标准【1 分｜判定条件】：业务口径集中（如评论统计、解决时长集中在 int_zendesk__ticket_metrics 并在 marts 直接暴露）。\n\n\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
{"id": "dacomp-de-arch-030-zh", "question": "这个季度里，我们每个账户“应计的订阅型收入（MRR）”中，有多少在开票后第7/30/60天仍未回款？请按产品、收费类型（Recurring/Non‑Recurring）和折扣类型拆解，并把在取消/降配（amendment）发生前后30天内开出的发票单独标记。我想看到：1)哪些账户的净MRR既被折扣侵蚀又回款最慢；2) 从开票到首次/全部回款的典型时滞分布；3) 与支付方式及失败率（如卡、ACH）的关联，以便调整账期与催收策略。", "rubric": "# Zuora MRR 未回款与回款时滞分析 评估标准\n\n## [总分 | 26 分] 固定三需求\n- 需求 I：业务对齐与语义准确性（19 分）\n- 需求 II：技术可行性与结构完备性（4 分）\n- 需求 III：设计质量（3 分）\n\n## 需求 I：业务对齐与语义准确性（19 分）\n\n### 标准 1.1（最高 16 分）：功能点覆盖\n- 路径 1.1.A（16 分）：完整覆盖\n  - 1.1.A.1 子公司（Account 层级/父子关系）【1 分｜存在 parent_account_id，not_null】\n  - 1.1.A.2 财务期对齐（日/周/月/年桶或日期脊柱）【1 分｜存在 date_day/date_week/date_month/date_year，not_null】\n  - 1.1.A.3 现金流（支付/退款）【1 分｜存在支付金额、退款金额字段，金额 ≥0】\n  - 1.1.A.4 AR 账龄（发票到期与未回款/逾期）【1 分｜存在 due_date、invoice_amount_unpaid/total_amount_past_due，金额 ≥0】\n  - 1.1.A.5 毛利【1 分｜需出现毛利相关字段，金额 ≥0】\n  - 1.1.A.6 费用【1 分｜需出现费用口径字段，金额 ≥0】\n  - 1.1.A.7 供应商付款【1 分｜需出现供应商付款相关字段，金额 ≥0】\n  - 1.1.A.8 贡献占比【1 分｜需出现 contribution_share 类字段，0–1 区间】\n  - 1.1.A.9 纠偏动作（信用余额调整）【1 分｜存在信用余额调整金额与次数字段，金额 ≥0】\n  - 1.1.A.10 MRR/Non-MRR 分类（月度净/毛与折扣）【1 分｜区分 charge_type 且输出 MRR/Non-MRR 净额、毛额、折扣额】\n  - 1.1.A.11 产品维度拆解【1 分｜存在 product_id/name/category，not_null】\n  - 1.1.A.12 收费类型（Recurring/Non-Recurring）维度【1 分｜存在 charge_type/charge_model，not_null】\n  - 1.1.A.13 折扣类型/金额拆解【1 分｜存在 discount_amount/discount_amount_home_currency，金额 ≥0】\n  - 1.1.A.14 标记取消/降配（amendment）前后 ±30 天开票【1 分｜存在 invoice_date 与 amendment_* 字段可用于窗口计算】\n  - 1.1.A.15 开票到首次/全部回款时滞分布【1 分｜存在 invoice_date 与 first_payment_date/most_recent_payment_date，差值 ≥0】\n  - 1.1.A.16 支付方式及失败率关联【1 分｜存在 payment_method_type、credit_card_type、ach_account_type，last_failed_sale_transaction_date】\n  - 1.1.A.17 应计 MRR 口径（服务期对齐与日桶）【1 分｜存在 service_start_* 与 MRR 金额字段，金额 ≥0】\n  - 1.1.A.18 币种与汇率口径一致【1 分｜存在交易币金额、本位币金额与 exchange_rate_date，跨模型不矛盾】\n\n- 路径 1.1.B（3 分）：基础覆盖（仅当未满足 1.1.A 评分）\n  - 1.1.B.1 实体维度可用【1 分｜至少包含 Account/Invoice/Item/Subscription/Payment/PaymentMethod 中两类主键】\n  - 1.1.B.2 时间维度可用【1 分｜至少包含 date_day/date_month 或 invoice_date】\n  - 1.1.B.3 聚合规则可用【1 分｜至少包含一种金额聚合与一种计数聚合】\n\n\n\n### 标准 1.2（最高 3 分）：指标/特征口径\n- 路径 1.2.A（3 分）：口径清晰\n  - 1.2.A.1 输出项要素齐全【1 分｜至少包含“按谁（实体 id）+ 时间范围（日/月）+ 聚合规则”三类要素】\n  - 1.2.A.2 缺失/异常/重复/负值处理【1 分｜字段含 not_null 或 ≥0 测试，重复通过 is_most_recent_record 标记处理】\n  - 1.2.A.3 跨输出项口径一致【1 分｜日期脊柱统一；币种/本位币一致；tax_amount_home_currency 与 invoice_base 一致】\n\n## 需求 II：技术可行性与结构完备性（4 分）\n\n### 标准 2.1（最高 2 分）：format/结构检查\n- 路径 2.1.A（2 分）：模型最小四要素\n  - 2.1.A.1 模型标识【1 分｜每个模型声明 name】\n  - 2.1.A.2 字段定义【1 分｜每列声明名称+类型，columns 含 data_type】\n\n### 标准 2.2（最高 2 分）：依赖闭合\n- 路径 2.2.A（2 分）：可构建依赖图\n  - 2.2.A.1 无悬空引用【1 分｜所有 source_models 均指向已定义模型】\n  - 2.2.A.2 外部来源边界清晰【1 分｜staging 仅引用 raw，intermediate 仅引用 staging，marts 仅引用 intermediate】\n\n## 需求 III：设计质量（3 分）\n\n### 标准 3.1（最高 1 分）：命名清晰\n- 3.1.1 名称语义化【1 分｜模型与列命名直观，如 zuora__account_overview、invoice_amount_unpaid、charge_type】\n\n### 标准 3.2（最高 2 分）：分层合理\n- 3.2.1 分层职责清晰【1 分｜staging→intermediate→marts 单向分层，职责明确】\n- 3.2.2 避免“上帝表”【1 分｜明细与汇总分离（line_item_* vs *_overview），无跨层耦合】\n\n### 评分须知\n- 每个小标准按 1/0 计分；找不到证据 → 0 分。\n- ALLOW_MULTI_MODEL=YES。\n"}
