# [总分 | 34分] 解决方案需满足以下四个核心需求：

  - 需求1：指标映射及代表级工作负荷/效率评分核算
  - 需求2：负荷失衡诊断与供需识别
  - 需求3：受约束的客户重分配算法设计与执行
  - 需求4：方案成效量化与落地治理

---

## 需求1：指标映射及代表级工作负荷/效率评分核算（最高 9分）

### 标准1.1：工作负荷评分计算（最高 5分）

#### 路径1.1.A【5分 | SQL 聚合实现】

- 小标准1.1.A.1【1分 | 完备性】： 在`salesforce__customer_360_view`表上按`owner_id/account_owner_name`聚合，映射字段：客户数=`COUNT(*)`，总年收入=`SUM(annual_revenue)`（美元口径），联系人总数=`SUM(total_contacts)`，州/城市去空去重=`COUNT(DISTINCT billing_state/billing_city)`。
- 小标准1.1.A.2【3分 | 精确性】： 按公式  
  `workload = 0.3×客户数 + 0.4×(SUM(annual_revenue)/10,000,000) + 0.2×min(5, SUM(total_contacts)/客户数) + 0.1×[2×COUNT_DISTINCT(state) + 0.5×COUNT_DISTINCT(city)]`  
  输出代表级工作负荷。验算平均值=8.741±0.005，标准差=2.9618±0.005（样本量=1000）。同时给出`lower=7.4298±0.005`、`upper=10.0521±0.005`。结果需以 SQL 可复现，示例：`0.3*COUNT(*) + ...`。
- 小标准1.1.A.3【1分 | 结论性】： 提供完整结果表，指出客户数项与年收入项共占 0.3+0.4=0.7 权重，为高负荷代表（如 Latoya Armstrong 20 户/267.02M）主要驱动，联系人与地理项提供附加增量。

#### 路径1.1.B【5分 | Python/Pandas 实现】

- 小标准1.1.B.1【1分 | 完备性】： 使用 pandas 读取同表，`groupby('owner_id')`聚合：`customer_count`、`total_revenue`、`total_contacts`、`billing_state/city`去重列；解释缺失填 0。必须展示核心代码片段（如`agg({'annual_revenue':'sum', ...})`）。
- 小标准1.1.B.2【3分 | 精确性】： 复现 1.1.A 公式，联系人覆盖率 `coverage = min(5, total_contacts/customer_count)`。校验均值、标准差与 SQL 结果一致（容差 ±0.005），并输出代表级 DataFrame。
- 小标准1.1.B.3【1分 | 结论性】： 结合 pandas 结果剖析典型高负荷代表（Latoya Armstrong/Paul Frey 等），说明“多客户+高收入+跨州管理”对总分的贡献。

#### 路径1.1.C【5分 | 构成项拆解校核】

- 小标准1.1.C.1【1分 | 完备性】： 列明四项构成口径：客户项=0.3×户数（无单位）、收入项=0.4×收入(USD)/10,000,000、联系人项=0.2×min(5, 平均联系人)、地理项=0.1×(2×distinct 州 +0.5×distinct 城)，无额外清洗。
- 小标准1.1.C.2【3分 | 精确性】： 至少抽取 5 名代表逐项核算，误差 ≤0.1。例如  
  - Latoya Armstrong：客户=6.00、收入=10.68、联系人=0.58、地理=3.25，总计=20.51；  
  - Paul Frey：5.10+10.65+0.45+2.95=19.15；  
  - Jeffrey Brown：4.50+10.68+0.43+2.35=17.95；  
  - Keith Hill：3.90+10.15+0.54+3.05=17.64；  
  - Cindy Jordan：4.50+8.99+0.55+3.30=17.34。
- 小标准1.1.C.3【1分 | 结论性】： 总结边际影响：收入与客户项合计 70% 权重，是评分主因；地理/联系人项用于区分跨区域或高覆盖度代表。

### 标准1.2：效率评分计算（最高 4分）

#### 路径1.2.A【4分 | 商机明细口径】

- 小标准1.2.A.1【1分 | 完备性】： 在`salesforce__opportunity_enhanced`中计算：胜率 = `SUM(is_won)/SUM(is_closed)`；平均交易额 = 赢单金额平均值；销售周期 = 仅 `days_to_close>0` 的均值（默认 120）；近 365 天转化率 = `closed(≤365)/created(≤365)`。
- 小标准1.2.A.2【2分 | 精确性】： 应用  
  `efficiency = 0.4×win_rate + 0.3×(avg_amount/100,000) + 0.2×(120/avg_days_to_close) + 0.1×conversion_rate`。基准验证：团队效率均值=7.4416±0.01，标准差=4.3538±0.01（样本=1000）；请说明比例转化与缺失处理。
- 小标准1.2.A.3【1分 | 结论性】： 输出代表级效率表，指出高效率代表（Megan Evans、Walter White 等）因 100% 胜率与 5M 平均金额贡献显著，而长周期拉低部分代表得分。

#### 路径1.2.B【4分 | 仪表盘聚合口径】

- 小标准1.2.B.1【1分 | 完备性】： 读取`salesforce__sales_performance_dashboard`的`win_rate_pct/avg_deal_size_usd/avg_sales_cycle_days/close_rate_pct`，声明百分比÷100，`avg_sales_cycle_days=0`时取 120。
- 小标准1.2.B.2【2分 | 精确性】： 同公式计算效率，团队均值=1.5094±0.01，标准差=2.3118±0.01，平均胜率=0.4266，平均交易额=349,709.71 美元，平均周期=207.19 天，平均转化率=0.2042。须与 1.2.A 均值在 ±0.05 内。
- 小标准1.2.B.3【1分 | 结论性】： 给出代表效率排序，解释高效率代表兼具高胜率与较短周期，低效率代表受长周期与低转化拖累。

---

## 需求2：负荷失衡诊断与供需识别（最高 8分）

### 标准2.1：负荷不均衡判定（最高 4分）

#### 路径2.1.A【4分 | 均值-标准差阈值法】

- 小标准2.1.A.1【1分 | 完备性】： 使用 1.1 结果计算全体均值 mean=8.7410、标准差 std=2.9618。
- 小标准2.1.A.2【2分 | 精确性】： 验证 `std > mean×0.3`（2.9618 > 2.6223）。给出上下界：`lower=7.4298±0.005`、`upper=10.0521±0.005`。统计超上/下界代表数与占比。
- 小标准2.1.A.3【1分 | 结论性】： 说明失衡成立，高负荷主要集中在“大额跨州客 + 多联系人”代表，低负荷为“单州/低收入”组合。

#### 路径2.1.B【4分 | 稳健统计法】

- 小标准2.1.B.1【1分 | 完备性】： 计算 median=8.4902、MAD=2.876（=1.4826×median(|x-median|)），稳健阈值=median±2×MAD，即 [2.7382, 14.2422]。
- 小标准2.1.B.2【2分 | 精确性】： 输出超出稳健阈值代表名单并对比均值法，要求数值与 1.1 取值一致（容差 ±0.1）。
- 小标准2.1.B.3【1分 | 结论性】： 对比两种方法，指出极端高负荷代表对标准差影响大，MAD 视角下仍存在低尾代表（<2.74）需重点补给。

### 标准2.2：供需集合与缺口估算（最高 4分）

#### 路径2.2.A【4分 | 绝对差额统计】

- 小标准2.2.A.1【1分 | 完备性】： 定义 donors=workload>upper、recipients=workload<lower，给出人数。
- 小标准2.2.A.2【2分 | 精确性】： 计算  
  - donors=307±1；recipients=346±1；  
  - `donor_surplus = Σ(workload - upper) = 673.3533±0.5`；  
  - `recipient_deficit = Σ(lower - workload) = 604.0753±0.5`。  
  必须提供 SQL/代码复现。
- 小标准2.2.A.3【1分 | 结论性】： 解释盈余略大于缺口，预计需调配 ~600 负荷点，优先处理超标代表（20 分段）向低负荷州转移。

#### 路径2.2.B【4分 | 单位负荷近似】

- 小标准2.2.B.1【1分 | 完备性】： 估算单位账户负荷：  
  `unit = 0.3 + 0.4×(mean_revenue_per_account/10,000,000) + 0.2×min(5, mean_contacts_per_account)`，地理项视情况补充。  
  统计值：`mean_revenue_per_account=8,183,888.72` 美元，`mean_contacts_per_account=2.50` → `unit≈1.1274`。
- 小标准2.2.B.2【2分 | 精确性】： 以 unit 近似折算 donor_surplus/recipient_deficit → 换算约需转移 598~605 户（向上取整）。须展示计算逻辑。
- 小标准2.2.B.3【1分 | 结论性】： 说明近似与绝对差额差异来源（未计地理增量、distinct 变化），适用于快速估算，但最终仍需逐账户校核。

---

## 需求3：受约束的客户重分配算法设计与执行（最高 11分）

### 标准3.1：约束声明与验证（最高 3分）

#### 路径3.1.A【3分 | 规则引擎实现】

- 小标准3.1.A.1【1分 | 完备性】： 明确硬约束：①同州优先（若无候选再扩散至邻州需注明）；②行业专长≥60%（新增后`Top3`行业占比≥0.60）；③规模匹配=仅接受现有前 2 大 size segment；④工作负荷落在 [lower, upper]。
- 小标准3.1.A.2【1分 | 精确性】： 每次迁移需即时更新客户数、总收入、联系人、state/city distinct、行业/规模计数，确保新增后`top3_share = ΣTop3行业户数/总户数 ≥0.60`。记录校验脚本或函数。
- 小标准3.1.A.3【1分 | 结论性】： 解释约束对客户保留（同州 + 行业匹配）、执行可操作性与成本控制（规模贴合、避免超负荷）的支撑作用。

#### 路径3.1.B【3分 | 软约束打分法】

- 小标准3.1.B.1【1分 | 完备性】： 定义匹配得分，例如`score = 0.5*same_state + 0.3*industry_top3 + 0.2*size_top2`；说明软约束用于拓宽候选池。
- 小标准3.1.B.2【1分 | 精确性】： 设定阈值≥0.7 入池；迁移后重新统计行业占比确保 ≥60%，并给出控制逻辑。
- 小标准3.1.B.3【1分 | 结论性】： 阐述软约束在样本稀缺州的价值与风险（需额外监控 retention）。

### 标准3.2：重分配算法路径（最高 5分）

#### 路径3.2.A【5分 | 启发式贪心迭代】

- 小标准3.2.A.1【1分 | 完备性】： 描述迭代框架：按`workload`降序选 donor，依据 impact 排序账户，遍历匹配受约束的 recipients，直至所有 donor≤upper 且 recipient≥lower。
- 小标准3.2.A.2【3分 | 精确性】： 使用 impact 定义  
  `impact = annual_revenue/1e6 + 0.25*min(total_contacts,10) + risk_bonus`（risk_bonus: Minimal0.3/Low0.5/Medium1.0/High1.5）。Recipient 选择优先级：`(状态是否低于lower, 是否同州, 当前workload)`。对每次转移输出`sender_before/after`与`receiver_before/after`，确保无死循环（迭代上限或无移动即停止）。
- 小标准3.2.A.3【1分 | 结论性】： 说明该贪心策略可快速生成可执行方案，并便于人工回溯（每条迁移记录含 before/after 负荷）。

#### 路径3.2.B【5分 | 整数线性规划 / 最小成本流】

- 小标准3.2.B.1【1分 | 完备性】： 定义决策变量 `x_{account,rep}∈{0,1}`，目标可最小化`Σ(workload_after_rep − mean)^2`或最大化效率提升。
- 小标准3.2.B.2【3分 | 精确性】： 列出约束：①单账户唯一归属；②`Σ load_contrib + current_workload ≤ upper`；③`Σ x * is_top3 ≥ 0.6 * Σx`；④规模不在Top2则禁止/惩罚；⑤同州优先可用大惩罚系数实现。需给出求解方式（MILP 或最小成本流图）。
- 小标准3.2.B.3【1分 | 结论性】： 讨论全局/近似最优优势以及数据需求、计算复杂度、回退方案。

### 标准3.3：迁移执行与合规输出（最高 3分）

#### 路径3.3.A【3分 | 样例清单核验】

- 小标准3.3.A.1【1分 | 完备性】： 至少输出 10 条客户迁移记录，字段含：`account_id/account_name/from_rep/to_rep/state/industry/size_segment/annual_revenue/Δsender_workload/Δreceiver_workload/匹配得分或理由`。
- 小标准3.3.A.2【1分 | 精确性】： 核验示例（参考运行结果）：  
  - 001uAORdCADjk8c Peterson and Sons：Latoya Armstrong→Adam Duncan（KS，Non-profit，Unknown，50M），发送者 20.51→17.95，接收者 2.70→5.05；  
  - 001Fs17f0O22vWu Ayers, Parker and Wood：Paul Frey→Natalie Hoover（CA，Financial Services，Mid-Market，50M），19.15→16.78，2.70→5.09；  
  - …（共 10 条，数值误差 ≤0.05）。需证明 recipient 未超上界且行业占比合规。
- 小标准3.3.A.3【1分 | 结论性】： 评估样例业务合理性（高匹配、高保留），并提示风险点（大额迁移需联合拜访）。

---

## 需求4：方案成效量化与落地治理（最高 6分）

### 标准4.1：迁移成效量化（最高 4分）

#### 路径4.1.A【4分 | 前后对比】

- 小标准4.1.A.1【1分 | 完备性】： 对比迁前/迁后：负荷标准差、±15% 覆盖率、收入加权效率指数、收入加权保留提升。
- 小标准4.1.A.2【2分 | 精确性】：  
  - 迁前标准差=2.9618；迁后须≤1.30；  
  - 迁前±15% 覆盖率=34.7%；迁后须≥95%；  
  - 效率指数（Σ rep效率 × 收入占比）：迁前=7.4761，迁后须≥7.90；  
  - 保留提升：baseline uplift=3.717pp（fit_points=0/1/2/3 分布=331/4641/5028），迁后须提升≥+0.6pp（≥4.317pp）。需提供计算脚本。
- 小标准4.1.A.3【1分 | 结论性】： 综合说明负荷均衡改善、效率提升原因（高效率代表收入权重提高）与保留增益（同州+行业匹配）。

#### 路径4.1.B【4分 | 参数敏感性分析】

- 小标准4.1.B.1【1分 | 完备性】： 测试至少两组参数（如 ±10% 阈值、行业权重 0.2/0.4、同州软约束）。
- 小标准4.1.B.2【2分 | 精确性】： 对每场景量化标准差、覆盖率、效率指数、保留 uplift，列出表格与数据来源。
- 小标准4.1.B.3【1分 | 结论性】： 推荐最优参数组合并指出风险（例如同州放宽导致保留下降）。

### 标准4.2：治理与落地（最高 2分）

#### 路径4.2.A【2分 | 执行路线图】

- 小标准4.2.A.1【1分 | 完备性】： 制定“准备→执行→优化”三阶段计划，明确时间表、责任人、关键动作（客户沟通、CRM 更新、监控指标），KPI 至少包含负荷方差、覆盖率、效率指数、保留 uplift。
- 小标准4.2.A.2【1分 | 结论性】： 指出潜在风险（效率波动、客户抵触、数据延迟）及缓解措施（联合拜访、培训、回退机制）。

#### 路径4.2.B【2分 | 风险治理与回退】

- 小标准4.2.B.1【1分 | 完备性】： 描述交接 SOP（并行期、联合拜访、联系人移交）、回退触发条件、快速响应流程。
- 小标准4.2.B.2【1分 | 结论性】： 明确评估转移成效的指标（60/90 天留存、活动频次、机会推进），以及触发回退或二次调优的标准。

---