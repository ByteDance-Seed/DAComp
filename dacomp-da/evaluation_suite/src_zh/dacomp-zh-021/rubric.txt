# [总分 | 13分] 解决方案需要满足两个需求：
- 需求1: 准确识别订单波峰波谷及核心特征
- 需求2: 关联取消率/费用分析并提出运营建议
---
## 需求1: 订单波峰波谷及核心特征分析（本需求最高可得 7分）
### 标准1.1：每日特定时间段波峰波谷识别
#### 路径1.1.A [4分 | 日内时段（小时）分析]
- 小标准1.1.A.1 [1分 | 完备性]: 采用小时维度分析思路。
- 小标准1.1.A.2 [1分 | 精确性]: 18点（或下午/晚6点）订单数为12397单（要求误差不超过5%），波峰时间段覆盖到18点（可以表达为高峰为17-19点，只要高峰时间覆盖18点即可算对）
- 小标准1.1.A.3 [1分 | 精确性]: 10点订单数为9577单（要求误差不超过5%），波峰时间段覆盖到10点（可以表达为高峰为9-11点，只要高峰时间覆盖10点即可算对）
- 小标准1.1.A.4 [1分 | 精确性]: 凌晨4点订单数为1321单（要求误差不超过5%），波谷时间段覆盖到凌晨4点（可以表达为低峰为0-4点，只要低峰时间覆盖4点即可算对）
### 标准1.2：特定日期波峰波谷识别
#### 路径1.2.A [3分 | 自然日（日期）/节假日维度分析]
- 小标准1.2.A.1 [1分 | 完备性]: 采用自然日维度分析思路。
- 小标准1.2.A.2 [1分 | 精确性]: 波峰日11月16日为462单（单数要求误差不超过1%），日期错误时0分。
- 小标准1.2.A.3 [1分 | 精确性]: 波谷日8月22日为355单（单数要求误差不超过1%），日期错误时0分。
#### 路径1.2.B [2分 | 周内（星期）维度分析]
- 小标准1.2.B.1 [1分 | 完备性]: 采用星期维度分析思路，对周一~周日分开统计分析（也可拆分为工作日 vs 周末的维度）。
- 小标准1.2.B.2 [1分 | 结论性]: 基本无波峰波谷影响
---
## 需求2: 关联取消率/费用分析与运营建议（本需求最高可得 7分）
### 标准2.1：取消率分析与运营建议
#### 路径2.1.A [3分 | 取消率分析与运营建议]
- 小标准2.1.A.1 [1分 | 完备性]: 计算取消率并给出相应的运营建议
- 小标准2.1.A.2 [1分 | 准确性]: 取消率计算正确（可以计算总取消率，也可以单独计算用户取消率和司机取消率）。计算总取消率时，筛选Booking Status时必须包含“Cancelled by Driver”、“Cancelled by Customer”这两类，可以包括“No Driver Found”，但不能包括“Completed”，不能包括“Incomplete”。可以参考以下三种算法，代码逻辑正确即可，形式不要求。
  ```伪代码：取消率计算
  df["cancel"] = df["Booking Status"].apply(lambda x: x in ["Cancelled by Driver", "Cancelled by Customer"])
  df["cancel"] = df["Booking Status"].apply(lambda x: x in ["Cancelled by Driver", "Cancelled by Customer", "No Driver Found"])
  df["cancel"] = df["Booking Status"].apply(lambda x: x not in ["Completed", "Incomplete"])
  df["cancel"] = df["Booking Status"].apply(lambda x: x not in ["Completed", "Incomplete", "No Driver Found"])
  ```
- 小标准2.1.A.3 [1分 | 准确性]: 查看用户/司机取消原因，并基于取消原因分别给出用户端和司机端的运营建议
### 标准2.2：每公里行程费用分析与运营建议
#### 路径2.2.A [4分 | 每公里行程费用分析与运营建议]
- 小标准2.2.A.1 [1分 | 完备性]: 计算每公里行程费用并给出相应的运营建议
- 小标准2.2.A.2 [1分 | 准确性]: 每公里行程费用计算正确。计算方法为总费用除以总行程。必须筛选Booking Status为Completed，不能计算Booking Status为Incomplete时的Booking value
- 小标准2.2.A.3 [2分 | 结论性]: 提出针对性的定价方案，方案合理即可
