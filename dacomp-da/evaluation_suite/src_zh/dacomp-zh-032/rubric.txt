# [总分 | 20分] 解决方案需满足以下三个核心需求：
- 需求1：准确筛选联系优先级为1的客户数据
- 需求2：量化客户投诉与工单处理情况指标
- 需求3：在总体基准下完成对服务质量的对比评估
---
## 需求1：准确筛选联系优先级为1的客户数据（本需求最高可得2分）
### 标准1.1［最高2分］高优先级客户的识别
#### 路径1.1.A［2分 | 精确识别］
- 小标准1.1.A.1［2分 | 精确性｜允许误差=0］：在《客户联系人表》中筛选`联系优先级=1`，提取并**按客户ID去重**；核验值：**去重后客户ID数量=105**。  
  ```
  INPUT: 联系人表 Contact(L_客户ID, 联系优先级, 其他…)
  STEP1: F = Filter(Contact, 联系优先级 == 1)
  STEP2: U = Unique(F.L_客户ID)           # 客户ID去重
  STEP3: n = Count(U)
  ASSERT n == 105                          # 允许误差=0（示例数据）；真实数据请给出实际n并说明
  OUTPUT: U, n
  ```
---
## 需求2：量化客户投诉与工单处理情况指标（本需求最高可得12分）
### 标准2.1［最高6分］投诉处理核心指标分析
#### 路径2.1.A［6分 | 文本口径（字段“投诉处理速度”形如“34h”）］
- 小标准2.1.A.1［2分 | 完备性］：声明文本解析规则（正则`^\d+(\.\d+)?h$`）、样本范围（仅P1）、异常处理（不匹配即剔除），工单聚合=均值。
- 小标准2.1.A.2［4分 | 精确性］：**（判分说明补充：以下数值为“示例数据的核验参考值”。若为真实库/动态数据，允许±10%区间内的偏差，或给出与示例不同但口径一致的结果，并在方案中说明。）**  
  核验值：  
  - 平均投诉满意度=**3.01**；平均投诉处理速度（文本口径）=**36.80h**；  
  - 1星差评率=**21.43%**；2星差评率=**17.30%**（或合计**38.73%**）。  
  ```
  INPUT: 投诉表 C(工单ID, 投诉客户满意度, 投诉处理速度_text, …)
  STEP1: C1 = Filter(C, 投诉处理速度_text matches r"^\d+(\.\d+)?h$")
  STEP2: C1.速度h = ParseFloat(RemoveSuffix(C1.投诉处理速度_text, "h"))
  STEP3: G = GroupBy(C1, 工单ID).Agg(
            csat = mean(投诉客户满意度),
            speed = mean(速度h),
            star1 = mean(投诉客户满意度 == 1),
            star2 = mean(投诉客户满意度 == 2)
          )
  STEP4: out.csat = mean(G.csat)
         out.speed = mean(G.speed)
         out.star1 = mean(G.star1) * 100%
         out.star2 = mean(G.star2) * 100%
  ASSERT |out.csat - 3.01|  <= 0.05
  ASSERT |out.speed - 36.80|<= 0.05
  ASSERT |out.star1 - 21.43|<= 0.5
  ASSERT |out.star2 - 17.30|<= 0.5
  OUTPUT: out
  ```
#### 路径2.1.B［6分 | 时间戳口径（速度=解决时间−提交时间）］
- 小标准2.1.B.1［2分 | 完备性］：声明口径（小时）、范围（仅P1）、异常（负时长/空值剔除），工单聚合=均值。
- 小标准2.1.B.2［4分 | 精确性｜有固定答案］：核验值：
  - 平均投诉满意度=**3.01**；平均投诉处理速度（timestamp）=**16664.21h**。
  **核验伪算法：**
  ```
  INPUT: 投诉表 C(工单ID, 投诉客户满意度, 投诉提交时间, 投诉解决时间)
  STEP1: C1 = DropNA(C, [投诉提交时间, 投诉解决时间, 投诉客户满意度])
  STEP2: C1.速度h = Hours(C1.投诉解决时间 - C1.投诉提交时间)
  STEP3: C1 = Filter(C1, 速度h >= 0)
  STEP4: G = GroupBy(C1, 工单ID).Agg(
            csat = mean(投诉客户满意度),
            speed = mean(速度h)
          )
  STEP5: out.csat = mean(G.csat)
         out.speed = mean(G.speed)
  ASSERT |out.csat - 3.01|     <= 0.05
  ASSERT |out.speed - 16664.21|<= 0.05
  OUTPUT: out
  ```
#### 路径2.1.C［6分 | 合成指标（无固定答案，需可复现）］
- 小标准2.1.C.1［2分 | 完备性］：定义`Index = Z(csat) - Z(speed_ts)`；标准化=Z-score；范围=全部P1投诉；聚合=样本均值。
- 小标准2.1.C.2［4分 | 精确性］：
  ```
  INPUT: 投诉表 C(工单ID, 投诉客户满意度, 投诉提交时间, 投诉解决时间)
  STEP1: 构造时间戳速度，见路径2.1.B的STEP1-3 → 得 C1(工单ID, csat, speedh)
  STEP2: S = Select(C1, [csat, speedh])  # 明确口径：不再按工单聚合，逐记录标准化
  STEP3: Z_csat  = ZScore(S.csat)
         Z_speed = ZScore(S.speedh)
  STEP4: Index = Z_csat - Z_speed
  STEP5: out.mean = mean(Index)
  # 期望理论均值接近 0.00（Z差均衡），不设固定数值，但需输出可复核结果
  OUTPUT: out.mean, Index分布
  ```
#### 路径2.1.D［6分 | 自定义指标（无固定答案，需可复现）］
- 小标准2.1.D.1［2分 | 完备性］：定义`X = 0.6*Z(csat) + 0.4*Z(speed_ts)`；声明权重来源、缺失处理。
- 小标准2.1.D.2［4分 | 精确性］：
  ```
  INPUT: 同2.1.C
  STEP1-3: 同2.1.C
  STEP4: X = 0.6*Z_csat + 0.4*Z_speed
  STEP5: out.mean = mean(X)
  OUTPUT: out.mean, X分布
  ```
#### 路径2.1.E［6分 | 投诉类型分布（无固定答案，需可复现）］
- 小标准2.1.E.1［2分 | 完备性］：声明类型归并字典、仅P1样本、异常类型归为“其他”。**（判分说明补充：若字段已为标准化类型，可明确声明“字典为恒等映射（identity）”。）**
- 小标准2.1.E.2［4分 | 精确性］：**（判分说明补充：SQL/伪代码/等价代码均可。可输出全量分布，或“Top-N + ‘其他’”且合计≈100%。）**  
  ```
  INPUT: 投诉表 C(工单ID, 投诉类型, …)
  STEP1: C1.类型 = Map(C.投诉类型, 字典) default="其他"
  STEP2: P = 100% * CountBy(C1.类型) / Count(C1)   # 占比
  STEP3: ASSERT |sum(P.values) - 100| <= 0.1
  OUTPUT: 按占比降序的类型分布表
  ```
### 标准2.2［最高6分］工单处理核心指标分析
#### 路径2.2.A［6分 | 逐工单均值（有固定答案）］
- 小标准2.2.A.1［2分 | 完备性］：范围=仅P1工单（若无法区分，须在**方案**中声明使用全量替代）；指标=平均工单满意度、平均工单耗时、“高”紧急占比；缺失/异常处理说明。  
  **（判分说明补充：并列展示可用表格或文字均可；若耗时字段为数值或带“h”的文本均可，需说明单位与解析口径一致。）**
- 小标准2.2.A.2［4分 | 精确性］：核验值：  
  - 平均工单满意度=**3.00**；平均工单耗时=**37.04h**；“高”紧急占比=**33.41%**。  
  **核验伪算法：**
  ```
  INPUT: 工单表 W(工单ID, 工单客户满意度评分, 工单耗时, 工单处理紧急程度, 工单优先级, …)
  STEP1: W1 = Filter(W, 工单优先级 == 1) or W 全量(替代需明示)
  STEP2: ASSERT 工单耗时单位为小时 (若字符串"h"需解析为数值)
  STEP3: out.mean_satisfaction = mean(W1.工单客户满意度评分)
         out.mean_hours       = mean(W1.工单耗时)
         out.rate_high        = mean(W1.工单处理紧急程度 == "高") * 100%
  ASSERT |out.mean_satisfaction - 3.00| <= 0.05
  ASSERT |out.mean_hours - 37.04|       <= 0.05
  ASSERT |out.rate_high - 33.41|        <= 0.5
  OUTPUT: out
  ```
#### 路径2.2.B［6分 | 分层加权（无固定答案，需可复现）］
- 小标准2.2.B.1［2分 | 完备性］：按`{高/中/低}`分层；层内均值，按层样本占比加权；权重与层样本量一致。
- 小标准2.2.B.2［4分 | 精确性］：
  ```
  INPUT: 同2.2.A STEP1后的 W1
  STEP1: 分层 L ∈ {"高","中","低"}
  STEP2: For each L:
            m_s[L] = mean(W1.工单客户满意度评分 | 层=L)
            m_h[L] = mean(W1.工单耗时 | 层=L)
            w[L]   = Count(层=L) / Count(W1)
  STEP3: out.mean_s = sum_L w[L]*m_s[L]
         out.mean_h = sum_L w[L]*m_h[L]
         out.rate_high = w["高"]*100%
  OUTPUT: out（与2.2.A对齐性可作为一致性校验）
  ```
#### 路径2.2.C［6分 | 坐席加权（无固定答案，需可复现）］
- 小标准2.2.C.1［2分 | 完备性］：按`工单处理客服人工号`聚合；权重=该坐席处理工单量；对极端坐席（n<3）声明处理。
- 小标准2.2.C.2［4分 | 精确性］：
  ```
  INPUT: 同2.2.A STEP1后的 W1
  STEP1: S = GroupBy(W1, 工单处理客服人工号).Agg(
            s_mean = mean(工单客户满意度评分),
            h_mean = mean(工单耗时),
            n = count()
          )
  STEP2: 过滤极端坐席（可选）：S1 = Filter(S, n >= 3) else S
  STEP3: w[i] = S1.n[i] / sum(S1.n)
         out.mean_s = sum_i w[i]*S1.s_mean[i]
         out.mean_h = sum_i w[i]*S1.h_mean[i]
         out.rate_high = mean(W1.工单处理紧急程度=="高")*100%
  OUTPUT: out
  ```
#### 路径2.2.D［6分 | 工单类型差异（无固定答案，需可复现）］
- 小标准2.2.D.1［2分 | 完备性］：声明类型映射（咨询/故障/退订/其他），仅P1样本。
- 小标准2.2.D.2［4分 | 精确性］：
  ```
  INPUT: W1(含 工单类型)
  STEP1: W1.类型 = Map(W1.工单类型, 字典) default="其他"
  STEP2: T = GroupBy(W1, 类型).Agg(
            mean_s = mean(工单客户满意度评分),
            mean_h = mean(工单耗时),
            share  = count()/Count(W1)
          )
  STEP3: 输出 T 按 share 降序
  OUTPUT: 类型差异表
  ```
---
## 需求3：在总体基准下完成对服务质量的对比评估（本需求最高可得6分）
### 标准3.1［最高6分］服务质量对比评估
#### 路径3.1.A［6分 | 静态均值对比（有固定答案）］
- 小标准3.1.A.1［2分 | 完备性］：并列展示P1与全体在5项指标（投诉满意度、投诉速度_ts、工单满意度、工单耗时、“高”紧急占比）；口径一致。  
  **（判分说明补充：并列展示可用表格或文字逐项对照均可；如“全体”口径无法直接获得，可明确声明使用全量替代且保持口径一致。）**
- 小标准3.1.A.2［3分 | 精确性］：核验对比值（P1=全体）：  
  - 投诉满意度 **3.01 vs 3.01**；投诉速度_ts **16664.21h vs 16664.21h**  
  - 工单满意度 **3.00 vs 3.00**；工单耗时 **37.04h vs 37.04h**；“高”紧急占比 **33.41% vs 33.41%**  
  **核验伪算法：**
  ```
  INPUT: P1指标表 M1(五项), 全体指标表 M0(五项)
  STEP1: 对五项逐一比较差值 Δ = M1 - M0
  STEP2: ASSERT |Δ_满意度(投诉)| <= 0.05
         ASSERT |Δ_速度(投诉)|   <= 0.05
         ASSERT |Δ_满意度(工单)| <= 0.05
         ASSERT |Δ_耗时(工单)|   <= 0.05
         ASSERT |Δ_高占比|       <= 0.5
  OUTPUT: Δ表
  ```
- 小标准3.1.A.3［1分 | 结论性］：**宏观表述**：P1与全体在关键体验指标上**完全持平**；目前看不到“资源倾斜带来体验红利”的证据。  
  **（判分说明补充：以下表述均视为等价合格：如“基本持平”“差异极小”“无显著差异”“整体接近/一致”。）**
#### 路径3.1.B［6分 | 相对差对比（无固定答案，需可复现）］
- 小标准3.1.B.1［2分 | 完备性］：定义相对差`RelDiff = (P1 - 全体)/全体`，百分比展示（两位小数）。
- 小标准3.1.B.2［3分 | 精确性］：
  ```
  INPUT: 同3.1.A
  STEP1: RelDiff = (M1 - M0) / M0 * 100%
  STEP2: 输出各指标RelDiff；若 |RelDiff| < 1pp 统一标注为“≈0”
  OUTPUT: RelDiff表
  ```
- 小标准3.1.B.3［1分 | 结论性］：**宏观表述**：相对差几乎为零，说明**结构未能带来体验优势**，需从“流程/策略”层面寻找突破。
#### 路径3.1.C［6分 | 显著性检验（无固定答案，需可复现）］
- 小标准3.1.C.1［2分 | 完备性］：设`H0：P1与全体均值相等`（工单满意度、工单耗时），采用Welch t检验；报告p值与Cohen’s d。
- 小标准3.1.C.2［3分 | 精确性］：
  ```
  INPUT: P1样本向量 S1, 全体样本向量 S0（各取“工单满意度/耗时”）
  STEP1: (t, p) = WelchT(S1, S0)
  STEP2: d = CohenD(S1, S0)               # 标准化效应量
  STEP3: 输出 p 与 d；标注 α=0.05
  OUTPUT: {p, d}
  ```
- 小标准3.1.C.3［1分 | 结论性］：**宏观表述**：若`p≥0.05且|d|小`，则“**统计上无差异**”；应将资源投入转向**提高首次解决率/投诉处置质量**。
#### 路径3.1.D［6分 | 服务健康指数SHI（无固定答案，需可复现）］
- 小标准3.1.D.1［2分 | 完备性］：定义`SHI = 0.4*Z(投诉满意度) - 0.3*Z(工单耗时) - 0.3*Z(投诉速度_ts)`；做±10%权重敏感性。
- 小标准3.1.D.2［3分 | 精确性］：
  ```
  INPUT: 指标矩阵（P1或全体）
  STEP1: 标准化：对三项指标各做Z-score
  STEP2: 计算SHI_base
  STEP3: 权重±10%生成若干组合，复算区间 [min, max]
  OUTPUT: SHI_base, 区间
  ```
- 小标准3.1.D.3［1分 | 结论性］：**宏观表述**：若P1与全体SHI接近且敏感性稳健，则“**系统健康度等量**”，优化需瞄准瓶颈环节而非堆叠资源。
#### 路径3.1.E［6分 | 时间序列趋势对比（无固定答案，需可复现）］
- 小标准3.1.E.1［2分 | 完备性］：按**周**聚合≥6期：投诉速度_ts/投诉满意度/工单耗时/工单满意度。
- 小标准3.1.E.2［3分 | 精确性］：
  ```
  INPUT: 带时间戳的记录
  STEP1: 周期字段 = ToWeek(时间戳)
  STEP2: 周聚合得到四条时间序列（P1与全体各一套）
  STEP3: 线性回归求斜率slope；输出slope_P1与slope_All
  OUTPUT: 斜率对比表
  ```
- 小标准3.1.E.3［1分 | 结论性］：**宏观表述**：若P1的“满意度斜率≤全体且耗时斜率≥全体”，说明**没有在时间维实现体验追赶**。
#### 路径3.1.F［6分 | 客户分群对比（无固定答案，需可复现）］
- 小标准3.1.F.1［2分 | 完备性］：按行业/规模/地区进行P1与全体分群；保证每群样本≥30（不足合并为“其他”）。
- 小标准3.1.F.2［3分 | 精确性］：
  ```
  INPUT: 客户维度表 + 关联后的指标
  STEP1: 分群标签 = Map(行业/规模/地区)
  STEP2: 对每群分别计算(P1, 全体)的均值与差值/相对差
  STEP3: 生成群内对比表；标注显著性(可选t检验)
  OUTPUT: 分群差异矩阵
  ```
- 小标准3.1.F.3［1分 | 结论性］：**宏观表述**：若差异集中在特定群体，说明**结构性因素**（如行业复杂度）主导，需**定制化SLA与知识库**。
