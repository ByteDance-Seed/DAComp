# [Total Score | 23 points] The solution must satisfy the following three core requirements:
- Requirement 1: Analyze 2022-2024 annual profit margin volatility for every `Product Category` and identify the category with the largest swing.
- Requirement 2: Diagnose the drivers behind the volatility of that category.
- Requirement 3: Use RFM segmentation to determine whether the category’s core consumers are more sensitive to the identified driver.
---
## Requirement 1: Analyze 2022-2024 annual profit margin volatility by category (maximum 9 points)
### Criterion 1.1: Profit margin calculation for each category (maximum 2 points)
#### Path 1.1.A [2 pts | Profit margin computation]
- Sub-criterion 1.1.A.1 [1 pt | Completeness]: Using `order_information`, compute the profit margin for all four categories (Home & Furniture / Electronic / Auto & Accessories / Fashion) for 2022-2024. Explicitly state the definition `Profit Margin = Σ(profit) ÷ Σ(Sales) × 100%`, grouped by `Product Category` and order year (derived from `Order Date`).
- Sub-criterion 1.1.A.2 [1 pt | Accuracy]: The profit margin math is correct. Reference values:
  | Product Category   | 2022 Profit Margin | 2023 Profit Margin | 2024 Profit Margin |
  |--------------------|--------------------|--------------------|--------------------|
  | Home & Furniture   | 44.43%             | 44.97%             | 44.20%             |
  | Electronic         | 44.31%             | 44.02%             | 44.04%             |
  | Auto & Accessories | 44.01%             | 44.24%             | 44.18%             |
  | Fashion            | 47.71%             | 47.62%             | 47.64%             |
### Criterion 1.2: Magnitude of fluctuation (maximum 5 points)
#### Path 1.2.A [2 pts | Range, absolute volatility]
- Sub-criterion 1.2.A.1 [1 pt | Completeness]: For each category, compute the three-year range (max − min) of profit margin, label the unit as percentage points (pp), and explicitly state in text that “the range reflects the absolute span of profit margin volatility.”
- Sub-criterion 1.2.A.2 [1 pt | Accuracy]: Ranges match the reference values:
  - Auto & Accessories: 44.24% − 44.01% = **0.23pp**
  - Electronic: 44.31% − 44.02% = **0.29pp**
  - Fashion: 47.71% − 47.62% = **0.09pp**
  - Home & Furniture: 44.97% − 44.20% = **0.77pp**
#### Path 1.2.B [2 pts | Standard deviation of annual margins]
- Sub-criterion 1.2.B.1 [1 pt | Completeness]: Compute the three-year standard deviation of profit margins for every category, indicate the formula, cite the unit (pp), and explain that standard deviation reflects dispersion and can be cross-checked with the range when the sample size (three years) is small.
- Sub-criterion 1.2.B.2 [1 pt | Accuracy]: Reference values:
  - Home & Furniture: **0.32pp**
  - Electronic: **0.13pp**
  - Auto & Accessories: **0.10pp**
  - Fashion: **0.04pp**
#### Path 1.2.C [2 pts | Coefficient of variation, CV = std ÷ mean]
- Sub-criterion 1.2.C.1 [1 pt | Completeness]: Compute the coefficient of variation for each category, show the formula `CV = standard deviation ÷ mean × 100%`, state the unit (%) and note that CV captures relative volatility.
- Sub-criterion 1.2.C.2 [1 pt | Accuracy]: Reference values:
  - Home & Furniture: **0.73%**
  - Electronic: **0.30%**
  - Auto & Accessories: **0.22%**
  - Fashion: **0.08%**
#### Path 1.2.D [2 pts | Mean absolute deviation (MAD) around the mean]
- Sub-criterion 1.2.D.1 [1 pt | Completeness]: Compute the mean absolute deviation of the three-year margins for each category, provide the formula, cite the unit (pp), and mention that MAD is more robust to outliers than standard deviation.
- Sub-criterion 1.2.D.2 [1 pt | Accuracy]: Reference values (pp): Home & Furniture **0.29**, Electronic **0.12**, Auto & Accessories **0.09**, Fashion **0.04**.
#### Path 1.2.E [2 pts | Robust MAD = 1.4826 × median|x − median|]
- Sub-criterion 1.2.E.1 [1 pt | Completeness]: Compute the robust MAD for each category, explain how it differs from MAD/standard deviation and when it is preferred.
- Sub-criterion 1.2.E.2 [1 pt | Accuracy]: Reference values (pp): Home & Furniture **0.34**, Electronic **0.03**, Auto & Accessories **0.09**, Fashion **0.03**.
#### Path 1.2.F [5 pts | Additional fluctuation measures]
- Sub-criterion 1.2.F.1 [1 pt | Completeness]: Interquartile Range (IQR = Q3 − Q1) focuses on the middle 50% span and downweights tail noise.
- Sub-criterion 1.2.F.2 [1 pt | Completeness]: Dynamic | Mean Absolute Change (MAC = mean(|Δ|)) measures the magnitude of adjacent-year swings, highlighting “jitter.”
- Sub-criterion 1.2.F.3 [1 pt | Completeness]: Dynamic | Standard deviation of differences `sd(Δ)` measures dispersion of the year-on-year delta series without regard to direction.
- Sub-criterion 1.2.F.4 [1 pt | Completeness]: Dynamic | Root mean square change `RMSΔ = sqrt(mean(Δ²))` penalizes large swings more heavily and captures “energy-style” volatility.
- Sub-criterion 1.2.F.5 [1 pt | Completeness]: Dynamic | Mean absolute percentage change (MAPC) benchmarks volatility relative to the prior year, enabling comparisons across sequences with different scales.
### Criterion 1.3: Identify the category with the greatest volatility (maximum 2 points)
#### Path 1.3.A [2 pts | Identification of the most volatile category]
- Sub-criterion 1.3.A.1 [1 pt | Completeness]: Based on the selected volatility metric(s), identify the category with the largest swing, cite the metric used, and provide a concise rationale.
- Sub-criterion 1.3.A.2 [1 pt | Accuracy]: The correct answer is **Home & Furniture**.
---
## Requirement 2: Diagnose why Home & Furniture’s profit margin fluctuated (maximum 9 points)
### Criterion 2.1: Cost factors (maximum 2 points)
#### Path 2.1.A [2 pts | Shipping method / unit freight]
- Sub-criterion 2.1.A.1 [1 pt | Completeness]: Using Home & Furniture records in `order_information`, calculate the change in unit shipping cost over the three years. Prefer `Unit Freight = Σ(Shipping Cost) ÷ Σ(Quantity)`; if `Quantity` is missing or unreliable, explicitly state the issue and use `Σ(Shipping Cost) ÷ Σ(Sales)` (or an equivalent ratio) as a proxy, explaining why it is acceptable.
- Sub-criterion 2.1.A.2 [1 pt | Accuracy]: Unit freight (or the declared proxy) must match the trend: 2024 (1.85) < 2023 (1.94), **down ~4.5%**, and across categories 2024 unit freight decreased or stayed flat (Auto & Accessories −2.9%, Electronic −2.7%, Home & Furniture −4.5%, Fashion +0.7%).
### Criterion 2.2: Product-level factors (maximum 4 points)
#### Path 2.2.A [2 pts | SKU structure]
- Sub-criterion 2.2.A.1 [1 pt | Completeness]: Segment Home & Furniture products into terciles (High / Medium / Low) based on average gross margin. Explain the rule (e.g., equal-sized buckets using `NTILE(3)` on average profit margin) and compute each tier’s annual share of category sales.
- Sub-criterion 2.2.A.2 [1 pt | Accuracy]: Sales-share results align with the reference:
  - 2022: High 51.42% | Medium 19.22% | Low 29.36%
  - 2023: High 57.54% | Medium 13.50% | Low 28.97%
  - 2024: High 49.54% | Medium 20.07% | Low 30.38%
  Calculation logic: For each `Product` within Home & Furniture, compute historical average margin `= Σ(profit) ÷ Σ(Sales)`, rank and bucket into three tiers, then for each year compute `Tier Share = Σ(Sales_tier, year) ÷ Σ(Sales_category, year) × 100%`.
#### Path 2.2.B [2 pts | Product contribution and margin shifts]
- Sub-criterion 2.2.B.1 [1 pt | Completeness]: For every Home & Furniture product, calculate 2024−2023 changes in profit, net unit price, net profit margin, and quantity (or an explicit proxy). If `Quantity` is unusable, declare the constraint and use `Net Sales ÷ number of orders` as the unit-price proxy, noting the limitation.
- Sub-criterion 2.2.B.2 [1 pt | Accuracy]: Calculations for the key SKUs match the reference table. Minimum evidence: present a table or code output listing the top negative contributors.
  | Product | Profit_2023 | Profit_2024 | Profit Δ | Net Unit Price Δ | Net Margin Δ | Quantity Δ |
  | --- | --- | --- | --- | --- | --- | --- |
  | Dinner Crockery | 13746.0 | 15167.0 | 1421.0 | -0.74 | -0.0014 | 124 |
  | Beds | 11498.5 | 12135.5 | 637.0 | -0.86 | -0.0228 | 148 |
  | Sofas | 9995.0 | 10514.8 | 519.8 | -0.32 | -0.0015 | 69 |
  | Dinning Tables | 9416.9 | 9554.1 | 137.2 | 1.27 | 0.0040 | -37 |
  | Shoe Rack | 11502.2 | 11625.6 | 123.4 | 2.89 | 0.0075 | -88 |
  | Curtains | 5547.3 | 5202.9 | -344.4 | 0.01 | -0.0053 | -56 |
  | Umbrellas | 11479.8 | 10727.7 | -752.1 | -1.84 | -0.0286 | 75 |
  | Bed Sheets | 39712.0 | 37253.7 | -2458.3 | 0.74 | -0.0039 | -69 |
  | Sofa Covers | 40845.9 | 38348.2 | -2497.7 | -1.05 | 0.0023 | -53 |
  | Towels | 44629.2 | 41059.1 | -3570.1 | -4.09 | -0.0037 | -21 |
  Definitions: `Net Sales = Sales × (1 − Discount)`; `Weighted Net Unit Price = Σ(Net Sales) ÷ Σ(Quantity)` at product-year grain; `Net Profit Margin = Σ(profit) ÷ Σ(Net Sales)`.
### Criterion 2.3: Pricing strategy factors (maximum 2 points)
#### Path 2.3.A [2 pts | Pricing diagnostics]
- Sub-criterion 2.3.A.1 [1 pt | Completeness]: Evaluate whether category-level or product-level sales/discount shifts signal self-initiated price cuts. Provide 2022, 2023, 2024 metrics plus the 2024−2023 deltas for discount rate and weighted unit price.
- Sub-criterion 2.3.A.2 [1 pt | Accuracy]: Discount rates must be gross-amount-weighted (`Σ Discount Amount ÷ Σ Gross Amount`, where Gross Amount = Original Unit Price × Quantity). If a net-weighted variant is used, present both and note that their difference ≤0.1pp leaves the conclusion unchanged. Weighted unit price = `Σ(Original Unit Price × Quantity) ÷ Σ Quantity`, where `Original Unit Price = Sales ÷ [(1 − Discount) × Quantity]`. Report discount rates with four decimals and unit prices with two decimals.
  | Product | 2024 Discount Rate | 2023 Discount Rate | Discount Δ | 2024 Weighted Unit Price | 2023 Weighted Unit Price | Unit Price Δ |
  | --- | --- | --- | --- | --- | --- | --- |
  | Bed Sheets | 0.0313 | 0.0299 | 0.0015 | 73.79 | 72.77 | 1.01 |
  | Beds | 0.0301 | 0.0304 | -0.0003 | 25.72 | 26.65 | -0.93 |
  | Curtains | 0.0305 | 0.0296 | 0.0009 | 11.62 | 11.59 | 0.03 |
  | Dinner Crockery | 0.0298 | 0.0297 | 0.0001 | 45.94 | 46.72 | -0.78 |
  | Dinning Tables | 0.0301 | 0.0309 | -0.0008 | 40.78 | 39.49 | 1.28 |
  | Shoe Rack | 0.0289 | 0.0299 | -0.0010 | 45.11 | 42.12 | 2.98 |
  | Sofa Covers | 0.0298 | 0.0305 | -0.0008 | 73.38 | 74.62 | -1.24 |
  | Sofas | 0.0325 | 0.0299 | 0.0026 | 23.00 | 23.21 | -0.22 |
  | Towels | 0.0296 | 0.0301 | -0.0005 | 74.91 | 79.34 | -4.43 |
  | Umbrellas | 0.0313 | 0.0295 | 0.0018 | 23.32 | 25.19 | -1.87 |
### Criterion 2.4: Operational factors (maximum 1 point)
#### Path 2.4.A [1 pt | Engagement diagnostics]
- Sub-criterion 2.4.A.1 [1 pt | Completeness]: Define yearly customer sets via `order_information` (2023 = customers who placed Home & Furniture orders in 2023; 2024 similarly). Join those customer IDs to `product_browsing` filtered to the Home & Furniture category and aggregate `Browsing Time (minutes)`, `like`, `share`, and `Add to Cart` for each year. Report the 2024−2023 deltas.
- Sub-criterion 2.4.A.2 [1 pt | Accuracy]: Calculations must match the reference table; if all deltas hover around ±1% with no structural drift, conclude “slight decline but no strong operational shock.”
  | 2023 Browsing Time | 2023 Likes | 2023 Shares | 2023 Add to Cart | 2024 Browsing Time | 2024 Likes | 2024 Shares | 2024 Add to Cart | Browsing Time Δ | Likes Δ | Shares Δ | Add to Cart Δ |
  | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
  | 181558.90 | 5648 | 5029 | 6871 | 180832.20 | 5613 | 5006 | 6830 | -726.70 | -35 | -23 | -41 |
  (Δ = 2024 − 2023; browsing time to 2 decimals, others as integers.)
### Criterion 2.5: Attribution summary (maximum 2 points)
#### Path 2.5.A [2 pts | Synthesis]
- Sub-criterion 2.5.A.1 [1 pt | Completeness]: Summarize the root causes across cost, SKU structure, product performance, pricing, and operations.
- Sub-criterion 2.5.A.2 [1 pt | Accuracy]: Conclusions must align with the quantified findings above, e.g.:
  - Cost: Shipping costs did not rise, so the cost channel is not the pressure source.
  - SKU structure: High-margin tier share fell in 2024 (≈−8pp) while medium/low tiers rose, dragging down overall margins.
  - Product performance: Towels (−3570.1), Sofa Covers (−2497.7), Bed Sheets (−2458.3), and Umbrellas (profit −752.1 with net margin −0.0286) are major negatives; modest gains from Beds/Sofas cannot offset them, so volume and net margin erosion drive the decline.
  - Pricing: Discount changes stayed within ±0.26pp and weighted unit prices mostly moved within ±3, indicating no broad-based markdown campaign.
  - Operations: Browsing and engagement dipped slightly (e.g., browsing time −726.7 minutes, likes −35), showing mild softening but no structural shock.
---
## Requirement 3: Use RFM segmentation to test whether core consumers are more sensitive to the driver (maximum 5 points)
### Criterion 3.1: RFM metric definition (maximum 1 point)
#### Path 3.1.A [1 pt | Define R, F, M with quintile scores]
- Sub-criterion 3.1.A.1 [1 pt | Completeness]: Define R (recency in days from fixed date 2024-12-31), F (frequency = number of orders), and M (monetary = sales or profit, with rationale). Use `order_information` (`Order Date`, `Order ID`, Sales/profit) to compute each metric, then assign quintile scores (1–5). Provide reproducible bins (e.g., q20/q40/q60/q80) and note R is reverse-scored while F/M are forward-scored.
  - R (days) percentiles: q20=3, q40=7, q60=15, q80=16
    | Score | Range (days) |
    | --- | --- |
    | 5 | R ≤ 3 |
    | 4 | (3, 7] |
    | 3 | (7, 15] |
    | 2 | (15, 16] |
    | 1 | > 16 |
  - F (orders) percentiles: q20=53, q40≈60.6, q60=67, q80=76
    | Score | Range (orders) |
    | --- | --- |
    | 1 | F ≤ 52 |
    | 2 | 53–60 |
    | 3 | 61–67 |
    | 4 | 68–76 |
    | 5 | ≥ 77 |
  - M (cumulative sales) percentiles: q20=8,225.80; q40=9,412.20; q60=10,522.80; q80=12,011.80
    | Score | Range (amount) |
    | --- | --- |
    | 1 | M < 8,225.80 |
    | 2 | [8,225.80, 9,412.20] |
    | 3 | (9,412.20, 10,522.80] |
    | 4 | (10,522.80, 12,011.80] |
    | 5 | > 12,011.80 |
### Criterion 3.2: Define core consumers (maximum 2 points)
#### Path 3.2.A [2 pts | Core definition]
- Sub-criterion 3.2.A.1 [1 pt | Completeness]: Define core consumers as those with R ≥ 4, F ≥ 4, and M ≥ 4 (or state and justify another reproducible rule such as top 10%).
- Sub-criterion 3.2.A.2 [1 pt | Accuracy]: Ensure the definition is internally consistent (thresholds, counts, share of population) so the same rule can be reproduced in Criterion 3.3. If using the default rule, clearly state the resulting customer count or percentage.
### Criterion 3.3: Sensitivity of core consumers to the driver (maximum 2 points)
#### Path 3.3.A [2 pts | Sensitivity assessment]
- Sub-criterion 3.3.A.1 [1 pt | Completeness]: Compare core vs. non-core customers on the same driver identified in Requirement 2 (e.g., share of high-margin tier or profit swings of the negative SKUs). Provide at least one quantitative contrast (difference, Δpp, standard deviation, etc.).
- Sub-criterion 3.3.A.2 [1 pt | Accuracy]: Quantities must reconcile with the segmentation and driver definitions. Reference values:
  | Consumer Segment | 2022 High-Margin Tier Share (%) | 2023 High-Margin Tier Share (%) | 2024 High-Margin Tier Share (%) |
  | --- | --- | --- | --- |
  | RFM ≥ 4 | 58.68 | 57.96 | 54.82 |
  | RFM < 4 | 55.85 | 57.34 | 55.21 |
  | Product | RFM ≥ 4 Profit 2022 | RFM ≥ 4 Profit 2023 | RFM ≥ 4 Profit 2024 | RFM < 4 Profit 2022 | RFM < 4 Profit 2023 | RFM < 4 Profit 2024 |
  | --- | --- | --- | --- | --- | --- | --- |
  | Towels | 15042.3 | 13733.3 | 14998.8 | 30427.4 | 30895.9 | 26060.3 |
  | Bed Sheets | 13193.1 | 13449.8 | 12392.9 | 24814.3 | 26262.2 | 24860.8 |
  | Sofa Covers | 13760.0 | 13238.3 | 10734.6 | 26439.0 | 27607.6 | 27613.6 |
  | Dinner Crockery | 4952.7 | 4121.0 | 5416.9 | 9478.8 | 9625.0 | 9750.1 |
  | Shoe Rack | 3257.0 | 3765.7 | 3844.1 | 7633.9 | 7736.5 | 7781.5 |
  | Beds | 4543.5 | 3537.3 | 3675.1 | 7575.1 | 7961.2 | 8460.4 |
  | Sofas | 2491.6 | 2911.7 | 3355.1 | 7742.0 | 7083.3 | 7159.7 |
  | Dinning Tables | 2920.8 | 3094.0 | 3062.3 | 6983.2 | 6322.9 | 6491.8 |
  | Umbrellas | 3764.3 | 3081.7 | 2981.3 | 7288.8 | 8398.1 | 7746.4 |
  | Curtains | 1646.0 | 2025.1 | 1525.4 | 3699.1 | 3522.2 | 3677.5 |
  Example conclusion: For the high-margin tier, RFM ≥ 4 customers show a sharper decline (58.68% → 54.82%, −3.86pp, std 2.05) than RFM < 4 (55.85% → 55.21%, −0.64pp, std 1.09), indicating that the core group is more sensitive to structural mix shifts. For individual-product profit swings, the average absolute year-over-year change is ≈675 for RFM ≥ 4 versus ≈714 for RFM < 4, and the 2022→2024 absolute change averages ≈770 vs. ≈845, showing larger SKU-level volatility among non-core customers.
---
Notes:
1. All accuracy criteria must be backed by reproducible calculations (SQL/code) that match the reference values.
2. Paths are mutually exclusive; do not double-count points.
3. Completeness requires clear methodology and rationale; incomplete explanations earn zero.
