Based on `klaviyo__campaigns` (with columns like `STATUS`/`STATUS_ID`, `SENT_AT`, `scheduled_to_send_at`, `EMAIL_TEMPLATE_ID`, `source_relation`, `count_received`, `count_opened`, `count_clicked`) and combined with activity metrics from `marts.klaviyo__persons`, build a campaign health framework.

Use Open Rate = `count_opened` ÷ `count_received` and Click-to-Open Rate = `count_clicked` ÷ `count_opened` as core metrics. Group the data by Campaign Type (e.g., Promotional/New Product/Storytelling) and audience size quantiles (< 10k, 10k–100k, > 100k, based on `count_received`). Calculate the mean and standard deviation of historical data from the last 6 months.

Set rules for anomaly detection: if a single campaign's metric falls below mean − 2σ or exceeds mean + 2σ, it should be flagged as an anomaly. Additionally, if the interval between a campaign's `updated_at` and the previous campaign's is < 24 hours, it should be identified as a high-frequency update anomaly. The analysis must trace the specific causes of anomalous campaigns, including sending time slot (weekday/weekend, morning/afternoon), template reuse frequency (percentage of the same `EMAIL_TEMPLATE_ID`), and copy theme (categorized by `source_relation`).

Finally, produce a diagnostic report that clearly outlines improvement directions for template governance (e.g., reduce reuse of templates with a >50% share), theme optimization (e.g., for theme types with low click-to-open rates), and sending cadence (e.g., avoid deployments with <24 hours between them). Propose at least one actionable A/B test plan (such as adjusting send time or replacing a template) and provide an estimated range for potential gains (e.g., projected 5–10% increase in open rate, 2–5% increase in click-to-open rate).
